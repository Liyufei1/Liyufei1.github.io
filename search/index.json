[{"content":"ğŸ“‹ ç›®å½• ç®€ä»‹ æ–¹æ¡ˆä¸€ï¼šlibcurlç›´æ¥è°ƒç”¨ æ–¹æ¡ˆäºŒï¼šopenai-cppåº“ æ–¹æ¡ˆä¸‰ï¼šcpr+jsonåº“ æ–¹æ¡ˆå¯¹æ¯” å®‰å…¨æ³¨æ„äº‹é¡¹ æ€»ç»“ ç®€ä»‹ éšç€å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å¿«é€Ÿå‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å¸Œæœ›åœ¨C++é¡¹ç›®ä¸­é›†æˆAIèƒ½åŠ›ã€‚ç„¶è€Œï¼ŒC++æ ‡å‡†åº“å¹¶ä¸ç›´æ¥æ”¯æŒHTTPè¯·æ±‚å’ŒJSONè§£æï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹åº“æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸‰ç§åœ¨C++é¡¹ç›®ä¸­å®‰å…¨ä½¿ç”¨API Keyè°ƒç”¨å¤§æ¨¡å‹æ¥å£çš„æ–¹æ¡ˆï¼Œå¸®åŠ©æ‚¨æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„è§£å†³æ–¹æ¡ˆã€‚\nåœ¨å¼€å§‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦åšå¥½ä»¥ä¸‹å‡†å¤‡å·¥ä½œï¼š\nè·å–API Keyï¼šè®¿é—®OpenAIã€Claudeæˆ–å…¶ä»–AIæœåŠ¡æä¾›å•†å®˜ç½‘ï¼Œæ³¨å†Œè´¦å·å¹¶è·å–API Key å¼€å‘ç¯å¢ƒï¼šç¡®ä¿å·²å®‰è£…æ”¯æŒC++11åŠä»¥ä¸Šæ ‡å‡†çš„ç¼–è¯‘å™¨ï¼ˆGCCã€Clangæˆ–MSVCï¼‰ ä¾èµ–ç®¡ç†ï¼šæ ¹æ®é€‰æ‹©çš„æ–¹æ¡ˆå®‰è£…ç›¸åº”çš„ä¾èµ–åº“ æ–¹æ¡ˆä¸€ï¼šlibcurlç›´æ¥è°ƒç”¨ æ–¹æ¡ˆæ¦‚è¿° libcurlæ˜¯ä¸€ä¸ªå¼ºå¤§çš„è·¨å¹³å°URLä¼ è¾“åº“ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„ç§ç½‘ç»œç¼–ç¨‹åœºæ™¯ã€‚å®ƒæä¾›äº†åº•å±‚çš„HTTPè¯·æ±‚æ§åˆ¶èƒ½åŠ›ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®Œå…¨æŒæ§è¯·æ±‚çš„æ¯ä¸€ä¸ªç»†èŠ‚ã€‚è¿™ç§æ–¹æ¡ˆè™½ç„¶çµæ´»æ€§æœ€é«˜ï¼Œä½†éœ€è¦ç¼–å†™æ›´å¤šçš„ä»£ç æ¥å¤„ç†HTTPåè®®ç»†èŠ‚å’ŒJSONæ•°æ®ã€‚\nç¯å¢ƒé…ç½® åœ¨Linuxç³»ç»Ÿä¸Šï¼Œå¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…libcurlï¼š\n1 2 3 4 5 6 7 8 # Ubuntu/Debian sudo apt-get install libcurl4-openssl-dev # CentOS/RHEL sudo yum install libcurl-devel # macOS brew install curl åœ¨Windowsä¸Šï¼Œæ‚¨å¯ä»¥ä¸‹è½½é¢„ç¼–è¯‘çš„DLLæ–‡ä»¶ï¼Œæˆ–è€…é€šè¿‡vcpkgã€conanç­‰åŒ…ç®¡ç†å™¨å®‰è£…ã€‚å®Œæˆåï¼Œåœ¨CMakeLists.txtä¸­é…ç½®é“¾æ¥ï¼š\n1 2 find_package(CURL REQUIRED) target_link_libraries(your_project PRIVATE CURL::libcurl) å®Œæ•´ä»£ç ç¤ºä¾‹ ä»¥ä¸‹æ˜¯ä½¿ç”¨libcurlç›´æ¥è°ƒç”¨OpenAI Chat Completion APIçš„å®Œæ•´ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;curl/curl.h\u0026gt; #include \u0026lt;nlohmann/json.hpp\u0026gt; using json = nlohmann::json; class OpenAIClient { private: std::string api_key_; std::string base_url_ = \u0026#34;https://api.openai.com/v1\u0026#34;; public: explicit OpenAIClient(const std::string\u0026amp; api_key) : api_key_(api_key) {} // å›è°ƒå‡½æ•°ç”¨äºæ¥æ”¶å“åº”æ•°æ® static size_t WriteCallback(void* contents, size_t size, size_t nmemb, std::string* userp) { userp-\u0026gt;append((char*)contents, size * nmemb); return size * nmemb; } json chat(const std::string\u0026amp; model, const std::string\u0026amp; message) { CURL* curl = curl_easy_init(); if (!curl) { throw std::runtime_error(\u0026#34;Failed to initialize CURL\u0026#34;); } // æ„å»ºè¯·æ±‚ä½“ json request_body = { {\u0026#34;model\u0026#34;, model}, {\u0026#34;messages\u0026#34;, { {{\u0026#34;role\u0026#34;, \u0026#34;user\u0026#34;}, {\u0026#34;content\u0026#34;, message}} }}, {\u0026#34;max_tokens\u0026#34;, 1000}, {\u0026#34;temperature\u0026#34;, 0.7} }; std::string response_string; struct curl_slist* headers = nullptr; headers = curl_slist_append(headers, \u0026#34;Content-Type: application/json\u0026#34;); std::string auth_header = \u0026#34;Authorization: Bearer \u0026#34; + api_key_; headers = curl_slist_append(headers, auth_header.c_str()); curl_easy_setopt(curl, CURLOPT_URL, (base_url_ + \u0026#34;/chat/completions\u0026#34;).c_str()); curl_easy_setopt(curl, CURLOPT_POST, 1L); curl_easy_setopt(curl, CURLOPT_POSTFIELDS, request_body.dump().c_str()); curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers); curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, WriteCallback); curl_easy_setopt(curl, CURLOPT_WRITEDATA, \u0026amp;response_string); curl_easy_setopt(curl, CURLOPT_TIMEOUT, 30L); curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1L); CURLcode res = curl_easy_perform(curl); long http_code = 0; curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, \u0026amp;http_code); curl_slist_free_all(headers); curl_easy_cleanup(curl); if (res != CURLE_OK) { throw std::runtime_error(\u0026#34;CURL request failed: \u0026#34; + std::string(curl_easy_strerror(res))); } if (http_code != 200) { throw std::runtime_error(\u0026#34;API request failed with HTTP code: \u0026#34; + std::to_string(http_code)); } return json::parse(response_string); } }; int main() { // ä»ç¯å¢ƒå˜é‡è¯»å–API Key const char* api_key = std::getenv(\u0026#34;OPENAI_API_KEY\u0026#34;); if (!api_key) { std::cerr \u0026lt;\u0026lt; \u0026#34;Error: Please set OPENAI_API_KEY environment variable\u0026#34; \u0026lt;\u0026lt; std::endl; return 1; } try { OpenAIClient client(api_key); std::cout \u0026lt;\u0026lt; \u0026#34;Sending request to OpenAI...\u0026#34; \u0026lt;\u0026lt; std::endl; json response = client.chat(\u0026#34;gpt-4o-mini\u0026#34;, \u0026#34;è¯·ç”¨ä¸€å¥è¯ä»‹ç»ä½ è‡ªå·±\u0026#34;); // è§£æå¹¶æ˜¾ç¤ºå“åº” std::string answer = response[\u0026#34;choices\u0026#34;][0][\u0026#34;message\u0026#34;][\u0026#34;content\u0026#34;]; std::cout \u0026lt;\u0026lt; \u0026#34;AI Response: \u0026#34; \u0026lt;\u0026lt; answer \u0026lt;\u0026lt; std::endl; } catch (const std::exception\u0026amp; e) { std::cerr \u0026lt;\u0026lt; \u0026#34;Error: \u0026#34; \u0026lt;\u0026lt; e.what() \u0026lt;\u0026lt; std::endl; return 1; } return 0; } ç¼–è¯‘ä¸è¿è¡Œ 1 2 3 4 5 6 # ç¼–è¯‘å‘½ä»¤ g++ -std=c++17 -o openai_demo main.cpp -lcurl # è®¾ç½®API Keyå¹¶è¿è¡Œ export OPENAI_API_KEY=\u0026#34;your-api-key-here\u0026#34; ./openai_demo ä¼˜ç¼ºç‚¹åˆ†æ ä¼˜ç‚¹ï¼š\nå®Œå…¨æ§åˆ¶HTTPè¯·æ±‚çš„æ¯ä¸€ä¸ªç»†èŠ‚ ä¾èµ–å°‘ï¼Œåªéœ€libcurl æ€§èƒ½é«˜ï¼Œå¼€é”€å° æ”¯æŒè‡ªå®šä¹‰è¶…æ—¶ã€é‡è¯•ã€ä»£ç†ç­‰ ç¼ºç‚¹ï¼š\nä»£ç é‡å¤§ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†HTTPåè®®ç»†èŠ‚ JSONè§£æéœ€è¦é¢å¤–ä¾èµ– é”™è¯¯å¤„ç†å¤æ‚ éœ€è¦è‡ªå·±å®ç°è¿æ¥æ± ã€é‡è¯•é€»è¾‘ æ–¹æ¡ˆäºŒï¼šopenai-cppåº“ æ–¹æ¡ˆæ¦‚è¿° openai-cppæ˜¯ä¸€ä¸ªè½»é‡çº§çš„header-only C++åº“ï¼Œä¸“é—¨ä¸ºOpenAI APIè®¾è®¡ã€‚å®ƒå°†å¤æ‚çš„HTTPè¯·æ±‚å°è£…æˆç®€æ´çš„C++æ¥å£ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹ã€‚ç›¸æ¯”ç›´æ¥ä½¿ç”¨libcurlï¼Œè¿™ä¸ªåº“å¤§å¤§é™ä½äº†ä½¿ç”¨é—¨æ§›ï¼ŒåŒæ—¶ä¿æŒäº†è¾ƒå¥½çš„çµæ´»æ€§ã€‚\nç¯å¢ƒé…ç½® å®‰è£…openai-cppéå¸¸ç®€å•ï¼Œåªéœ€å°†ä¸¤ä¸ªå¤´æ–‡ä»¶å¤åˆ¶åˆ°é¡¹ç›®ä¸­å³å¯ï¼š\n1 2 3 # ä¸‹è½½openai-cppåº“ git clone https://github.com/olrea/openai-cpp.git cp openai-cpp/include/openai ./your_project/include/ æˆ–è€…ä½¿ç”¨CMakeçš„FetchContentè‡ªåŠ¨ä¸‹è½½ï¼š\n1 2 3 4 5 6 include(FetchContent) FetchContent_Declare(openai-cpp GIT_REPOSITORY https://github.com/olrea/openai-cpp.git GIT_TAG main) FetchContent_MakeAvailable(openai-cpp) target_link_libraries(your_project PRIVATE openai::openai) å®Œæ•´ä»£ç ç¤ºä¾‹ ä»¥ä¸‹æ˜¯ä½¿ç”¨openai-cppçš„ç®€åŒ–ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 #include \u0026lt;iostream\u0026gt; #include \u0026#34;openai.hpp\u0026#34; int main() { // ä»ç¯å¢ƒå˜é‡è¯»å–API Key const char* api_key = std::getenv(\u0026#34;OPENAI_API_KEY\u0026#34;); if (!api_key) { std::cerr \u0026lt;\u0026lt; \u0026#34;Error: Please set OPENAI_API_KEY environment variable\u0026#34; \u0026lt;\u0026lt; std::endl; return 1; } // åˆå§‹åŒ–APIé…ç½® openai::config api_key_config(api_key); openai::OpenAI openai(api_key_config); try { std::cout \u0026lt;\u0026lt; \u0026#34;Sending request to OpenAI...\u0026#34; \u0026lt;\u0026lt; std::endl; // åˆ›å»ºèŠå¤©è¯·æ±‚ openai::ChatCompletions chat; chat.model = \u0026#34;gpt-4o-mini\u0026#34;; chat.messages = { {{\u0026#34;role\u0026#34;, \u0026#34;system\u0026#34;}, {\u0026#34;content\u0026#34;, \u0026#34;ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„åŠ©æ‰‹\u0026#34;}}, {{\u0026#34;role\u0026#34;, \u0026#34;user\u0026#34;}, {\u0026#34;content\u0026#34;, \u0026#34;è¯·ç”¨ä¸€å¥è¯ä»‹ç»C++ç¼–ç¨‹è¯­è¨€\u0026#34;}} }; chat.max_tokens = 500; chat.temperature = 0.7; // å‘é€è¯·æ±‚å¹¶è·å–å“åº” auto response = openai.chat().create(chat); // è§£æå“åº” std::string content = response[\u0026#34;choices\u0026#34;][0][\u0026#34;message\u0026#34;][\u0026#34;content\u0026#34;]; std::cout \u0026lt;\u0026lt; \u0026#34;AI Response: \u0026#34; \u0026lt;\u0026lt; content \u0026lt;\u0026lt; std::endl; } catch (const std::exception\u0026amp; e) { std::cerr \u0026lt;\u0026lt; \u0026#34;Error: \u0026#34; \u0026lt;\u0026lt; e.what() \u0026lt;\u0026lt; std::endl; return 1; } return 0; } ç¼–è¯‘ä¸è¿è¡Œ 1 2 3 4 5 6 # ç¼–è¯‘å‘½ä»¤ g++ -std=c++17 -I./include -o openai_demo main.cpp # è®¾ç½®API Keyå¹¶è¿è¡Œ export OPENAI_API_KEY=\u0026#34;your-api-key-here\u0026#34; ./openai_demo é«˜çº§é…ç½®é€‰é¡¹ openai-cppæ”¯æŒå¤šç§é…ç½®ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // è®¾ç½®API Keyå’ŒåŸºç¡€URLï¼ˆç”¨äºä»£ç†æˆ–ç§æœ‰éƒ¨ç½²ï¼‰ openai::config config(api_key); config.base_url = \u0026#34;https://api.openai.com/v1\u0026#34;; config.organization = \u0026#34;your-org-id\u0026#34;; // è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ config.timeout = 60; // å¯ç”¨/ç¦ç”¨å¼‚å¸¸æŠ›å‡º config.throw_exceptions = true; // è‡ªå®šä¹‰HTTPè¯·æ±‚å¤´ config.headers[\u0026#34;X-Custom-Header\u0026#34;] = \u0026#34;custom-value\u0026#34;; openai::OpenAI openai(config); ä¼˜ç¼ºç‚¹åˆ†æ ä¼˜ç‚¹ï¼š\nHeader-onlyï¼Œæ— éœ€ç¼–è¯‘ æ¥å£ç®€æ´ï¼Œæ˜“äºä½¿ç”¨ è‡ªåŠ¨å¤„ç†JSONåºåˆ—åŒ–/ååºåˆ—åŒ– æ”¯æŒæµå¼å“åº” ä»£ç é‡å°‘ ç¼ºç‚¹ï¼š\nåŠŸèƒ½ç›¸å¯¹åŸºç¡€ ç¤¾åŒºè§„æ¨¡è¾ƒå° é«˜çº§åŠŸèƒ½å¯èƒ½éœ€è¦è‡ªå·±æ‰©å±• é”™è¯¯ä¿¡æ¯å¯èƒ½ä¸å¤Ÿè¯¦ç»† æ–¹æ¡ˆä¸‰ï¼šcpr+jsonåº“ æ–¹æ¡ˆæ¦‚è¿° cpræ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„C++ HTTPå®¢æˆ·ç«¯åº“ï¼ŒAPIè®¾è®¡å‚è€ƒäº†Pythonä¸­å¹¿å—æ¬¢è¿çš„requestsåº“ã€‚å®ƒæä¾›äº†ç›´è§‚æ˜“ç”¨çš„æ¥å£ï¼ŒåŒæ—¶ä¿æŒäº†C++çš„ç±»å‹å®‰å…¨å’Œæ€§èƒ½ä¼˜åŠ¿ã€‚ç»“åˆnlohmann/jsonå¤„ç†JSONæ•°æ®ï¼Œè¿™å¥—ç»„åˆéå¸¸é€‚åˆæ„å»ºç”Ÿäº§çº§åˆ«çš„AIåº”ç”¨ã€‚\nç¯å¢ƒé…ç½® åœ¨Linuxä¸Šå®‰è£…cprå’Œnlohmann/jsonï¼š\n1 2 3 4 5 6 7 8 # Ubuntu/Debian sudo apt-get install libcurl4-openssl-dev nlohmann-json3-dev # æˆ–è€…ä½¿ç”¨vcpkg vcpkg install cpr nlohmann-json # æˆ–è€…ä½¿ç”¨conan conan install cpr/1.10.0 nlohmann-json/3.11.2 CMakeLists.txté…ç½®ï¼š\n1 2 3 4 find_package(cpr REQUIRED) find_package(nlohmann_json REQUIRED) target_link_libraries(your_project PRIVATE cpr::cpr nlohmann_json::nlohmann_json) å®Œæ•´ä»£ç ç¤ºä¾‹ ä»¥ä¸‹æ˜¯ä½¿ç”¨cprçš„å®Œæ•´ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;cpr/cpr.h\u0026gt; #include \u0026lt;nlohmann/json.hpp\u0026gt; using json = nlohmann::json; class AIClient { private: std::string api_key_; std::string base_url_; int timeout_ = 30; public: AIClient(const std::string\u0026amp; api_key, const std::string\u0026amp; base_url = \u0026#34;https://api.openai.com/v1\u0026#34;) : api_key_(api_key), base_url_(base_url) {} void set_timeout(int seconds) { timeout_ = seconds; } json chat(const std::string\u0026amp; model, const std::string\u0026amp; message) { // æ„å»ºè¯·æ±‚ä½“ json request_body = { {\u0026#34;model\u0026#34;, model}, {\u0026#34;messages\u0026#34;, { {{\u0026#34;role\u0026#34;, \u0026#34;system\u0026#34;}, {\u0026#34;content\u0026#34;, \u0026#34;You are a helpful assistant.\u0026#34;}}, {{\u0026#34;role\u0026#34;, \u0026#34;user\u0026#34;}, {\u0026#34;content\u0026#34;, message}} }}, {\u0026#34;max_tokens\u0026#34;, 1000}, {\u0026#34;temperature\u0026#34;, 0.7} }; // å‘é€POSTè¯·æ±‚ cpr::Response r = cpr::Post( cpr::Url{base_url_ + \u0026#34;/chat/completions\u0026#34;}, cpr::Header{ {\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;}, {\u0026#34;Authorization\u0026#34;, \u0026#34;Bearer \u0026#34; + api_key_} }, cpr::Body{request_body.dump()}, cpr::Timeout{timeout_ * 1000} ); // æ£€æŸ¥å“åº”çŠ¶æ€ if (r.status_code != 200) { throw std::runtime_error(\u0026#34;API request failed: HTTP \u0026#34; + std::to_string(r.status_code) + \u0026#34; - \u0026#34; + r.text); } return json::parse(r.text); } // æµå¼å“åº”å¤„ç† void stream_chat(const std::string\u0026amp; model, const std::string\u0026amp; message, std::function\u0026lt;void(const std::string\u0026amp;)\u0026gt; on_chunk) { json request_body = { {\u0026#34;model\u0026#34;, model}, {\u0026#34;messages\u0026#34;, { {{\u0026#34;role\u0026#34;, \u0026#34;user\u0026#34;}, {\u0026#34;content\u0026#34;, message}} }}, {\u0026#34;stream\u0026#34;, true} }; auto r = cpr::Post( cpr::Url{base_url_ + \u0026#34;/chat/completions\u0026#34;}, cpr::Header{ {\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;}, {\u0026#34;Authorization\u0026#34;, \u0026#34;Bearer \u0026#34; + api_key_} }, cpr::Body{request_body.dump()}, cpr::Timeout{timeout_ * 1000}, cpr::WriteCallback{[on_chunk](std::string data) { on_chunk(data); return data.size(); }} ); } }; int main() { const char* api_key = std::getenv(\u0026#34;OPENAI_API_KEY\u0026#34;); if (!api_key) { std::cerr \u0026lt;\u0026lt; \u0026#34;Error: Please set OPENAI_API_KEY environment variable\u0026#34; \u0026lt;\u0026lt; std::endl; return 1; } try { AIClient client(api_key); std::cout \u0026lt;\u0026lt; \u0026#34;Sending request to OpenAI...\u0026#34; \u0026lt;\u0026lt; std::endl; json response = client.chat(\u0026#34;gpt-4o-mini\u0026#34;, \u0026#34;è¯·è§£é‡Šä»€ä¹ˆæ˜¯C++çš„RAIIç‰¹æ€§\u0026#34;); std::string content = response[\u0026#34;choices\u0026#34;][0][\u0026#34;message\u0026#34;][\u0026#34;content\u0026#34;]; std::cout \u0026lt;\u0026lt; \u0026#34;AI Response: \u0026#34; \u0026lt;\u0026lt; content \u0026lt;\u0026lt; std::endl; } catch (const std::exception\u0026amp; e) { std::cerr \u0026lt;\u0026lt; \u0026#34;Error: \u0026#34; \u0026lt;\u0026lt; e.what() \u0026lt;\u0026lt; std::endl; return 1; } return 0; } å¼‚æ­¥è¯·æ±‚ç¤ºä¾‹ cpræ”¯æŒå¼‚æ­¥è¯·æ±‚ï¼Œé€‚åˆéœ€è¦å¹¶å‘å¤„ç†çš„åœºæ™¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 #include \u0026lt;future\u0026gt; // å¼‚æ­¥å‘é€è¯·æ±‚ std::future\u0026lt;json\u0026gt; future = std::async(std::launch::async, [\u0026amp;]() { return client.chat(\u0026#34;gpt-4o-mini\u0026#34;, \u0026#34;å¤„ç†è¿™ä¸ªè¯·æ±‚\u0026#34;); }); // ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡... std::cout \u0026lt;\u0026lt; \u0026#34;Doing other work...\u0026#34; \u0026lt;\u0026lt; std::endl; // è·å–å¼‚æ­¥ç»“æœ json response = future.get(); é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #include \u0026lt;thread\u0026gt; #include \u0026lt;chrono\u0026gt; json chat_with_retry(const std::string\u0026amp; model, const std::string\u0026amp; message, int max_retries = 3) { int retry_count = 0; while (retry_count \u0026lt; max_retries) { try { return client.chat(model, message); } catch (const std::exception\u0026amp; e) { retry_count++; std::cerr \u0026lt;\u0026lt; \u0026#34;Attempt \u0026#34; \u0026lt;\u0026lt; retry_count \u0026lt;\u0026lt; \u0026#34; failed: \u0026#34; \u0026lt;\u0026lt; e.what() \u0026lt;\u0026lt; std::endl; if (retry_count \u0026lt; max_retries) { // æŒ‡æ•°é€€é¿ std::this_thread::sleep_for(std::chrono::seconds(std::pow(2, retry_count))); } } } throw std::runtime_error(\u0026#34;All retry attempts failed\u0026#34;); } ä¼˜ç¼ºç‚¹åˆ†æ ä¼˜ç‚¹ï¼š\nAPIè®¾è®¡ç°ä»£åŒ–ï¼Œç±»ä¼¼Pythonçš„requests æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥è¯·æ±‚ å†…ç½®è¿æ¥æ± ã€è¶…æ—¶æ§åˆ¶ é”™è¯¯ä¿¡æ¯è¯¦ç»† ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„ æ”¯æŒä»£ç†ã€é‡å®šå‘ç­‰é«˜çº§ç‰¹æ€§ ç¼ºç‚¹ï¼š\néœ€è¦ç¼–è¯‘å®‰è£… ä¾èµ–è¾ƒå¤šï¼ˆlibcurlã€OpenSSLç­‰ï¼‰ å­¦ä¹ æ›²çº¿ç•¥é«˜ åŒ…ä½“ç§¯è¾ƒå¤§ æ–¹æ¡ˆå¯¹æ¯” å¯¹æ¯”ç»´åº¦ libcurlç›´æ¥è°ƒç”¨ openai-cppåº“ cpr+jsonç»„åˆ ä»£ç å¤æ‚åº¦ é«˜ ä½ ä¸­ ä¾èµ–æ•°é‡ 1 1-2 2-3 å­¦ä¹ æˆæœ¬ é«˜ ä½ ä¸­ çµæ´»æ€§ æœ€é«˜ ä¸­ é«˜ æ€§èƒ½ æœ€å¥½ å¥½ å¥½ ç¤¾åŒºæ”¯æŒ å¹¿æ³› è¾ƒå° æ´»è·ƒ ç»´æŠ¤çŠ¶æ€ æŒç»­æ›´æ–° ç»´æŠ¤ä¸­ æ´»è·ƒ åŠŸèƒ½ä¸°å¯Œåº¦ åŸºç¡€ åŸºç¡€ ä¸°å¯Œ æ¨èæŒ‡æ•° â­â­â­ â­â­â­â­â­ â­â­â­â­â­ é€‚ç”¨åœºæ™¯ åº•å±‚å¼€å‘ã€é«˜åº¦å®šåˆ¶ å¿«é€ŸåŸå‹ã€ç®€å•åº”ç”¨ ç”Ÿäº§ç¯å¢ƒã€å¤æ‚éœ€æ±‚ é€‰æ‹©å»ºè®® é€‰æ‹©libcurlç›´æ¥è°ƒç”¨ï¼šå¦‚æœæ‚¨éœ€è¦å®Œå…¨æ§åˆ¶HTTPè¯·æ±‚çš„æ¯ä¸€ä¸ªç»†èŠ‚ï¼Œæˆ–è€…é¡¹ç›®æœ‰ç‰¹æ®Šçš„å®‰å…¨ã€æ€§èƒ½è¦æ±‚ï¼Œä¸”å›¢é˜Ÿæœ‰è¶³å¤Ÿçš„ç½‘ç»œç¼–ç¨‹ç»éªŒã€‚\né€‰æ‹©openai-cppï¼šå¦‚æœæ‚¨è¿½æ±‚å¿«é€Ÿå¼€å‘ï¼Œé¡¹ç›®éœ€æ±‚ç®€å•ï¼Œä¸éœ€è¦å¤ªå¤šé«˜çº§åŠŸèƒ½ï¼Œå¸Œæœ›å°½å¿«ä¸Šæ‰‹ä½¿ç”¨ã€‚\né€‰æ‹©cpr+jsonï¼šå¦‚æœæ‚¨éœ€è¦æ„å»ºç”Ÿäº§çº§åˆ«çš„åº”ç”¨ï¼Œéœ€è¦å¼‚æ­¥è¯·æ±‚ã€é”™è¯¯é‡è¯•ã€è¿æ¥æ± ç­‰é«˜çº§ç‰¹æ€§ï¼Œä¸”æ„¿æ„èŠ±æ—¶é—´å­¦ä¹ è¿™å¥—ç»„åˆçš„ä½¿ç”¨æ–¹æ³•ã€‚\nå®‰å…¨æ³¨æ„äº‹é¡¹ API Keyç®¡ç† ç»å¯¹ä¸è¦å°†API Keyç¡¬ç¼–ç åœ¨ä»£ç ä¸­ï¼šè¿™æ˜¯æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€é‡è¦çš„å®‰å…¨åŸåˆ™ã€‚ 1 2 3 4 5 // âŒ é”™è¯¯åšæ³• const std::string api_key = \u0026#34;sk-xxxxxxxxxxxx\u0026#34;; // âœ… æ­£ç¡®åšæ³•ï¼šä»ç¯å¢ƒå˜é‡è¯»å– const char* api_key = std::getenv(\u0026#34;OPENAI_API_KEY\u0026#34;); ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†API Keyï¼š 1 2 3 4 5 # Linux/macOS export OPENAI_API_KEY=\u0026#34;your-api-key-here\u0026#34; # Windows set OPENAI_API_KEY=your-api-key-here ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡ï¼šå¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šçš„å¯†é’¥ç®¡ç†æœåŠ¡ï¼Œå¦‚AWS Secrets Managerã€HashiCorp Vaultç­‰ã€‚\né™åˆ¶API Keyçš„æƒé™ï¼šåœ¨AIæœåŠ¡æ§åˆ¶å°ä¸­ï¼Œä¸ºAPI Keyè®¾ç½®åˆç†çš„æƒé™èŒƒå›´å’Œè°ƒç”¨é™åˆ¶ã€‚\nç½‘ç»œå®‰å…¨ å§‹ç»ˆä½¿ç”¨HTTPSï¼šç¡®ä¿æ‰€æœ‰APIè¯·æ±‚éƒ½é€šè¿‡åŠ å¯†é€šé“ä¼ è¾“ã€‚\néªŒè¯SSLè¯ä¹¦ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸è¦ç¦ç”¨è¯ä¹¦éªŒè¯ã€‚\n1 2 3 4 // é”™è¯¯ï¼šç¦ç”¨è¯ä¹¦éªŒè¯ curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0); // æ­£ç¡®ï¼šä½¿ç”¨é»˜è®¤çš„è¯ä¹¦éªŒè¯ è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼šé˜²æ­¢è¯·æ±‚æ— é™æœŸç­‰å¾…ï¼š 1 curl_easy_setopt(curl, CURLOPT_TIMEOUT, 30L); // 30ç§’è¶…æ—¶ é”™è¯¯å¤„ç† æ•è·å¹¶å¤„ç†æ‰€æœ‰å¼‚å¸¸ï¼šé˜²æ­¢ç¨‹åºå› æœªå¤„ç†çš„å¼‚å¸¸å´©æºƒã€‚\nè®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼šä¾¿äºé—®é¢˜æ’æŸ¥ï¼Œä½†æ³¨æ„ä¸è¦è®°å½•æ•æ„Ÿçš„API Keyä¿¡æ¯ã€‚\nå®ç°é‡è¯•æœºåˆ¶ï¼šå¯¹äºç½‘ç»œé”™è¯¯ï¼Œå®ç°è‡ªåŠ¨é‡è¯•é€»è¾‘ã€‚\nèµ„æºç®¡ç† åŠæ—¶é‡Šæ”¾èµ„æºï¼šç¡®ä¿CURLå¥æŸ„ã€å†…å­˜ç­‰èµ„æºè¢«æ­£ç¡®é‡Šæ”¾ã€‚\né™åˆ¶å“åº”å¤§å°ï¼šé˜²æ­¢å“åº”æ•°æ®è¿‡å¤§å¯¼è‡´å†…å­˜é—®é¢˜ï¼š\n1 curl_easy_setopt(curl, CURLOPT_MAXFILESIZE, 5 * 1024 * 1024); // 5MBé™åˆ¶ æ€»ç»“ æœ¬æ–‡ä»‹ç»äº†ä¸‰ç§åœ¨C++é¡¹ç›®ä¸­é›†æˆAIå¤§æ¨¡å‹APIçš„æ–¹æ¡ˆï¼Œæ¯ç§æ–¹æ¡ˆéƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯å’Œä¼˜ç¼ºç‚¹ã€‚\nlibcurlç›´æ¥è°ƒç”¨æ–¹æ¡ˆæä¾›äº†æœ€å¤§çš„çµæ´»æ€§å’Œæ§åˆ¶åŠ›ï¼Œé€‚åˆéœ€è¦æ·±åº¦å®šåˆ¶çš„é¡¹ç›®ï¼Œä½†å¼€å‘æˆæœ¬è¾ƒé«˜ã€‚openai-cppåº“ä»¥å…¶ç®€æ´çš„æ¥å£å’Œæ˜“ç”¨æ€§ï¼Œéå¸¸é€‚åˆå¿«é€ŸåŸå‹å¼€å‘å’Œç®€å•åº”ç”¨ã€‚cpr+jsonç»„åˆåˆ™ä»¥å…¶ç°ä»£åŒ–çš„APIè®¾è®¡å’Œä¸°å¯Œçš„åŠŸèƒ½ï¼Œæ˜¯æ„å»ºç”Ÿäº§çº§AIåº”ç”¨çš„ç†æƒ³é€‰æ‹©ã€‚\nåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå»ºè®®æ‚¨æ ¹æ®å›¢é˜Ÿçš„æŠ€æœ¯æ ˆã€é¡¹ç›®çš„å¤æ‚åº¦è¦æ±‚ã€ä»¥åŠæ€§èƒ½éœ€æ±‚æ¥é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆã€‚æ— è®ºé€‰æ‹©å“ªç§æ–¹æ¡ˆï¼Œéƒ½è¯·åŠ¡å¿…æ³¨æ„API Keyçš„å®‰å…¨ç®¡ç†ï¼Œç¡®ä¿æ‚¨çš„åº”ç”¨æ—¢é«˜æ•ˆåˆå®‰å…¨ã€‚\néšç€AIæŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œè¿™äº›åº“å’Œæ–¹æ¡ˆä¹Ÿåœ¨ä¸æ–­æ¼”è¿›ã€‚å»ºè®®æ‚¨å®šæœŸå…³æ³¨å®˜æ–¹æ–‡æ¡£å’Œç¤¾åŒºåŠ¨æ€ï¼ŒåŠæ—¶è·å–æœ€æ–°çš„åŠŸèƒ½æ›´æ–°å’Œå®‰å…¨ä¿®å¤ã€‚\nå‚è€ƒèµ„æº OpenAI APIæ–‡æ¡£ï¼šhttps://platform.openai.com/docs libcurlå®˜æ–¹æ–‡æ¡£ï¼šhttps://curl.se/libcurl/c/ openai-cpp GitHubï¼šhttps://github.com/olrea/openai-cpp cpræ–‡æ¡£ï¼šhttps://docs.libcpr.org/ nlohmann/jsonï¼šhttps://github.com/nlohmann/json ç¥æ‚¨åœ¨C++ AIå¼€å‘ä¹‹æ—…ä¸­æ”¶è·æ»¡æ»¡ï¼ğŸš€\n","date":"2026-02-12T00:00:00+08:00","image":"https://Liyufei1.github.io/AI.png","permalink":"https://Liyufei1.github.io/p/ai-02-c-%E4%B8%ADapi-key%E7%9A%84%E4%BD%BF%E7%94%A8/","title":"AI-02-C++ä¸­API Keyçš„ä½¿ç”¨"},{"content":"ğŸ“‹ ç›®å½• ç®€ä»‹ æ¨¡å‹ å¸¸ç”¨åŠŸèƒ½ SKILLå’ŒMCP äº‘ç«¯ç¯å¢ƒ ç®€ä»‹ OpenCode æ˜¯ä¸€ä¸ªå¼€æºçš„ AI ç¼–ç¨‹åŠ©æ‰‹ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ç§è¿è¡Œæ–¹å¼: ç»ˆç«¯å‘½ä»¤è¡Œ ã€IDEæ’ä»¶ ã€ç‹¬ç«‹æ¡Œé¢åº”ç”¨ ã€ äº‘ç«¯ç¯å¢ƒ .ç›¸è¾ƒäºå…¶ä»–aiç¼–ç¨‹å·¥å…·ï¼Œ OpenCode å…·å¤‡ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š\nå¤šå¹³å°æ”¯æŒ: æ”¯æŒç»ˆç«¯ç•Œé¢ã€æ¡Œé¢åº”ç”¨å’Œ IDE æ‰©å±• çµæ´»çš„æ¨¡å‹æ”¯æŒ: æ”¯æŒ 75+ ä¸ª LLM æä¾›å•†ï¼ŒåŒ…æ‹¬ Claudeã€GPTã€Gemini ç­‰ LSP é›†æˆ: è‡ªåŠ¨åŠ è½½é€‚åˆ LLM çš„è¯­è¨€æœåŠ¡å™¨åè®® å¤šä¼šè¯: å¯åœ¨åŒä¸€é¡¹ç›®ä¸Šå¹¶è¡Œå¯åŠ¨å¤šä¸ªä»£ç† å®‰è£… æœ¬æ–‡ä»…ä»‹ç»æœ€ç®€å•çš„ç»ˆç«¯å‘½ä»¤è¡Œçš„å®‰è£…æ–¹å¼ï¼Œæ›´å¤šå®‰è£…æ–¹å¼è¯·æŸ¥çœ‹ opencodeæ–‡æ¡£\nnpm:\n1 npm install -g opencode-ai å®‰è£…å®Œæ¯•å,åœ¨cmdä¸­æ‰§è¡Œopencodeå³å¯çœ‹åˆ°å®ƒçš„è¿è¡Œç•Œé¢(è§ä¸‹å›¾):\næ¨¡å‹ OpenCode æ”¯æŒè¿æ¥åˆ°å¤šç§ LLM æä¾›å•†ã€‚ä½ å¯ä»¥é€šè¿‡é…ç½® API å¯†é’¥æ¥ä½¿ç”¨ä¸åŒçš„æ¨¡å‹ã€‚\nåœ¨ TUI ä¸­è¿è¡Œ /connect å‘½ä»¤,é€‰æ‹©æ¨¡å‹ä¾›åº”å•†ï¼Œå¹¶å¡«å†™ä½ çš„API Key (éå¿…é¡») ä¸€èˆ¬ä½¿ç”¨ openrouter.ai æ¥å¯¹æ¥æ¨¡å‹,é‡Œé¢æœ‰è®¸å¤šå…è´¹æ¨¡å‹çš„API,ä¹Ÿæœ‰ä»˜è´¹çš„. ä¹Ÿå¯ä»¥å¯¹æ¥å„ç§å®˜æ–¹çš„æ¨¡å‹,å¦‚OpenAIã€googleã€anthropic åœ¨ TUI ä¸­è¿è¡Œ /model å‘½ä»¤,é€‰æ‹©æƒ³ä½¿ç”¨çš„æ¨¡å‹. å¿«æ·é”® F2 å¯ä»¥å¿«é€Ÿåˆ‡æ¢æ¨¡å‹ï¼Œåå‘åˆ‡æ¢å¿«æ·é”® Shift+F2 MiniMax-M2.1 : ç¼–ç¨‹èƒ½åŠ›è¾ƒå¼º GLM-4.7: ç¼–ç¨‹èƒ½åŠ›è¾ƒå¼º å¯¹æ¨¡å‹çš„é…ç½®ï¼Œä¼šæŒä¹…åŒ–ä¿å­˜åœ¨ C:\\Users\\YourName\\.local\\share\\opencode\\auth.jsonå½“ä¸­ï¼Œå› æ­¤ä¹Ÿå¯ä»¥é€šè¿‡å¯¹è¯¥æ–‡ä»¶çš„ç¼–è¾‘ï¼Œå®ç°æ‰‹åŠ¨é…ç½®æ¨¡å‹ã€‚ å¸¸ç”¨åŠŸèƒ½ åŸºæœ¬å‘½ä»¤ å‘½ä»¤ è¯´æ˜ /init åˆå§‹åŒ–é¡¹ç›®ï¼Œåˆ›å»º AGENTS.md /connect è¿æ¥æ¨¡å‹æä¾›å•† /model åˆ‡æ¢ä½¿ç”¨çš„æ¨¡å‹ /undo æ’¤é”€ä¸Šæ¬¡çš„æ›´æ”¹ï¼ˆå¯å¤šæ¬¡æ’¤é”€ï¼‰ /redo é‡åšå·²æ’¤é”€çš„æ›´æ”¹ /compact å‹ç¼©å¯¹è¯ï¼Œæ¥é‡Šæ”¾æ¨¡å‹ä¸Šä¸‹æ–‡ /new æ–°å»ºä¸€ä¸ªå¯¹è¯ï¼Œå¯ä»¥å¹¶è¡Œè¿è¡Œ /session æŸ¥çœ‹æ‰€æœ‰å¯¹è¯ /timeline å¯è§†åŒ–å¯¹è¯æ—¶é—´çº¿ï¼Œæ˜¾ç¤ºä¼šè¯å†å²çš„æ ‘çŠ¶ç»“æ„ï¼Œæ”¯æŒå¯¼èˆªå’Œåˆ†æ”¯ /share ç”Ÿæˆåˆ†äº«é“¾æ¥ï¼ŒåŒ…å«äº†æ•´ä¸ªå¯¹è¯è®°å½•ï¼ˆå¤åˆ¶åˆ°å‰ªè´´æ¿ï¼‰ /unshare å–æ¶ˆåˆ†äº« /export å°†å¯¹è¯è®°å½•ï¼Œå¯¼å‡ºæˆæ–‡ä»¶ å·¥ä½œæ¨¡å¼ï¼ˆä¸»Angentï¼‰ Plan æ¨¡å¼ï¼ˆè§„åˆ’æ¨¡å¼ï¼‰ï¼š\næŒ‰ Tab é”®åˆ‡æ¢åˆ°è§„åˆ’æ¨¡å¼ åœ¨æ­¤æ¨¡å¼ä¸‹ï¼ŒOpenCode ä¸ä¼šç›´æ¥ä¿®æ”¹ä»£ç ï¼Œè€Œæ˜¯æä¾›å®ç°æ–¹æ¡ˆ é€‚åˆåœ¨å¼€å‘å‰è®¨è®ºå’Œç¡®è®¤å®ç°æ€è·¯ Build æ¨¡å¼ï¼ˆæ„å»ºæ¨¡å¼ï¼‰ï¼š\nå†æ¬¡æŒ‰ Tab é”®åˆ‡æ¢å›æ„å»ºæ¨¡å¼ OpenCode å°†ç›´æ¥æ‰§è¡Œä»£ç ä¿®æ”¹ é€‚ç”¨äºæ˜ç¡®çš„å¼€å‘ä»»åŠ¡ è‡ªå®šä¹‰ Agent æ¨¡å¼ï¼š\næŒ‰ Ctrl+Tab é”®åˆ‡æ¢åˆ°è‡ªå®šä¹‰æ¨¡å¼ åœ¨~/.config/opencode/agent/your_agent.mdä¸­å®šä¹‰ä¸“å±æç¤ºè¯ å¯ä»¥ä¸ºä¸åŒåœºæ™¯åˆ›å»ºä¸“é—¨çš„ Agentï¼ˆå¦‚ä»£ç å®¡æŸ¥ã€æ•°æ®åˆ†æã€å‰ç«¯å¼€å‘ç­‰ï¼‰ æ ¼å¼è§„èŒƒè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ SKILLå’ŒMCP Agent Skillsï¼ˆæ™ºèƒ½ä½“æŠ€èƒ½ï¼‰ Agent Skills å…è®¸ä½ å®šä¹‰å¯é‡ç”¨çš„è¡Œä¸ºï¼ŒOpenCode å¯ä»¥é€šè¿‡åŸç”Ÿ skill å·¥å…·æŒ‰éœ€åŠ è½½è¿™äº›æŠ€èƒ½ã€‚\nåˆ›å»º Skill åˆ›å»º .opencode/skills/\u0026lt;skill-name\u0026gt;/SKILL.md æ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 --- name: git-release description: Create consistent releases and changelogs license: MIT compatibility: opencode --- ## What I do - Draft release notes from merged PRs - Propose a version bump - Provide a copy-pasteable `gh release create` command ## When to use me Use this when you are preparing a tagged release. Skill å­˜å‚¨ä½ç½® é¡¹ç›®çº§ï¼š.opencode/skills/\u0026lt;name\u0026gt;/SKILL.md å…¨å±€ï¼š~/.config/opencode/skills/\u0026lt;name\u0026gt;/SKILL.md Claude å…¼å®¹ï¼š.claude/skills/\u0026lt;name\u0026gt;/SKILL.md Agents å…¼å®¹ï¼š.agents/skills/\u0026lt;name\u0026gt;/SKILL.md MCP Serversï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰ MCPï¼ˆModel Context Protocolï¼‰æ˜¯ä¸€ç§è®© AI æ¨¡å‹ä¸å¤–éƒ¨å·¥å…·å’Œæ•°æ®æºäº¤äº’çš„åè®®ã€‚OpenCode æ”¯æŒ MCP æœåŠ¡å™¨ï¼Œå¯ä»¥æ‰©å±•å…¶åŠŸèƒ½ã€‚\né€šè¿‡ MCPï¼Œä½ å¯ä»¥ï¼š\nè¿æ¥æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ ä¸ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿé›†æˆ è®¿é—®å¤–éƒ¨ API ä½¿ç”¨è‡ªå®šä¹‰å·¥å…· é…ç½® MCP æœåŠ¡å™¨åœ¨ ~/.config/opencode/opencode.json çš„ mcps éƒ¨åˆ†ã€‚\näº‘ç«¯ç¯å¢ƒ OpenCode äº‘æœåŠ¡ OpenCode æä¾›äº†äº‘ç«¯ç¯å¢ƒæ”¯æŒï¼Œè®©ä½ å¯ä»¥åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä½¿ç”¨ OpenCodeã€‚\nä¸»è¦ç‰¹æ€§ è¿œç¨‹å¼€å‘ï¼šåœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè¿è¡Œ OpenCode åä½œåŠŸèƒ½ï¼šä¸å›¢é˜Ÿæˆå‘˜å…±äº«ä¼šè¯ å…±äº«é“¾æ¥ï¼šç”Ÿæˆå¯åˆ†äº«çš„å¯¹è¯é“¾æ¥ ç”Ÿæˆåˆ†äº«é“¾æ¥ åœ¨ä»»æ„ä¼šè¯ä¸­è¿è¡Œï¼š\n1 /share è¿™ä¼šå°†å½“å‰å¯¹è¯çš„é“¾æ¥å¤åˆ¶åˆ°ä½ çš„å‰ªè´´æ¿ã€‚ä½ å¯ä»¥å°†æ­¤é“¾æ¥åˆ†äº«ç»™å›¢é˜Ÿæˆå‘˜ï¼Œä»¥ä¾¿ï¼š\nä»£ç å®¡æŸ¥ é—®é¢˜è°ƒè¯• çŸ¥è¯†å…±äº« æ³¨æ„ï¼šå¯¹è¯é»˜è®¤ä¸å…¬å¼€åˆ†äº«ï¼Œåªæœ‰ä½ ä¸»åŠ¨åˆ†äº«åä»–äººæ‰å¯è®¿é—®ã€‚\néšç§ä¸å®‰å…¨ OpenCode é‡‡ç”¨éšç§ä¼˜å…ˆçš„è®¾è®¡ï¼š\nä¸å­˜å‚¨ä½ çš„ä»£ç æˆ–ä¸Šä¸‹æ–‡æ•°æ® æ‰€æœ‰æ•°æ®å¤„ç†åœ¨æœ¬åœ°å®Œæˆ é€‚åˆåœ¨éšç§æ•æ„Ÿçš„ç¯å¢ƒä¸­ä½¿ç”¨ å¦‚éœ€äº†è§£æ›´å¤šéšç§æ”¿ç­–ï¼Œè¯·è®¿é—® opencode.ai/docs/enterprise\næ€»ç»“ OpenCode æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€çµæ´»ä¸”éšç§å‹å¥½çš„ AI ç¼–ç¨‹åŠ©æ‰‹ã€‚æ— è®ºä½ æ˜¯ä¸ªäººå¼€å‘è€…è¿˜æ˜¯å›¢é˜Ÿæˆå‘˜ï¼Œå®ƒéƒ½èƒ½æ˜¾è‘—æå‡ä½ çš„å¼€å‘æ•ˆç‡ã€‚\nå¿«é€Ÿå¼€å§‹å»ºè®® å®‰è£… OpenCodeï¼šcurl -fsSL https://opencode.ai/install | bash é…ç½®ä½ çš„ API å¯†é’¥ åœ¨é¡¹ç›®ç›®å½•è¿è¡Œ opencode å¹¶æ‰§è¡Œ /init å¼€å§‹ä¸ AI å¯¹è¯ï¼Œæ¢ç´¢ä»£ç åº“ å­¦ä¹ èµ„æº å®˜æ–¹æ–‡æ¡£ï¼šhttps://opencode.ai/docs GitHubï¼šhttps://github.com/anomalyco/opencode Discord ç¤¾åŒºï¼šhttps://opencode.ai/discord ç¥ç¼–ç æ„‰å¿«ï¼ğŸš€\n","date":"2026-02-11T00:00:00+08:00","image":"https://Liyufei1.github.io/AI.png","permalink":"https://Liyufei1.github.io/p/ai-01-ai%E7%BC%96%E7%A8%8B%E5%B7%A5%E5%85%B7opencode%E7%AE%80%E4%BB%8B/","title":"AI-01-AIç¼–ç¨‹å·¥å…·opencodeç®€ä»‹"},{"content":"1. åˆ›å»ºä¸€ä¸ªagentå·¥ä½œæµ ","date":"2026-01-15T00:00:00Z","image":"https://Liyufei1.github.io/AI.png","permalink":"https://Liyufei1.github.io/p/iflow-in-development/","title":"Iflowåœ¨å¼€å‘ä¸­çš„è¿›é˜¶æ•™ç¨‹"},{"content":"ç¯å¢ƒæ­å»º ä¾èµ–åº“ GLFW GLFWï¼ˆOpenGL FrameWorkï¼‰æ˜¯ä¸€ä¸ªä¸“é—¨ä¸º OpenGL å’Œ Vulkan è®¾è®¡çš„å¼€æºã€è·¨å¹³å°çš„çª—å£å’Œè¾“å…¥åº“ã€‚å®ƒæä¾›äº†ä¸€ç»„ç®€å•ã€ç›´è§‚çš„ APIï¼Œç”¨äºåˆ›å»ºçª—å£ã€å¤„ç†è¾“å…¥ï¼ˆé”®ç›˜ã€é¼ æ ‡ã€æ¸¸æˆæ‰‹æŸ„ï¼‰ä»¥åŠç®¡ç† OpenGL ä¸Šä¸‹æ–‡ã€‚\nä¸»è¦ç‰¹æ€§ï¼š\nè·¨å¹³å°æ”¯æŒï¼šæ”¯æŒ Windowsã€macOSã€Linuxã€FreeBSD å’Œå…¶ä»–ç±» Unix ç³»ç»Ÿ OpenGL ä¸Šä¸‹æ–‡ç®¡ç†ï¼šæ”¯æŒåˆ›å»ºå’Œç®¡ç† OpenGL ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬æ ¸å¿ƒæ¨¡å¼å’Œå…¼å®¹æ¨¡å¼ çª—å£ç®¡ç†ï¼šæä¾›çª—å£åˆ›å»ºã€è°ƒæ•´å¤§å°ã€ä½ç½®æ§åˆ¶ç­‰åŠŸèƒ½ è¾“å…¥å¤„ç†ï¼šæ”¯æŒé”®ç›˜ã€é¼ æ ‡ã€æ¸¸æˆæ‰‹æŸ„ç­‰å¤šç§è¾“å…¥è®¾å¤‡ äº‹ä»¶é©±åŠ¨ï¼šé‡‡ç”¨å›è°ƒæœºåˆ¶å¤„ç†çª—å£äº‹ä»¶ã€è¾“å…¥äº‹ä»¶ç­‰ æ—¶é—´ç®¡ç†ï¼šæä¾›é«˜ç²¾åº¦çš„æ—¶é—´æŸ¥è¯¢åŠŸèƒ½ å¤šæ˜¾ç¤ºå™¨æ”¯æŒï¼šæ”¯æŒå¤šæ˜¾ç¤ºå™¨ç¯å¢ƒä¸‹çš„çª—å£ç®¡ç† ä¸å…¶ä»–çª—å£åº“ï¼ˆå¦‚ GLUTã€SDLï¼‰ç›¸æ¯”ï¼ŒGLFW æ›´åŠ è½»é‡çº§ï¼Œä¸“æ³¨äºæä¾› OpenGL å¼€å‘æ‰€éœ€çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒAPI è®¾è®¡ç®€æ´ï¼Œæ˜“äºä½¿ç”¨ã€‚å®ƒä¸æä¾›æ¸²æŸ“åŠŸèƒ½ï¼Œåªè´Ÿè´£çª—å£å’Œè¾“å…¥ç®¡ç†ï¼Œè®©å¼€å‘è€…å¯ä»¥å®Œå…¨ä¸“æ³¨äº OpenGL çš„å›¾å½¢ç¼–ç¨‹ã€‚\næ¥å£\nå‡½æ•° ä½œç”¨ glfwInit() åˆå§‹åŒ– GLFW åº“ï¼Œå¿…é¡»åœ¨è°ƒç”¨å…¶ä»– GLFW å‡½æ•°ä¹‹å‰è°ƒç”¨ã€‚æˆåŠŸè¿”å› GLFW_TRUEï¼Œå¤±è´¥è¿”å› GLFW_FALSE glfwWindowHint() è®¾ç½®çª—å£åˆ›å»ºæç¤ºï¼Œç”¨äºé…ç½®çª—å£çš„å±æ€§ï¼ˆå¦‚ OpenGL ç‰ˆæœ¬ã€çª—å£æ¨¡å¼ã€é‡‡æ ·æ•°ç­‰ï¼‰ã€‚å¿…é¡»åœ¨ glfwCreateWindow ä¹‹å‰è°ƒç”¨ glfwCreateWindow() åˆ›å»ºçª—å£å’Œ OpenGL ä¸Šä¸‹æ–‡ã€‚è¿”å›çª—å£æŒ‡é’ˆï¼Œå¤±è´¥è¿”å› NULLã€‚å‚æ•°åŒ…æ‹¬å®½åº¦ã€é«˜åº¦ã€çª—å£æ ‡é¢˜ã€ç›‘è§†å™¨å’Œå…±äº«ä¸Šä¸‹æ–‡ glfwMakeContextCurrent() å°†æŒ‡å®šçª—å£çš„ OpenGL ä¸Šä¸‹æ–‡è®¾ä¸ºå½“å‰ä¸Šä¸‹æ–‡ã€‚å¿…é¡»åœ¨è°ƒç”¨ OpenGL å‡½æ•°ä¹‹å‰è°ƒç”¨ï¼Œç¡®ä¿ OpenGL æ“ä½œä½œç”¨äºæ­£ç¡®çš„çª—å£ glfwSetFramebufferSizeCallback() æ³¨å†Œå¸§ç¼“å†²å¤§å°æ”¹å˜çš„å›è°ƒå‡½æ•°ã€‚å½“çª—å£å¤§å°æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼Œç”¨äºæ›´æ–°è§†å£å¤§å°ç­‰æ“ä½œ glfwSetInputMode() è®¾ç½®è¾“å…¥æ¨¡å¼ã€‚å¸¸ç”¨é…ç½®åŒ…æ‹¬å…‰æ ‡æ¨¡å¼ï¼ˆæ­£å¸¸ã€éšè—ã€ç¦ç”¨ï¼‰ã€ç²˜æ»æŒ‰é”®æ¨¡å¼ç­‰ glfwSetCursorPosCallback() æ³¨å†Œå…‰æ ‡ä½ç½®æ”¹å˜çš„å›è°ƒå‡½æ•°ã€‚å½“å…‰æ ‡ç§»åŠ¨æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼Œä¼ å…¥å…‰æ ‡çš„å±å¹•åæ ‡ glfwSetScrollCallback() æ³¨å†Œæ»šåŠ¨äº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚å½“é¼ æ ‡æ»šè½®æ»šåŠ¨æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼Œä¼ å…¥æ»šåŠ¨åç§»é‡ glfwWindowShouldClose() æ£€æŸ¥çª—å£æ˜¯å¦åº”è¯¥å…³é—­ã€‚å½“ç”¨æˆ·ç‚¹å‡»å…³é—­æŒ‰é’®æˆ–è°ƒç”¨ glfwSetWindowShouldClose æ—¶è¿”å› GLFW_TRUE glfwSwapBuffers() äº¤æ¢é¢œè‰²ç¼“å†²åŒºã€‚ä½¿ç”¨åŒç¼“å†²æœºåˆ¶ï¼Œå°†æ¸²æŸ“å¥½çš„å›¾åƒæ˜¾ç¤ºåˆ°å±å¹•ä¸Šï¼Œé¿å…é—ªçƒ glfwPollEvents() å¤„ç†æ‰€æœ‰å¾…å¤„ç†äº‹ä»¶ã€‚åŒ…æ‹¬é”®ç›˜è¾“å…¥ã€é¼ æ ‡ç§»åŠ¨ã€çª—å£è°ƒæ•´å¤§å°ç­‰ã€‚å¿…é¡»åœ¨æ¸²æŸ“å¾ªç¯ä¸­è°ƒç”¨ glfwTerminate() ç»ˆæ­¢ GLFW åº“ï¼Œé‡Šæ”¾æ‰€æœ‰åˆ†é…çš„èµ„æºã€‚åœ¨ç¨‹åºé€€å‡ºå‰è°ƒç”¨ï¼Œæ¸…ç† GLFW ç›¸å…³çš„æ‰€æœ‰èµ„æº glfwGetTime() è·å–è‡ª glfwInit è¢«è°ƒç”¨ä»¥æ¥çš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚è¿”å›é«˜ç²¾åº¦çš„åŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œç”¨äºåŠ¨ç”»å’Œè®¡æ—¶ GLAD å¯¹OpenGLçš„æ¥å£å°è£…ã€‚\n1 2 3 4 5 6 7 8 // å®šä¹‰å‡½æ•°åŸå‹ typedef void (*GL_GENBUFFERS) (GLsizei, GLuint*); // æ‰¾åˆ°æ­£ç¡®çš„å‡½æ•°å¹¶èµ‹å€¼ç»™å‡½æ•°æŒ‡é’ˆ GL_GENBUFFERS glGenBuffers = (GL_GENBUFFERS)wglGetProcAddress(\u0026#34;glGenBuffers\u0026#34;); // ç°åœ¨å‡½æ•°å¯ä»¥è¢«æ­£å¸¸è°ƒç”¨äº† GLuint buffer; glGenBuffers(1, \u0026amp;buffer); çª—å£æ­å»º ä¸‹æ–¹æ˜¯ä½¿ç”¨GLFWåˆ›å»ºçª—å£çš„æœ€ç®€ç¤ºä¾‹ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 #include \u0026lt;glad/glad.h\u0026gt; #include \u0026lt;GLFW/glfw3.h\u0026gt;\t//åˆå§‹åŒ–GLFW glfwInit(); //è®¾ç½®ä¸»è¦å’Œæ¬¡è¦ç‰ˆæœ¬,æœ¬æ–‡æ¡£ä½¿ç”¨3.3ç‰ˆæœ¬OpenGLçš„æ ¸å¿ƒæ¨¡å¼ glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR,3); glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR,3); glfwWindowHint(GLFW_OPENGL_PROFILE,GLFW_OPENGL_CORE_PROFILE); //æ–°å»ºä¸€ä¸ªçª—å£ GLFWwindow * MyWindows = glfwCreateWindow(800,600,\u0026#34;Title\u0026#34;,NULL,NULL); if (MyWindows == NULL){ std::cout \u0026lt;\u0026lt; \u0026#34;Create Windows Failed!\u0026#34; \u0026lt;\u0026lt; std::endl; glfwTerminate(); return -1; } //åˆ›å»ºä¸Šä¸‹æ–‡å…³è” glfwMakeContextCurrent(MyWindows); //åˆå§‹åŒ–GLADï¼Œç”¨äºç®¡ç†OpenGLçš„å‡½æ•°æŒ‡é’ˆ if (!gladLoadGLLoader((GLADloadproc)glfwGetProcAddress)){ std::cout \u0026lt;\u0026lt; \u0026#34;Failed to initiallize GLAD \u0026#34; \u0026lt;\u0026lt; std::endl; return -1; } //è®¾ç½®è§†å£,å·¦ä¸‹è§’ä½ç½®ä¸º(0,0),å®½800ï¼Œé«˜600 glViewport(0,0,800,600); glEnable(GL_PROGRAM_POINT_SIZE); //æ³¨å†Œç›‘å¬ glfwSetFramebufferSizeCallback(MyWindows,FrameBufferSizeCallback);//ç›‘å¬å‡½æ•°ï¼ˆ1ï¼‰å®šä¹‰åœ¨ä¸‹æ–¹ //æ¸²æŸ“å¾ªç¯ while (!glfwWindowShouldClose(MyWindows)){ //~Input Begin ProcessInput(MyWindows);//è¾“å…¥å‡½æ•°ï¼ˆ2ï¼‰ //~Input End //~Render command Begin glClearColor(0.4f,0.9f,0.8f,1.0f); glClear(GL_COLOR_BUFFER_BIT); //~Render command End //æ£€æŸ¥å¹¶è°ƒç”¨äº‹ä»¶ï¼Œäº¤æ¢ç¼“å†² glfwSwapBuffers(MyWindows);//é‡‡ç”¨åŒç¼“å­˜æœºåˆ¶ï¼Œä¿è¯å¸§ä¸å¸§ä¹‹é—´ä¸ä¼šé—ªçƒ glfwPollEvents();//æ£€æµ‹äº‹ä»¶è¾“å…¥ï¼šé”®ç›˜è¾“å…¥ã€é¼ æ ‡ç‚¹å‡»ã€Windowç¼©æ”¾ç­‰,å¹¶æ›´æ–°Window } glfwTerminate();//é‡Šæ”¾/åˆ é™¤ åˆ†é…çš„èµ„æº ç›‘å¬å‡½æ•°\n1 2 3 4 5 /** When the user changes the size of GlfwWindow , it will change the size of Viewport*/ void FrameBufferSizeCallback(GLFWwindow *Window, int Width, int Height) { glViewport(0,0,Width,Height); } è¾“å…¥å‡½æ•°\n1 2 3 4 5 6 7 8 9 /** When the user press the \u0026#34;ESC\u0026#34; ,quit the Window */ void ProcessInput(GLFWwindow* Window) { if (glfwGetKey(Window,GLFW_KEY_ESCAPE) == GLFW_PRESS) { glfwSetWindowShouldClose(Window,true); } } OpenGL OpenGLå¹•åä½¿ç”¨glViewportä¸­å®šä¹‰çš„ä½ç½®å’Œå®½é«˜è¿›è¡Œ2Dåæ ‡çš„è½¬æ¢ï¼Œå°†OpenGLä¸­çš„ä½ç½®åæ ‡è½¬æ¢ä¸ºä½ çš„å±å¹•åæ ‡ã€‚ä¾‹å¦‚ï¼ŒOpenGLä¸­çš„åæ ‡(-0.5, 0.5)æœ‰å¯èƒ½ï¼ˆæœ€ç»ˆï¼‰è¢«æ˜ å°„ä¸ºå±å¹•ä¸­çš„åæ ‡(200,450)ã€‚æ³¨æ„ï¼Œå¤„ç†è¿‡çš„OpenGLåæ ‡èŒƒå›´åªä¸º-1åˆ°1ï¼Œå› æ­¤æˆ‘ä»¬äº‹å®ä¸Šå°†(-1åˆ°1)èŒƒå›´å†…çš„åæ ‡æ˜ å°„åˆ°(0, 800)å’Œ(0, 600)ã€‚\né›¶ã€æ‚é¡¹ 1ã€glEnable ä¸€ã€å†…å­˜ç›¸å…³æ¥å£ 0ã€å¸¸ç”¨ç¤ºä¾‹ 1 2 3 4 unsigned int VBO; glGenBuffers(1, \u0026amp;VBO); glBindBuffer(GL_ARRAY_BUFFER, VBO); glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW); 1ã€glGenBuffers 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 /** * @brief ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªç¼“å†²åŒºå¯¹è±¡çš„åç§°ï¼ˆIDï¼‰ã€‚ * * è¯¥å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªæ–°çš„ç¼“å†²åŒºå¯¹è±¡çš„æ ‡è¯†ç¬¦ï¼ˆGLuint ç±»å‹ï¼‰ï¼Œè¿™äº›åç§°å¯ç”¨äºä¹‹åçš„ç¼“å†²åŒºç»‘å®šå’Œæ•°æ®ä¼ è¾“æ“ä½œã€‚ * å®ƒä»…ç”Ÿæˆåç§°ï¼Œä¸ä¼šåˆ†é…æˆ–åˆå§‹åŒ–ä»»ä½•æ•°æ®ï¼Œå¿…é¡»ä¸ glBindBuffer å’Œ glBufferData æ­é…ä½¿ç”¨ã€‚ * * @param n æŒ‡å®šè¦ç”Ÿæˆçš„ç¼“å†²åŒºå¯¹è±¡åç§°çš„æ•°é‡ã€‚ * * @param buffers æŒ‡å‘ä¸€ä¸ª GLuint ç±»å‹çš„æ•°ç»„ï¼Œç”¨äºå­˜å‚¨ç”Ÿæˆçš„ç¼“å†²åŒºå¯¹è±¡åç§°ã€‚ * è°ƒç”¨è€…éœ€è¦ä¸ºè¯¥æ•°ç»„åˆ†é…è¶³å¤Ÿçš„ç©ºé—´ï¼ˆä¾‹å¦‚ n ä¸ª GLuintï¼‰ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note ç”Ÿæˆçš„ç¼“å†²åŒºå¯¹è±¡åœ¨ä½¿ç”¨å‰å¿…é¡»é€šè¿‡ glBindBuffer ç»‘å®šåˆ°åˆé€‚çš„ç›®æ ‡ã€‚ * è‹¥ä¼ å…¥çš„ buffers æ•°ç»„æ— æ•ˆæˆ–æœªåˆ†é…ï¼Œå¯èƒ½å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚ * * @see glBindBuffer, glBufferData, glDeleteBuffers */ void glGenBuffers(GLsizei n, GLuint *buffers); 2ã€glBindBuffer 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * @brief ç»‘å®šä¸€ä¸ªå‘½åçš„ç¼“å†²åŒºå¯¹è±¡åˆ°æŒ‡å®šçš„ç¼“å†²åŒºç›®æ ‡ã€‚ * * è¯¥å‡½æ•°å°†æŒ‡å®šçš„ç¼“å†²åŒºå¯¹è±¡ç»‘å®šåˆ°ç»™å®šçš„ç¼“å†²åŒºç›®æ ‡ä¸Šï¼Œä½¿å¾—åç»­å¯¹è¯¥ç›®æ ‡çš„ç¼“å†²åŒºæ“ä½œï¼ˆå¦‚æ•°æ®åˆ†é…æˆ–æ›´æ–°ï¼‰ä¼šä½œç”¨äºæ­¤ç¼“å†²åŒºå¯¹è±¡ã€‚ * å¦‚æœä¼ å…¥çš„ buffer ä¸º 0ï¼Œåˆ™ä¼šè§£ç»‘å½“å‰ç»‘å®šçš„ç¼“å†²åŒºå¯¹è±¡ã€‚ * * @param target æŒ‡å®šè¦ç»‘å®šçš„ç¼“å†²åŒºç›®æ ‡ã€‚å¸¸ç”¨çš„ç›®æ ‡åŒ…æ‹¬ï¼š * - GL_ARRAY_BUFFERï¼šç”¨äºé¡¶ç‚¹å±æ€§æ•°æ®ï¼ˆVBOï¼‰ * - GL_ELEMENT_ARRAY_BUFFERï¼šç”¨äºç´¢å¼•æ•°æ®ï¼ˆEBO/IBOï¼‰ * - GL_UNIFORM_BUFFERã€GL_SHADER_STORAGE_BUFFER ç­‰é«˜çº§ç”¨é€” * * @param buffer è¦ç»‘å®šçš„ç¼“å†²åŒºå¯¹è±¡çš„åç§°ï¼ˆIDï¼‰ï¼Œç”± glGenBuffers ç”Ÿæˆã€‚ * å¦‚æœè®¾ç½®ä¸º 0ï¼Œè¡¨ç¤ºè§£ç»‘å½“å‰ç›®æ ‡çš„ç¼“å†²åŒºå¯¹è±¡ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note æ¯ä¸ªç¼“å†²åŒºç›®æ ‡åœ¨ä»»æ„æ—¶åˆ»åªèƒ½ç»‘å®šä¸€ä¸ªç¼“å†²åŒºå¯¹è±¡ã€‚ç»‘å®šä¹‹åï¼Œæ‰€æœ‰å¯¹è¯¥ç›®æ ‡çš„æ“ä½œéƒ½ä½œç”¨äºå½“å‰ç»‘å®šçš„å¯¹è±¡ã€‚ * * @see glGenBuffers, glBufferData, glDeleteBuffers */ void glBindBuffer(GLenum target, GLuint buffer); 3ã€glBufferData 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 /** * @brief å‘å½“å‰ç»‘å®šçš„ç¼“å†²åŒºå¯¹è±¡åˆ†é…å†…å­˜å¹¶å¯é€‰åœ°ä¼ å…¥æ•°æ®ã€‚ * * è¯¥å‡½æ•°ç”¨äºä¸ºå½“å‰ç»‘å®šåˆ°æŒ‡å®šç›®æ ‡çš„ç¼“å†²åŒºå¯¹è±¡åˆ†é…å­˜å‚¨ç©ºé—´ï¼Œå¹¶å¯å°†æŒ‡å®šçš„æ•°æ®å¤åˆ¶åˆ°ç¼“å†²åŒºä¸­ã€‚ * å®ƒé€šå¸¸åœ¨ glGenBuffers å’Œ glBindBuffer ä¹‹åè°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–ç¼“å†²åŒºæ•°æ®ã€‚ * * @param target æŒ‡å®šç¼“å†²åŒºå¯¹è±¡çš„ç›®æ ‡ç±»å‹ã€‚å¸¸ç”¨å€¼åŒ…æ‹¬ï¼š * - GL_ARRAY_BUFFERï¼šç”¨äºé¡¶ç‚¹å±æ€§æ•°æ® * - GL_ELEMENT_ARRAY_BUFFERï¼šç”¨äºç´¢å¼•æ•°æ® * * @param size è¦åˆ†é…çš„ç¼“å†²åŒºå¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ * * @param data æŒ‡å‘åŒ…å«åˆå§‹åŒ–æ•°æ®çš„æŒ‡é’ˆã€‚å¦‚æœä¸º NULLï¼Œä»…åˆ†é…å†…å­˜è€Œä¸åˆå§‹åŒ–æ•°æ®ã€‚ * * @param usage æç¤ºæ•°æ®çš„ä½¿ç”¨æ–¹å¼ï¼Œå¸®åŠ© OpenGL ä¼˜åŒ–æ€§èƒ½ã€‚å¸¸ç”¨å€¼åŒ…æ‹¬ï¼š * - GL_STATIC_DRAWï¼šæ•°æ®å°†å¾ˆå°‘æ›´æ”¹ï¼Œä¸»è¦ç”¨äºç»˜åˆ¶ * - GL_DYNAMIC_DRAWï¼šæ•°æ®ä¼šé¢‘ç¹æ›´æ”¹ï¼Œä»ç”¨äºç»˜åˆ¶ * - GL_STREAM_DRAWï¼šæ•°æ®æ¯å¸§éƒ½å¯èƒ½æ›´æ–° * * @return æ— è¿”å›å€¼ã€‚ * * @note å¦‚æœç¼“å†²åŒºå·²ç»æœ‰æ•°æ®ï¼Œæ­¤è°ƒç”¨ä¼šæ›¿æ¢åŸæœ‰å†…å®¹ã€‚ */ void glBufferData(GLenum target, GLsizeiptr size, const void *data, GLenum usage); eg.1 glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW); äºŒã€ç€è‰²å™¨ 0ã€ä»£ç ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 //eg.1 åˆ›å»ºç€è‰²å™¨ unsigned int vertexShader; vertexShader = glCreateShader(GL_VERTEX_SHADER); glShaderSource(vertexShader, 1, \u0026amp;vertexShaderSource, NULL); glCompileShader(vertexShader); GLint success; glGetShaderiv(vertexShader, GL_COMPILE_STATUS, \u0026amp;success); if (!success) { char infoLog[512]; glGetShaderInfoLog(vertexShader, 512, NULL, infoLog); printf(\u0026#34;Shader compilation failed:\\n%s\\n\u0026#34;, infoLog); } //eg.2\tç€è‰²å™¨ç¨‹åº unsigned int shaderProgram; shaderProgram = glCreateProgram(); glAttachShader(shaderProgram, vertexShader); glAttachShader(shaderProgram, fragmentShader); glLinkProgram(shaderProgram); glGetProgramiv(shaderProgram, GL_LINK_STATUS, \u0026amp;success); if(!success) { glGetProgramInfoLog(shaderProgram, 512, NULL, infoLog); ... } glUseProgram(shaderProgram); glDeleteShader(vertexShader); glDeleteShader(fragmentShader); 1ã€glCreateShader 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * @brief åˆ›å»ºä¸€ä¸ªç€è‰²å™¨å¯¹è±¡å¹¶è¿”å›å…¶ IDã€‚ * * è¯¥å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªç©ºçš„ç€è‰²å™¨å¯¹è±¡ã€‚åˆ›å»ºåï¼Œä½ éœ€è¦ä½¿ç”¨ glShaderSource æä¾›æºä»£ç ï¼Œ * ç„¶åä½¿ç”¨ glCompileShader å¯¹å…¶è¿›è¡Œç¼–è¯‘ã€‚ * * @param shaderType æŒ‡å®šè¦åˆ›å»ºçš„ç€è‰²å™¨ç±»å‹ã€‚å¸¸è§çš„ç±»å‹åŒ…æ‹¬ï¼š * - GL_VERTEX_SHADERï¼šé¡¶ç‚¹ç€è‰²å™¨ * - GL_FRAGMENT_SHADERï¼šç‰‡æ®µï¼ˆåƒç´ ï¼‰ç€è‰²å™¨ * - GL_GEOMETRY_SHADERï¼šå‡ ä½•ç€è‰²å™¨ï¼ˆå¯é€‰ï¼‰ * - GL_COMPUTE_SHADERï¼šè®¡ç®—ç€è‰²å™¨ * - GL_TESS_CONTROL_SHADER / GL_TESS_EVALUATION_SHADERï¼šç»†åˆ†ç€è‰²å™¨ï¼ˆå¯é€‰ï¼‰ * * @return è¿”å›ä¸€ä¸ªéé›¶çš„ GLuint å€¼ï¼Œè¡¨ç¤ºæ–°åˆ›å»ºçš„ç€è‰²å™¨å¯¹è±¡çš„ IDã€‚ * å¦‚æœè¿”å›å€¼ä¸º 0ï¼Œåˆ™è¡¨ç¤ºåˆ›å»ºå¤±è´¥ï¼ˆå¯èƒ½æ˜¯å› ä¸ºä¸Šä¸‹æ–‡é”™è¯¯æˆ– shaderType æ— æ•ˆï¼‰ã€‚ * * @note ç€è‰²å™¨åˆ›å»ºåå¿…é¡»æ‰‹åŠ¨é‡Šæ”¾ï¼Œä½¿ç”¨ glDeleteShader åˆ é™¤ä¸å†ä½¿ç”¨çš„ç€è‰²å™¨å¯¹è±¡ã€‚ * * @see glShaderSource, glCompileShader, glAttachShader, glDeleteShader */ GLuint glCreateShader(GLenum shaderType); 2ã€glShaderSource 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 /** * @brief å°†æºä»£ç å­—ç¬¦ä¸²ä¼ é€’ç»™æŒ‡å®šçš„ç€è‰²å™¨å¯¹è±¡ã€‚ * * è¯¥å‡½æ•°ç”¨äºè®¾ç½®ç€è‰²å™¨å¯¹è±¡çš„æºä»£ç ï¼Œé€šå¸¸åœ¨è°ƒç”¨ glCreateShader åˆ›å»ºç€è‰²å™¨å¯¹è±¡ä¹‹åä½¿ç”¨ã€‚ * è®¾ç½®å®Œæˆåï¼Œéœ€è¦ä½¿ç”¨ glCompileShader å¯¹è¯¥ç€è‰²å™¨è¿›è¡Œç¼–è¯‘ã€‚ * * @param shader ç€è‰²å™¨å¯¹è±¡çš„ IDï¼Œç”± glCreateShader åˆ›å»ºã€‚ * * @param count æºç å­—ç¬¦ä¸²çš„æ•°é‡ã€‚å¦‚æœä½ åªä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥è®¾ç½®ä¸º 1ã€‚ * * @param string åŒ…å«æºä»£ç å­—ç¬¦ä¸²çš„æŒ‡é’ˆæ•°ç»„ï¼ˆæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª C é£æ ¼å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼‰ã€‚ * * @param length æ¯ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦æ•°ç»„ã€‚å¯ä»¥ä¸º NULLï¼ˆæ­¤æ—¶å­—ç¬¦ä¸²ä»¥ null ç»“å°¾ï¼‰ï¼Œ * å¦åˆ™å¿…é¡»æä¾›ä¸€ä¸ªåŒ…å« count ä¸ªå…ƒç´ çš„æ•´å‹æ•°ç»„ï¼ŒæŒ‡æ˜æ¯ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note è®¾ç½®æºä»£ç å¹¶ä¸ä¼šè‡ªåŠ¨ç¼–è¯‘ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨ glCompileShader è¿›è¡Œç¼–è¯‘ã€‚ * * @see glCreateShader, glCompileShader, glGetShaderiv, glGetShaderInfoLog */ void glShaderSource(GLuint shader, GLsizei count, const GLchar **string, const GLint *length); 4ã€glCompileShader 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 /** * @brief ç¼–è¯‘ä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ã€‚ * * æ­¤å‡½æ•°ç”¨äºç¼–è¯‘é€šè¿‡ glShaderSource è®¾ç½®äº†æºä»£ç çš„ç€è‰²å™¨å¯¹è±¡ã€‚ç¼–è¯‘æˆåŠŸåï¼Œ * ç€è‰²å™¨å¯¹è±¡å¯ä»¥è¢«é™„åŠ åˆ°ç¨‹åºå¯¹è±¡ï¼ˆProgram Objectï¼‰ä¸­ã€‚ * * @param shader è¦ç¼–è¯‘çš„ç€è‰²å™¨å¯¹è±¡ IDï¼Œç”± glCreateShader åˆ›å»ºï¼Œå¹¶é€šè¿‡ glShaderSource è®¾ç½®äº†æºä»£ç ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note ç¼–è¯‘å®Œæˆååº”ä½¿ç”¨ glGetShaderiv å’Œ glGetShaderInfoLog æ£€æŸ¥æ˜¯å¦ç¼–è¯‘æˆåŠŸä»¥åŠè·å–å¯èƒ½çš„é”™è¯¯ä¿¡æ¯ã€‚ * ç€è‰²å™¨ç¼–è¯‘å¤±è´¥ä¸ä¼šå¯¼è‡´ OpenGL æŠ›å‡ºé”™è¯¯ï¼Œå¿…é¡»æ‰‹åŠ¨æ£€æŸ¥çŠ¶æ€ã€‚ * * @see glCreateShader, glShaderSource, glGetShaderiv, glAttachShader, glLinkProgram */ void glCompileShader(GLuint shader); 5ã€glGetShaderiv 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * @brief è·å–ç€è‰²å™¨å¯¹è±¡çš„å‚æ•°ä¿¡æ¯ã€‚ * * æ­¤å‡½æ•°ç”¨äºæŸ¥è¯¢ç€è‰²å™¨å¯¹è±¡çš„ç¼–è¯‘çŠ¶æ€æˆ–å…¶ä»–ç›¸å…³å±æ€§ã€‚æœ€å¸¸ç”¨äºæ£€æµ‹ç¼–è¯‘æ˜¯å¦æˆåŠŸï¼Œ * é€šå¸¸åœ¨è°ƒç”¨ glCompileShader åç«‹å³ä½¿ç”¨ã€‚ * * @param shader è¦æŸ¥è¯¢çš„ç€è‰²å™¨å¯¹è±¡ IDï¼Œç”± glCreateShader åˆ›å»ºã€‚ * * @param pname æŒ‡å®šè¦è·å–çš„å‚æ•°ç±»å‹ã€‚å¸¸ç”¨å€¼åŒ…æ‹¬ï¼š * - GL_COMPILE_STATUSï¼šç¼–è¯‘æ˜¯å¦æˆåŠŸï¼ˆGL_TRUE æˆ– GL_FALSEï¼‰ * - GL_SHADER_TYPEï¼šç€è‰²å™¨ç±»å‹ï¼ˆå¦‚ GL_VERTEX_SHADERï¼‰ * - GL_DELETE_STATUSï¼šæ˜¯å¦å·²è¢«æ ‡è®°åˆ é™¤ * - GL_INFO_LOG_LENGTHï¼šä¿¡æ¯æ—¥å¿—çš„é•¿åº¦ï¼ˆå¯ç”¨äºåˆ†é… glGetShaderInfoLog æ‰€éœ€çš„ç¼“å†²åŒºï¼‰ * * @param params æŒ‡å‘æ•´æ•°å˜é‡çš„æŒ‡é’ˆï¼Œç”¨äºæ¥æ”¶æŸ¥è¯¢ç»“æœã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @see glCompileShader, glGetShaderInfoLog, glCreateShader, glShaderSource */ void glGetShaderiv(GLuint shader, GLenum pname, GLint *params); 6ã€glGetShaderInfoLog 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * @brief è·å–ç€è‰²å™¨ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ—¥å¿—ï¼ˆå¦‚é”™è¯¯æˆ–è­¦å‘Šä¿¡æ¯ï¼‰ã€‚ * * æ­¤å‡½æ•°é€šå¸¸åœ¨ç€è‰²å™¨ç¼–è¯‘å¤±è´¥åè°ƒç”¨ï¼Œç”¨äºè·å–ç¼–è¯‘é”™è¯¯æˆ–è­¦å‘Šçš„è¯¦ç»†æ–‡æœ¬ä¿¡æ¯ã€‚ * * @param shader è¦æŸ¥è¯¢çš„ç€è‰²å™¨å¯¹è±¡ IDï¼Œç”± glCreateShader åˆ›å»ºå¹¶å·²è°ƒç”¨ glCompileShader ç¼–è¯‘ã€‚ * * @param maxLength æŒ‡å®š infoLog ç¼“å†²åŒºçš„æœ€å¤§é•¿åº¦ï¼ˆä»¥å­—ç¬¦æ•°è®¡ï¼ŒåŒ…æ‹¬ç»“å°¾çš„ null å­—ç¬¦ï¼‰ã€‚ * * @param length å¯ä¸º NULLï¼Œæˆ–è€…æŒ‡å‘ä¸€ä¸ªæ•´æ•°çš„æŒ‡é’ˆï¼Œç”¨äºæ¥æ”¶å®é™…å†™å…¥ infoLog çš„å­—ç¬¦ä¸²é•¿åº¦ï¼ˆä¸åŒ…å«ç»“å°¾ nullï¼‰ã€‚ * * @param infoLog ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œç”¨äºæ¥æ”¶ä¿¡æ¯æ—¥å¿—å­—ç¬¦ä¸²ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note åªæœ‰åœ¨ç¼–è¯‘å¤±è´¥æˆ–ç¼–è¯‘æ—¶å‡ºç°è­¦å‘Šæ—¶ï¼Œä¿¡æ¯æ—¥å¿—æ‰å¯èƒ½åŒ…å«å†…å®¹ã€‚ * å»ºè®®åœ¨ç¼–è¯‘åå§‹ç»ˆè°ƒç”¨æ­¤å‡½æ•°ï¼Œä»¥ä¾¿åŠæ—¶å‘ç°æ½œåœ¨é—®é¢˜ã€‚ * * @see glCompileShader, glGetShaderiv, glCreateShader */ void glGetShaderInfoLog(GLuint shader, GLsizei maxLength, GLsizei *length, GLchar *infoLog); 7ã€glDeleteShader 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /** * @brief åˆ é™¤ä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ã€‚ * * æ­¤å‡½æ•°æ ‡è®°ä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ä»¥ä¾›åˆ é™¤ã€‚å½“è¯¥ç€è‰²å™¨ä¸å†é™„åŠ åˆ°ä»»ä½•ç¨‹åºå¯¹è±¡æ—¶ï¼Œå®ƒå°†è¢«çœŸæ­£é‡Šæ”¾ã€‚ * * @param shader è¦åˆ é™¤çš„ç€è‰²å™¨å¯¹è±¡ IDï¼Œç”± glCreateShader åˆ›å»ºã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - å¦‚æœè¯¥ç€è‰²å™¨ä»ç„¶é™„åŠ åˆ°æŸä¸ªç¨‹åºå¯¹è±¡ä¸­ï¼Œå®ƒä¸ä¼šç«‹å³è¢«åˆ é™¤ï¼Œè€Œæ˜¯åœ¨åˆ†ç¦»æˆ–åˆ é™¤ç¨‹åºå¯¹è±¡åæ‰çœŸæ­£é”€æ¯ã€‚ * - å³ä½¿ç€è‰²å™¨å·²ç»åˆ é™¤ï¼Œåªè¦ç¨‹åºä»ç„¶é“¾æ¥æˆåŠŸï¼Œä½¿ç”¨è¯¥ç¨‹åºå¯¹è±¡ä¾ç„¶æœ‰æ•ˆã€‚ * - åœ¨æˆåŠŸé“¾æ¥åï¼Œä½ é€šå¸¸å¯ä»¥å®‰å…¨åœ°è°ƒç”¨ glDeleteShader é‡Šæ”¾ä¸­é—´çš„ shader èµ„æºã€‚ * * @see glCreateShader, glAttachShader, glCompileShader, glDeleteProgram */ void glDeleteShader(GLuint shader); ä¸‰ã€ç€è‰²å™¨ç¨‹åº 0ã€ä»£ç ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 //eg.2\tç€è‰²å™¨ç¨‹åº unsigned int shaderProgram; shaderProgram = glCreateProgram(); glAttachShader(shaderProgram, vertexShader); glAttachShader(shaderProgram, fragmentShader); glLinkProgram(shaderProgram); glGetProgramiv(shaderProgram, GL_LINK_STATUS, \u0026amp;success); if(!success) { glGetProgramInfoLog(shaderProgram, 512, NULL, infoLog); ... } glUseProgram(shaderProgram); glDeleteShader(vertexShader); glDeleteShader(fragmentShader); 1ã€glCreateProgram 1 2 3 4 5 6 7 8 9 10 11 12 13 14 /** * @brief åˆ›å»ºä¸€ä¸ªæ–°çš„ç¨‹åºå¯¹è±¡ï¼ˆProgram Objectï¼‰ã€‚ * * ç¨‹åºå¯¹è±¡ç”¨äºå°†å¤šä¸ªç€è‰²å™¨ï¼ˆå¦‚é¡¶ç‚¹ç€è‰²å™¨ã€ç‰‡æ®µç€è‰²å™¨ç­‰ï¼‰é“¾æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ GPU æ¸²æŸ“ç®¡çº¿ã€‚ * åˆ›å»ºåï¼Œå¯ä»¥é€šè¿‡ glAttachShader é™„åŠ å·²ç¼–è¯‘çš„ç€è‰²å™¨ï¼Œå¹¶ä½¿ç”¨ glLinkProgram è¿›è¡Œé“¾æ¥ã€‚ * * @return è¿”å›ä¸€ä¸ªéé›¶çš„ç¨‹åºå¯¹è±¡ IDï¼ˆGLuint ç±»å‹ï¼‰ã€‚å¦‚æœè¿”å›å€¼ä¸º 0ï¼Œè¡¨ç¤ºåˆ›å»ºå¤±è´¥ã€‚ * * @note åˆ›å»ºçš„ç¨‹åºå¯¹è±¡åœ¨ä½¿ç”¨å®Œæ¯•ååº”é€šè¿‡ glDeleteProgram é‡Šæ”¾ã€‚ * å¿…é¡»å…ˆé“¾æ¥ï¼ˆglLinkProgramï¼‰åæ‰èƒ½ä½¿ç”¨ï¼ˆglUseProgramï¼‰ã€‚ * * @see glAttachShader, glLinkProgram, glUseProgram, glDeleteProgram */ GLuint glCreateProgram(void); 2ã€glAttachShader 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 /** * @brief å°†ä¸€ä¸ªå·²ç¼–è¯‘çš„ç€è‰²å™¨å¯¹è±¡é™„åŠ åˆ°ç¨‹åºå¯¹è±¡ä¸Šã€‚å¯ä»¥é™„åŠ å¤šç§ç€è‰²å™¨ï¼Œä½†æ˜¯æ¯ç§ç€è‰²å™¨ä»…æ”¯æŒä¸€ä¸ªï¼Œ *\tç‰¹åˆ«çš„è®¡ç®—ç€è‰²å™¨ä¸å…¶ä»–ä¸æ··ç”¨ * glAttachShader(program, vertexShader); // é¡¶ç‚¹ç€è‰²å™¨ glAttachShader(program, fragmentShader); // ç‰‡æ®µç€è‰²å™¨ glAttachShader(program, geometryShader); // å‡ ä½•ç€è‰²å™¨ï¼ˆå¯é€‰ï¼‰ glAttachShader(program, tessCtrlShader); // æ›²é¢ç»†åˆ†æ§åˆ¶ï¼ˆå¯é€‰ï¼‰ glAttachShader(program, tessEvalShader); // æ›²é¢ç»†åˆ†è¯„ä¼°ï¼ˆå¯é€‰ï¼‰ * æ­¤å‡½æ•°ç”¨äºå°†å·²ç»ç¼–è¯‘æˆåŠŸçš„ç€è‰²å™¨é™„åŠ åˆ°ä¸€ä¸ª OpenGL ç¨‹åºå¯¹è±¡ï¼ˆprogram objectï¼‰ä¸­ã€‚ * ä¸€ä¸ªç¨‹åºå¯ä»¥é™„åŠ å¤šä¸ªä¸åŒç±»å‹çš„ç€è‰²å™¨ï¼ˆä¾‹å¦‚é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ï¼‰ï¼Œåœ¨é“¾æ¥ç¨‹åºæ—¶å°†å®ƒä»¬ç»„åˆæˆä¸€ä¸ªå®Œæ•´çš„æ¸²æŸ“ç®¡çº¿ã€‚ * * @param program è¦é™„åŠ ç€è‰²å™¨çš„ç¨‹åºå¯¹è±¡ IDï¼Œç”± glCreateProgram åˆ›å»ºã€‚ * * @param shader è¦é™„åŠ çš„ç€è‰²å™¨å¯¹è±¡ IDï¼Œéœ€ç”± glCreateShader åˆ›å»ºå¹¶é€šè¿‡ glCompileShader ç¼–è¯‘ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - ä¸€ä¸ªç€è‰²å™¨å¯¹è±¡å¯ä»¥é™„åŠ åˆ°å¤šä¸ªç¨‹åºå¯¹è±¡ä¸­ã€‚ * - å¿…é¡»åœ¨ glLinkProgram ä¹‹å‰è°ƒç”¨ glAttachShaderã€‚ * - å¯ä»¥å¤šæ¬¡è°ƒç”¨ä»¥é™„åŠ å¤šä¸ªä¸åŒç±»å‹çš„ç€è‰²å™¨ã€‚ * - è°ƒç”¨ glDeleteShader åˆ é™¤ç€è‰²å™¨ä¸ä¼šç«‹å³é”€æ¯å®ƒï¼Œåªè¦å®ƒä»ç„¶è¢«é™„åŠ åˆ°ç¨‹åºä¸Šã€‚ * * @see glCreateProgram, glCreateShader, glCompileShader, glLinkProgram, glDetachShader, glDeleteShader */ void glAttachShader(GLuint program, GLuint shader); 3ã€glLinkProgram 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 /** * @brief é“¾æ¥ä¸€ä¸ªç¨‹åºå¯¹è±¡ï¼Œå°†é™„åŠ çš„ç€è‰²å™¨ç»„åˆä¸ºä¸€ä¸ªå¯æ‰§è¡Œçš„ GPU ç¨‹åºã€‚ * * æ­¤å‡½æ•°ç”¨äºå°†é€šè¿‡ glAttachShader é™„åŠ åˆ°ç¨‹åºå¯¹è±¡çš„å„ä¸ªç€è‰²å™¨è¿›è¡Œé“¾æ¥ã€‚ * é“¾æ¥æˆåŠŸåï¼Œè¯¥ç¨‹åºå¯¹è±¡å¯ä»¥é€šè¿‡ glUseProgram å¯ç”¨ç”¨äºæ¸²æŸ“æˆ–è®¡ç®—ä»»åŠ¡ã€‚ * * @param program ç¨‹åºå¯¹è±¡çš„ IDï¼Œç”± glCreateProgram åˆ›å»ºï¼Œä¸”å·²é™„åŠ æ‰€éœ€çš„ç€è‰²å™¨å¯¹è±¡ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - é“¾æ¥å‰å¿…é¡»é™„åŠ è‡³å°‘ä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ï¼‰ã€‚ * - é“¾æ¥åå¯ä»¥è°ƒç”¨ glGetProgramiv å’Œ glGetProgramInfoLog æ£€æŸ¥æ˜¯å¦æˆåŠŸã€‚ * - æˆåŠŸé“¾æ¥åï¼Œå¯ä»¥åˆ†ç¦»æˆ–åˆ é™¤ç€è‰²å™¨å¯¹è±¡ï¼ˆglDetachShaderã€glDeleteShaderï¼‰ï¼Œä¸ä¼šå½±å“ç¨‹åºå¯¹è±¡ã€‚ * * @see glCreateProgram, glAttachShader, glUseProgram, glGetProgramiv, glGetProgramInfoLog */ void glLinkProgram(GLuint program); 4ã€glGetProgramiv 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 /** * @brief è·å–ç¨‹åºå¯¹è±¡çš„å‚æ•°ä¿¡æ¯ï¼ˆå¦‚é“¾æ¥çŠ¶æ€ã€æ—¥å¿—é•¿åº¦ç­‰ï¼‰ã€‚ * * æ­¤å‡½æ•°ç”¨äºæŸ¥è¯¢ OpenGL ç¨‹åºå¯¹è±¡çš„çŠ¶æ€æˆ–å±æ€§ï¼Œå¸¸ç”¨äºåœ¨ glLinkProgram åæ£€æŸ¥æ˜¯å¦é“¾æ¥æˆåŠŸã€‚ * * @param program è¦æŸ¥è¯¢çš„ç¨‹åºå¯¹è±¡ IDï¼Œç”± glCreateProgram åˆ›å»ºã€‚ * * @param pname æŒ‡å®šè¦è·å–çš„å‚æ•°ç±»å‹ã€‚å¸¸ç”¨å€¼åŒ…æ‹¬ï¼š * - GL_LINK_STATUSï¼šé“¾æ¥æ˜¯å¦æˆåŠŸï¼ˆGL_TRUE æˆ– GL_FALSEï¼‰ * - GL_VALIDATE_STATUSï¼šéªŒè¯çŠ¶æ€æ˜¯å¦æˆåŠŸ * - GL_INFO_LOG_LENGTHï¼šä¿¡æ¯æ—¥å¿—çš„é•¿åº¦ï¼ˆç”¨äºåˆ†é… glGetProgramInfoLog çš„ç¼“å†²åŒºï¼‰ * - GL_ATTACHED_SHADERSï¼šé™„åŠ çš„ç€è‰²å™¨æ•°é‡ * - GL_ACTIVE_ATTRIBUTESï¼šæ´»è·ƒçš„é¡¶ç‚¹å±æ€§æ•°é‡ * - GL_ACTIVE_UNIFORMSï¼šæ´»è·ƒçš„ uniform æ•°é‡ * * @param params æŒ‡å‘æ•´æ•°å˜é‡çš„æŒ‡é’ˆï¼Œç”¨äºæ¥æ”¶æŸ¥è¯¢ç»“æœã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note é€šå¸¸ä¸ glGetProgramInfoLog é…åˆä½¿ç”¨ï¼Œç”¨äºåœ¨ç¨‹åºé“¾æ¥å¤±è´¥æ—¶è·å–é”™è¯¯ä¿¡æ¯ã€‚ * * @see glLinkProgram, glGetProgramInfoLog, glAttachShader */ void glGetProgramiv(GLuint program, GLenum pname, GLint *params); 5ã€glGetProgramInfoLog 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 /** * @brief è·å–ç¨‹åºå¯¹è±¡çš„é“¾æ¥æˆ–éªŒè¯é˜¶æ®µçš„é”™è¯¯æˆ–è­¦å‘Šä¿¡æ¯æ—¥å¿—ã€‚ * * æ­¤å‡½æ•°ç”¨äºåœ¨è°ƒç”¨ glLinkProgram æˆ– glValidateProgram åè·å–ç¨‹åºå¯¹è±¡çš„ç¼–è¯‘/é“¾æ¥æ—¥å¿—ï¼Œ * ä¸»è¦ç”¨äºè°ƒè¯•å¤±è´¥çš„ç€è‰²å™¨ç¨‹åºã€‚ * * @param program è¦æŸ¥è¯¢çš„ç¨‹åºå¯¹è±¡ IDï¼Œç”± glCreateProgram åˆ›å»ºã€‚ * * @param maxLength infoLog ç¼“å†²åŒºçš„æœ€å¤§é•¿åº¦ï¼ˆä»¥å­—ç¬¦æ•°ä¸ºå•ä½ï¼ŒåŒ…æ‹¬ç»“å°¾ null å­—ç¬¦ï¼‰ã€‚ * * @param length å¯ä¸º NULLï¼Œæˆ–è€…æŒ‡å‘æ•´æ•°å˜é‡çš„æŒ‡é’ˆï¼Œç”¨äºæ¥æ”¶å†™å…¥ infoLog çš„å®é™…é•¿åº¦ï¼ˆä¸åŒ…æ‹¬ç»“å°¾ nullï¼‰ã€‚ * * @param infoLog æ¥æ”¶æ—¥å¿—å­—ç¬¦ä¸²çš„å­—ç¬¦æ•°ç»„ï¼ˆå¿…é¡»ç”±ç”¨æˆ·åˆ†é…å†…å­˜ï¼‰ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - åœ¨ glLinkProgram æˆ– glValidateProgram ä¹‹åè°ƒç”¨æ­¤å‡½æ•°ã€‚ * - å¦‚æœç¨‹åºå¯¹è±¡æ²¡æœ‰ä¿¡æ¯æ—¥å¿—ï¼ˆå¦‚é“¾æ¥æˆåŠŸä¸”æ— è­¦å‘Šï¼‰ï¼Œè¿”å›çš„ infoLog å¯èƒ½æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚ * * @see glLinkProgram, glValidateProgram, glGetProgramiv */ void glGetProgramInfoLog(GLuint program, GLsizei maxLength, GLsizei *length, GLchar *infoLog); 6ã€glUseProgram 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 /** * @brief æ¿€æ´»æŒ‡å®šçš„ç¨‹åºå¯¹è±¡ï¼Œä½¿å…¶æˆä¸ºå½“å‰ä½¿ç”¨çš„ç€è‰²å™¨ç¨‹åºã€‚ * * æ­¤å‡½æ•°å°†ä¸€ä¸ªå·²æˆåŠŸé“¾æ¥çš„ç¨‹åºå¯¹è±¡è®¾ä¸ºå½“å‰ OpenGL çŠ¶æ€ä¸‹ä½¿ç”¨çš„ç€è‰²å™¨ç¨‹åºï¼Œ * åç»­æ‰€æœ‰ç»˜å›¾æ“ä½œå°†ä½¿ç”¨è¯¥ç¨‹åºä¸­çš„ç€è‰²å™¨æ‰§è¡Œæ¸²æŸ“ã€‚ * * @param program ç¨‹åºå¯¹è±¡çš„ IDï¼Œç”± glCreateProgram åˆ›å»ºå¹¶æˆåŠŸé“¾æ¥ã€‚å¦‚æœè®¾ç½®ä¸º 0ï¼Œè¡¨ç¤ºå–æ¶ˆå½“å‰ç€è‰²å™¨ç¨‹åºï¼ˆä½¿ç”¨å›ºå®šåŠŸèƒ½ç®¡çº¿ï¼Œå¦‚æœæ”¯æŒï¼‰ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - ç¨‹åºå¿…é¡»åœ¨è°ƒç”¨ glLinkProgram åæ‰èƒ½ä½¿ç”¨ã€‚ * - æ¯æ¬¡åªèƒ½æ¿€æ´»ä¸€ä¸ªç¨‹åºå¯¹è±¡ï¼Œé‡å¤è°ƒç”¨ä¼šæ›¿æ¢ä¹‹å‰çš„ã€‚ * - åœ¨ç»˜åˆ¶å‰å¿…é¡»è°ƒç”¨ glUseProgram æ¿€æ´»ç¨‹åºï¼Œå¦åˆ™é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ä¸ä¼šç”Ÿæ•ˆã€‚ * * @see glCreateProgram, glAttachShader, glLinkProgram, glDeleteProgram */ void glUseProgram(GLuint program); å››ã€ç¼“å­˜ 0.ç¤ºä¾‹ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 unsigned int VBO, VAO; glGenVertexArrays(1, \u0026amp;VAO); glGenBuffers(1, \u0026amp;VBO); glBindVertexArray(VAO); glBindBuffer(GL_ARRAY_BUFFER, VBO); glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW); glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0); glEnableVertexAttribArray(0); glBindBuffer(GL_ARRAY_BUFFER, 0); glBindVertexArray(0); 1. glVertexAttribPointer 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 /** * @brief å®šä¹‰ä¸€ä¸ªé¡¶ç‚¹å±æ€§æ•°ç»„ä¸­å•ä¸ªå±æ€§çš„å†…å­˜å¸ƒå±€ã€‚ * * æ­¤å‡½æ•°ç”¨äºå‘Šè¯‰ OpenGL å¦‚ä½•ä»å½“å‰ç»‘å®šçš„é¡¶ç‚¹ç¼“å†²åŒºå¯¹è±¡ä¸­è¯»å–é¡¶ç‚¹å±æ€§ï¼ˆå¦‚ä½ç½®ã€é¢œè‰²ã€æ³•çº¿ç­‰ï¼‰ã€‚ * å®ƒå®šä¹‰äº†é¡¶ç‚¹å±æ€§åœ¨ç¼“å†²åŒºä¸­çš„æ•°æ®æ ¼å¼å’Œåç§»æ–¹å¼ã€‚ * * @param index é¡¶ç‚¹ç€è‰²å™¨ä¸­è¾“å…¥å˜é‡çš„ä½ç½®ï¼ˆlocationï¼‰ï¼Œç”± layout(location = x) æŒ‡å®šæˆ–é€šè¿‡ glGetAttribLocation æŸ¥è¯¢ã€‚ * * @param size æ¯ä¸ªé¡¶ç‚¹å±æ€§çš„æ•°æ®æ•°é‡ï¼ˆ1~4ï¼‰ã€‚å¦‚ vec3 åˆ™ä¸º 3ã€‚ * * @param type æ•°æ®ç±»å‹ã€‚å¸¸è§çš„æœ‰ï¼š * - GL_FLOAT * - GL_INT * - GL_UNSIGNED_BYTE ç­‰ * * @param normalized æŒ‡å®šæ•°æ®æ˜¯å¦åœ¨é€å…¥ç€è‰²å™¨å‰éœ€è¦å½’ä¸€åŒ–ï¼ˆå¦‚ GL_UNSIGNED_BYTE è½¬æ¢ä¸º [0,1]ï¼‰ã€‚ * é€šå¸¸ä¸º GL_FALSEã€‚ * * @param stride æ¯ä¸ªé¡¶ç‚¹çš„å­—èŠ‚é—´éš”ï¼ˆæ­¥é•¿ï¼‰ã€‚å¦‚æœæ•°æ®æ˜¯ç´§å¯†æ’åˆ—çš„ï¼Œå¯ä»¥ä¼  0ã€‚ * * @param pointer æŒ‡å‘ç¬¬ä¸€ä¸ªé¡¶ç‚¹å±æ€§æ•°æ®åœ¨ç¼“å†²åŒºä¸­çš„åç§»é‡ï¼ˆå¯ä»¥æ˜¯åç§»é‡å€¼æˆ– (void*)0 è¡¨ç¤ºèµ·å§‹ï¼‰ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - è°ƒç”¨å‰å¿…é¡»ç»‘å®šä¸€ä¸ªå¯¹åº”çš„ç¼“å†²åŒºåˆ° `GL_ARRAY_BUFFER`ã€‚ * - è°ƒç”¨åéœ€å¯ç”¨è¯¥å±æ€§ï¼š`glEnableVertexAttribArray(index)`ã€‚ * - æ‰€æœ‰é…ç½®åªå½±å“å½“å‰ç»‘å®šçš„ VAOï¼ˆé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼‰ã€‚ * * @see glEnableVertexAttribArray, glDisableVertexAttribArray, glBindBuffer, glVertexAttribDivisor */ void glVertexAttribPointer(GLuint index, GLint size, GLenum type, GLboolean normalized, GLsizei stride, const void *pointer); 2.glEnableVertexAttribArray 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 /** * @brief å¯ç”¨ä¸€ä¸ªé¡¶ç‚¹å±æ€§æ•°ç»„ã€‚ * * æ­¤å‡½æ•°ç”¨äºå¯ç”¨é€šè¿‡ glVertexAttribPointer å®šä¹‰çš„é¡¶ç‚¹å±æ€§ï¼Œä½¿å…¶åœ¨æ¸²æŸ“æ—¶è¢« GPU ä½¿ç”¨ã€‚ * å¦‚æœæ²¡æœ‰å¯ç”¨ï¼Œå¯¹åº”å±æ€§å³ä½¿å®šä¹‰äº†ä¹Ÿä¸ä¼šç”Ÿæ•ˆã€‚ * * @param index é¡¶ç‚¹å±æ€§çš„ä½ç½®ï¼ˆlocationï¼‰ï¼Œå¯¹åº”ç€è‰²å™¨ä¸­ layout(location = x) æˆ– glGetAttribLocation çš„è¿”å›å€¼ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - é¡¶ç‚¹å±æ€§é»˜è®¤æ˜¯ç¦ç”¨çš„ï¼Œå¿…é¡»æ‰‹åŠ¨å¯ç”¨ã€‚ * - å¯ç”¨åï¼ŒGPU ä¼šä»ç»‘å®šçš„ VBO ä¸­æŒ‰ glVertexAttribPointer å®šä¹‰è¯»å–è¯¥å±æ€§ã€‚ * - ç»‘å®šçš„ VAO ä¼šè®°å½•è¯¥çŠ¶æ€ï¼Œå› æ­¤å»ºè®®åœ¨è®¾ç½® VAO æ—¶å¯ç”¨ã€‚ * * @see glVertexAttribPointer, glDisableVertexAttribArray, glBindVertexArray */ void glEnableVertexAttribArray(GLuint index); 3.glGenBuffers 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 /** * @brief ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªç¼“å†²åŒºå¯¹è±¡åç§°ï¼ˆIDï¼‰ã€‚ * * è¯¥å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªæ–°çš„ OpenGL ç¼“å†²åŒºå¯¹è±¡æ ‡è¯†ç¬¦ï¼ˆåç§°ï¼‰ï¼Œè¿™äº›å¯¹è±¡å¯ç”¨äºå­˜å‚¨é¡¶ç‚¹æ•°æ®ã€ * ç´¢å¼•æ•°æ®ã€ç»Ÿä¸€å˜é‡ç­‰ã€‚ç”Ÿæˆçš„åç§°å¯ç”¨äºåç»­çš„ glBindBuffer å’Œ glBufferData ç­‰æ“ä½œã€‚ * * @param n è¦ç”Ÿæˆçš„ç¼“å†²åŒºå¯¹è±¡æ•°é‡ã€‚ * @param buffers æŒ‡å‘ GLuint æ•°ç»„çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨ç”Ÿæˆçš„ç¼“å†²åŒºå¯¹è±¡åç§°ã€‚ * è°ƒç”¨è€…å¿…é¡»é¢„å…ˆä¸ºè¯¥æ•°ç»„åˆ†é…è‡³å°‘ n ä¸ªå…ƒç´ çš„ç©ºé—´ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - æ­¤å‡½æ•°åªåˆ†é…åç§°ï¼ˆIDï¼‰ï¼Œä¸åˆ†é… GPU å†…å­˜ã€‚å¿…é¡»é€šè¿‡ glBindBuffer + glBufferData æ‰èƒ½çœŸæ­£ä½¿ç”¨ã€‚ * - åˆ›å»ºåå¯ä½¿ç”¨ glDeleteBuffers åˆ é™¤å¯¹è±¡ï¼Œé‡Šæ”¾èµ„æºã€‚ * * @see glBindBuffer, glBufferData, glDeleteBuffers */ void glGenBuffers(GLsizei n, GLuint *buffers); 4.glBindBuffer 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 /** * @brief å°†ä¸€ä¸ªç¼“å†²åŒºå¯¹è±¡ç»‘å®šåˆ°æŒ‡å®šçš„ç¼“å†²åŒºç›®æ ‡ã€‚ * * æ­¤å‡½æ•°å°†ç»™å®šçš„ç¼“å†²åŒºå¯¹è±¡ ID ç»‘å®šåˆ°æŒ‡å®šç›®æ ‡ï¼Œä½¿å…¶æˆä¸ºå½“å‰æ´»è·ƒçš„ç¼“å†²åŒºã€‚ * åç»­å¯¹è¯¥ç›®æ ‡çš„æ“ä½œï¼ˆå¦‚ glBufferDataã€glVertexAttribPointerï¼‰å°†ä½œç”¨äºæ­¤ç»‘å®šå¯¹è±¡ã€‚ * * @param target æŒ‡å®šè¦ç»‘å®šçš„ç¼“å†²åŒºç›®æ ‡ã€‚å¸¸è§ç›®æ ‡åŒ…æ‹¬ï¼š * - GL_ARRAY_BUFFERï¼šé¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼ˆVBOï¼‰ * - GL_ELEMENT_ARRAY_BUFFERï¼šç´¢å¼•ç¼“å†²å¯¹è±¡ï¼ˆEBO/IBOï¼‰ * - GL_UNIFORM_BUFFERï¼šç»Ÿä¸€å˜é‡ç¼“å†²åŒº * - GL_SHADER_STORAGE_BUFFERï¼šç€è‰²å™¨å­˜å‚¨ç¼“å†²åŒº * * @param buffer è¦ç»‘å®šçš„ç¼“å†²åŒºå¯¹è±¡ IDï¼Œç”± glGenBuffers åˆ›å»ºã€‚å¦‚æœä¸º 0ï¼Œåˆ™è§£ç»‘å½“å‰ç›®æ ‡çš„ç¼“å†²åŒºå¯¹è±¡ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - æ¯ä¸ªç¼“å†²åŒºç›®æ ‡åœ¨ä»»ä¸€æ—¶åˆ»åªèƒ½ç»‘å®šä¸€ä¸ªç¼“å†²åŒºå¯¹è±¡ã€‚ * - è°ƒç”¨ glBindBuffer åçš„æ‰€æœ‰ç¼“å†²åŒºæ“ä½œå°†ä½œç”¨äºå½“å‰ç»‘å®šçš„ç›®æ ‡ã€‚ * - VAOï¼ˆé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼‰ä¼šè®°å½•å¯¹ GL_ARRAY_BUFFER å’Œ GL_ELEMENT_ARRAY_BUFFER çš„ç»‘å®šçŠ¶æ€ã€‚ * * @see glGenBuffers, glBufferData, glDeleteBuffers, glBindVertexArray */ void glBindBuffer(GLenum target, GLuint buffer); 5.glGenVertexArrays 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 /** * @brief ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼ˆVAOï¼‰çš„åç§°ï¼ˆIDï¼‰ã€‚ * * é¡¶ç‚¹æ•°ç»„å¯¹è±¡ç”¨äºå°è£…æ‰€æœ‰ä¸é¡¶ç‚¹è¾“å…¥æœ‰å…³çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬é¡¶ç‚¹å±æ€§æŒ‡é’ˆï¼ˆå¦‚ä½ç½®ã€é¢œè‰²ã€æ³•çº¿ç­‰ï¼‰ã€ * é¡¶ç‚¹ç¼“å†²ç»‘å®šå’Œç´¢å¼•ç¼“å†²ç»‘å®šç­‰ã€‚ä½¿ç”¨ VAO å¯ä»¥ç®€åŒ–ç»˜åˆ¶è°ƒç”¨ï¼Œå¹¶æé«˜æ¸²æŸ“æ•ˆç‡ã€‚ * * @param n è¦ç”Ÿæˆçš„ VAO æ•°é‡ã€‚ * @param arrays æŒ‡å‘ GLuint æ•°ç»„çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨ç”Ÿæˆçš„ VAO åç§°ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - ç”Ÿæˆçš„ VAO åç§°æœ¬èº«æ²¡æœ‰åˆ†é…å®é™…èµ„æºï¼Œåªæœ‰åœ¨ç»‘å®šå¹¶é…ç½®æ—¶æ‰çœŸæ­£è®°å½•çŠ¶æ€ã€‚ * - æ¯æ¬¡ç»˜åˆ¶å‰åº”ç»‘å®šå¯¹åº”çš„ VAOã€‚ * - VAO çš„çŠ¶æ€åŒ…æ‹¬ï¼šglVertexAttribPointer è®¾ç½®ã€glEnableVertexAttribArray çŠ¶æ€ã€ç»‘å®šçš„ VBO å’Œ EBOã€‚ * * @see glBindVertexArray, glDeleteVertexArrays, glVertexAttribPointer, glEnableVertexAttribArray */ void glGenVertexArrays(GLsizei n, GLuint *arrays); 6.glBindVertexArray 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /** * @brief ç»‘å®šä¸€ä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼ˆVAOï¼‰ã€‚ * * æ­¤å‡½æ•°å°†æŒ‡å®šçš„é¡¶ç‚¹æ•°ç»„å¯¹è±¡ç»‘å®šä¸ºå½“å‰ä½¿ç”¨çš„ VAOã€‚ç»‘å®šåï¼Œæ‰€æœ‰ä¸é¡¶ç‚¹è¾“å…¥ç›¸å…³çš„çŠ¶æ€è®¾ç½®ï¼ˆå¦‚å±æ€§æŒ‡é’ˆã€å¯ç”¨çŠ¶æ€ã€ç¼“å†²åŒºç»‘å®šç­‰ï¼‰å°†è®°å½•åœ¨æ­¤ VAO ä¸­ã€‚ * * @param array è¦ç»‘å®šçš„ VAO çš„ IDï¼Œç”± glGenVertexArrays ç”Ÿæˆã€‚ä¼ å…¥ 0 è¡¨ç¤ºè§£ç»‘å½“å‰ VAOã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - VAO ä¼šè®°å½•ï¼šglVertexAttribPointer è®¾ç½®ã€glEnableVertexAttribArray çŠ¶æ€ã€å½“å‰ç»‘å®šçš„ GL_ARRAY_BUFFER å’Œ GL_ELEMENT_ARRAY_BUFFERã€‚ * - ç»˜å›¾å‰å¿…é¡»ç»‘å®šæ­£ç¡®çš„ VAOã€‚ * - VAO çŠ¶æ€ä¸ç»‘å®šç¼“å†²åŒºå¯¹è±¡æ˜¯ç»‘å®šåœ¨ä¸€èµ·çš„ï¼Œå¿…é¡»åœ¨ç»‘å®š VAO åè®¾ç½®ç¼“å†²åŒºã€‚ * * @see glGenVertexArrays, glVertexAttribPointer, glEnableVertexAttribArray, glDrawArrays, glDrawElements */ void glBindVertexArray(GLuint array); 7.glBufferData 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * @brief åˆ›å»ºå¹¶åˆå§‹åŒ–ç¼“å†²åŒºå¯¹è±¡çš„æ•°æ®å­˜å‚¨ã€‚ * * æ­¤å‡½æ•°ä¸ºå½“å‰ç»‘å®šçš„ç¼“å†²åŒºå¯¹è±¡ï¼ˆå¦‚ GL_ARRAY_BUFFER æˆ– GL_ELEMENT_ARRAY_BUFFERï¼‰åˆ†é…å†…å­˜ï¼Œå¹¶å¯ä»¥é€‰æ‹©æ€§åœ°åˆå§‹åŒ–æ•°æ®ã€‚å®ƒæ˜¯è®¾ç½®é¡¶ç‚¹æ•°æ®æˆ–ç´¢å¼•æ•°æ®çš„å…³é”®æ­¥éª¤ã€‚ * * @param target æŒ‡å®šè¦æ“ä½œçš„ç¼“å†²åŒºç±»å‹ï¼Œå¸¸ç”¨å€¼æœ‰ GL_ARRAY_BUFFERã€GL_ELEMENT_ARRAY_BUFFERã€GL_UNIFORM_BUFFER ç­‰ã€‚ * @param size åˆ†é…çš„å†…å­˜å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ * @param data æŒ‡å‘è¦å¤åˆ¶åˆ°ç¼“å†²åŒºçš„æ•°æ®æŒ‡é’ˆï¼Œä¼ å…¥ NULL è¡¨ç¤ºåªåˆ†é…å†…å­˜ä¸åˆå§‹åŒ–ã€‚ * @param usage æŒ‡å®šç¼“å†²åŒºçš„é¢„æœŸç”¨é€”æ¨¡å¼ï¼Œä¾‹å¦‚ GL_STATIC_DRAWã€GL_DYNAMIC_DRAWã€GL_STREAM_DRAWã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - æ­¤å‡½æ•°ä¼šä½¿ä¹‹å‰ç¼“å†²åŒºä¸­çš„å†…å®¹å¤±æ•ˆï¼ˆå³ä½¿å¤§å°ä¸å˜ï¼‰ã€‚ * - `usage` å‚æ•°ä¸ä¼šå½±å“æ¸²æŸ“ç»“æœï¼Œä»…ç”¨äºé©±åŠ¨ä¼˜åŒ–å†…å­˜ç®¡ç†ã€‚ * - ä½¿ç”¨å‰åº”ç»‘å®šå¯¹åº”çš„ç¼“å†²åŒºç›®æ ‡ï¼›ç»‘å®šç‚¹ç”± `target` å‚æ•°æŒ‡å®šã€‚ * - è‹¥è¦æ›´æ–°å·²æœ‰ç¼“å†²æ•°æ®çš„å±€éƒ¨å†…å®¹ï¼Œåº”ä½¿ç”¨ glBufferSubDataã€‚ * * @see glGenBuffers, glBindBuffer, glBufferSubData, glDeleteBuffers */ void glBufferData(GLenum target, GLsizeiptr size, const void *data, GLenum usage); äº”ã€ç»˜åˆ¶ 0.ç¤ºä¾‹ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 // ------------------------------------------------------------------ float vertices[] = { 0.5f, 0.5f, 0.0f, // top right 0.5f, -0.5f, 0.0f, // bottom right -0.5f, -0.5f, 0.0f, // bottom left -0.5f, 0.5f, 0.0f // top left }; unsigned int indices[] = { // note that we start from 0! 0, 1, 3, // first Triangle 1, 2, 3 // second Triangle }; unsigned int VBO, VAO, EBO; glGenVertexArrays(1, \u0026amp;VAO); glGenBuffers(1, \u0026amp;VBO); glGenBuffers(1, \u0026amp;EBO); glBindVertexArray(VAO); glBindBuffer(GL_ARRAY_BUFFER, VBO); glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW); glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO); glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW); glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0); glEnableVertexAttribArray(0); glBindBuffer(GL_ARRAY_BUFFER, 0); glBindVertexArray(0); while (!glfwWindowShouldClose(window)) { processInput(window); glClearColor(0.2f, 0.3f, 0.3f, 1.0f); glClear(GL_COLOR_BUFFER_BIT); // draw our first triangle glUseProgram(shaderProgram); glBindVertexArray(VAO); glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0); glfwSwapBuffers(window); glfwPollEvents(); } 1.glDrawElements 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 /** * @brief ä½¿ç”¨ç´¢å¼•æ•°ç»„æ¸²æŸ“å›¾å…ƒï¼ˆåŸºäºç´¢å¼•çš„ç»˜åˆ¶ï¼‰ã€‚ * * glDrawElements æ ¹æ®å½“å‰ç»‘å®šçš„é¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼ˆVAOï¼‰å’Œç´¢å¼•ç¼“å†²å¯¹è±¡ï¼ˆEBOï¼‰ä¸­çš„ç´¢å¼•ï¼Œ * ä»å·²ç»‘å®šçš„é¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼ˆVBOï¼‰ä¸­è¯»å–é¡¶ç‚¹æ•°æ®ï¼Œå¹¶æŒ‰æŒ‡å®šçš„ç»˜åˆ¶æ¨¡å¼æ¸²æŸ“å›¾å…ƒã€‚ * * @param mode æŒ‡å®šè¦æ¸²æŸ“çš„å›¾å…ƒç±»å‹ã€‚å¯é€‰å€¼åŒ…æ‹¬ï¼š * - GL_POINTS * - GL_LINE_STRIP, GL_LINE_LOOP, GL_LINES * - GL_TRIANGLE_STRIP, GL_TRIANGLE_FAN, GL_TRIANGLES * - ä»¥åŠå…¶ä»–ä» OpenGL æ‰©å±•ä¸­æ”¯æŒçš„æ¨¡å¼ã€‚ * @param count æŒ‡å®šå°†è¦æ¸²æŸ“çš„ç´¢å¼•æ•°é‡ï¼ˆå…ƒç´ æ•°é‡ï¼‰ï¼Œå³ç´¢å¼•æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚ * @param type æŒ‡å®šç´¢å¼•æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„æ•°æ®ç±»å‹ã€‚å¯é€‰å€¼ä¸ºï¼š * - GL_UNSIGNED_BYTE * - GL_UNSIGNED_SHORT * - GL_UNSIGNED_INT * ï¼ˆæ³¨æ„ï¼šéƒ¨åˆ†æ—§ç‰ˆç¡¬ä»¶å¯èƒ½ä¸æ”¯æŒ 32 ä½æ— ç¬¦å·æ•´å‹ç´¢å¼•ï¼‰ * @param indices æŒ‡å®šç´¢å¼•æ•°æ®çš„åç§»é‡æˆ–æŒ‡é’ˆï¼š * - å½“å·²ç»‘å®š GL_ELEMENT_ARRAY_BUFFERï¼ˆEBOï¼‰æ—¶ï¼Œæ­¤å‚æ•°è¢«è§†ä¸ºå­—èŠ‚åç§»é‡ï¼ˆconst void* offsetï¼‰ã€‚ * - è‹¥æœªç»‘å®š EBOï¼Œåˆ™æ­¤å‚æ•°ä¸ºæŒ‡å‘å®¢æˆ·ç«¯å†…å­˜ä¸­ç´¢å¼•æ•°ç»„çš„æŒ‡é’ˆï¼ˆå·²åºŸå¼ƒï¼Œç°ä»£ OpenGL å»ºè®®ä½¿ç”¨ EBOï¼‰ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - æ¸²æŸ“å‰å¿…é¡»ç»‘å®šç›¸åº”çš„ VAOï¼Œå¹¶ç¡®ä¿è¯¥ VAO å·²è®°å½•äº†æ­£ç¡®çš„é¡¶ç‚¹å±æ€§å’Œ EBO ç»‘å®šçŠ¶æ€ã€‚ * - ç´¢å¼•è¯»å–çš„ä½ç½®åŸºäºå½“å‰ç»‘å®šçš„ GL_ELEMENT_ARRAY_BUFFER å¯¹è±¡ï¼Œå¹¶å— type å‚æ•°æŒ‡å®šçš„å­—èŠ‚å¤§å°å½±å“ã€‚ * - å¦‚æœ indices ä¸ºéé›¶æŒ‡é’ˆä¸”æœªç»‘å®š EBOï¼Œåˆ™ç´¢å¼•æ•°æ®ä¼šä»å®¢æˆ·ç«¯å†…å­˜è¯»å–ï¼Œä½†æ­¤ç”¨æ³•åœ¨æ ¸å¿ƒæ¨¡å¼ä¸‹å·²ä¸æ¨èã€‚ * - glDrawElements æ˜¯ä¸€æ¬¡æ€§ç»˜åˆ¶ï¼Œè‹¥éœ€å¤šå®ä¾‹ç»˜åˆ¶ï¼Œè¯·ä½¿ç”¨ glDrawElementsInstancedã€‚ * - ç»˜åˆ¶å®Œæˆåï¼ŒOpenGL ä¼šæ ¹æ®å½“å‰ä¸Šä¸‹æ–‡çŠ¶æ€ï¼ˆå‰”é™¤ã€æ·±åº¦æµ‹è¯•ã€æ··åˆç­‰ï¼‰å¯¹å›¾å…ƒè¿›è¡Œå¤„ç†ã€‚ * * @see glDrawArrays, glDrawElementsInstanced, glBindBuffer, glBindVertexArray */ void glDrawElements(GLenum mode,GLsizei count,GLenum type,const void *indices); 2. glUniform1f è®¾ç½®å•ä¸ªæµ®ç‚¹æ•° uniform å˜é‡çš„å€¼ã€‚\n3. glUniform3f è®¾ç½®ä¸‰ä¸ªæµ®ç‚¹æ•° uniform å˜é‡çš„å€¼ã€‚\n4. glUniform3fv è®¾ç½®æµ®ç‚¹æ•°å‘é‡ uniform å˜é‡çš„å€¼ã€‚\nå…­ã€çº¹ç† è´´å›¾çš„UVåæ ‡å¦‚ä¸‹åˆ†å¸ƒï¼š\n0.ä»£ç ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 //åˆ›å»ºå’Œç»‘å®š mData = stbi_load(path, \u0026amp;mWidth, \u0026amp;mHeight, \u0026amp;mChannels, 0); //åˆ©ç”¨stb_imageè¯»å–å›¾ç‰‡ glGenTextures(1, \u0026amp;mTextureID); glBindTexture(GL_TEXTURE_2D, mTextureID); //è®¾ç½®ç¯ç»•æ–¹å¼ glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, mSurroundMode); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, mSurroundMode); //è®¾ç½®æ»¤æ³¢æ–¹å¼ï¼ˆé‡‡æ ·ï¼‰ glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, mFilterMode); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, mFilterMode); //ç»‘å®šåŸå§‹æ•°æ® switch (mChannels) { default: case 3: glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, mWidth, mHeight, 0, GL_RGB, GL_UNSIGNED_BYTE, mData); break; case 4: glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, mWidth, mHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, mData); break; } //ç”Ÿæˆmipmap glGenerateMipmap(GL_TEXTURE_2D); //ä½¿ç”¨ glUniform1i(\u0026#34;uTexture\u0026#34;,0);//éœ€è¦å…ˆè®¾ç½®è´´å›¾é€šé“ glActiveTexture(GL_TEXTURE0 + i); glBindTexture(GL_TEXTURE_2D, mTextureID); glBindVertexArray(mVAO); glDrawElements(GL_TRIANGLES, mMeshBatch.indexs.size(), GL_UNSIGNED_INT, 0); 1. glTexParameteri image-20250716134350990.png\nimage-20250716133617973\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 /** * @brief è®¾ç½®çº¹ç†å¯¹è±¡çš„å‚æ•°å±æ€§ï¼ˆå¦‚è¿‡æ»¤æ–¹å¼å’Œç¯ç»•æ¨¡å¼ï¼‰ã€‚ * * glTexParameteri ç”¨äºä¸ºå½“å‰ç»‘å®šçš„çº¹ç†å¯¹è±¡æŒ‡å®šç‰¹å®šçš„è¡Œä¸ºå‚æ•°ï¼Œå¸¸ç”¨äºå®šä¹‰çº¹ç†åœ¨ç¼©æ”¾ã€ * ç¯ç»•ç­‰æƒ…å†µä¸‹çš„è¡¨ç°æ–¹å¼ã€‚è¯¥å‡½æ•°åªé€‚ç”¨äºç»‘å®šåˆ°å½“å‰æ¿€æ´»çº¹ç†ç›®æ ‡çš„çº¹ç†å¯¹è±¡ã€‚ * * @param target æŒ‡å®šçº¹ç†ç›®æ ‡ç±»å‹ã€‚å¯é€‰å€¼åŒ…æ‹¬ï¼š * - GL_TEXTURE_1D * - GL_TEXTURE_2D * - GL_TEXTURE_3D * - GL_TEXTURE_CUBE_MAP * - ä»¥åŠå…¶ä»– OpenGL æ‰©å±•æ”¯æŒçš„ç›®æ ‡ã€‚ * * @param pname æŒ‡å®šè¦è®¾ç½®çš„çº¹ç†å‚æ•°åã€‚å¸¸ç”¨å€¼åŒ…æ‹¬ï¼š * - GL_TEXTURE_MIN_FILTERï¼šçº¹ç†ç¼©å°æ—¶çš„è¿‡æ»¤æ–¹å¼ * - GL_TEXTURE_MAG_FILTERï¼šçº¹ç†æ”¾å¤§æ—¶çš„è¿‡æ»¤æ–¹å¼ * - GL_TEXTURE_WRAP_Sï¼šçº¹ç†åœ¨ Sï¼ˆUï¼‰è½´çš„ç¯ç»•æ¨¡å¼ * - GL_TEXTURE_WRAP_Tï¼šçº¹ç†åœ¨ Tï¼ˆVï¼‰è½´çš„ç¯ç»•æ¨¡å¼ * - GL_TEXTURE_WRAP_Rï¼šçº¹ç†åœ¨ Rï¼ˆWï¼‰è½´çš„ç¯ç»•æ¨¡å¼ï¼ˆä»…é€‚ç”¨äº 3D/ç«‹æ–¹ä½“è´´å›¾ï¼‰ * * @param param æŒ‡å®š pname æ‰€å¯¹åº”çš„å‚æ•°å€¼ã€‚å–å€¼ä¾èµ–äº pname çš„ç±»å‹ï¼š * - è¿‡æ»¤æ–¹å¼å¸¸ç”¨å€¼ï¼š * - GL_NEARESTï¼šæœ€è¿‘ç‚¹é‡‡æ · * - GL_LINEARï¼šçº¿æ€§æ’å€¼é‡‡æ · * - GL_NEAREST_MIPMAP_NEAREST / GL_LINEAR_MIPMAP_LINEAR ç­‰ï¼ˆç”¨äº mipmapï¼‰ * - ç¯ç»•æ¨¡å¼å¸¸ç”¨å€¼ï¼š * - GL_REPEATï¼šé‡å¤çº¹ç† * - GL_CLAMP_TO_EDGEï¼šè¾¹ç¼˜é’³åˆ¶ * - GL_MIRRORED_REPEATï¼šé•œåƒé‡å¤ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - glTexParameteri å¿…é¡»åœ¨ç»‘å®šäº†ç›¸åº”çº¹ç†ï¼ˆé€šè¿‡ glBindTextureï¼‰ä¹‹åè°ƒç”¨ï¼Œå¦åˆ™æ— æ•ˆã€‚ * - å¯¹äº mipmap è¿‡æ»¤æ–¹å¼ï¼Œéœ€è¦ä½¿ç”¨ glGenerateMipmap æˆ–æ‰‹åŠ¨æŒ‡å®šæ¯çº§ mipmap å±‚ã€‚ * - è‹¥æœªè®¾ç½®åˆé€‚çš„è¿‡æ»¤å’Œç¯ç»•æ¨¡å¼ï¼Œå¯èƒ½ä¼šå¯¼è‡´çº¹ç†æ˜¾ç¤ºå¼‚å¸¸æˆ–æ€§èƒ½ä¸‹é™ã€‚ * - çº¹ç†å‚æ•°æ˜¯çº¹ç†å¯¹è±¡çŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œä¸€æ—¦è®¾ç½®ä¾¿ä¼šè¢«è¯¥çº¹ç†ä¸€ç›´ä½¿ç”¨ï¼Œé™¤éå†æ¬¡ä¿®æ”¹ã€‚ * * @see glTexParameterf, glBindTexture, glTexImage2D, glGenerateMipmap */ void glTexParameteri(GLenum target, GLenum pname, GLint param); 2.glTexParameterfv 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 /** * @brief è®¾ç½®çº¹ç†å¯¹è±¡çš„å‚æ•°å±æ€§ï¼ˆä»¥æµ®ç‚¹æ•°ç»„å½¢å¼ä¼ å…¥ï¼‰ã€‚ * * glTexParameterfv ç”¨äºä¸ºå½“å‰ç»‘å®šçš„çº¹ç†å¯¹è±¡æŒ‡å®šæŸä¸ªçº¹ç†å‚æ•°ï¼Œå…¶å€¼é€šè¿‡ä¸€ä¸ªæµ®ç‚¹æ•°ç»„ä¼ å…¥ã€‚ * é€‚ç”¨äºå‚æ•°å€¼ä¸ºæµ®ç‚¹å‘é‡ç±»å‹çš„çº¹ç†å±æ€§ï¼ˆå¦‚è¾¹ç•Œé¢œè‰²ç­‰ï¼‰ã€‚ * * @param target æŒ‡å®šçº¹ç†ç›®æ ‡ç±»å‹ã€‚å¯é€‰å€¼åŒ…æ‹¬ï¼š * - GL_TEXTURE_1D * - GL_TEXTURE_2D * - GL_TEXTURE_3D * - GL_TEXTURE_CUBE_MAP * - ä»¥åŠå…¶ä»– OpenGL æ‰©å±•æ”¯æŒçš„ç›®æ ‡ã€‚ * * @param pname æŒ‡å®šè¦è®¾ç½®çš„çº¹ç†å‚æ•°åã€‚å¸¸ç”¨å€¼åŒ…æ‹¬ï¼š * - GL_TEXTURE_BORDER_COLORï¼šçº¹ç†è¾¹ç•Œé¢œè‰²ï¼ˆéœ€ä¼ å…¥4ä¸ªfloatï¼‰ * - å…¶ä»–æ¥å—æµ®ç‚¹æ•°ç»„ä½œä¸ºå‚æ•°çš„æ‰©å±•å‚æ•° * * @param params æŒ‡å‘æµ®ç‚¹å€¼æ•°ç»„çš„æŒ‡é’ˆï¼Œå…¶å†…å®¹ä¾èµ–äº pname çš„è¦æ±‚ï¼š * - è‹¥ pname ä¸º GL_TEXTURE_BORDER_COLORï¼Œåˆ™åº”æä¾› 4 ä¸ªå…ƒç´ çš„ RGBA æ•°ç»„ï¼ˆä¾‹å¦‚ï¼š{1.0f, 1.0f, 1.0f, 1.0f}ï¼‰ã€‚ * - å…¶ä»– pname å¯æ ¹æ®å…·ä½“ OpenGL æ‰©å±•éœ€æ±‚è®¾ç½®å¯¹åº”æ•°é‡çš„ floatã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - glTexParameterfv ä¸ glTexParameteri ç”¨æ³•ç±»ä¼¼ï¼Œä½†å‚æ•°ç±»å‹ä¸ºæµ®ç‚¹æ•°ç»„ã€‚ * - åœ¨è®¾ç½® GL_TEXTURE_BORDER_COLOR æ—¶ï¼Œçº¹ç†ç¯ç»•æ¨¡å¼éœ€é…åˆ GL_CLAMP_TO_BORDER ä½¿ç”¨æ‰èƒ½ç”Ÿæ•ˆã€‚ * - è¯·ç¡®ä¿å·²æ­£ç¡®ç»‘å®šçº¹ç†å¯¹è±¡ï¼Œå¦åˆ™è°ƒç”¨å°†ä¸ä¼šäº§ç”Ÿæ•ˆæœã€‚ * - ä¸æ”¯æŒçš„ pname å€¼å¯èƒ½åœ¨ä¸åŒç¡¬ä»¶æˆ– OpenGL ç‰ˆæœ¬ä¸‹å¯¼è‡´è¡Œä¸ºæœªå®šä¹‰ã€‚ * * @see glTexParameteri, glTexParameterf, glBindTexture, glTexImage2D, glTexParameteriv */ void glTexParameterfv(GLenum target, GLenum pname, const GLfloat *params); 3.glGenTextures 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 /** * @brief ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªæ–°çš„çº¹ç†å¯¹è±¡åç§°ã€‚ * * glGenTextures ç”¨äºè¯·æ±‚ OpenGL åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªå”¯ä¸€çš„çº¹ç†å¯¹è±¡ IDï¼ˆåç§°ï¼‰ï¼Œè¿™äº›çº¹ç†å¯¹è±¡ * å¯é€šè¿‡ glBindTexture ç»‘å®šå¹¶è¿›ä¸€æ­¥é…ç½®ã€‚ç”Ÿæˆçš„çº¹ç†å¯¹è±¡å°šæœªåˆå§‹åŒ–ï¼Œéœ€é€šè¿‡ç»‘å®šåä½¿ç”¨ã€‚ * * @param n æŒ‡å®šè¦ç”Ÿæˆçš„çº¹ç†å¯¹è±¡åç§°æ•°é‡ï¼ˆå³çº¹ç†æ•°é‡ï¼‰ã€‚ * @param textures æŒ‡å‘ GLuint ç±»å‹æ•°ç»„çš„æŒ‡é’ˆï¼Œç”¨äºæ¥æ”¶ç”Ÿæˆçš„çº¹ç†åç§°ï¼ˆIDï¼‰ã€‚ * - è¯¥æ•°ç»„çš„å¤§å°åº”è‡³å°‘ä¸º nã€‚ * - å¾—åˆ°çš„çº¹ç† ID å¯é€šè¿‡ glBindTexture ç»‘å®šè‡³æŒ‡å®šçº¹ç†ç›®æ ‡ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - ç”Ÿæˆçš„çº¹ç†å¯¹è±¡åç§°åœ¨é¦–æ¬¡ç»‘å®šå‰æ˜¯â€œæœªåˆå§‹åŒ–çŠ¶æ€â€ï¼ŒOpenGL ä¸ä¼šè‡ªåŠ¨åˆ†é…å­˜å‚¨æˆ–å±æ€§ã€‚ * - è°ƒç”¨ glGenTextures åªç”Ÿæˆåç§°ï¼Œä¸ä¼šåšä»»ä½•èµ„æºåˆ†é…ï¼Œèµ„æºåˆ†é…å°†åœ¨ glTexImage* å‘ç”Ÿã€‚ * - å¯ä»¥é€šè¿‡ glDeleteTextures åˆ é™¤ä¸å†ä½¿ç”¨çš„çº¹ç†å¯¹è±¡ï¼Œé‡Šæ”¾èµ„æºã€‚ * - ä¸åº”åœ¨æœªåˆå§‹åŒ–çš„çº¹ç†å¯¹è±¡ä¸Šè°ƒç”¨æ¸²æŸ“æ“ä½œï¼Œå¦åˆ™ç»“æœæœªå®šä¹‰ã€‚ * * @see glBindTexture, glDeleteTextures, glTexImage2D, glTexParameteri */ void glGenTextures(GLsizei n, GLuint *textures); 4.glTexImage2D 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 /** * @brief ä¸ºå½“å‰ç»‘å®šçš„äºŒç»´çº¹ç†å¯¹è±¡æŒ‡å®šäºŒç»´åƒç´ å›¾åƒæ•°æ®ã€‚ * * glTexImage2D ç”¨äºå‘å½“å‰ç»‘å®šåˆ° target çš„äºŒç»´çº¹ç†å¯¹è±¡ä¸Šä¼ å›¾åƒæ•°æ®ï¼Œ * å¹¶ä¸ºè¯¥çº¹ç†åˆ†é…å­˜å‚¨ç©ºé—´ã€‚å¯ç”¨äºåˆå§‹åŒ–çº¹ç†æˆ–æ›¿æ¢æŒ‡å®š mipmap çº§åˆ«çš„æ•°æ®ã€‚ * * @param target æŒ‡å®šçº¹ç†ç›®æ ‡ç±»å‹ã€‚å¸¸ç”¨å€¼ï¼š * - GL_TEXTURE_2D * - GL_PROXY_TEXTURE_2Dï¼ˆä»…ç”¨äºæŸ¥è¯¢çº¹ç†è§„æ ¼ï¼Œä¸åˆ†é…å†…å­˜ï¼‰ * - GL_TEXTURE_CUBE_MAP_POSITIVE_X ç­‰ç«‹æ–¹ä½“è´´å›¾é¢ï¼ˆè‹¥ç”¨äºŒç»´è°ƒç”¨ï¼‰ * @param level æŒ‡å®š mipmap çº§åˆ«ã€‚0 ä¸ºåŸºå‡†çº§ï¼ˆæœ€é«˜åˆ†è¾¨ç‡ï¼‰ï¼Œn ä¸ºç¬¬ n çº§ mipmapã€‚ * @param internalFormat æŒ‡å®šçº¹ç†åœ¨ GPU ä¸­çš„å†…éƒ¨å­˜å‚¨æ ¼å¼ï¼Œä¾‹å¦‚ï¼š * - GL_RGB, GL_RGBA * - GL_R8, GL_RG16F * - GL_DEPTH_COMPONENT24 ç­‰ * @param width æŒ‡å®šçº¹ç†å›¾åƒçš„å®½åº¦ï¼ˆåƒç´ æ•°ï¼‰ï¼Œå¿…é¡»ä¸ºæ­£æ•´æ•°ã€‚ * @param height æŒ‡å®šçº¹ç†å›¾åƒçš„é«˜åº¦ï¼ˆåƒç´ æ•°ï¼‰ï¼Œå¯¹äºä¸€ç»´çº¹ç†åº”ä¸º 1ã€‚ * @param border æŒ‡å®šè¾¹æ¡†å®½åº¦ï¼Œå¿…é¡»ä¸º 0ï¼ˆæ ¸å¿ƒæ¨¡å¼ä¸æ”¯æŒéé›¶è¾¹æ¡†ï¼‰ã€‚ * @param format æŒ‡å®šåƒç´ æ•°æ®çš„å¸ƒå±€æ ¼å¼ï¼Œä¾‹å¦‚ï¼š * - GL_RGB, GL_RGBA, GL_RED, GL_DEPTH_COMPONENT ç­‰ * @param type æŒ‡å®šåƒç´ æ•°æ®çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š * - GL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_FLOAT ç­‰ * ï¼ˆå–å†³äº format æ”¯æŒçš„æ•°æ®ç±»å‹ï¼‰ * @param data æŒ‡å‘å®¢æˆ·ç«¯å†…å­˜ä¸­å›¾åƒæ•°æ®çš„æŒ‡é’ˆï¼›è‹¥ä¸º NULLï¼Œåˆ™åªåˆ†é…å­˜å‚¨ï¼Œä¸ä¸Šä¼ æ•°æ®ã€‚ * * @return æ— è¿”å›å€¼ã€‚ * * @note * - è°ƒç”¨å‰å¿…é¡»å·²ç»‘å®šçº¹ç†å¯¹è±¡ï¼šglBindTexture(target, texID)ã€‚ * - internalFormat ä¸ format/type ç»„åˆå¿…é¡»å—ç¡¬ä»¶æ”¯æŒï¼Œå¦åˆ™å¯èƒ½äº§ç”Ÿé”™è¯¯æˆ–é™çº§è¡Œä¸ºã€‚ * - è‹¥éœ€è¦åˆ›å»ºå®Œæ•´ mipmap çº§åˆ«ï¼Œå¯å¤šæ¬¡è°ƒç”¨ glTexImage2D ä¸Šä¼ æ¯ä¸ª levelï¼Œæˆ–åœ¨ä¸Šä¼ åŸºå‡†çº§åè°ƒç”¨ glGenerateMipmapã€‚ * - GL_PROXY_TEXTURE_2D å¯ç”¨äºæµ‹è¯•æŒ‡å®šæ ¼å¼/å°ºå¯¸æ˜¯å¦è¢«æ”¯æŒï¼ŒæŸ¥è¯¢åä¸åˆ†é…å®é™…å­˜å‚¨ã€‚ * - å¯¹äºå­åŒºåŸŸæ›´æ–°ï¼Œå¯æ”¹ç”¨ glTexSubImage2D ä»¥é¿å…é‡åˆ†é…å­˜å‚¨ã€‚ * * @see glBindTexture, glTexSubImage2D, glGenerateMipmap, glTexImage3D */ void glTexImage2D(GLenum target, GLint level, GLint internalFormat, GLsizei width, GLsizei height, GLint border, GLenum format, GLenum type, const void *data); å›¾å½¢å­¦ç›¸å…³ ä¸€ã€åæ ‡ç©ºé—´ 0ã€GLMçš„å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // 1ã€çŸ¢é‡å’ŒçŸ©é˜µçš„åˆå§‹åŒ– glm::vec4 vec(1.0f, 0.0f, 0.0f, 1.0f); glm::mat4x4 MView = glm::mat4(1.0f); // 2ã€å˜æ¢çŸ©é˜µ // å¹³ç§» Mtrans = glm::translate(Mtrans, glm::vec3(1.0f, 1.0f, 0.0f)); // ç¼©æ”¾ MScale = glm::scale(MScale, glm::vec3(1.0f, 1.5f, 1.0f)); // æ—‹è½¬ï¼ˆæ¬§æ‹‰è§’ï¼‰ MRot = glm::rotate(MRot, glm::radians(90.0f), glm::vec3(0.0f, 0.0f, 1.0f)); // è½¬ç½® MTranspose = glm::transpose(Mx); // 3ã€æ¨¡å‹çŸ©é˜µ MModel = MTran * MRota; // è¡¨ç¤ºåœ¨æœ¬åœ°åæ ‡ç³»ä¸‹ï¼Œæ¨¡å‹è‡ªèº«çš„å˜æ¢ // 4ã€è§‚å¯ŸçŸ©é˜µ MView = MrT * M-t; // è¡¨ç¤ºæ‘„åƒæœºçš„å˜æ¢ï¼Œå¹¶å°†å…¶åå˜æ¢ä½œç”¨åœ¨æ¨¡å‹ä¸Š // 5ã€æŠ•å½±é€è§†çŸ©é˜µ Mpersp = glm::perspective(glm::radians(45.0f), 1.0f, 0.1f, 100.0f); // æŠ•å½±ç›’å­+é€è§† // 6ã€æ€»çŸ©é˜µ M = Mpersp * MView * MModel; 1ã€ç®€ä»‹ å°†åæ ‡å˜æ¢ä¸ºæ ‡å‡†åŒ–è®¾å¤‡åæ ‡ï¼Œæ¥ç€å†è½¬åŒ–ä¸ºå±å¹•åæ ‡çš„è¿‡ç¨‹é€šå¸¸æ˜¯åˆ†æ­¥è¿›è¡Œçš„ã€‚åœ¨æµæ°´çº¿ä¸­ï¼Œç‰©ä½“çš„é¡¶ç‚¹åœ¨æœ€ç»ˆè½¬åŒ–ä¸ºå±å¹•åæ ‡ä¹‹å‰è¿˜ä¼šè¢«å˜æ¢åˆ°å¤šä¸ªåæ ‡ç³»ç»Ÿ(Coordinate System)ã€‚å°†ç‰©ä½“çš„åæ ‡å˜æ¢åˆ°å‡ ä¸ªè¿‡æ¸¡åæ ‡ç³»(Intermediate Coordinate System)çš„ä¼˜ç‚¹åœ¨äºï¼Œåœ¨è¿™äº›ç‰¹å®šçš„åæ ‡ç³»ç»Ÿä¸­ï¼Œä¸€äº›æ“ä½œæˆ–è¿ç®—æ›´åŠ æ–¹ä¾¿å’Œå®¹æ˜“ï¼Œè¿™ä¸€ç‚¹å¾ˆå¿«å°±ä¼šå˜å¾—å¾ˆæ˜æ˜¾ã€‚å¯¹æˆ‘ä»¬æ¥è¯´æ¯”è¾ƒé‡è¦çš„æ€»å…±æœ‰5ä¸ªä¸åŒçš„åæ ‡ç³»ç»Ÿï¼š\nå±€éƒ¨ç©ºé—´(Local Spaceï¼Œæˆ–è€…ç§°ä¸ºç‰©ä½“ç©ºé—´(Object Space)) ä¸–ç•Œç©ºé—´(World Space) è§‚å¯Ÿç©ºé—´(View Spaceï¼Œæˆ–è€…ç§°ä¸ºè§†è§‰ç©ºé—´(Eye Space)) è£å‰ªç©ºé—´(Clip Space) å±å¹•ç©ºé—´(Screen Space) coordinate_systems.png\næ¨¡å‹(Model)ã€è§‚å¯Ÿ(View)ã€æŠ•å½±(Projection)ä¸‰ä¸ªçŸ©é˜µ $$ M_{Total}=M_{Projection}*M_{View}*M_{Model} $$2ã€å±€éƒ¨ç©ºé—´ï¼ˆæ¨¡å‹çŸ©é˜µï¼‰ å¹³ç§»çŸ©é˜µï¼š$T_{t_x,t_y}=\\left( \\begin{matrix} 1 \u0026amp; 0 \u0026amp; 0 \u0026amp; t_x \\ 0 \u0026amp; 1 \u0026amp; 0\u0026amp; t_y \\ 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; t_z \\ 0\u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\end{matrix} \\right) \\tag{3}$\næ—‹è½¬çŸ©é˜µï¼š\nç»•$\\hat z$æ–¹å‘é€†æ—¶é’ˆæ—‹è½¬çŸ©é˜µ:$R_{\\theta}=\\left( \\begin{matrix} \\cos \\theta \u0026amp; -\\sin \\theta \u0026amp; 0 \u0026amp; 0 \\ \\sin \\theta \u0026amp; \\cos \\theta \u0026amp; 0 \u0026amp; 0 \\ 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; 0 \\ 0 \u0026amp; 0\u0026amp;0\u0026amp;1 \\end{matrix} \\right) \\tag{4}$\nç»•$\\hat x$æ–¹å‘é€†æ—¶é’ˆæ—‹è½¬çŸ©é˜µ:$R_{\\theta}=\\left( \\begin{matrix} 1 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\ 0 \u0026amp; \\cos \\theta \u0026amp; \\sin \\theta \u0026amp; 0 \\ 0 \u0026amp; -\\sin \\theta \u0026amp; \\cos \\theta \u0026amp; 0 \\ 0 \u0026amp; 0\u0026amp;0\u0026amp;1 \\end{matrix} \\right) \\tag{4}$\nç»•$\\hat y$æ–¹å‘é€†æ—¶é’ˆæ—‹è½¬çŸ©é˜µ:$R_{\\theta}=\\left( \\begin{matrix} \\cos \\theta \u0026amp; 0 \u0026amp; \\sin \\theta \u0026amp; 0 \\ 0 \u0026amp; 1 \u0026amp; 0 \u0026amp; 0 \\ -\\sin \\theta \u0026amp; 0 \u0026amp; \\cos \\theta \u0026amp; 0 \\ 0 \u0026amp; 0\u0026amp;0\u0026amp;1 \\end{matrix} \\right) \\tag{4}$\nå¯¹äºæ—‹è½¬çŸ©é˜µRï¼Œæœ‰ä»¥ä¸‹æ€§è´¨$R^{-1}\\theta =R{-\\theta}=R_\\theta ^T$\nç¼©æ”¾çŸ©é˜µï¼š$S_{s_x,s_y}=\\left( \\begin{matrix} s_x \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\ 0 \u0026amp; s_y \u0026amp; 0 \u0026amp; 0 \\ 0 \u0026amp; 0 \u0026amp; s_z \u0026amp; 0\\ 0 \u0026amp;0 \u0026amp;0 \u0026amp;1 \\end{matrix} \\right) \\tag{3}$\nåˆ‡å˜ï¼š$S_{s_x,s_y}=\\left( \\begin{matrix} 1 \u0026amp; 1 \u0026amp; 0 \u0026amp; 0 \\ 0 \u0026amp; 1 \u0026amp; 0 \u0026amp; 0 \\ 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; 0 \\ 0 \u0026amp;0\u0026amp;0\u0026amp;1 \\end{matrix} \\right) $\næ¨¡å‹çŸ©é˜µä¸€èˆ¬ç”±å¹³ç§»çŸ©é˜µã€ç¼©æ”¾çŸ©é˜µã€æ—‹è½¬çŸ©é˜µç›¸ä¹˜å¾—åˆ°ã€‚\n$$ M_{model}=M_{transform}*M_{Scale}*M_{rotarion} $$ 1 2 3 4 5 6 7 8 glm::vec4 vec(1.0f, 0.0f, 0.0f, 1.0f); glm::mat4x4 Mtrans = glm::mat4(1.0f); glm::mat4x4 MProject = glm::perspective(glm::radians(90.0f), 1.0f, 0.1f, 100.0f); // æŠ•å½±çŸ©é˜µ glm::mat4x4 Mtrans = glm::translate(Mtrans, glm::vec3(0.0f, 0.0f, -3.0f)); // ç”Ÿæˆå¹³ç§»çŸ©é˜µ glm::mat4x4 MScale = glm::scale(MScale, glm::vec3(1.0f, 1.0f, 1.0f)); // ç”Ÿæˆç¼©æ”¾çŸ©é˜µ glm::mat4x4 MRot = glm::rotate(MRot, glm::radians(90.0f), glm::vec3(0.0f, 0.0f, 1.0f)); // ç”Ÿæˆæ—‹è½¬çŸ©é˜µ 3ã€æ‘„åƒæœºï¼ˆè§†å£çŸ©é˜µï¼‰ image-20250717171129515.png\nï¼ˆ1ï¼‰æ‘„åƒæœºä½ç½® 1 glm::vec3 cameraPos = glm::vec3(0.0f, 0.0f, 3.0f); ï¼ˆ2ï¼‰æ‘„åƒæœºæ–¹å‘ 1 2 glm::vec3 cameraTarget = glm::vec3(0.0f, 0.0f, 0.0f); glm::vec3 cameraDirection = glm::normalize(cameraPos - cameraTarget); ï¼ˆ3ï¼‰æ‘„åƒæœºçš„å³è½´å’Œä¸Šè½´ 1 2 3 glm::vec3 up = glm::vec3(0.0f, 1.0f, 0.0f); glm::vec3 cameraRight = glm::normalize(glm::cross(up, cameraDirection)); glm::vec3 cameraUp = glm::cross(cameraDirection, cameraRight); ï¼ˆ4ï¼‰LookAtçŸ©é˜µ â€‹\tä½¿ç”¨çŸ©é˜µçš„å¥½å¤„ä¹‹ä¸€æ˜¯å¦‚æœä½ ä½¿ç”¨3ä¸ªç›¸äº’å‚ç›´ï¼ˆæˆ–éçº¿æ€§ï¼‰çš„è½´å®šä¹‰äº†ä¸€ä¸ªåæ ‡ç©ºé—´ï¼Œä½ å¯ä»¥ç”¨è¿™3ä¸ªè½´å¤–åŠ ä¸€ä¸ªå¹³ç§»å‘é‡æ¥åˆ›å»ºä¸€ä¸ªçŸ©é˜µï¼Œå¹¶ä¸”ä½ å¯ä»¥ç”¨è¿™ä¸ªçŸ©é˜µä¹˜ä»¥ä»»ä½•å‘é‡æ¥å°†å…¶å˜æ¢åˆ°é‚£ä¸ªåæ ‡ç©ºé—´ã€‚\nâ€‹\tglm::LookAtå‡½æ•°éœ€è¦ä¸€ä¸ªä½ç½®ã€ç›®æ ‡å’Œä¸Šå‘é‡ã€‚å®ƒä¼šåˆ›å»ºä¸€ä¸ªå’Œåœ¨ä¸Šä¸€èŠ‚ä½¿ç”¨çš„ä¸€æ ·çš„è§‚å¯ŸçŸ©é˜µã€‚\nimage-20241126162019735.png\n1 2 glm::mat4 view; view = glm::lookAt(cameraPos, cameraTarget,up); äºŒã€å…‰ç…§ 1ã€å¸ƒæ—æ©-å†¯æ¨¡å‹ ç¯å¢ƒå…‰: vec3 ambient = ambientStrength * lightColor * objectColor;\nç¯å¢ƒå…‰å› å­ä¸€èˆ¬ç”±ä¸€ä¸ªè¾ƒå°çš„å› å­ä¹˜ä¸Šå…‰ç…§é¢œè‰²å¾—åˆ°ã€‚å†ç”±ç¯å¢ƒå…‰å› å­ä¸ç‰©ä½“é¢œè‰²ç›¸ä¹˜ï¼Œå°±å¯ä»¥å¾—åˆ°ç¯å¢ƒå…‰ç…§å¯¹ç‰©ä½“çš„ä½œç”¨ç»“æœã€‚ æ¼«åå°„ï¼švec3 diffuse = max(dot(norm, lightDir), 0.0)* lightColor * objectColor;\næ¼«åå°„ååº”çš„æ˜¯å…‰åœ¨è¯¥å¹³é¢ä¸Šçš„å…‰é€šé‡å¼ºåº¦ï¼Œå½“å…¥å°„è¿›è¯¥å¹³é¢çš„å…‰è¶Šå¤šï¼Œæ¼«åå°„å°±è¶Šå¼ºã€‚ image-20250922094541562.png é•œé¢åå°„ï¼š vec3 specular = specularStrength * pow(max(dot(viewDir, reflectDir), 0.0), 32) * lightColor * objectColor;å…¶ä¸­ï¼švec3 reflectDir = reflect(-lightDir, norm);\né•œé¢åå°„å¼ºåº¦ï¼Œä¸å…‰çº¿å‡ºå°„è§’ä»¥åŠè§‚å¯Ÿæ–¹å‘ï¼Œç›´æ¥ç›¸å…³ã€‚å½“ä¸¤è€…å¤¹è§’è¶Šå°ï¼Œé•œé¢åå°„å¼ºåº¦è¶Šé«˜ã€‚åŒæ—¶å¯¹è¯¥å½±å“å› å­çš„å¹‚æ¬¡è¶Šé«˜ï¼Œé«˜å…‰è¶Šé›†ä¸­åŒ–ã€‚ image-20250922094927976.png image-20250922100232547.png æ³¨æ„äº‹é¡¹ï¼šæ³•çº¿ç”±å±€éƒ¨åæ ‡ç³»è½¬æ¢åˆ°ä¸–ç•Œåæ ‡ç³»ä¸èƒ½ç®€å•çš„é€šè¿‡æ¨¡å‹çŸ©é˜µæ¥è®¡ç®—ã€‚å¦‚æœæ¨¡å‹çŸ©é˜µæ‰§è¡Œäº†ä¸ç­‰æ¯”ç¼©æ”¾ï¼Œé¡¶ç‚¹çš„æ”¹å˜ä¼šå¯¼è‡´æ³•å‘é‡ä¸å†å‚ç›´äºè¡¨é¢äº†ã€‚è§ä¸‹å›¾ï¼šimage-20250922100002164.png\u0026quot;\nå› æ­¤ï¼Œä¸–ç•Œåæ ‡ä¸­çš„æ³•çº¿ä¸€èˆ¬é‡‡ç”¨Normal = mat3(transpose(inverse(model))) * aNormal;çš„æ–¹å¼æ¥è®¡ç®—è·å¾—ã€‚\n2ã€ç›´æ¥å…‰æº é‡‡ç”¨å¸ƒæ—æ©å†¯æ¨¡å‹\nç¯å¢ƒå…‰ï¼š å…‰æºé¢œè‰² * ç‰©ä½“é¢œè‰² ç‰©ä½“é¢œè‰²å¯é‡‡ç”¨æ¼«åå°„è´´å›¾ vec3 ambient = light.ambient * objectColor; æ¼«åå°„ï¼š éœ€è¦è€ƒè™‘å…‰çº¿å…¥å°„è§’å’Œè¡¨é¢æ³•çº¿å¤¹è§’ ç‰©ä½“é¢œè‰²å¯é‡‡ç”¨æ¼«åå°„è´´å›¾ vec3 diffuse = max(dot(norm, lightDir), 0.0)* light.diffuse* objectColor; é•œé¢åå°„ ï¼š è€ƒè™‘å…‰çº¿å‡ºå°„è§’å’Œè§‚å¯Ÿè§†çº¿çš„å¤¹è§’ ç‰©ä½“é¢œè‰²å¯é‡‡ç”¨é•œé¢åå°„è´´å›¾ vec3 specular = pow(max(dot(viewDir, reflectDir), 0.0), 32) * light.specular* objectColor; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 struct Material { sampler2D diffuse; sampler2D specular; float shininess; }; struct Dirlight { vec3 direction; vec3 ambient; vec3 diffuse; vec3 specular; }; vec3 CalcDirLight(Dirlight light, vec3 normal, vec3 viewDir) { vec3 lightDir = normalize(-light.direction); vec3 reflectDir = reflect(light.direction, normal); vec3 ambient = light.ambient * texture(uMaterial.diffuse, TexCoord.xy).rgb ; //ç¯å¢ƒå…‰ vec3 diffuse = max(dot(normal, lightDir), 0.0f) * light.diffuse * texture(uMaterial.diffuse, TexCoord.xy).rgb; //æ¼«åå°„ vec3 specular = pow(max(dot(reflectDir,viewDir), 0.0f), uMaterial.shininess) * light.specular * texture(uMaterial.specular,TexCoord.xy).rgb; //é•œé¢å…‰ return (ambient + diffuse + specular); } 3ã€ç‚¹å…‰æº é‡‡ç”¨å¸ƒæ—æ©å†¯æ¨¡å‹ï¼Œä¸å¹³è¡Œå…‰ä»…æœ‰å¾®å°çš„å·®å¼‚\nå…‰çº¿æ–¹å‘éœ€è¦æœ‰ç‚¹å…‰æºä½ç½®ä¸ç‰‡æ®µä½ç½®è®¡ç®—å¾—å‡º ç‚¹å…‰æºçš„å¼ºåº¦ä¼šéšè·ç¦»è¡°å‡ã€‚ image-20251014110623598.png\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 struct Material { sampler2D diffuse; //æ¼«åå°„è´´å›¾ sampler2D specular; //é•œé¢å…‰è´´å›¾ float shininess; //é«˜å…‰æŒ‡æ•° }; struct PointLight { vec3 position; //ç‚¹å…‰æºä½ç½® float constant; //å¸¸æ•°é¡¹ float linear; //çº¿æ€§é¡¹ float quadratic; //äºŒæ¬¡é¡¹ vec3 ambient; //ç¯å¢ƒå…‰ vec3 diffuse; //æ¼«åå°„ vec3 specular; //é•œé¢å…‰ }; vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir) { vec3 lightDir = normalize(light.position - fragPos); vec3 reflectDir = reflect(-lightDir, normal); float distance = length(light.position - fragPos); float attenuation = 1.0f / (light.constant + light.linear * distance + light.quadratic * (distance * distance)); vec3 ambient = light.ambient * texture(uMaterial.diffuse, TexCoord.xy).rgb ; //ç¯å¢ƒå…‰ vec3 diffuse = max(dot(normal, lightDir), 0.0f) * light.diffuse * texture(uMaterial.diffuse, TexCoord.xy).rgb; //æ¼«åå°„ vec3 specular = pow(max(dot(reflectDir,viewDir), 0.0f), uMaterial.shininess) * light.specular * texture(uMaterial.specular,TexCoord.xy).rgb; //é•œé¢å…‰ return (ambient + diffuse + specular) * attenuation; } 4ã€èšå…‰ç¯ èšå…‰ç¯æ˜¯ä¸€ç§ä½ç½®åœ¨ç¯å¢ƒä¸­çš„å…‰æºï¼Œå®ƒåªåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–¹å‘ä¸Šå‘å°„å…‰çº¿ï¼Œå¹¶ä¸”å…‰çº¿ä¼šéšç€è·ç¦»é€æ¸è¡°å‡ã€‚èšå…‰ç¯é€šå¸¸ç”¨äºæ¨¡æ‹Ÿæ‰‹ç”µç­’ã€è½¦ç¯ç­‰æ•ˆæœã€‚\nèšå…‰ç¯çš„å…‰ç…§è®¡ç®—éœ€è¦è€ƒè™‘ï¼š\nå…‰æºä½ç½®å’Œæ–¹å‘ èšå…‰ç¯çš„åˆ‡å…‰è§’ï¼ˆCut-off angleï¼‰ èšå…‰ç¯çš„å¤–åˆ‡å…‰è§’ï¼ˆOuter cut-off angleï¼‰ å…‰çº¿è¡°å‡ ä¸‰ã€æè´¨ åœ¨å¸ƒæ—æ©å†¯æ¨¡å‹ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ›´ç²¾ç»†çš„æ§åˆ¶å…‰ç…§è¡¨ç°ï¼Œå› æ­¤æŠ½è±¡å‡ºäº†æè´¨çš„æ¦‚å¿µã€‚\nç‰©ä½“æè´¨ï¼ˆMaterialï¼‰åŒ…å«ä»¥ä¸‹å‡ ä¸ªå±æ€§ï¼š\nambientï¼šåŸºç¡€é¢œè‰²ã€‚å®šä¹‰äº†åœ¨ç¯å¢ƒå…‰ç…§ä¸‹è¿™ä¸ªè¡¨é¢åå°„çš„æ˜¯ä»€ä¹ˆé¢œè‰²ï¼Œé€šå¸¸ä¸è¡¨é¢çš„é¢œè‰²ç›¸åŒã€‚ diffuseï¼šæ¼«åå°„ã€‚å®šä¹‰äº†åœ¨æ¼«åå°„å…‰ç…§ä¸‹è¡¨é¢çš„é¢œè‰²ã€‚æ¼«åå°„é¢œè‰²ï¼ˆå’Œç¯å¢ƒå…‰ç…§ä¸€æ ·ï¼‰ä¹Ÿè¢«è®¾ç½®ä¸ºæˆ‘ä»¬æœŸæœ›çš„ç‰©ä½“é¢œè‰²ã€‚ specularï¼šé•œé¢åå°„ï¼Œè®¾ç½®çš„æ˜¯è¡¨é¢ä¸Šé•œé¢é«˜å…‰çš„é¢œè‰²ï¼ˆæˆ–è€…ç”šè‡³å¯èƒ½åæ˜ ä¸€ä¸ªç‰¹å®šè¡¨é¢çš„é¢œè‰²ï¼‰ã€‚ shininessï¼šé•œé¢åå°„åŠå¾„ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #version 330 core struct Material { vec3 ambient; vec3 diffuse; vec3 specular; float shininess; }; uniform Material material; lightingShader.setVec3(\u0026#34;material.ambient\u0026#34;, 1.0f, 0.5f, 0.31f); lightingShader.setVec3(\u0026#34;material.diffuse\u0026#34;, 1.0f, 0.5f, 0.31f); lightingShader.setVec3(\u0026#34;material.specular\u0026#34;, 0.5f, 0.5f, 0.5f); lightingShader.setFloat(\u0026#34;material.shininess\u0026#34;, 32.0f); é™¤äº†ç‰©ä½“æè´¨æœ¬èº«ï¼Œå…‰ä¹Ÿå…·æœ‰è‡ªèº«çš„å±æ€§ã€‚\nä¸€ä¸ªå…‰æºå¯¹å®ƒçš„ambientã€diffuseå’Œspecularå…‰ç…§åˆ†é‡æœ‰ç€ä¸åŒçš„å¼ºåº¦ã€‚ç¯å¢ƒå…‰ç…§é€šå¸¸è¢«è®¾ç½®ä¸ºä¸€ä¸ªæ¯”è¾ƒä½çš„å¼ºåº¦ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›ç¯å¢ƒå…‰é¢œè‰²å¤ªè¿‡ä¸»å¯¼ã€‚å…‰æºçš„æ¼«åå°„åˆ†é‡é€šå¸¸è¢«è®¾ç½®ä¸ºæˆ‘ä»¬å¸Œæœ›å…‰æ‰€å…·æœ‰çš„é‚£ä¸ªé¢œè‰²ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ˜äº®çš„ç™½è‰²ã€‚é•œé¢å…‰åˆ†é‡é€šå¸¸ä¼šä¿æŒä¸ºvec3(1.0)ï¼Œä»¥æœ€å¤§å¼ºåº¦å‘å…‰ã€‚æ³¨æ„æˆ‘ä»¬ä¹Ÿå°†å…‰æºçš„ä½ç½®å‘é‡åŠ å…¥äº†ç»“æ„ä½“\n1 2 3 4 5 6 7 8 9 struct Light { vec3 position; vec3 ambient; vec3 diffuse; vec3 specular; }; uniform Light light; GLSL GLSLç”±ä¸‰éƒ¨åˆ†æ„æˆï¼švertex + fragment\nç‰ˆæœ¬æŒ‡å®šï¼š#version 310 es\né›¶ã€ç®€å•çš„ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 /** This is a VertexShader */ const char* VertexShaderSource = \u0026#34;#version 330 core\\n\u0026#34; \u0026#34;layout (location = 0) in vec3 aPos;\\n\u0026#34; \u0026#34;void main()\\n\u0026#34; \u0026#34;{\\n\u0026#34; \u0026#34; gl_Position = vec4(aPos.x,aPos.y,aPos.z,1.0);\\n\u0026#34; \u0026#34; gl_PointSize = 20.0f;\\n\u0026#34; \u0026#34;}\\0\u0026#34; ; /** This is a FragmentShader */ const char* FragmentShaderSource = \u0026#34;#version 330 core\\n\u0026#34; \u0026#34;out vec4 FragColor;\\n\u0026#34; \u0026#34;void main()\\n\u0026#34; \u0026#34;{\\n\u0026#34; \u0026#34; FragColor = vec4(1.0f,0.5f,0.2f,1.0f);\\n\u0026#34; \u0026#34;}\\0\u0026#34; ; ä¸€ã€ç€è‰²å™¨å…³é”®å­— å…³é”®å­— è¯´æ˜ ç¤ºä¾‹ attribute é¡¶ç‚¹å±æ€§ï¼Œåªä¼šåœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å‡ºç°ï¼Œä¸ä¼šåœ¨ç‰‡æ®µç€è‰²å™¨ä¸­å‡ºç°\nç°åœ¨å·²ç»åºŸå¼ƒï¼Œè€Œé‡‡ç”¨inå’Œout attribute aVertexPosition uniform å¤–éƒ¨å˜é‡ï¼Œå…¨å±€ç»Ÿä¸€ uniform uModelViewMatrix varing å¯é€ä¼ åˆ°ç‰‡æ®µç€è‰²å™¨çš„å˜é‡ï¼Œç”±é¡¶ç‚¹ç€è‰²å™¨è®¡ç®—å¾—å‡º varing highp vec3 vFragPos layout in è¯¥ç€è‰²å™¨çš„è¾“å…¥ layout (location = 0) in vec3 aPos;\nlayout (location = 1) in vec3 aTangent; out è¯¥ç€è‰²å™¨çš„è¾“å‡º out type out_variable_name; äºŒã€å˜é‡ å˜é‡ç±»å‹ è¯´æ˜ ç¤ºä¾‹ int / float / double / uint / bool åŸºç¡€ç±»å‹ vec å‘é‡ï¼Œé»˜è®¤ä¸ºfloatï¼Œä¹Ÿå¯ä»¥é€‰æ‹©boolã€doubleã€uint bvec3 / vec2 mat çŸ©é˜µ sampler2D çº¹ç†è´´å›¾ gl_Position é¡¶ç‚¹ç€è‰²å™¨ä¸­çš„é»˜è®¤å˜é‡ gl_FragColor ç‰‡æ®µç€è‰²å™¨ä¸­çš„é»˜è®¤å˜é‡ï¼Œå¯ä»¥å­˜åœ¨å¤šä¸ªï¼Œéœ€è¦ç”¨åˆ°å˜ç§ã€‚ï¼ˆä¸€æ¬¡passï¼Œè¾“å‡ºå¤šä¸ªç»“æœï¼‰ ä¸‰ã€å‡½æ•° å‡½æ•°å è¯´æ˜ ç¤ºä¾‹ texture2D è´´å›¾é‡‡æ ·å™¨ texture2D(uSampler,vTextureCoord).rgb pow ä¹˜æ–¹ï¼Œå¸¸ç”¨ï¼šgamaçŸ«æ­£ pow(texture2D(uSampler,vTextureCoord).rgb,vec3(2.2) max å–å¤§å€¼ min å–å°å€¼ mix çº¿æ€§æ’å€¼/æ··åˆ mix(texture(uTexture0, TexCoord.xy),texture(uTexture1, TexCoord.xy),0.8f); å››ã€å¸¸ç”¨å‡½æ•° ä¸€ã€æ·±åº¦æ‰“åŒ…å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 //Fragment vec4 pack (float depth) { // ä½¿ç”¨rgba 4å­—èŠ‚å…±32ä½æ¥å­˜å‚¨zå€¼,1ä¸ªå­—èŠ‚ç²¾åº¦ä¸º1/256 const vec4 bitShift = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0); const vec4 bitMask = vec4(1.0/256.0, 1.0/256.0, 1.0/256.0, 0.0); // gl_FragCoord:ç‰‡å…ƒçš„åæ ‡,fract():è¿”å›æ•°å€¼çš„å°æ•°éƒ¨åˆ† vec4 rgbaDepth = fract(depth * bitShift); //è®¡ç®—æ¯ä¸ªç‚¹çš„zå€¼ rgbaDepth -= rgbaDepth.gbaa * bitMask; // Cut off the value which do not fit in 8 bits return rgbaDepth; } float unpack() { // TODO: å®ç°è§£åŒ…å‡½æ•° } void main() { gl_FragColor = pack(gl_FragCoord.z); } HLSL Vertex + Pixel\nGLMåº“ GLMï¼ˆOpenGL Mathematicsï¼‰æ˜¯ä¸€ä¸ªä¸“é—¨ä¸º OpenGL è®¾è®¡çš„ C++ æ•°å­¦åº“ï¼Œå®ƒæä¾›äº†ä¸ GLSLï¼ˆOpenGL Shading Languageï¼‰å…¼å®¹çš„æ•°å­¦ç±»å‹å’Œå‡½æ•°ã€‚GLM çš„è®¾è®¡ç›®æ ‡æ˜¯è®© C++ ä»£ç èƒ½å¤Ÿæ–¹ä¾¿åœ°ä½¿ç”¨ä¸ç€è‰²å™¨ç›¸åŒçš„æ•°å­¦è¿ç®—ã€‚\nä¸»è¦ç‰¹æ€§ï¼š\næä¾›å‘é‡ï¼ˆvec2, vec3, vec4ï¼‰ã€çŸ©é˜µï¼ˆmat3, mat4ï¼‰ç­‰æ•°æ®ç±»å‹ æ”¯æŒå¸¸è§çš„æ•°å­¦è¿ç®—ï¼ˆç‚¹ç§¯ã€å‰ç§¯ã€å½’ä¸€åŒ–ç­‰ï¼‰ æä¾›å˜æ¢å‡½æ•°ï¼ˆå¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ã€é€è§†æŠ•å½±ç­‰ï¼‰ ä¸ GLSL è¯­æ³•é«˜åº¦å…¼å®¹ STBåº“ STB æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å•æ–‡ä»¶ C/C++ åº“é›†åˆï¼Œç”± Sean Barrett å¼€å‘ã€‚å®ƒåŒ…å«äº†å„ç§å¸¸ç”¨åŠŸèƒ½çš„å®ç°ï¼Œå¦‚å›¾åƒåŠ è½½ã€æ–‡æœ¬è§£æã€éŸ³é¢‘å¤„ç†ç­‰ã€‚\nä¸€ã€stb_image å‡½æ•° ä½œç”¨ ç¤ºä¾‹ stbi_load() åŠ è½½å›¾ç‰‡ int width, height, nrChannels; unsigned char *data = stbi_load(\u0026ldquo;container.jpg\u0026rdquo;, \u0026amp;width, \u0026amp;height, \u0026amp;nrChannels, 0); ","date":"2026-01-05T00:00:00Z","image":"https://Liyufei1.github.io/OpenGL.png","permalink":"https://Liyufei1.github.io/p/opengl-learning-notes/","title":"OpenGLå­¦ä¹ éšç¬”"},{"content":"Godot 4.4 å¯åŠ¨å‚æ•°å®Œæ•´æŒ‡å— Godot å¼•æ“æä¾›äº†ä¸°å¯Œçš„å‘½ä»¤è¡Œå¯åŠ¨å‚æ•°ï¼Œå…è®¸å¼€å‘è€…åœ¨è¿è¡Œæ—¶å’Œç¼–è¾‘å™¨ä¸­ç²¾ç»†æ§åˆ¶å¼•æ“è¡Œä¸ºã€‚æœ¬æ–‡åŸºäº Godot 4.4 æºç ï¼Œå…¨é¢æ¢³ç†äº†æ‰€æœ‰å¯ç”¨çš„å¯åŠ¨å‚æ•°ï¼Œå¹¶æŒ‰åŠŸèƒ½åˆ†ç±»è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚\nç›®å½• åŸºæœ¬å‚æ•° è¿è¡Œæ—¶å‚æ•° ç¼–è¾‘å™¨å‚æ•° æ˜¾ç¤ºä¸æ¸²æŸ“å‚æ•° éŸ³é¢‘å‚æ•° è°ƒè¯•å‚æ•° ç½‘ç»œä¸æ–‡ä»¶ç³»ç»Ÿå‚æ•° å¹³å°ç‰¹å®šå‚æ•° å…¶ä»–å·¥å…·å‚æ•° å¸¸ç”¨ç»„åˆç¤ºä¾‹ æ³¨æ„äº‹é¡¹ åŸºæœ¬å‚æ•° -h, --help, /? æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡ºã€‚è¿™æ˜¯è·å–æ‰€æœ‰å¯ç”¨å‘½ä»¤è¡Œå‚æ•°çš„æœ€å¿«æ–¹æ³•ã€‚\n1 godot --help ä½¿ç”¨åœºæ™¯ï¼š\nåˆæ¬¡ä½¿ç”¨ Godot æ—¶äº†è§£å¯ç”¨å‚æ•° å¿˜è®°å…·ä½“å‚æ•°åç§°æ—¶å¿«é€ŸæŸ¥é˜… æ£€æŸ¥å½“å‰ Godot ç‰ˆæœ¬æ”¯æŒçš„å‚æ•°åˆ—è¡¨ --version æ˜¾ç¤º Godot ç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡ºã€‚\n1 godot --version ä½¿ç”¨åœºæ™¯ï¼š\nç¡®è®¤å½“å‰ä½¿ç”¨çš„ Godot ç‰ˆæœ¬ åœ¨ CI/CD ç¯å¢ƒä¸­éªŒè¯å¼•æ“ç‰ˆæœ¬ æŠ¥å‘Šé—®é¢˜æ—¶æä¾›ç‰ˆæœ¬ä¿¡æ¯ -v, --verbose å¯ç”¨è¯¦ç»†è¾“å‡ºæ¨¡å¼ï¼Œæ‰“å°æ›´å¤šä¿¡æ¯åˆ°æ§åˆ¶å°ã€‚åŒ…æ‹¬å¼•æ“åˆå§‹åŒ–ã€èµ„æºåŠ è½½ã€é”™è¯¯è¯¦æƒ…ç­‰ã€‚\n1 godot --verbose ä½¿ç”¨åœºæ™¯ï¼š\nè°ƒè¯•å¯åŠ¨é—®é¢˜ æŸ¥çœ‹èµ„æºåŠ è½½è¿‡ç¨‹ åˆ†æå¼•æ“åˆå§‹åŒ–æµç¨‹ å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¸­è·å–æ›´å¤šä¿¡æ¯ -q, --quiet å¯ç”¨å®‰é™æ¨¡å¼ï¼Œå‡å°‘æ§åˆ¶å°è¾“å‡ºã€‚ä»…æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œé€‚ç”¨äºè‡ªåŠ¨åŒ–è„šæœ¬ã€‚\n1 godot --quiet ä½¿ç”¨åœºæ™¯ï¼š\nCI/CD ç¯å¢ƒä¸­å‡å°‘æ—¥å¿—å™ªéŸ³ è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ æ‰¹é‡å¤„ç†ä»»åŠ¡ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½² --no-header ç¦ç”¨å¯åŠ¨æ—¶æ˜¾ç¤ºçš„ Godot æ ‡é¢˜å¤´ä¿¡æ¯ï¼Œä½¿è¾“å‡ºæ›´åŠ ç®€æ´ã€‚\n1 godot --no-header ä½¿ç”¨åœºæ™¯ï¼š\nè„šæœ¬åŒ–æ“ä½œæ—¶ä¿æŒè¾“å‡ºæ•´æ´ æ—¥å¿—åˆ†ææ—¶å‡å°‘æ— å…³ä¿¡æ¯ è‡ªåŠ¨åŒ–æµ‹è¯•ç¯å¢ƒ è¿è¡Œæ—¶å‚æ•° --path \u0026lt;path\u0026gt; æŒ‡å®šé¡¹ç›®è·¯å¾„ã€‚è¿™æ˜¯æœ€é‡è¦çš„å‚æ•°ä¹‹ä¸€ï¼Œå‘Šè¯‰ Godot åœ¨å“ªé‡Œæ‰¾åˆ°é¡¹ç›®ã€‚\n1 godot --path /path/to/project ä½¿ç”¨åœºæ™¯ï¼š\nä»ä»»æ„ç›®å½•è¿è¡Œ Godot é¡¹ç›® åœ¨è„šæœ¬ä¸­æŒ‡å®šé¡¹ç›®ä½ç½® CI/CD ç®¡é“ä¸­çš„é¡¹ç›®è·¯å¾„é…ç½® æœ€ä½³å®è·µï¼š\nä¼˜å…ˆä½¿ç”¨ç»å¯¹è·¯å¾„ä»¥ç¡®ä¿å¯é æ€§ åœ¨è‡ªåŠ¨åŒ–è„šæœ¬ä¸­æ€»æ˜¯æ˜ç¡®æŒ‡å®šé¡¹ç›®è·¯å¾„ è·¯å¾„åº”åŒ…å« project.godot æ–‡ä»¶ -u, --upwards å‘ä¸Šæ‰«ææ–‡ä»¶å¤¹ä»¥æŸ¥æ‰¾ project.godot æ–‡ä»¶ã€‚ä»å½“å‰ç›®å½•å¼€å§‹é€’å½’æœç´¢çˆ¶ç›®å½•ã€‚\n1 godot --upwards ä½¿ç”¨åœºæ™¯ï¼š\nåœ¨é¡¹ç›®å­ç›®å½•ä¸­å¿«é€Ÿè¿è¡Œ Godot å¼€å‘ç¯å¢ƒä¸­çš„ä¾¿æ·æ“ä½œ ä¸éœ€è¦è®°ä½å®Œæ•´é¡¹ç›®è·¯å¾„çš„å¿«é€Ÿå¯åŠ¨ æœ€ä½³å®è·µï¼š\né€‚ç”¨äºå¼€å‘ç¯å¢ƒï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ --path ç¡®ä¿é¡¹ç›®ç›®å½•ç»“æ„æ¸…æ™°ï¼Œé¿å…å¤šä¸ª project.godot æ–‡ä»¶ --main-pack \u0026lt;path\u0026gt; æŒ‡å®šä¸»åŒ…æ–‡ä»¶è·¯å¾„ã€‚å…è®¸ä» PCK æ–‡ä»¶è¿è¡Œé¡¹ç›®ï¼Œæ— éœ€æºä»£ç ã€‚\n1 godot --main-pack /path/to/main.pck ä½¿ç”¨åœºæ™¯ï¼š\nè¿è¡Œæ‰“åŒ…åçš„æ¸¸æˆ åˆ†å‘æ¸¸æˆè€Œä¸æš´éœ²æºä»£ç  æ¨¡å—åŒ–é¡¹ç›®éƒ¨ç½² æœ€ä½³å®è·µï¼š\nç¡®ä¿ PCK æ–‡ä»¶ä¸å¼•æ“ç‰ˆæœ¬å…¼å®¹ ç”¨äºæœ€ç»ˆäº§å“åˆ†å‘ï¼Œä¸ç”¨äºå¼€å‘ --quit åœ¨ç¬¬ä¸€ä¸ªä¸»å¾ªç¯è¿­ä»£åè‡ªåŠ¨é€€å‡ºã€‚ç”¨äºå¿«é€Ÿæµ‹è¯•å’ŒéªŒè¯ã€‚\n1 godot --quit ä½¿ç”¨åœºæ™¯ï¼š\néªŒè¯é¡¹ç›®é…ç½®æ˜¯å¦æ­£ç¡® å¿«é€Ÿæ£€æŸ¥è„šæœ¬è¯­æ³•é”™è¯¯ CI/CD ä¸­çš„å¿«é€ŸéªŒè¯æ­¥éª¤ æœ€ä½³å®è·µï¼š\nç»“åˆ --verbose ä½¿ç”¨ä»¥è·å–é”™è¯¯ä¿¡æ¯ ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•çš„ç¬¬ä¸€æ­¥éªŒè¯ --quit-after \u0026lt;n\u0026gt; åœ¨æŒ‡å®šæ•°é‡çš„è¿­ä»£åé€€å‡ºã€‚å…è®¸è¿è¡Œç‰¹å®šå¸§æ•°åè‡ªåŠ¨é€€å‡ºã€‚\n1 godot --quit-after 100 ä½¿ç”¨åœºæ™¯ï¼š\næ€§èƒ½æµ‹è¯•çš„å›ºå®šæ—¶é•¿ è‡ªåŠ¨åŒ–æˆªå›¾æˆ–å½•åˆ¶ æœ‰é™æ—¶é•¿çš„æµ‹è¯•åœºæ™¯ æœ€ä½³å®è·µï¼š\nç»“åˆ --fixed-fps ä½¿ç”¨ä»¥è·å¾—ç²¾ç¡®çš„æ—¶é—´æ§åˆ¶ ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•å’Œæ€§èƒ½åŸºå‡†æµ‹è¯• --max-fps \u0026lt;n\u0026gt; è®¾ç½®æœ€å¤§æ¸²æŸ“å¸§ç‡ã€‚0 è¡¨ç¤ºä¸é™åˆ¶å¸§ç‡ã€‚\n1 godot --max-fps 60 ä½¿ç”¨åœºæ™¯ï¼š\né™åˆ¶ CPU/GPU ä½¿ç”¨ç‡ ç§»åŠ¨è®¾å¤‡çœç”µ ä¿æŒä¸€è‡´çš„å¸§ç‡ æ€§èƒ½æµ‹è¯• æœ€ä½³å®è·µï¼š\nç§»åŠ¨å¹³å°é€šå¸¸è®¾ç½®ä¸º 30 æˆ– 60 FPS æ¡Œé¢å¹³å°å¯ä»¥ä¸é™åˆ¶æˆ–è®¾ç½®ä¸ºæ˜¾ç¤ºå™¨åˆ·æ–°ç‡ ç”¨äºæ€§èƒ½ä¼˜åŒ–æ—¶ï¼Œé€æ­¥é™ä½å¸§ç‡æµ‹è¯• --fixed-fps \u0026lt;n\u0026gt; è®¾ç½®å›ºå®šå¸§ç‡æ¨¡å¼ã€‚ç¦ç”¨å®æ—¶åŒæ­¥ï¼Œå¼ºåˆ¶å›ºå®šæ—¶é—´æ­¥é•¿ã€‚\n1 godot --fixed-fps 30 ä½¿ç”¨åœºæ™¯ï¼š\nç‰©ç†æ¨¡æ‹Ÿéœ€è¦å›ºå®šæ—¶é—´æ­¥é•¿ å½•åˆ¶æ¸¸æˆè§†é¢‘æ—¶ç¡®ä¿ä¸€è‡´æ€§ ç½‘ç»œåŒæ­¥æ¸¸æˆ è°ƒè¯•æ—¶é—´ç›¸å…³é—®é¢˜ æœ€ä½³å®è·µï¼š\nç‰©ç†æ¸¸æˆé€šå¸¸ä½¿ç”¨ 60 FPS çš„å›ºå®šå¸§ç‡ å½•åˆ¶è§†é¢‘æ—¶æ ¹æ®ç›®æ ‡å¸§ç‡è®¾ç½® ä¸é€‚ç”¨äºéœ€è¦å®æ—¶å“åº”çš„æ¸¸æˆ --frame-delay \u0026lt;ms\u0026gt; è®¾ç½®å¸§å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ã€‚æ¨¡æ‹Ÿé«˜ CPU è´Ÿè½½æƒ…å†µã€‚\n1 godot --frame-delay 16 ä½¿ç”¨åœºæ™¯ï¼š\næ¨¡æ‹Ÿä½ç«¯è®¾å¤‡æ€§èƒ½ æµ‹è¯•æ¸¸æˆåœ¨æ…¢é€Ÿç¯å¢ƒä¸‹çš„è¡¨ç° æ€§èƒ½å‹åŠ›æµ‹è¯• æœ€ä½³å®è·µï¼š\nä¸è¦ç”¨ä½œ FPS é™åˆ¶å™¨ï¼Œåº”ä½¿ç”¨ --max-fps ç”¨äºæ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–éªŒè¯ å…¸å‹å€¼ä¸º 16msï¼ˆ60 FPSï¼‰æˆ– 33msï¼ˆ30 FPSï¼‰ --time-scale \u0026lt;scale\u0026gt; è®¾ç½®æ—¶é—´ç¼©æ”¾å› å­ã€‚1.0 ä¸ºæ­£å¸¸é€Ÿåº¦ï¼Œæ›´é«˜å€¼æ›´å¿«ï¼Œæ›´ä½å€¼æ›´æ…¢ã€‚\n1 godot --time-scale 0.5 ä½¿ç”¨åœºæ™¯ï¼š\næ…¢åŠ¨ä½œæ•ˆæœæµ‹è¯• å¿«é€Ÿæµ‹è¯•é•¿æ—¶é—´è¿è¡Œçš„æ¸¸æˆ è°ƒè¯•æ—¶é—´ç›¸å…³çš„æ¸¸æˆæœºåˆ¶ æ€§èƒ½æµ‹è¯•ä¸­çš„æ—¶é—´åŠ é€Ÿ æœ€ä½³å®è·µï¼š\n0.5 ç”¨äºæ…¢åŠ¨ä½œè°ƒè¯• 2.0 æˆ–æ›´é«˜ç”¨äºå¿«é€Ÿæµ‹è¯• ç»“åˆ --fixed-fps è·å¾—å¯é‡ç°çš„ç»“æœ --delta-smoothing \u0026lt;mode\u0026gt; è®¾ç½®å¢é‡å¹³æ»‘æ¨¡å¼ï¼ˆenable/disableï¼‰ã€‚æ§åˆ¶å¸§æ—¶é—´å¹³æ»‘ä»¥å‡å°‘æŠ–åŠ¨ã€‚\n1 godot --delta-smoothing enable ä½¿ç”¨åœºæ™¯ï¼š\næé«˜åŠ¨ç”»å’Œç‰©ç†çš„å¹³æ»‘åº¦ å‡å°‘å¸§ç‡æ³¢åŠ¨çš„å½±å“ è°ƒè¯•æ—¶é—´ç›¸å…³é—®é¢˜ æœ€ä½³å®è·µï¼š\né»˜è®¤å¯ç”¨ä»¥è·å¾—æ›´å¥½çš„æ¸¸æˆä½“éªŒ è°ƒè¯•æ—¶å¯ä»¥ç¦ç”¨ä»¥æŸ¥çœ‹åŸå§‹å¸§æ—¶é—´ åœ¨å›ºå®šå¸§ç‡æ¨¡å¼ä¸‹é€šå¸¸ä¸éœ€è¦ ç¼–è¾‘å™¨å‚æ•° -e, --editor å¯åŠ¨ç¼–è¾‘å™¨æ¨¡å¼ã€‚\n1 godot --editor -p, --project-manager å¯åŠ¨é¡¹ç›®ç®¡ç†å™¨ã€‚\n1 godot --project-manager --recovery-mode å¯ç”¨æ¢å¤æ¨¡å¼ã€‚\n1 godot --recovery-mode --single-window å¼ºåˆ¶å•çª—å£æ¨¡å¼ã€‚\n1 godot --single-window --build-solutions æ„å»ºè„šæœ¬è§£å†³æ–¹æ¡ˆï¼ˆå¦‚ C#ï¼‰ã€‚\n1 godot --build-solutions --import å¯¼å…¥èµ„æºå¹¶é€€å‡ºã€‚\n1 godot --import --export-release \u0026lt;preset\u0026gt; \u0026lt;path\u0026gt; å‘å¸ƒæ¨¡å¼å¯¼å‡ºé¡¹ç›®ã€‚\n1 godot --export-release \u0026#34;Windows Desktop\u0026#34; game.exe --export-debug \u0026lt;preset\u0026gt; \u0026lt;path\u0026gt; è°ƒè¯•æ¨¡å¼å¯¼å‡ºé¡¹ç›®ã€‚\n1 godot --export-debug \u0026#34;Windows Desktop\u0026#34; game_debug.exe --export-pack \u0026lt;preset\u0026gt; \u0026lt;path\u0026gt; å¯¼å‡ºä¸º PCK åŒ…ã€‚\n1 godot --export-pack \u0026#34;Windows Desktop\u0026#34; game.pck --export-patch \u0026lt;preset\u0026gt; \u0026lt;path\u0026gt; å¯¼å‡ºä¸ºè¡¥ä¸åŒ…ã€‚\n1 godot --export-patch \u0026#34;Windows Desktop\u0026#34; patch.pck æ˜¾ç¤ºä¸æ¸²æŸ“å‚æ•° -f, --fullscreen å¼ºåˆ¶å…¨å±æ¨¡å¼ã€‚\n1 godot --fullscreen -m, --maximized å¼ºåˆ¶æœ€å¤§åŒ–çª—å£ã€‚\n1 godot --maximized -w, --windowed å¼ºåˆ¶çª—å£æ¨¡å¼ã€‚\n1 godot --windowed --resolution \u0026lt;WxH\u0026gt; è®¾ç½®çª—å£åˆ†è¾¨ç‡ã€‚\n1 godot --resolution 1920x1080 --position \u0026lt;X,Y\u0026gt; è®¾ç½®çª—å£ä½ç½®ã€‚\n1 godot --position 100,100 --screen \u0026lt;n\u0026gt; æŒ‡å®šæ˜¾ç¤ºå™¨ç¼–å·ã€‚\n1 godot --screen 1 -t, --always-on-top å¼ºåˆ¶çª—å£ç½®é¡¶ã€‚\n1 godot --always-on-top --display-driver \u0026lt;driver\u0026gt; æŒ‡å®šæ˜¾ç¤ºé©±åŠ¨ã€‚\n1 godot --display-driver vulkan --rendering-method \u0026lt;method\u0026gt; æŒ‡å®šæ¸²æŸ“æ–¹æ³•ã€‚\n1 godot --rendering-method forward_plus --rendering-driver \u0026lt;driver\u0026gt; æŒ‡å®šæ¸²æŸ“é©±åŠ¨ã€‚\n1 godot --rendering-driver vulkan --gpu-index \u0026lt;n\u0026gt; æŒ‡å®š GPU ç´¢å¼•ã€‚\n1 godot --gpu-index 0 --gpu-validation å¯ç”¨ GPU éªŒè¯å±‚ã€‚\n1 godot --gpu-validation --disable-vsync ç¦ç”¨å‚ç›´åŒæ­¥ã€‚\n1 godot --disable-vsync --headless å¯ç”¨æ— å¤´æ¨¡å¼ï¼ˆæ— éŸ³é¢‘ã€æ— æ¸²æŸ“ï¼‰ã€‚\n1 godot --headless --render-thread \u0026lt;mode\u0026gt; è®¾ç½®æ¸²æŸ“çº¿ç¨‹æ¨¡å¼ï¼ˆsafe/separateï¼‰ã€‚\n1 godot --render-thread safe --xr-mode \u0026lt;mode\u0026gt; è®¾ç½® XR æ¨¡å¼ï¼ˆdefault/off/onï¼‰ã€‚\n1 godot --xr-mode default éŸ³é¢‘å‚æ•° --audio-driver \u0026lt;driver\u0026gt; æŒ‡å®šéŸ³é¢‘é©±åŠ¨ã€‚\n1 godot --audio-driver ALSA --audio-output-latency \u0026lt;ms\u0026gt; è®¾ç½®éŸ³é¢‘è¾“å‡ºå»¶è¿Ÿã€‚\n1 godot --audio-output-latency 15 è°ƒè¯•å‚æ•° -d, --debug å¯ç”¨è°ƒè¯•æ¨¡å¼ã€‚å¯åŠ¨æœ¬åœ°è°ƒè¯•æœåŠ¡å™¨å¹¶å…è®¸è¿æ¥è°ƒè¯•å™¨ã€‚\n1 godot --debug ä½¿ç”¨åœºæ™¯ï¼š\næœ¬åœ°è°ƒè¯•æ¸¸æˆé€»è¾‘ è„šæœ¬è°ƒè¯•å’Œé”™è¯¯è¿½è¸ª å¼€å‘é˜¶æ®µçš„å®æ—¶è°ƒè¯• æœ€ä½³å®è·µï¼š\nå¼€å‘é˜¶æ®µå§‹ç»ˆå¯ç”¨ å‘å¸ƒç‰ˆæœ¬ä¸­ç¦ç”¨ä»¥æé«˜æ€§èƒ½ ç»“åˆ IDE çš„è°ƒè¯•åŠŸèƒ½ä½¿ç”¨ --debug-collisions å¯ç”¨ç¢°æ’è°ƒè¯•ã€‚åœ¨æ¸¸æˆä¸­æ˜¾ç¤ºæ‰€æœ‰ç¢°æ’å½¢çŠ¶çš„å¯è§è½®å»“ã€‚\n1 godot --debug-collisions ä½¿ç”¨åœºæ™¯ï¼š\nè°ƒè¯•ç‰©ç†ç¢°æ’é—®é¢˜ éªŒè¯ç¢°æ’å½¢çŠ¶è®¾ç½® ä¼˜åŒ–ç¢°æ’æ£€æµ‹æ€§èƒ½ æœ€ä½³å®è·µï¼š\nç‰©ç†æ¸¸æˆå¼€å‘ä¸­ç»å¸¸ä½¿ç”¨ ç”¨äºè°ƒè¯•ä¸å¯è§çš„ç¢°æ’é—®é¢˜ å‘å¸ƒå‰ç¡®ä¿ç¦ç”¨ä»¥æé«˜æ€§èƒ½ --debug-paths å¯ç”¨è·¯å¾„è°ƒè¯•ã€‚æ˜¾ç¤ºå¯¼èˆªè·¯å¾„å’Œå¯»è·¯ç›¸å…³çš„å¯è§†åŒ–ä¿¡æ¯ã€‚\n1 godot --debug-paths ä½¿ç”¨åœºæ™¯ï¼š\nè°ƒè¯• AI å¯»è·¯é—®é¢˜ éªŒè¯å¯¼èˆªç½‘æ ¼è®¾ç½® ä¼˜åŒ–è·¯å¾„æŸ¥æ‰¾ç®—æ³• æœ€ä½³å®è·µï¼š\nAI æ¸¸æˆå¼€å‘å¿…å¤‡å·¥å…· ç”¨äºå¤æ‚çš„å¯¼èˆªç³»ç»Ÿè°ƒè¯• å¸®åŠ©ç†è§£è·¯å¾„æŸ¥æ‰¾è¡Œä¸º --debug-navigation å¯ç”¨å¯¼èˆªè°ƒè¯•ã€‚æ˜¾ç¤ºå¯¼èˆªå¤šè¾¹å½¢å’Œå¯¼èˆªç½‘æ ¼çš„å¯è§†åŒ–ä¿¡æ¯ã€‚\n1 godot --debug-navigation ä½¿ç”¨åœºæ™¯ï¼š\nè°ƒè¯•å¯¼èˆªç½‘æ ¼ç”Ÿæˆ éªŒè¯å¯¼èˆªåŒºåŸŸè®¾ç½® ä¼˜åŒ–å¯¼èˆªç³»ç»Ÿæ€§èƒ½ æœ€ä½³å®è·µï¼š\n3D æ¸¸æˆå¯¼èˆªç³»ç»Ÿå¼€å‘ ç”¨äºè°ƒè¯•å¤æ‚çš„å¯¼èˆªåœºæ™¯ å¸®åŠ©è¯†åˆ«å¯¼èˆªé—®é¢˜ --debug-avoidance å¯ç”¨é¿éšœè°ƒè¯•ã€‚æ˜¾ç¤ºé¿éšœç®—æ³•çš„å¯è§†åŒ–ä¿¡æ¯ã€‚\n1 godot --debug-avoidance ä½¿ç”¨åœºæ™¯ï¼š\nè°ƒè¯• AI é¿éšœè¡Œä¸º éªŒè¯é¿éšœç®—æ³•æ•ˆæœ ä¼˜åŒ–é¿éšœç³»ç»Ÿæ€§èƒ½ æœ€ä½³å®è·µï¼š\nå¤æ‚ AI ç³»ç»Ÿå¼€å‘ ç”¨äºè°ƒè¯•ç¾¤ä½“è¡Œä¸º å¸®åŠ©ä¼˜åŒ–é¿éšœå‚æ•° --debug-canvas-item-redraw å¯ç”¨ç”»å¸ƒé¡¹ç›®é‡ç»˜è°ƒè¯•ã€‚æ¯æ¬¡ç”»å¸ƒé¡¹ç›®è¯·æ±‚é‡ç»˜æ—¶æ˜¾ç¤ºçŸ©å½¢ã€‚\n1 godot --debug-canvas-item-redraw ä½¿ç”¨åœºæ™¯ï¼š\nè°ƒè¯• UI é‡ç»˜é—®é¢˜ ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ æ’æŸ¥è¿‡åº¦é‡ç»˜é—®é¢˜ æœ€ä½³å®è·µï¼š\nUI æ€§èƒ½ä¼˜åŒ–æ—¶ä½¿ç”¨ ç”¨äºè°ƒè¯•ä½å¤„ç†å™¨æ¨¡å¼é—®é¢˜ å¸®åŠ©è¯†åˆ«ä¸å¿…è¦çš„é‡ç»˜ --debug-stringnames å¯ç”¨å­—ç¬¦ä¸²åç§°è°ƒè¯•ã€‚åœ¨å¼•æ“é€€å‡ºæ—¶æ‰“å°æ‰€æœ‰ StringName åˆ†é…ä¿¡æ¯ã€‚\n1 godot --debug-stringnames ä½¿ç”¨åœºæ™¯ï¼š\nå†…å­˜ä½¿ç”¨åˆ†æ å­—ç¬¦ä¸²ä¼˜åŒ– è°ƒè¯•å­—ç¬¦ä¸²å†…å­˜æ³„æ¼ æœ€ä½³å®è·µï¼š\nå†…å­˜ä¼˜åŒ–åˆ†ææ—¶ä½¿ç”¨ ç”¨äºè¯†åˆ«å­—ç¬¦ä¸²æ€§èƒ½é—®é¢˜ å‘å¸ƒç‰ˆæœ¬ä¸­ç¦ç”¨ --remote-debug \u0026lt;uri\u0026gt; è®¾ç½®è¿œç¨‹è°ƒè¯•åœ°å€ã€‚å…è®¸é€šè¿‡ç½‘ç»œè¿æ¥è°ƒè¯•å™¨ã€‚\n1 godot --remote-debug tcp://127.0.0.1:6007 ä½¿ç”¨åœºæ™¯ï¼š\nè¿œç¨‹è®¾å¤‡è°ƒè¯• ç§»åŠ¨è®¾å¤‡è°ƒè¯• CI/CD ç¯å¢ƒä¸­çš„è°ƒè¯• æœ€ä½³å®è·µï¼š\næ ¼å¼ï¼štcp://\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt; é»˜è®¤ç«¯å£ï¼š6007 ç¡®ä¿ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½® --profiling å¯ç”¨æ€§èƒ½åˆ†æã€‚æ”¶é›†è¿è¡Œæ—¶æ€§èƒ½æ•°æ®ç”¨äºåˆ†æã€‚\n1 godot --profiling ä½¿ç”¨åœºæ™¯ï¼š\næ€§èƒ½ç“¶é¢ˆåˆ†æ ä¼˜åŒ–æ¸¸æˆæ€§èƒ½ ç›‘æ§èµ„æºä½¿ç”¨ æœ€ä½³å®è·µï¼š\næ€§èƒ½ä¼˜åŒ–é˜¶æ®µä½¿ç”¨ ç»“åˆ --verbose è·å¾—è¯¦ç»†ä¿¡æ¯ å®šæœŸè¿›è¡Œæ€§èƒ½åˆ†æ --profile-gpu å¯ç”¨ GPU æ€§èƒ½åˆ†æã€‚æ”¶é›† GPU ç›¸å…³çš„æ€§èƒ½æ•°æ®ã€‚\n1 godot --profile-gpu ä½¿ç”¨åœºæ™¯ï¼š\nGPU æ€§èƒ½ä¼˜åŒ– æ¸²æŸ“ç“¶é¢ˆåˆ†æ ç€è‰²å™¨æ€§èƒ½è°ƒè¯• æœ€ä½³å®è·µï¼š\nå›¾å½¢å¯†é›†å‹æ¸¸æˆå¿…å¤‡ ç”¨äºä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ éœ€è¦æ”¯æŒ GPU åˆ†æçš„é©±åŠ¨ --print-fps æ‰“å°å¸§ç‡ä¿¡æ¯åˆ°æ ‡å‡†è¾“å‡ºã€‚å®æ—¶æ˜¾ç¤ºå½“å‰å¸§ç‡ã€‚\n1 godot --print-fps ä½¿ç”¨åœºæ™¯ï¼š\nå®æ—¶æ€§èƒ½ç›‘æ§ å¸§ç‡ç¨³å®šæ€§æµ‹è¯• æ€§èƒ½å›å½’æµ‹è¯• æœ€ä½³å®è·µï¼š\næ€§èƒ½æµ‹è¯•æ—¶ä½¿ç”¨ ç”¨äºç›‘æ§å¸§ç‡æ³¢åŠ¨ ç»“åˆ --max-fps éªŒè¯é™åˆ¶æ•ˆæœ -b, --breakpoints \u0026lt;list\u0026gt; è®¾ç½®æ–­ç‚¹åˆ—è¡¨ã€‚åœ¨æŒ‡å®šä½ç½®è®¾ç½®è°ƒè¯•æ–­ç‚¹ã€‚\n1 godot --breakpoints res://script.gd:42,res://other.gd:10 ä½¿ç”¨åœºæ™¯ï¼š\nè‡ªåŠ¨åŒ–æµ‹è¯•ä¸­çš„æ–­ç‚¹è®¾ç½® è°ƒè¯•ç‰¹å®šä»£ç è·¯å¾„ éªŒè¯ä»£ç æ‰§è¡Œæµç¨‹ æœ€ä½³å®è·µï¼š\næ ¼å¼ï¼šè·¯å¾„:è¡Œå·ï¼Œå¤šä¸ªæ–­ç‚¹ç”¨é€—å·åˆ†éš” ç”¨äºè‡ªåŠ¨åŒ–è°ƒè¯•æµç¨‹ ç»“åˆè¿œç¨‹è°ƒè¯•ä½¿ç”¨ --skip-breakpoints è·³è¿‡æ‰€æœ‰æ–­ç‚¹ã€‚å¿½ç•¥ä»£ç ä¸­è®¾ç½®çš„æ–­ç‚¹ã€‚\n1 godot --skip-breakpoints ä½¿ç”¨åœºæ™¯ï¼š\nå¿«é€Ÿè¿è¡Œæµ‹è¯• å¿½ç•¥è°ƒè¯•æ–­ç‚¹ ç”Ÿäº§ç¯å¢ƒè¿è¡Œ æœ€ä½³å®è·µï¼š\nCI/CD ç¯å¢ƒä¸­ä½¿ç”¨ ç”¨äºå¿«é€ŸéªŒè¯åŠŸèƒ½ é¿å…æ„å¤–æš‚åœæ‰§è¡Œ ç½‘ç»œä¸æ–‡ä»¶ç³»ç»Ÿå‚æ•° --remote-fs \u0026lt;host:port\u0026gt; è®¾ç½®è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿåœ°å€ã€‚\n1 godot --remote-fs 192.168.1.100:6010 --remote-fs-password \u0026lt;password\u0026gt; è®¾ç½®è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿå¯†ç ã€‚\n1 godot --remote-fs-password mypassword --log-file \u0026lt;path\u0026gt; æŒ‡å®šæ—¥å¿—æ–‡ä»¶è·¯å¾„ã€‚\n1 godot --log-file /path/to/godot.log å¹³å°ç‰¹å®šå‚æ•° --tablet-driver \u0026lt;driver\u0026gt; æŒ‡å®šå¹³æ¿é©±åŠ¨ã€‚\n1 godot --tablet-driver wintab --wid \u0026lt;window_id\u0026gt; åµŒå…¥åˆ°æŒ‡å®šçª—å£ IDã€‚\n1 godot --wid 123456 --lsp-port \u0026lt;port\u0026gt; è®¾ç½® LSP ç«¯å£ã€‚\n1 godot --lsp-port 8080 --dap-port \u0026lt;port\u0026gt; è®¾ç½® DAP ç«¯å£ã€‚\n1 godot --dap-port 8081 å…¶ä»–å·¥å…·å‚æ•° --doctool ç”Ÿæˆæ–‡æ¡£å·¥å…·ã€‚\n1 godot --doctool --gdscript-docs \u0026lt;path\u0026gt; ç”Ÿæˆ GDScript æ–‡æ¡£ã€‚\n1 godot --gdscript-docs /path/to/project --dump-gdextension-interface å¯¼å‡º GDExtension æ¥å£å¤´æ–‡ä»¶ã€‚\n1 godot --dump-gdextension-interface --dump-extension-api å¯¼å‡ºæ‰©å±• APIã€‚\n1 godot --dump-extension-api --dump-extension-api-with-docs å¯¼å‡ºæ‰©å±• APIï¼ˆåŒ…å«æ–‡æ¡£ï¼‰ã€‚\n1 godot --dump-extension-api-with-docs --validate-extension-api \u0026lt;file\u0026gt; éªŒè¯æ‰©å±• API æ–‡ä»¶ã€‚\n1 godot --validate-extension-api extension_api.json --test-rd-support æµ‹è¯•æ¸²æŸ“è®¾å¤‡æ”¯æŒã€‚\n1 godot --test-rd-support --test-rd-creation æµ‹è¯•æ¸²æŸ“è®¾å¤‡åˆ›å»ºã€‚\n1 godot --test-rd-creation --write-movie \u0026lt;path\u0026gt; å½•åˆ¶ç”µå½±åˆ°æŒ‡å®šè·¯å¾„ã€‚\n1 godot --write-movie /path/to/movie.avi --benchmark å¯ç”¨åŸºå‡†æµ‹è¯•æ¨¡å¼ã€‚\n1 godot --benchmark --benchmark-file \u0026lt;path\u0026gt; æŒ‡å®šåŸºå‡†æµ‹è¯•æ–‡ä»¶è·¯å¾„ã€‚\n1 godot --benchmark-file /path/to/benchmark.json --disable-crash-handler ç¦ç”¨å´©æºƒå¤„ç†å™¨ã€‚\n1 godot --disable-crash-handler --single-threaded-scene ä½¿ç”¨å•çº¿ç¨‹åœºæ™¯å¤„ç†ã€‚\n1 godot --single-threaded-scene --disable-render-loop ç¦ç”¨æ¸²æŸ“å¾ªç¯ã€‚\n1 godot --disable-render-loop --text-driver \u0026lt;driver\u0026gt; æŒ‡å®šæ–‡æœ¬é©±åŠ¨ã€‚\n1 godot --text-driver \u0026lt;driver_name\u0026gt; --editor-pid \u0026lt;pid\u0026gt; æŒ‡å®šç¼–è¾‘å™¨è¿›ç¨‹ IDï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰ã€‚\n1 godot --editor-pid 1234 --editor-pseudolocalization å¯ç”¨ç¼–è¾‘å™¨ä¼ªæœ¬åœ°åŒ–ã€‚\n1 godot --editor-pseudolocalization --generate-spirv-debug-info ç”Ÿæˆ SPIR-V è°ƒè¯•ä¿¡æ¯ã€‚\n1 godot --generate-spirv-debug-info --extra-gpu-memory-tracking å¯ç”¨é¢å¤–çš„ GPU å†…å­˜è·Ÿè¸ªã€‚\n1 godot --extra-gpu-memory-tracking --accurate-breadcrumbs å¯ç”¨å‡†ç¡®çš„é¢åŒ…å±‘è·Ÿè¸ªã€‚\n1 godot --accurate-breadcrumbs --gpu-abort åœ¨ GPU é”™è¯¯æ—¶ä¸­æ­¢ã€‚\n1 godot --gpu-abort --debug-server \u0026lt;uri\u0026gt; å¯åŠ¨è°ƒè¯•æœåŠ¡å™¨ã€‚\n1 godot --debug-server tcp://127.0.0.1:6007 --patches \u0026lt;list\u0026gt; æŒ‡å®šè¡¥ä¸åˆ—è¡¨ã€‚\n1 godot --patches patch1.pck,patch2.pck --language \u0026lt;locale\u0026gt; è®¾ç½®ç•Œé¢è¯­è¨€ã€‚\n1 godot --language zh_CN -- åœæ­¢è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œåç»­å‚æ•°å°†ä¼ é€’ç»™é¡¹ç›®ã€‚\n1 godot -- --custom-arg value ++ åœæ­¢è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œåç»­å‚æ•°å°†ä½œä¸ºç”¨æˆ·å‚æ•°ä¼ é€’ã€‚\n1 godot ++ --user-arg value å¸¸ç”¨ç»„åˆç¤ºä¾‹ 1. å¼€å‘è°ƒè¯• 1 godot --path /path/to/project --editor --verbose è¯´æ˜ï¼šå¯åŠ¨ç¼–è¾‘å™¨å¹¶å¯ç”¨è¯¦ç»†è¾“å‡ºï¼Œé€‚åˆæ—¥å¸¸å¼€å‘å·¥ä½œã€‚\nä½¿ç”¨åœºæ™¯ï¼š\næ—¥å¸¸æ¸¸æˆå¼€å‘ æ–°åŠŸèƒ½å¼€å‘ é—®é¢˜è°ƒè¯•å’Œä¿®å¤ æœ€ä½³å®è·µï¼š\nå¼€å‘é˜¶æ®µå§‹ç»ˆä½¿ç”¨ --verbose è·å–æ›´å¤šä¿¡æ¯ ç¡®ä¿é¡¹ç›®è·¯å¾„æ­£ç¡® ç»“åˆ IDE çš„è°ƒè¯•åŠŸèƒ½ä½¿ç”¨ 2. æ¸¸æˆæµ‹è¯• 1 godot --path /path/to/project --debug --remote-debug tcp://127.0.0.1:6007 è¯´æ˜ï¼šä»¥è°ƒè¯•æ¨¡å¼è¿è¡Œæ¸¸æˆå¹¶å¯ç”¨è¿œç¨‹è°ƒè¯•ï¼Œé€‚åˆåŠŸèƒ½æµ‹è¯•ã€‚\nä½¿ç”¨åœºæ™¯ï¼š\næ¸¸æˆåŠŸèƒ½æµ‹è¯• è„šæœ¬è°ƒè¯• é€»è¾‘éªŒè¯ æœ€ä½³å®è·µï¼š\næµ‹è¯•å‰ç¡®ä¿è°ƒè¯•æœåŠ¡å™¨é…ç½®æ­£ç¡® ä½¿ç”¨ IDE è¿æ¥åˆ°è°ƒè¯•æœåŠ¡å™¨ æµ‹è¯•å®ŒæˆååŠæ—¶å…³é—­è°ƒè¯•æ¨¡å¼ 3. æ€§èƒ½åˆ†æ 1 godot --path /path/to/project --profiling --profile-gpu --max-fps 60 è¯´æ˜ï¼šå¯ç”¨å…¨é¢çš„æ€§èƒ½åˆ†æï¼ŒåŒ…æ‹¬ CPU å’Œ GPU æ€§èƒ½æ•°æ®æ”¶é›†ã€‚\nä½¿ç”¨åœºæ™¯ï¼š\næ€§èƒ½ç“¶é¢ˆåˆ†æ ä¼˜åŒ–å‰åçš„æ€§èƒ½å¯¹æ¯” å¸§ç‡ç¨³å®šæ€§æµ‹è¯• æœ€ä½³å®è·µï¼š\nåœ¨ä¸€è‡´çš„ç¯å¢ƒä¸­è¿›è¡Œæ€§èƒ½æµ‹è¯• è®°å½•æµ‹è¯•æ¡ä»¶ä»¥ä¾¿ç»“æœå¯¹æ¯” ç»“åˆ --quit-after è¿›è¡Œå›ºå®šæ—¶é•¿çš„æµ‹è¯• 4. æ— å¤´æœåŠ¡å™¨ 1 godot --path /path/to/project --headless --dedicated-server è¯´æ˜ï¼šä»¥æ— å¤´æ¨¡å¼è¿è¡Œä¸“ç”¨æœåŠ¡å™¨ï¼Œé€‚åˆéƒ¨ç½²åˆ°æœåŠ¡å™¨ç¯å¢ƒã€‚\nä½¿ç”¨åœºæ™¯ï¼š\nå¤šäººæ¸¸æˆæœåŠ¡å™¨ CI/CD ç¯å¢ƒä¸­çš„è‡ªåŠ¨åŒ–æµ‹è¯• äº‘æœåŠ¡å™¨éƒ¨ç½² æœ€ä½³å®è·µï¼š\nç¡®ä¿é¡¹ç›®é…ç½®æ”¯æŒæœåŠ¡å™¨æ¨¡å¼ ä½¿ç”¨ --log-file è®°å½•æœåŠ¡å™¨æ—¥å¿— é…ç½®é€‚å½“çš„èµ„æºé™åˆ¶å’Œç›‘æ§ 5. è‡ªåŠ¨å¯¼å‡º 1 godot --headless --path /path/to/project --export-release \u0026#34;Windows Desktop\u0026#34; game.exe è¯´æ˜ï¼šä»¥æ— å¤´æ¨¡å¼å¯¼å‡ºå‘å¸ƒç‰ˆæœ¬ï¼Œé€‚åˆ CI/CD ç®¡é“ä¸­çš„è‡ªåŠ¨æ„å»ºã€‚\nä½¿ç”¨åœºæ™¯ï¼š\nCI/CD è‡ªåŠ¨åŒ–æ„å»º æ‰¹é‡å¯¼å‡ºå¤šä¸ªå¹³å° å®šæœŸæ„å»ºéªŒè¯ æœ€ä½³å®è·µï¼š\nå§‹ç»ˆä½¿ç”¨ --headless é¿å…çª—å£å¹²æ‰° ç¡®ä¿å¯¼å‡ºæ¨¡æ¿å·²å®‰è£… éªŒè¯å¯¼å‡ºé¢„è®¾åç§°çš„æ­£ç¡®æ€§ ä½¿ç”¨ç»å¯¹è·¯å¾„é¿å…è·¯å¾„é—®é¢˜ 6. è§†é¢‘å½•åˆ¶ 1 godot --path /path/to/project --write-movie demo.avi --fixed-fps 60 --quit-after 300 è¯´æ˜ï¼šå½•åˆ¶æ¸¸æˆè§†é¢‘ï¼Œå›ºå®šå¸§ç‡ç¡®ä¿è§†é¢‘è´¨é‡ï¼Œé™åˆ¶å½•åˆ¶æ—¶é•¿ã€‚\nä½¿ç”¨åœºæ™¯ï¼š\næ¸¸æˆå®£ä¼ è§†é¢‘åˆ¶ä½œ æ¼”ç¤ºè§†é¢‘å½•åˆ¶ Bug å¤ç°è§†é¢‘ æœ€ä½³å®è·µï¼š\nä½¿ç”¨ --fixed-fps ç¡®ä¿è§†é¢‘å¸§ç‡ä¸€è‡´ ä½¿ç”¨ --quit-after æ§åˆ¶å½•åˆ¶æ—¶é•¿ é€‰æ‹©é€‚å½“çš„è§†é¢‘æ ¼å¼å’Œå‹ç¼©è®¾ç½® ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ 7. åŸºå‡†æµ‹è¯• 1 godot --path /path/to/project --benchmark --benchmark-file benchmark.json --max-fps 60 --quit-after 600 è¯´æ˜ï¼šè¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œç»“æœä¿å­˜åˆ° JSON æ–‡ä»¶ä¾¿äºåˆ†æã€‚\nä½¿ç”¨åœºæ™¯ï¼š\næ€§èƒ½å›å½’æµ‹è¯• ä¸åŒç‰ˆæœ¬çš„æ€§èƒ½å¯¹æ¯” ç¡¬ä»¶æ€§èƒ½è¯„ä¼° æœ€ä½³å®è·µï¼š\nåœ¨ä¸€è‡´çš„æµ‹è¯•ç¯å¢ƒä¸­è¿è¡Œ ä½¿ç”¨å›ºå®šå¸§ç‡ç¡®ä¿ç»“æœå¯æ¯”æ€§ ä¿å­˜åŸºå‡†æµ‹è¯•ç»“æœç”¨äºå†å²å¯¹æ¯” å®šæœŸè¿è¡Œä»¥ç›‘æ§æ€§èƒ½å˜åŒ– 8. CI/CD å®Œæ•´æ„å»ºæµæ°´çº¿ 1 2 3 4 5 6 7 8 9 10 # æ­¥éª¤1ï¼šéªŒè¯é¡¹ç›®é…ç½® godot --headless --path /path/to/project --quit --verbose # æ­¥éª¤2ï¼šè¿è¡Œæµ‹è¯• godot --headless --path /path/to/project --script tests/run_tests.gd --quit # æ­¥éª¤3ï¼šå¯¼å‡ºå¤šå¹³å°ç‰ˆæœ¬ godot --headless --path /path/to/project --export-release \u0026#34;Windows Desktop\u0026#34; builds/game.exe godot --headless --path /path/to/project --export-release \u0026#34;Linux/X11\u0026#34; builds/game.x86_64 godot --headless --path /path/to/project --export-release \u0026#34;macOS\u0026#34; builds/game.zip è¯´æ˜ï¼šå®Œæ•´çš„ CI/CD æ„å»ºæµç¨‹ï¼ŒåŒ…æ‹¬éªŒè¯ã€æµ‹è¯•å’Œå¯¼å‡ºã€‚\nä½¿ç”¨åœºæ™¯ï¼š\nè‡ªåŠ¨åŒ–æ„å»ºå’Œéƒ¨ç½² å¤šå¹³å°å‘å¸ƒ æŒç»­é›†æˆéªŒè¯ æœ€ä½³å®è·µï¼š\næ¯ä¸ªæ­¥éª¤ç‹¬ç«‹éªŒè¯ ä½¿ç”¨é€‚å½“çš„é”™è¯¯å¤„ç† è®°å½•æ„å»ºæ—¥å¿—ç”¨äºé—®é¢˜æ’æŸ¥ è®¾ç½®æ„å»ºé€šçŸ¥å’ŒæŠ¥å‘Š æ³¨æ„äº‹é¡¹ å‚æ•°ä½¿ç”¨åŸåˆ™ å‚æ•°é¡ºåºï¼šæŸäº›å‚æ•°çš„é¡ºåºå¾ˆé‡è¦ï¼Œç‰¹åˆ«æ˜¯è·¯å¾„ç›¸å…³å‚æ•°ã€‚\n--path åº”è¯¥åœ¨å…¶ä»–éœ€è¦é¡¹ç›®ä¸Šä¸‹æ–‡çš„å‚æ•°ä¹‹å‰ --headless é€šå¸¸æ”¾åœ¨å‰é¢ä»¥é¿å…ä¸å¿…è¦çš„åˆå§‹åŒ– åœºæ™¯æ–‡ä»¶è·¯å¾„åº”è¯¥åœ¨æœ€å å¹³å°å·®å¼‚ï¼šéƒ¨åˆ†å‚æ•°ä»…åœ¨ç‰¹å®šå¹³å°ä¸Šå¯ç”¨ã€‚\nmacOS éœ€è¦ä½¿ç”¨ .app åŒ…å†…çš„å¯æ‰§è¡Œæ–‡ä»¶ Windows å’Œ Linux å¯ä»¥ç›´æ¥è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ ç§»åŠ¨å¹³å°çš„å‚æ•°æ”¯æŒæœ‰é™ ç‰ˆæœ¬å…¼å®¹æ€§ï¼šä¸åŒç‰ˆæœ¬çš„ Godot å¯èƒ½æ”¯æŒä¸åŒçš„å‚æ•°ã€‚\næ–°ç‰ˆæœ¬å¯èƒ½æ·»åŠ æ–°å‚æ•°æˆ–åºŸå¼ƒæ—§å‚æ•° æŸäº›å‚æ•°çš„è¡Œä¸ºå¯èƒ½åœ¨ä¸åŒç‰ˆæœ¬é—´æœ‰å·®å¼‚ å»ºè®®æŸ¥çœ‹å¯¹åº”ç‰ˆæœ¬çš„å®˜æ–¹æ–‡æ¡£ æ€§èƒ½è€ƒè™‘ æ€§èƒ½å½±å“ï¼šè°ƒè¯•å’Œæ€§èƒ½åˆ†æå‚æ•°å¯èƒ½ä¼šæ˜¾è‘—å½±å“è¿è¡Œæ€§èƒ½ã€‚\n--debug ä¼šé™ä½è¿è¡Œæ€§èƒ½ï¼Œä»…ç”¨äºå¼€å‘é˜¶æ®µ --profiling å’Œ --profile-gpu ä¼šå¢åŠ å¼€é”€ --verbose ä¼šäº§ç”Ÿå¤§é‡è¾“å‡ºï¼Œå½±å“ I/O æ€§èƒ½ å‘å¸ƒç‰ˆæœ¬ä¸­ç¦ç”¨æ‰€æœ‰è°ƒè¯•å‚æ•° èµ„æºç®¡ç†ï¼šæŸäº›å‚æ•°ä¼šå½±å“å†…å­˜å’Œèµ„æºä½¿ç”¨ã€‚\n--extra-gpu-memory-tracking ä¼šå¢åŠ å†…å­˜ä½¿ç”¨ --write-movie éœ€è¦å¤§é‡ç£ç›˜ç©ºé—´ --profiling ä¼šæ”¶é›†å¤§é‡æ•°æ® å®‰å…¨è€ƒè™‘ å®‰å…¨è€ƒè™‘ï¼šè¿œç¨‹è°ƒè¯•å’Œæ–‡ä»¶ç³»ç»Ÿå‚æ•°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åº”è°¨æ…ä½¿ç”¨ã€‚ --remote-debug å¯èƒ½æš´éœ²å®‰å…¨æ¼æ´ --remote-fs æ¶‰åŠç½‘ç»œæ–‡ä»¶ç³»ç»Ÿè®¿é—® é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒå¯ç”¨è°ƒè¯•åŠŸèƒ½ ä½¿ç”¨é˜²ç«å¢™é™åˆ¶è°ƒè¯•ç«¯å£è®¿é—® å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ è·¯å¾„é—®é¢˜ï¼š\nä½¿ç”¨ç»å¯¹è·¯å¾„é¿å…ç›¸å¯¹è·¯å¾„é—®é¢˜ Windows è·¯å¾„ä½¿ç”¨åæ–œæ ï¼ŒUnix ä½¿ç”¨æ­£æ–œæ  ç¡®ä¿è·¯å¾„ä¸­ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦æˆ–ç©ºæ ¼ï¼ˆæˆ–ä½¿ç”¨å¼•å·ï¼‰ æƒé™é—®é¢˜ï¼š\nç¡®ä¿å¯¹é¡¹ç›®ç›®å½•æœ‰è¯»å†™æƒé™ æ£€æŸ¥æ—¥å¿—æ–‡ä»¶çš„å†™å…¥æƒé™ æŸäº›å‚æ•°å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™ å…¼å®¹æ€§é—®é¢˜ï¼š\næ£€æŸ¥ Godot ç‰ˆæœ¬ä¸é¡¹ç›®å…¼å®¹æ€§ ç¡®ä¿å¯¼å‡ºæ¨¡æ¿ç‰ˆæœ¬åŒ¹é… éªŒè¯ä¾èµ–é¡¹å’Œæ’ä»¶å…¼å®¹æ€§ ç¯å¢ƒé…ç½®ï¼š\nç¡®ä¿ç³»ç»Ÿç¯å¢ƒå˜é‡æ­£ç¡®è®¾ç½® æ£€æŸ¥å›¾å½¢é©±åŠ¨ç¨‹åºå…¼å®¹æ€§ éªŒè¯éŸ³é¢‘é©±åŠ¨å¯ç”¨æ€§ æœ€ä½³å®è·µæ€»ç»“ å¼€å‘ç¯å¢ƒï¼š\nä½¿ç”¨ --verbose è·å–è¯¦ç»†ä¿¡æ¯ å¯ç”¨é€‚å½“çš„è°ƒè¯•å‚æ•° ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†é¡¹ç›® æµ‹è¯•ç¯å¢ƒï¼š\næ¨¡æ‹Ÿç›®æ ‡ç¯å¢ƒé…ç½® ä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ è®°å½•æµ‹è¯•ç»“æœå’Œæ€§èƒ½æ•°æ® ç”Ÿäº§ç¯å¢ƒï¼š\nç¦ç”¨æ‰€æœ‰è°ƒè¯•å‚æ•° ä½¿ç”¨ --quiet å‡å°‘æ—¥å¿—è¾“å‡º é…ç½®é€‚å½“çš„æ—¥å¿—è½®è½¬ CI/CD ç¯å¢ƒï¼š\nå§‹ç»ˆä½¿ç”¨ --headless é…ç½®é€‚å½“çš„è¶…æ—¶æ—¶é—´ ä½¿ç”¨æ˜ç¡®çš„é”™è¯¯å¤„ç† æ€§èƒ½ä¼˜åŒ–ï¼š\nå®šæœŸè¿›è¡Œæ€§èƒ½åˆ†æ ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ å»ºç«‹æ€§èƒ½åŸºå‡†çº¿ æºç è§£æ ä»¥ä¸‹æ˜¯ Godot 4.4 æºç ä¸­å…³é”®å¯åŠ¨å‚æ•°çš„å¤„ç†é€»è¾‘ç²¾ç®€ç‰ˆï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 Error Main::setup(const char *execpath, int argc, char *argv[], bool p_second_phase) { // ... // å‘½ä»¤è¡Œå‚æ•°è§£æå¾ªç¯ while (I) { List\u0026lt;String\u0026gt;::Element *N = I-\u0026gt;next(); const String \u0026amp;arg = I-\u0026gt;get(); // 1. --help å‚æ•°å¤„ç† if (arg == \u0026#34;-h\u0026#34; || arg == \u0026#34;--help\u0026#34; || arg == \u0026#34;/?\u0026#34;) { show_help = true; exit_err = ERR_HELP; // å¼ºåˆ¶æ—©æœŸé€€å‡ºï¼Œè¿”å›æˆåŠŸä»£ç  goto error; } // 2. --remote-debug å‚æ•°å¤„ç† else if (arg == \u0026#34;--remote-debug\u0026#34;) { if (N) { debug_uri = N-\u0026gt;get(); if (!debug_uri.contains(\u0026#34;://\u0026#34;)) { // éªŒè¯åœ°å€æ ¼å¼ OS::get_singleton()-\u0026gt;print( \u0026#34;Invalid debug host address, it should be of the form \u0026lt;protocol\u0026gt;://\u0026lt;host/IP\u0026gt;:\u0026lt;port\u0026gt;.\\n\u0026#34;); goto error; } N = N-\u0026gt;next(); } else { OS::get_singleton()-\u0026gt;print(\u0026#34;Missing remote debug host address, aborting.\\n\u0026#34;); goto error; } } // 3. --max-fps å‚æ•°å¤„ç† else if (arg == \u0026#34;--max-fps\u0026#34;) { if (N) { max_fps = N-\u0026gt;get().to_int(); N = N-\u0026gt;next(); } else { OS::get_singleton()-\u0026gt;print(\u0026#34;Missing maximum FPS argument, aborting.\\n\u0026#34;); goto error; } } // 4. --time-scale å‚æ•°å¤„ç† ä»¥åŠå®ç° else if (arg == \u0026#34;--time-scale\u0026#34;) { if (N) { // è®¾ç½®æ—¶é—´ç¼©æ”¾ Engine::get_singleton()-\u0026gt;set_time_scale(N-\u0026gt;get().to_float()); N = N-\u0026gt;next(); } else { OS::get_singleton()-\u0026gt;print(\u0026#34;Missing time scale argument, aborting.\\n\u0026#34;); goto error; } } I = N; //1. --help çš„å®ç° if (show_help) { print_help(execpath); } // 2. --remote-debug çš„å®ç° EngineDebugger::initialize(debug_uri, skip_breakpoints, breakpoints, []() { if (editor_pid) { DisplayServer::get_singleton()-\u0026gt;enable_for_stealing_focus(editor_pid); } }); // 3. --max-fps çš„å®ç° Engine::get_singleton()-\u0026gt;set_max_fps(GLOBAL_DEF(PropertyInfo(Variant::INT, \u0026#34;application/run/max_fps\u0026#34;, PROPERTY_HINT_RANGE, \u0026#34;0,1000,1\u0026#34;), 0)); if (max_fps \u0026gt;= 0) { Engine::get_singleton()-\u0026gt;set_max_fps(max_fps); } } } æ€»ç»“ Godot 4.4 çš„å¯åŠ¨å‚æ•°æä¾›äº†å¯¹å¼•æ“å„ä¸ªæ–¹é¢çš„ç²¾ç»†æ§åˆ¶ï¼Œä»åŸºæœ¬çš„è¿è¡Œæ¨¡å¼åˆ°é«˜çº§çš„è°ƒè¯•å’Œæ€§èƒ½åˆ†æåŠŸèƒ½ã€‚åˆç†ä½¿ç”¨è¿™äº›å‚æ•°å¯ä»¥å¤§å¤§æé«˜å¼€å‘æ•ˆç‡å’Œè°ƒè¯•èƒ½åŠ›ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„å‚æ•°ç»„åˆï¼Œå¹¶æ³¨æ„å‚æ•°ä¹‹é—´çš„ç›¸äº’å½±å“ã€‚\n","date":"2025-12-20T09:18:31+08:00","image":"https://Liyufei1.github.io/godot.png","permalink":"https://Liyufei1.github.io/p/godot%E4%B8%83godot%E7%9A%84%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0/","title":"ã€godotã€‘ä¸ƒã€godotçš„å¯åŠ¨å‚æ•°"},{"content":"iFlow CLI ä½¿ç”¨å’Œéƒ¨ç½²å®Œæ•´æ•™ç¨‹ iFlowåˆæ­¥è®¤è¯† iFlow CLI æ˜¯ä¸€æ¬¾ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œçš„å¼ºå¤§ AI åŠ©æ‰‹ã€‚å®ƒèƒ½å¤Ÿæ— ç¼åˆ†æä»£ç ä»“åº“ã€æ‰§è¡Œç¼–ç¨‹ä»»åŠ¡ã€ç†è§£ä¸Šä¸‹æ–‡éœ€æ±‚ï¼Œé€šè¿‡è‡ªåŠ¨åŒ–å¤„ç†ä»ç®€å•çš„æ–‡ä»¶æ“ä½œåˆ°å¤æ‚çš„å·¥ä½œæµç¨‹ï¼Œå…¨é¢æå‡æ‚¨çš„å·¥ä½œæ•ˆç‡ã€‚\næ ¸å¿ƒç‰¹æ€§ å…è´¹ AI æ¨¡å‹ï¼šé€šè¿‡ å¿ƒæµå¼€æ”¾å¹³å° è®¿é—®å¼ºå¤§çš„å…è´¹ AI æ¨¡å‹ï¼ŒåŒ…æ‹¬ Kimi K2ã€Qwen3 Coderã€DeepSeek v3 ç­‰ çµæ´»é›†æˆï¼šä¿ç•™ä½ å–œæ¬¢çš„å¼€å‘å·¥å…·ï¼Œä¹Ÿå¯é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿå®ç°è‡ªåŠ¨åŒ– è‡ªç„¶è¯­è¨€äº¤äº’ï¼šå‘Šåˆ«å¤æ‚å‘½ä»¤ï¼Œç”¨æ—¥å¸¸å¯¹è¯é©±åŠ¨ AIï¼Œä»ä»£ç å¼€å‘åˆ°ç”Ÿæ´»åŠ©ç† å¼€æ”¾å¹³å°ï¼šä»å¿ƒæµå¼€æ”¾å¸‚åœºä¸­å¯ä»¥ä¸€é”®å®‰è£…SubAgentå’ŒMCPï¼Œå¿«é€Ÿæ‰©å±•æ™ºèƒ½ä½“ï¼Œç»„å»ºåªå±äºä½ çš„AIå›¢é˜Ÿ æ ¸å¿ƒåŠŸèƒ½ æ”¯æŒ4ç§è¿è¡Œæ¨¡å¼ï¼šyoloæ¨¡å¼ï¼ˆæ¨¡å‹æ‹¥æœ‰æœ€å¤§æƒé™ï¼Œå¯æ‰§è¡Œä»»ä½•æ“ä½œï¼‰ã€æ¥å—ç¼–è¾‘æ¨¡å¼ï¼ˆæ¨¡å‹ä»…æ‹¥æœ‰æ–‡ä»¶ä¿®æ”¹æƒé™ï¼‰ã€è®¡åˆ’æ¨¡å¼ï¼ˆå…ˆè®¡åˆ’åæ‰§è¡Œï¼‰ã€é»˜è®¤æ¨¡å¼ï¼ˆæ¨¡å‹æ— æƒé™ï¼‰ å‡çº§subAgentåŠŸèƒ½ï¼šå°†CLIä»é€šç”¨åŠ©æ‰‹è½¬å˜ä¸ºä¸“å®¶å›¢é˜Ÿï¼Œæä¾›æ›´ä¸“ä¸šå‡†ç¡®çš„å»ºè®®ã€‚ä½¿ç”¨ /agent æŸ¥çœ‹æ›´å¤šé¢„é…ç½®ä»£ç† å‡çº§taskå·¥å…·ï¼šæœ‰æ•ˆå‹ç¼©ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œè®©CLIæ›´å½»åº•åœ°å®Œæˆæ‚¨çš„ä»»åŠ¡ã€‚å½“ä¸Šä¸‹æ–‡è¾¾åˆ°70%æ—¶è‡ªåŠ¨å‹ç¼© é›†æˆå¿ƒæµå¼€æ”¾å¸‚åœºï¼šå¿«é€Ÿå®‰è£…æœ‰ç”¨çš„MCPå·¥å…·ã€Subagentså’Œè‡ªå®šä¹‰æŒ‡ä»¤ã€‚ä½¿ç”¨ /mcp äº†è§£æ›´å¤š å…è´¹å¤šæ¨¡æ€æ¨¡å‹ä½¿ç”¨ï¼šç°åœ¨æ‚¨ä¹Ÿå¯ä»¥åœ¨CLIä¸­ç²˜è´´å›¾ç‰‡äº†ï¼ˆCtrl+Vç²˜è´´å›¾ç‰‡ï¼‰ æ”¯æŒå¯¹è¯å†å²ä¿å­˜å’Œå›æ»šï¼ˆiflow \u0026ndash;resume å’Œ /chat å‘½ä»¤ï¼‰ æ”¯æŒæ›´å¤šæœ‰ç”¨çš„ç»ˆç«¯å‘½ä»¤ï¼ˆiflow -h æŸ¥çœ‹æ›´å¤šå‘½ä»¤ï¼‰ VSCodeæ’ä»¶æ”¯æŒ è‡ªåŠ¨å‡çº§ï¼šiFlow CLIè‡ªåŠ¨æ£€æµ‹å½“å‰ç‰ˆæœ¬æ˜¯å¦ä¸ºæœ€æ–°ç‰ˆæœ¬ æ›´å¤šä½¿ç”¨æ•™ç¨‹è¯·è®¿é—®ï¼šiFlowå¹³å°\nWindowså¹³å°çš„å®‰è£…éƒ¨ç½² ç³»ç»Ÿè¦æ±‚ æ“ä½œç³»ç»Ÿï¼šWindows 10+ï¼ˆä½¿ç”¨ WSL 1ã€WSL 2 æˆ– Git for Windowsï¼‰ ç¡¬ä»¶ï¼š4GB+ å†…å­˜ è½¯ä»¶ï¼šNode.js 22+ ç½‘ç»œï¼šéœ€è¦äº’è”ç½‘è¿æ¥ç”¨äºèº«ä»½éªŒè¯å’Œ AI å¤„ç† Shellï¼šåœ¨ Bashã€Zsh æˆ– Fish ä¸­æ•ˆæœæœ€ä½³ å®‰è£…æ­¥éª¤ æ–¹æ³•ä¸€ï¼šæ ‡å‡†å®‰è£… è®¿é—® Node.jså®˜ç½‘ ä¸‹è½½æœ€æ–°çš„ Node.js å®‰è£…ç¨‹åº è¿è¡Œå®‰è£…ç¨‹åºæ¥å®‰è£… Node.js é‡å¯ç»ˆç«¯ï¼šCMD æˆ– PowerShell è¿è¡Œ npm install -g @iflow-ai/iflow-cli æ¥å®‰è£… iFlow CLI è¿è¡Œ iflow æ¥å¯åŠ¨ iFlow CLI æ–¹æ³•äºŒï¼šä¸­å›½å¤§é™†ç”¨æˆ·ä¸“ç”¨å®‰è£…ï¼ˆæ¨èï¼‰ å¦‚æœæ‚¨åœ¨ä¸­å›½å¤§é™†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… iFlow CLIï¼š\nè®¿é—® iFlow CLI nvmå®‰è£…åŒ… ä¸‹è½½æœ€æ–°çš„ nvm å®‰è£…ç¨‹åº è¿è¡Œå®‰è£…ç¨‹åºæ¥å®‰è£… nvm é‡å¯ç»ˆç«¯ï¼šCMD æˆ– PowerShell è¿è¡Œ nvm node_mirror https://npmmirror.com/mirrors/node/ å’Œ nvm npm_mirror https://npmmirror.com/mirrors/npm/ è¿è¡Œ nvm install 22 æ¥å®‰è£… Node.js 22ï¼Œç¨ç­‰ç‰‡åˆ» è¿è¡Œ nvm use 22 æ¥ä½¿ç”¨ Node.js 22 è¿è¡Œ npm install -g @iflow-ai/iflow-cli æ¥å®‰è£… iFlow CLI è¿è¡Œ iflow æ¥å¯åŠ¨ iFlow CLI éªŒè¯å®‰è£… å®‰è£…å®Œæˆåï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š\n1 iflow --version å¦‚æœæ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œåˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚\nç™»å½•å’Œä½¿ç”¨ iFlow CLIæä¾›ä¸¤ç§èº«ä»½éªŒè¯æ–¹å¼ï¼š\næ¨èæ–¹å¼ï¼šä½¿ç”¨ iFlow åŸç”Ÿèº«ä»½éªŒè¯ å¤‡é€‰æ–¹å¼ï¼šé€šè¿‡ OpenAI å…¼å®¹ API è¿æ¥ è·å– API Key è·å– API Keyçš„æ­¥éª¤ï¼š\næ³¨å†Œ iFlow è´¦æˆ· è¿›å…¥ä¸ªäººè®¾ç½®é¡µé¢æˆ–ç‚¹å‡»æ­¤ç›´è¾¾é“¾æ¥ åœ¨å¼¹å‡ºå¯¹è¯æ¡†ä¸­ç‚¹å‡»\u0026quot;é‡ç½®\u0026quot;ç”Ÿæˆæ–°çš„ API å¯†é’¥ ç”Ÿæˆå¯†é’¥åï¼Œå°†å…¶ç²˜è´´åˆ°ç»ˆç«¯æç¤ºç¬¦ä¸­å³å¯å®Œæˆè®¾ç½®ã€‚æ³¨æ„ï¼šåœ¨ Windows çš„ CMD æˆ–è€… PowerShell ä¸­ï¼Œè¯·ç‚¹å‡»å³é”®è¿›è¡Œç²˜è´´ã€‚\nå¿«é€Ÿå¼€å§‹ è¦å¯åŠ¨ iFlow CLIï¼Œè¯·åœ¨ç»ˆç«¯ä¸­å¯¼èˆªåˆ°æ‚¨çš„å·¥ä½œç©ºé—´å¹¶è¾“å…¥ï¼š\n1 iflow åˆ›å»ºæ–°é¡¹ç›® å¯¹äºæ–°é¡¹ç›®ï¼Œåªéœ€æè¿°æ‚¨æƒ³è¦åˆ›å»ºçš„å†…å®¹ï¼š\n1 2 3 cd new-project/ iflow \u0026gt; ä½¿ç”¨ HTML åˆ›å»ºä¸€ä¸ªåŸºäºç½‘é¡µçš„æˆ‘çš„ä¸–ç•Œæ¸¸æˆ å¤„ç†ç°æœ‰é¡¹ç›® å¯¹äºç°æœ‰ä»£ç åº“ï¼Œå»ºè®®å…ˆä½¿ç”¨ /init å‘½ä»¤å¸®åŠ© iFlow ç†è§£æ‚¨çš„é¡¹ç›®ï¼š\n1 2 3 4 cd project1/ iflow \u0026gt; /init \u0026gt; æ ¹æ® requirement.md æ–‡ä»¶ä¸­çš„ PRD æ–‡æ¡£åˆ†æéœ€æ±‚ï¼Œè¾“å‡ºæŠ€æœ¯æ–‡æ¡£ï¼Œç„¶åå®ç°è§£å†³æ–¹æ¡ˆã€‚ /init å‘½ä»¤ä¼šæ‰«ææ‚¨çš„ä»£ç åº“ï¼Œå­¦ä¹ å…¶ç»“æ„ï¼Œå¹¶åˆ›å»ºåŒ…å«å®Œæ•´æ–‡æ¡£çš„ IFLOW.md æ–‡ä»¶ã€‚\næœ‰å…³æ–œæ å‘½ä»¤çš„å®Œæ•´åˆ—è¡¨å’Œä½¿ç”¨è¯´æ˜ï¼Œè¯·æŸ¥çœ‹iFlowå‘½ä»¤æ–‡æ¡£ã€‚\nå¸è½½ å¦‚æœéœ€è¦å¸è½½ iFlow CLIï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 npm uninstall -g @iflow-ai/iflow-cli æ­¤å‘½ä»¤å°†å®Œå…¨ç§»é™¤ iFlow CLI åŠå…¶ç›¸å…³æ–‡ä»¶ã€‚\né¢å¤–æ¸…ç† å¦‚æœéœ€è¦å½»åº•æ¸…ç†æ‰€æœ‰ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åˆ é™¤ä»¥ä¸‹ç›®å½•ï¼š\nWindows: C:\\Users\\{ç”¨æˆ·å}\\.iflow é…ç½®æ–‡ä»¶: ~/.iflow/settings.json iFlowä¸­çš„\u0026rsquo;/\u0026lsquo;å‘½ä»¤å’Œä½¿ç”¨ç¤ºä¾‹ iFlow CLI æä¾›äº†ä¸°å¯Œçš„æ–œæ å‘½ä»¤ï¼ˆSlash Commandsï¼‰ï¼Œè¿™äº›å‘½ä»¤å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´é«˜æ•ˆåœ°æ§åˆ¶å’Œä½¿ç”¨AIåŠ©æ‰‹ã€‚æ–œæ å‘½ä»¤ä»¥ / å¼€å¤´ï¼Œå¯ä»¥å¿«é€Ÿæ‰§è¡Œç‰¹å®šåŠŸèƒ½ã€‚\nå¸¸ç”¨æ–œæ å‘½ä»¤ å‘½ä»¤ åŠŸèƒ½æè¿° ä½¿ç”¨ç¤ºä¾‹ é€‚ç”¨åœºæ™¯ /help æˆ– /? æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æ–œæ å‘½ä»¤åˆ—è¡¨å’Œå¸®åŠ©ä¿¡æ¯ \u0026gt; /help éœ€è¦æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤æ—¶ /init åˆ†æå½“å‰é¡¹ç›®ç»“æ„ï¼Œæ‰«æä»£ç åº“å¹¶ç”ŸæˆIFLOW.mdæ–‡æ¡£ï¼Œå¸®åŠ©iFlowæ›´å¥½åœ°ç†è§£æ‚¨çš„é¡¹ç›® \u0026gt; /init\n\u0026gt; æ­£åœ¨åˆ†æé¡¹ç›®ç»“æ„... é¡¹ç›®åˆå§‹åŒ–æ—¶ /chat ç®¡ç†å¯¹è¯å†å²ï¼ŒæŸ¥çœ‹ä¹‹å‰çš„å¯¹è¯è®°å½•æˆ–åˆ‡æ¢åˆ°ä¸åŒçš„å¯¹è¯ \u0026gt; /chat list # åˆ—å‡ºæ‰€æœ‰å¯¹è¯\n\u0026gt; /chat resume # æ¢å¤ä¹‹å‰çš„å¯¹è¯ ç®¡ç†å¯¹è¯å†å²æ—¶ /agent ä½¿ç”¨é¢„é…ç½®çš„ä¸“å®¶ä»£ç†ï¼ˆsubagentï¼‰æ¥å¤„ç†ç‰¹å®šé¢†åŸŸçš„ä»»åŠ¡ \u0026gt; /agent # æŸ¥çœ‹å¯ç”¨çš„ä»£ç†\n\u0026gt; /agent code # ä½¿ç”¨ä»£ç ä¸“å®¶ä»£ç† éœ€è¦ä¸“ä¸šé¢†åŸŸå¸®åŠ©æ—¶ /mcp è®¿é—®å¿ƒæµå¼€æ”¾å¸‚åœºä¸­çš„MCPï¼ˆModel Context Protocolï¼‰å·¥å…·ï¼Œæ‰©å±•iFlowçš„åŠŸèƒ½ \u0026gt; /mcp # æŸ¥çœ‹å¯ç”¨çš„MCPå·¥å…·\n\u0026gt; /mcp install # å®‰è£…MCPå·¥å…· æ‰©å±•åŠŸèƒ½æ—¶ /task ä½¿ç”¨ä»»åŠ¡ç®¡ç†å·¥å…·ï¼Œå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¯ç®¡ç†çš„å­ä»»åŠ¡ \u0026gt; /task create # åˆ›å»ºä»»åŠ¡åˆ—è¡¨\n\u0026gt; /task list # æŸ¥çœ‹ä»»åŠ¡è¿›åº¦ å¤„ç†å¤æ‚ä»»åŠ¡æ—¶ /plan è¿›å…¥è®¡åˆ’æ¨¡å¼ï¼Œå…ˆåˆ¶å®šè¯¦ç»†è®¡åˆ’å†æ‰§è¡Œä»»åŠ¡ï¼Œç¡®ä¿æ‰§è¡Œè¿‡ç¨‹æ›´åŠ å¯æ§ \u0026gt; /plan # è¿›å…¥è®¡åˆ’æ¨¡å¼ éœ€è¦å…ˆåˆ¶å®šè®¡åˆ’å†æ‰§è¡Œæ—¶ /yolo è¿›å…¥YOLOï¼ˆYou Only Live Onceï¼‰æ¨¡å¼ï¼Œèµ‹äºˆAIæ¨¡å‹æœ€å¤§æƒé™ï¼Œå¯æ‰§è¡Œä»»ä½•æ“ä½œ \u0026gt; /yolo # è¿›å…¥YOLOæ¨¡å¼ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ éœ€è¦AIå®Œå…¨è‡ªä¸»æ“ä½œæ—¶ /accept è¿›å…¥æ¥å—ç¼–è¾‘æ¨¡å¼ï¼ŒAIæ¨¡å‹ä»…æ‹¥æœ‰æ–‡ä»¶ä¿®æ”¹æƒé™ï¼Œæ›´å®‰å…¨ \u0026gt; /accept # è¿›å…¥æ¥å—ç¼–è¾‘æ¨¡å¼ éœ€è¦æ›´å®‰å…¨çš„æ“ä½œæ¨¡å¼æ—¶ /compact å‹ç¼©å¯¹è¯ä¸Šä¸‹æ–‡ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜å“åº”é€Ÿåº¦ \u0026gt; /compact # å‹ç¼©å¯¹è¯å†å² å¯¹è¯å†å²è¿‡é•¿æ—¶ /search æ‰§è¡Œç½‘ç»œæœç´¢ä»»åŠ¡ï¼Œè·å–å®æ—¶ä¿¡æ¯ \u0026gt; /search # æ‰§è¡Œæœç´¢ éœ€è¦è·å–å®æ—¶ä¿¡æ¯æ—¶ å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹ åœºæ™¯ å‘½ä»¤ç¤ºä¾‹ é¡¹ç›®åˆå§‹åŒ– \u0026gt; /init\n\u0026gt; åˆ†æé¡¹ç›®ç»“æ„åï¼Œç”Ÿæˆæ–‡æ¡£å¹¶æä¾›ä¼˜åŒ–å»ºè®®ã€‚ ä»£ç å®¡æŸ¥ \u0026gt; /agent code\n\u0026gt; å®¡æŸ¥å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ä»£ç æ–‡ä»¶ï¼Œæ‰¾å‡ºæ½œåœ¨é—®é¢˜ã€‚ ä»»åŠ¡åˆ†è§£ \u0026gt; /task create\n\u0026gt; è¯·å¸®æˆ‘å®ç°ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ï¼ŒåŒ…å«å‰ç«¯è¡¨å•ã€åç«¯æ¥å£å’Œæ•°æ®åº“è®¾è®¡ é«˜çº§æƒé™æ“ä½œ \u0026gt; /yolo\n\u0026gt; åˆ›å»ºæ–°é¡¹ç›®ç›®å½•ï¼Œå®‰è£…ä¾èµ–ï¼Œç”ŸæˆåŸºæœ¬ä»£ç ç»“æ„ è¿™äº›æ–œæ å‘½ä»¤æå¤§åœ°å¢å¼ºäº†iFlow CLIçš„åŠŸèƒ½æ€§ï¼Œè®©æ‚¨å¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶AIåŠ©æ‰‹çš„è¡Œä¸ºï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚æœ‰å…³æ–œæ å‘½ä»¤çš„å®Œæ•´åˆ—è¡¨å’Œæœ€æ–°åŠŸèƒ½ï¼Œè¯·æŸ¥çœ‹iFlowå‘½ä»¤æ–‡æ¡£ã€‚\nç»“è¯­ iFlow CLI æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¼€å‘åŠ©æ‰‹ï¼Œé€šè¿‡æœ¬æ•™ç¨‹ï¼Œæ‚¨åº”è¯¥å·²ç»æŒæ¡äº†å¦‚ä½•åœ¨ Windows å¹³å°ä¸Šå®‰è£…ã€ç™»å½•ä½¿ç”¨å’Œå¸è½½ iFlow CLIã€‚æ›´å¤šé«˜çº§åŠŸèƒ½å’Œä½¿ç”¨æŠ€å·§ï¼Œè¯·è®¿é—®å®˜æ–¹æ–‡æ¡£ï¼šiFlow CLI GitHubä»“åº“\nå¦‚éœ€åŠ å…¥ç¤¾åŒºäº¤æµï¼Œå¯ä»¥æ‰«æå®˜æ–¹å¾®ä¿¡ç¾¤äºŒç»´ç ï¼šiFlowå¾®ä¿¡ç¤¾åŒº\n","date":"2025-12-09T10:00:00+08:00","image":"https://Liyufei1.github.io/AI.png","permalink":"https://Liyufei1.github.io/p/iflow-cli-%E4%BD%BF%E7%94%A8%E5%92%8C%E9%83%A8%E7%BD%B2%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B/","title":"iFlow CLI ä½¿ç”¨å’Œéƒ¨ç½²å®Œæ•´æ•™ç¨‹"},{"content":"æ¦‚è¿° å¯¹äºè¿½æ±‚æå®¢ç²¾ç¥çš„å°ä¼™ä¼´è€Œè¨€ï¼Œå¯¹godotç¼–è¾‘å™¨çš„æ”¹é€ æ— ç–‘æ˜¯ä¸€ä»¶éå¸¸é…·çš„äº‹æƒ…ã€‚å®ƒå¯ä»¥ä¸ºgodotç¼–è¾‘å™¨æ·»åŠ ä¸€äº›å®šåˆ¶åŒ–çš„æ“ä½œï¼Œç”¨äºæå‡å¼€å‘æ•ˆç‡ï¼ŒåŠ é€Ÿå·¥ç¨‹å®ç°ã€‚å¯¹äºæ³›ç”¨çš„ç¼–è¾‘å™¨åŠŸèƒ½æˆ–æ˜¯è‡ªå®šä¹‰åŠŸèƒ½ç±»çš„è°ƒå¼è¡¥å……ç•Œé¢ï¼Œåšæˆç¼–è¾‘å™¨æ’ä»¶æ˜¯éå¸¸ä¸é”™çš„ï¼Œæ¯”å¦‚ï¼šæ‰¹é‡çš„å®ä½“æ”¾ç½®ã€æ‰¹é‡çš„æè´¨å¤åˆ¶ã€æ›²çº¿çš„debugç»˜åˆ¶ç­‰ã€‚ éœ€è¦å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„ç¼–è¾‘å™¨æ’ä»¶ï¼Œä¼šæ¶‰åŠåˆ°ä¸‹æ–¹å‡ ä¸ªç±»ï¼š\nEditorNode:Godotç¼–è¾‘å™¨çš„æ ¸å¿ƒæ§åˆ¶ç±»,ç®¡ç†æ‰€æœ‰ç¼–è¾‘å™¨é¢æ¿/åœºæ™¯ç¼–è¾‘å™¨/æ–‡ä»¶æµè§ˆå™¨/è„šæœ¬ç¼–è¾‘å™¨/ç¼–è¾‘å™¨æ’ä»¶ç­‰,EditorPluginã€Node3DEditorã€CanvasItemEditor å’ŒEditorDockManageréƒ½é›†æˆåœ¨å®ƒçš„é‡Œé¢. EditorPluginï¼šGodotå†…ç½®çš„æ’ä»¶åŸºç±»ï¼Œæä¾›äº†ä¸ç¼–è¾‘å™¨è¿›è¡Œäº¤äº’çš„æ¥å£ã€‚ Node3DEditorï¼šGodotå†…ç½®3Dåœºæ™¯ç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯3Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ï¼ŒåŒ…æ‹¬äº†ï¼š3Dç‰©ä½“çš„é½æ¬¡çº¿æ€§å˜æ¢ã€å·¥å…·æ ã€Gizmoã€ç½‘æ ¼ç­‰ç­‰ã€‚ CanvasItemEditorï¼šGodotå†…ç½®2Dåœºæ™¯ç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯2Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ï¼ŒåŒ…æ‹¬äº†ï¼š2Dç‰©ä½“çš„å˜æ¢ã€å·¥å…·æ ç­‰ç­‰ã€‚ EditorDockManager: EditorPlugin EditorPluginæ˜¯Godotç¼–è¾‘å™¨æ’ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒç±»ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å¼€å‘æ’ä»¶çš„èµ·ç‚¹ã€‚\nğŸ‘‰åˆå§‹åŒ– 1 2 3 4 5 6 7 //åœ¨register_editor_types.cppä¸­æ³¨å†Œæ’ä»¶ EditorPlugins::add_by_type\u0026lt;LyfTestEditorPlugin\u0026gt;(); //åœ¨EditorDataçš„æ„é€ é˜¶æ®µ,å®é™…åˆ›å»ºå¹¶æ”¶é›†æ’ä»¶ for (int i = 0; i \u0026lt; EditorPlugins::get_plugin_count(); i++) { add_editor_plugin(EditorPlugins::create(i)); } ğŸ‘‰æ‰©å±• Godot ç¼–è¾‘å™¨ æˆ‘ä»¬å¯ä»¥å¯ä»¥æ·»åŠ å·¥å…·é¢æ¿ã€èœå•æŒ‰é’®ã€è‡ªå®šä¹‰æ£€æŸ¥å™¨ã€æ“ä½œ2D/3Dç¼–è¾‘å™¨(Node3DEditor/CanvasItemEditor)ç­‰ã€‚\nEditorPluginUIæ‹“å±•çš„å®ç°,ä¾èµ–å®é™…çš„å·¥ä½œç±»ï¼Œæ¯”å¦‚ï¼šNode3DEditorã€CanvasItemEditorã€EditorDockManagerã€‚å®ƒåªæ˜¯å¯¹å·¥ä½œç±»çš„æ¥å£è¿›è¡Œå°è£…ã€‚\næ¥å£ ä½œç”¨ add_control_to_container æ·»åŠ æ§ä»¶åˆ°æŒ‡å®šä½ç½® add_control_to_bottom_panel ç¼–è¾‘å™¨åº•éƒ¨é¢æ¿æ·»åŠ ä¸€ä¸ªæ–°çš„å·¥å…·é€‰é¡¹å¡ add_control_to_dock ç¼–è¾‘å™¨æ·»åŠ ä¸€ä¸ªå¯åœé çš„è‡ªå®šä¹‰é¢æ¿ add_tool_menu_item åœ¨å·¥å…·æ æ·»åŠ ä¸€ä¸ªèœå•é¡¹ add_control_to_container add_control_to_containerå­˜åœ¨å¤šä¸ªåœé ä½ç½®:\nCONTAINER_TOOLBAR : ä¸Šæ–¹å·¥å…·æ , CONTAINER_SPATIAL_EDITOR_MENU : 3Dè§†å£ä¸Šæ–¹èœå•æ  CONTAINER_SPATIAL_EDITOR_SIDE_LEFT : 3Dè§†å£å·¦æ–¹ CONTAINER_SPATIAL_EDITOR_SIDE_RIGHT : 3Dè§†å£å³æ–¹ CONTAINER_SPATIAL_EDITOR_BOTTOM : 3Dè§†å£ä¸‹æ–¹ CONTAINER_CANVAS_EDITOR_MENU : 2Dè§†å£ä¸Šæ–¹èœå•æ  CONTAINER_CANVAS_EDITOR_SIDE_LEFT : 2Dè§†å£å·¦æ–¹ CONTAINER_CANVAS_EDITOR_SIDE_RIGHT : 2Dè§†å£å³æ–¹ CONTAINER_CANVAS_EDITOR_BOTTOM : 2Dè§†å£ä¸‹æ–¹ CONTAINER_INSPECTOR_BOTTOM : æ£€æŸ¥å™¨ä¸‹æ–¹ CONTAINER_PROJECT_SETTING_TAB_LEFT : é¡¹ç›®è®¾ç½®å·¦ä¾§ CONTAINER_PROJECT_SETTING_TAB_RIGHT : é¡¹ç›®è®¾ç½®å³ä¾§ add_control_to_bottom_panel add_control_to_dock add_tool_menu_item ğŸ‘‰å¤„ç†ç”¨æˆ·é€‰ä¸­çš„å¯¹è±¡ ç¼–è¾‘å™¨æ¯æ¬¡é€‰ä¸­å¯¹è±¡æ—¶éƒ½ä¼šè°ƒç”¨ï¼šbool EditorPlugin::handles(Object *p_object)åˆ¤æ–­å½“å‰é€‰ä¸­çš„å¯¹è±¡æ˜¯å¦åº”è¯¥è¢«æ’ä»¶å¤„ç†ã€‚\nå½“æ’ä»¶å†³å®šâ€œæ¥ç®¡æŸå¯¹è±¡â€æ—¶ï¼Œä¼šè§¦å‘å¯¹è±¡è¿›å…¥/é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼š\nvoid EditorPlugin::make_visible(bool p_visible); è¿›å…¥æ—¶ï¼Œp_visibleä¸ºtrueï¼› é€€å‡ºæ—¶ï¼šp_visibleä¸ºfalse void EditorPlugin::edit(Object *p_object) è¿›å…¥æ—¶ï¼šp_objectä¸ºé€‰ä¸­çš„å¯¹è±¡ï¼› é€€å‡ºæ—¶ï¼šp_objectä¸ºnullptr 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //EditorPluginå­ç±»çš„åŸºæœ¬æ ·å¼ class LyfTestEditorPlugin : public EditorPlugin { GDCLASS(LyfTestEditorPlugin, EditorPlugin); // MeshInstance3DEditor *mesh_editor = nullptr; public: virtual String get_plugin_name() const override { return \u0026#34;LyfTestEditorPlugin\u0026#34;; } bool has_main_screen() const override { return false; } virtual bool handles(Object *p_object) const override; virtual void make_visible(bool p_visible) override; virtual void edit(Object *p_object) override; LyfTestEditorPlugin(); ~LyfTestEditorPlugin(); }; ğŸ‘‰æ·»åŠ ç‰¹å®šçš„ç¼–è¾‘å™¨æ’ä»¶ godotè¿˜å°è£…äº†ä¸€ç³»åˆ—å…·æœ‰å®Œæ•´åŠŸèƒ½çš„ç¼–è¾‘å™¨æ’ä»¶:\nEditorTranslationParserPluginï¼šç”¨äºè§£æç¿»è¯‘æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š.potæ–‡ä»¶ã€‚ EditorImportPlugin: èµ„æºå¯¼å…¥æ’ä»¶ï¼Œæ¯”å¦‚ï¼šè‡ªå®šä¹‰.fbxæ–‡ä»¶å¯¼å…¥ã€‚ EditorNode3DGizmoPlugin: ç”¨æ¥åœ¨3Dè§†å›¾é‡Œä¸ºæŸäº›Node3Dç±»å‹ç»˜åˆ¶è‡ªå®šä¹‰gizmoï¼ˆæ“ä½œæ‰‹æŸ„/å¯è§†è¾…åŠ©ï¼‰ EditorInspectorPlugin: æ£€æŸ¥å™¨å±æ€§ç¼–è¾‘æ’ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 void add_translation_parser_plugin(const Ref\u0026lt;EditorTranslationParserPlugin\u0026gt; \u0026amp;p_parser); void add_import_plugin(const Ref\u0026lt;EditorImportPlugin\u0026gt; \u0026amp;p_importer, bool p_first_priority = false); void add_export_plugin(const Ref\u0026lt;EditorExportPlugin\u0026gt; \u0026amp;p_exporter); void add_export_platform(const Ref\u0026lt;EditorExportPlatform\u0026gt; \u0026amp;p_platform); void add_node_3d_gizmo_plugin(const Ref\u0026lt;EditorNode3DGizmoPlugin\u0026gt; \u0026amp;p_gizmo_plugin); void add_inspector_plugin(const Ref\u0026lt;EditorInspectorPlugin\u0026gt; \u0026amp;p_plugin); void add_scene_format_importer_plugin(const Ref\u0026lt;EditorSceneFormatImporter\u0026gt; \u0026amp;p_importer, bool p_first_priority = false); void add_scene_post_import_plugin(const Ref\u0026lt;EditorScenePostImportPlugin\u0026gt; \u0026amp;p_importer, bool p_first_priority = false); void add_autoload_singleton(const String \u0026amp;p_name, const String \u0026amp;p_path); void add_debugger_plugin(const Ref\u0026lt;EditorDebuggerPlugin\u0026gt; \u0026amp;p_plugin); void add_resource_conversion_plugin(const Ref\u0026lt;EditorResourceConversionPlugin\u0026gt; \u0026amp;p_plugin); void add_context_menu_plugin(EditorContextMenuPlugin::ContextMenuSlot p_slot, const Ref\u0026lt;EditorContextMenuPlugin\u0026gt; \u0026amp;p_plugin); Node3DEditor Node3DEditoræ˜¯Godotå†…ç½®3Dåœºæ™¯ç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯3Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ï¼ŒåŒ…æ‹¬äº†ï¼šè§†å£ã€å·¥å…·æ ã€Gizmoã€ç½‘æ ¼ç­‰ç­‰ã€‚\nâœ”ï¸åˆå§‹åŒ– 1 2 //åœ¨EditorNodeçš„æ„é€ é˜¶æ®µ,åˆ›å»ºå¹¶æ³¨å†Œ add_editor_plugin(memnew(Node3DEditorPlugin)); âœ”ï¸UIæ‰©å±•ï¼šå¾€3Dç•Œé¢ç¼–è¾‘å™¨çš„ä¸Šä¸‹å·¦å³æ·»åŠ æ§ä»¶ æ¥å£ ä½œç”¨ add_control_to_menu_panel åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ add_control_to_left_panel åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ add_control_to_right_panel åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ get_shader_split è·å–è§†å£åº•éƒ¨çš„å®¹å™¨ç›’ 1 2 3 4 5 6 7 8 9 10 11 12 //ä½¿ç”¨ç¤ºä¾‹ //åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;add_control_to_menu_panel(p_control); //åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;add_control_to_left_panel(p_control); //åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;add_control_to_right_panel(p_control); //åœ¨è§†å£åº•éƒ¨æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;get_shader_split()-\u0026gt;add_child(p_control); Gizmoæ‰©å±•ï¼šæ·»åŠ è‡ªå®šä¹‰Gizmo CanvasItemEditor CanvasItemEditoræ˜¯Godotå†…ç½®2Dç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯2Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ã€‚\nUIæ‰©å±•ï¼šå¾€2Dç•Œé¢ç¼–è¾‘å™¨çš„ä¸Šä¸‹å·¦å³æ·»åŠ æ§ä»¶ æ¥å£ ä½œç”¨ add_control_to_menu_panel åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ add_control_to_left_panel åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ add_control_to_right_panel åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ get_bottom_split è·å–è§†å£åº•éƒ¨çš„å®¹å™¨ç›’ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //ä½¿ç”¨ç¤ºä¾‹ case CONTAINER_CANVAS_EDITOR_MENU: { //åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;add_control_to_menu_panel(p_control); } break; case CONTAINER_CANVAS_EDITOR_SIDE_LEFT: { //åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;add_control_to_left_panel(p_control); } break; case CONTAINER_CANVAS_EDITOR_SIDE_RIGHT: { //åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;add_control_to_right_panel(p_control); } break; case CONTAINER_CANVAS_EDITOR_BOTTOM: { //åœ¨è§†å£åº•éƒ¨æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;get_bottom_split()-\u0026gt;add_child(p_control); } break; ","date":"2025-11-20T09:18:31+08:00","image":"https://Liyufei1.github.io/godot.png","permalink":"https://Liyufei1.github.io/p/godot%E5%85%ADgodot%E4%B8%AD%E7%9A%84%E7%BC%96%E8%BE%91%E5%99%A8%E6%8F%92%E4%BB%B6editorplugin/","title":"ã€godotã€‘å…­ã€godotä¸­çš„ç¼–è¾‘å™¨æ’ä»¶EditorPlugin"},{"content":"æ¦‚è¿° åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼ŒåŠ¨æ€æ€§å’Œçµæ´»æ€§æ˜¯è‡³å…³é‡è¦çš„ç‰¹æ€§ã€‚pythonï¼ŒC#ï¼Œjavaç­‰ç¼–ç¨‹è¯­è¨€ï¼Œä»è¯­éŸ³å±‚é¢å°±æ˜¯æ”¯æŒåå°„æˆ–åŠ¨æ€ç±»å‹ç³»ç»Ÿçš„ï¼Œå¯ä»¥è¿è¡Œæ—¶åŠ¨æ€åœ°æŸ¥çœ‹å¯¹è±¡çš„ç±»å‹ã€æˆå‘˜ã€æ–¹æ³•ï¼Œç”šè‡³åŠ¨æ€è°ƒç”¨æˆ–ä¿®æ”¹å®ƒä»¬ã€‚è€Œæ¸¸æˆå¼•æ“ä¸ºäº†è¿½æ±‚è¿è¡Œæ—¶çš„æ•ˆç‡ï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨Cppè¯­è¨€è¿›è¡Œå¼€å‘ï¼ŒCppè¯­è¨€æœ¬èº«ä¸æ”¯æŒåå°„ï¼Œæ‰€ä»¥å„å¤§æ¸¸æˆå¼•æ“éƒ½å„æ˜¾ç¥é€šåœ°æ·»åŠ äº†åå°„ç³»ç»Ÿï¼Œä»¥æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€ç±»å‹ä¿¡æ¯ã€‚\nåœ¨è™šå¹»å¼•æ“å½“ä¸­ï¼Œæ˜¯é€šè¿‡UObjectç±»æ¥æ”¶é›†å…ƒä¿¡æ¯çš„ã€‚é€šè¿‡UPROPTERTY()ç­‰å®æ ‡è®°ï¼Œç”¨UHTå·¥å…·ï¼Œåœ¨ç¼–è¯‘å‰è¿›è¡Œä¸€æ¬¡å¤´æ–‡ä»¶çš„ç”Ÿæˆï¼Œä»è€Œç”ŸæˆUPROPERTY()æ‰€æ ‡è®°çš„å±æ€§å…ƒä¿¡æ¯çš„Uç±»ã€‚å¯¹äºè™šå¹»çš„åå°„å®ç°æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œå¯ä»¥å‚è€ƒå¤§é’Šåœ¨çŸ¥ä¹ä¸Šçš„æ–‡ç« ï¼šè™šå¹»å¼•æ“çš„å…ƒä¿¡æ¯æœºåˆ¶ åœ¨Unityä¸­ï¼Œåå°„ç³»ç»Ÿç”±C#æä¾›çš„ã€‚ åœ¨godotä¸­ï¼Œåå°„ç³»ç»Ÿåˆ™æ˜¯ç”±åä¸ºClassDBæä¾›ï¼Œå®ƒè®°å½•äº†æ‰€æœ‰æ´¾ç”Ÿè‡ªObjectç±»çš„ç±»å‹ä¿¡æ¯ã€‚åœ¨ä¸šåŠ¡ä»£ç å±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæä¾›çš„ä¸€ç³»åˆ—é™æ€æ–¹æ³•æ¥è¿è¡Œæ—¶è®¿é—®ç±»çš„ç±»å‹ä¿¡æ¯ï¼Œæ¯”å¦‚è·å–ç±»çš„æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å±æ€§ç­‰ä¿¡æ¯ã€‚ ClassDBä»‹ç» å¯¹äºgodotæ¥è¯´ClassDBæ˜¯ä¸€ä¸ªå…¨å±€ç±»ä¿¡æ¯åº“ï¼Œå¯ä»¥å¯¹æ‰€æœ‰æ³¨å†Œç±»çš„å…ƒæ•°æ®è¿›è¡Œè®¿é—®ã€‚\nClassDBåˆ©ç”¨é™æ€æˆå‘˜å˜é‡æ¥å­˜å‚¨ç±»çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ç±»çš„ç»§æ‰¿å…³ç³»ã€æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å±æ€§ç­‰ä¿¡æ¯ã€‚ ClassDBæä¾›äº†ä¸€ç³»åˆ—çš„é™æ€æˆå‘˜å‡½æ•°ç»™ç”¨æˆ·æ¥è¿›è¡Œå…ƒæ•°æ®æŸ¥è¯¢ã€‚ å› æ­¤ClassDBå¹¶æ²¡æœ‰å®ä¾‹åŒ–çš„éœ€æ±‚ã€‚ ä¸‹æ–¹æˆªå–äº†4.4ç‰ˆæœ¬godotæºç ä¸­ClassDBç±»çš„éƒ¨åˆ†ä»£ç ï¼Œå¹¶æ ‡æ³¨äº†ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼Œå¸®åŠ©æˆ‘ä»¬å»æ•´ä½“çš„ç†è§£ClassDBçš„è¿è¡ŒåŸç†ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæ–¹æ³•å’Œå±æ€§çš„é¡ºåºï¼Œå¹¶éä¸æºç ä¸¥æ ¼ä¸€è‡´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 class ClassDB { public: //... //è¯»å†™é”ï¼Œé˜²æ­¢å¤šçº¿ç¨‹é—®é¢˜ static RWLock lock; //æ‰€æœ‰æ³¨å†Œçš„ç±»ä¿¡æ¯ static HashMap\u0026lt;StringName, ClassInfo\u0026gt; classes; // static HashMap\u0026lt;StringName, StringName\u0026gt; resource_base_extensions; static HashMap\u0026lt;StringName, StringName\u0026gt; compat_classes; //... public: //... //æŸ¥è¯¢æ‰€æœ‰ç±»çš„åç§°åˆ—è¡¨ static void get_class_list(List\u0026lt;StringName\u0026gt; *p_classes); //æŸ¥è¯¢æ‰€æœ‰GDExtensionçš„ç±»åç§°åˆ—è¡¨ static void get_extensions_class_list(List\u0026lt;StringName\u0026gt; *p_classes); //æŒ‰ç…§åç§°æŸ¥è¯¢ç±»æ˜¯å¦å­˜åœ¨ static bool class_exists(const StringName \u0026amp;p_class); //ä¿¡å·æ¥å£ static void add_signal(const StringName \u0026amp;p_class, const MethodInfo \u0026amp;p_signal); static bool has_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, bool p_no_inheritance = false); static bool get_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, MethodInfo *r_signal); static void get_signal_list(const StringName \u0026amp;p_class, List\u0026lt;MethodInfo\u0026gt; *p_signals, bool p_no_inheritance = false); }; ç±»çš„æŸ¥è¯¢æ¥å£ åœ¨ç†è§£ClassDBä¸­çš„é™æ€æˆå‘˜å˜é‡static HashMap\u0026lt;StringName, ClassInfo\u0026gt; classes;å­˜å‚¨äº†æ‰€æœ‰çš„ç±»ä¿¡æ¯åï¼Œä¸‹æ–¹ä¸¤ä¸ªæŸ¥è¯¢çš„æ¥å£ï¼Œå°±éå¸¸å¥½ç†è§£äº†ã€‚\næ¥å£ ä½œç”¨ ä¸€èˆ¬æ¥å£ get_class_list æŸ¥è¯¢æ‰€æœ‰ç±»åç§° class_exists æŸ¥è¯¢ç±»æ˜¯å¦å­˜åœ¨ instantiate è°ƒç”¨å®ä¾‹åŒ–å‡½æ•°ï¼Œå¹¶å‘é€é€šçŸ¥ å‘ä¸‹æŸ¥è¯¢ get_inheriters_from_class æŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿ç±» get_direct_inheriters_from_class æŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿ç±»(ä¸åŒ…å«è‡ªèº«) å‘ä¸ŠæŸ¥è¯¢ get_parent_class æŸ¥è¯¢çˆ¶ç±» get_parent_class_nocheck æŸ¥è¯¢çˆ¶ç±»åç§°ï¼Œä¸åšæŠ¥é”™ get_inheritance_chain_nocheck æŸ¥è¯¢ç»§æ‰¿é“¾ is_parent_class æŸ¥è¯¢Aæ˜¯å¦ç»§æ‰¿è‡ªB(åŒ…æ‹¬åŒä¸€ç±») ä¸€èˆ¬æ¥å£ get_class_list ï¼šï¼šæ‰€æœ‰ç±»åç§°æŸ¥è¯¢ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„å…ƒç´ æ˜¯æ‰€æœ‰ç±»çš„åç§°ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 void ClassDB::get_class_list(List\u0026lt;StringName\u0026gt; *p_classes) { //åˆ›å»ºè¯»é”ï¼Œgodotå®šä¹‰çš„å®ï¼Œå¯ä»¥ä¸å…³æ³¨å®ƒçš„å®ç°ç»†èŠ‚ OBJTYPE_RLOCK; //éå†å­˜æ”¾æ‰€æœ‰ç±»ä¿¡æ¯çš„HashMapï¼šclassesï¼Œæ‹¿åˆ°å®ƒçš„é”®å€¼ï¼Œä¹Ÿå°±æ˜¯ç±»åï¼Œæ·»åŠ è¿›è¾“å‡ºåˆ—è¡¨ for (const KeyValue\u0026lt;StringName, ClassInfo\u0026gt; \u0026amp;E : classes) { p_classes-\u0026gt;push_back(E.key); } //å¯¹ p_classes åˆ—è¡¨ä¸­çš„æ‰€æœ‰ç±»åï¼ˆStringNameï¼‰æŒ‰ç…§å­—æ¯é¡ºåºè¿›è¡Œæ’åºã€‚ p_classes-\u0026gt;sort_custom\u0026lt;StringName::AlphCompare\u0026gt;(); } class_exists ï¼šï¼šæŸ¥è¯¢ç±»æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚ 1 2 3 4 5 6 bool ClassDB::class_exists(const StringName \u0026amp;p_class) { //åˆ›å»ºè¯»é” OBJTYPE_RLOCK; //æ ¹æ®é”®å€¼æŸ¥è¯¢å“ˆå¸Œè¡¨ return classes.has(p_class); } å‘ä¸‹æŸ¥è¯¢ get_inheriters_from_class ï¼šï¼š æŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿è‡ªæŒ‡å®šç±»çš„ç±»åç§°åˆ—è¡¨ã€‚ get_direct_inheriters_from_class ï¼šï¼šæŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿è‡ªæŒ‡å®šç±»çš„ç±»åç§°åˆ—è¡¨ï¼Œè¿‡æ»¤æ‰äº†ä¼ å…¥çš„ç±»æœ¬èº« 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 void ClassDB::get_inheriters_from_class(const StringName \u0026amp;p_class, List\u0026lt;StringName\u0026gt; *p_classes) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //éå†å­˜æ”¾æ‰€æœ‰ç±»ä¿¡æ¯ï¼Œå¦‚æœEä¸ºç»§æ‰¿è‡ªp_classçš„ç±»ï¼Œåˆ™æ·»åŠ è¿›è¾“å‡ºåˆ—è¡¨ for (const KeyValue\u0026lt;StringName, ClassInfo\u0026gt; \u0026amp;E : classes) { if (E.key != p_class \u0026amp;\u0026amp; _is_parent_class(E.key, p_class)) { p_classes-\u0026gt;push_back(E.key); } } } void ClassDB::get_direct_inheriters_from_class(const StringName \u0026amp;p_class, List\u0026lt;StringName\u0026gt; *p_classes) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //åŒä¸Šï¼Œä½†æ˜¯è¿‡æ»¤æ‰äº†è‡ªèº« for (const KeyValue\u0026lt;StringName, ClassInfo\u0026gt; \u0026amp;E : classes) { if (E.key != p_class \u0026amp;\u0026amp; _get_parent_class(E.key) == p_class) { p_classes-\u0026gt;push_back(E.key); } } } å‘ä¸ŠæŸ¥è¯¢ get_parent_class ï¼šï¼šæŸ¥è¯¢æŒ‡å®šç±»çš„çˆ¶ç±»åç§° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 StringName ClassDB::get_parent_class(const StringName \u0026amp;p_class) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //è°ƒç”¨å®é™…æ‰§è¡Œå‡½æ•° return _get_parent_class(p_class); } StringName ClassDB::_get_parent_class(const StringName \u0026amp;p_class) { ClassInfo *ti = classes.getptr(p_class); //éç©ºåˆ¤æ–­ï¼Œä¸ºç©ºæ—¶æŠ¥é”™å¹¶è¿”å›ç©ºå­—ç¬¦ä¸² ERR_FAIL_NULL_V_MSG(ti, StringName(), vformat(\u0026#34;Cannot get class \u0026#39;%s\u0026#39;.\u0026#34;, String(p_class))); //è¿”å›çˆ¶ç±»åç§° return ti-\u0026gt;inherits; } get_parent_class_nocheck ï¼šï¼šæŸ¥è¯¢æŒ‡å®šç±»çš„çˆ¶ç±»åç§°ï¼Œä¸åšæŠ¥é”™ 1 2 3 4 5 6 7 8 9 10 11 12 13 StringName ClassDB::get_parent_class_nocheck(const StringName \u0026amp;p_class) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //éç©ºåˆ¤æ–­ ClassInfo *ti = classes.getptr(p_class); if (!ti) { return StringName(); } //è¿”å›çˆ¶ç±»åç§° return ti-\u0026gt;inherits; } get_inheritance_chain_nocheckï¼šï¼šæŸ¥è¯¢ç»§æ‰¿é“¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 bool ClassDB::get_inheritance_chain_nocheck(const StringName \u0026amp;p_class, Vector\u0026lt;StringName\u0026gt; \u0026amp;r_result) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //éç©ºåˆ¤æ–­ ClassInfo *start = classes.getptr(p_class); if (!start) { return false; } //å‘ä¸ŠæŸ¥è¯¢ï¼Œç›´è‡³çˆ¶ç±»æŒ‡é’ˆä¸ºç©º int classes_to_add = 0; for (ClassInfo *ti = start; ti; ti = ti-\u0026gt;inherits_ptr) { classes_to_add++; } //æ‰©å®¹r_resultåˆ—è¡¨ï¼Œå¹¶å°†çˆ¶ç±»ååˆ—è¡¨ç§°æ·»åŠ è¿›åˆ—è¡¨ //ä¸ç”¨push_backï¼Œå› ä¸ºpush_backä¼šåŠ¨æ€æ‰©å®¹ï¼Œæ€§èƒ½è¡¨ç°æ›´å·®ï¼Œè€Œresizeä¸ä¼š int64_t old_size = r_result.size(); r_result.resize(old_size + classes_to_add); StringName *w = r_result.ptrw() + old_size; for (ClassInfo *ti = start; ti; ti = ti-\u0026gt;inherits_ptr) { *w++ = ti-\u0026gt;name; } return true; } ä¿¡å·æ¥å£ ä¿¡å·ç›¸å…³çš„ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨ClassInfoçš„signal_mapå½“ä¸­\næ¥å£ ä½œç”¨ add_signal ä¸ºæŸä¸ªç±»æ·»åŠ ä¸€ä¸ª ä¿¡å·ï¼Œæ™®éä½¿ç”¨å®ƒçš„å®ADD_SIGNALç‰ˆæœ¬ has_signal æ£€æŸ¥ç±»æ˜¯å¦ï¼ˆå«çˆ¶ç±»ï¼‰å®šä¹‰äº†æŸä¸ªä¿¡å· get_signal è¿”å› class æˆ–å…¶ç¥–å…ˆçš„ä¿¡å·æ•°æ®ã€‚ get_signal_list è·å–æ‰€æœ‰ä¿¡å·ï¼ˆå¯åŒ…æ‹¬çˆ¶ç±»ï¼‰ åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ï¼š godotä¸­çš„signalç±»ä¼¼äºueä¸­çš„åŠ¨æ€å¤šæ’­ä»£ç†ã€‚å®ƒå¯ä»¥å°†ä¸€ä¸ªä¿¡å·ï¼ˆå¯ä»¥å¸¦å‚æ•°ï¼‰å‘é€åˆ°æ‰€æœ‰ç›‘å¬å‡½æ•°ã€‚\nä¿¡å·çš„åˆ›å»ºä¸€èˆ¬æ”¾åœ¨_bind_methodsä¸­ ç›‘å¬ä¿¡å·çš„ç»‘å®šï¼Œåˆ™éœ€è¦ç»“åˆå®é™…çš„ç›‘å¬è€…ï¼ˆObject*ï¼‰ï¼Œå› æ­¤ä¸ä¼šåœ¨é™æ€å‡½æ•°_bind_methodsä¸­ç»‘å®šã€‚ ä¿¡å·çš„å‘é€ï¼Œä¹Ÿéœ€è¦ç»“åˆå®é™…çš„å‘é€è€…ã€‚ æ³¨æ„ï¼Œç”±äºä¿¡å·åŠŸèƒ½çš„å®ç°ï¼Œä¾èµ–äº†Objectå†…çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç›¸å…³çš„å‡½æ•°éœ€è¦è¢«æ³¨å†Œè¿›ç±»å‹ä¿¡æ¯å½“ä¸­ï¼Œå¦åˆ™Objectæ— æ³•é€šè¿‡callåŠ¨æ€çš„è°ƒç”¨ç»‘å®šçš„å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 //ä¿¡å·åˆ›å»º void MyNode::_bind_methods() { //å®šä¹‰ä¿¡å·çš„å±æ€§ MethodInfo mi(\u0026#34;TestSignal\u0026#34;); //ä¿¡å·åç§°ä¸ºTestSignal mi._push_params(PropertyInfo(Variant::INT,\u0026#34;Arg1\u0026#34;)); //å…·æœ‰ä¸€ä¸ªç±»å‹ä¸ºintçš„å‚æ•°Arg1 ClassDB::add_signal(\u0026#34;NsTestResource\u0026#34;, mi);\t//æ·»åŠ ä¿¡å· //å®çš„å®ç°ç‰ˆæœ¬ //ä¿¡å·åç§°ä¸ºTestSignalï¼Œä¿¡å·å…·æœ‰ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹ä¸ºint ADD_SIGNAL(MethodInfo(\u0026#34;NsTestResource\u0026#34;, PropertyInfo(Variant::INT, \u0026#34;TestSignal\u0026#34;)));\t} //å®šä¹‰è¢«è°ƒç”¨å‡½æ•° void NsTestResource::test_func_for_signal(int AAA){ print_line(\u0026#34;test_func_for_signal::\u0026#34;,AAA); } //ç»‘å®šä¿¡å· void NsTestResource::test_func_for_connect(){ connect(\u0026#34;TestSignal\u0026#34;, Callable(this,\u0026#34;test_func_for_signal\u0026#34;)); } //å‘å°„ä¿¡å· void NsTestResource::test_func_for_emit(int AAA){ emit_signal(\u0026#34;TestSignal\u0026#34;, 2); } add_signal ä¸ºæŸä¸ªç±»æ·»åŠ ä¸€ä¸ªä¿¡å·,MethodInfoå‚è€ƒé“¾æ¥\næ–¹æ³•ç­¾å\n1 2 3 4 void ClassDB::add_signal( const StringName \u0026amp;p_class, //ç±»å const MethodInfo \u0026amp;p_signal\t//ä¿¡å·ä¿¡æ¯ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 #define ADD_SIGNAL(m_signal) ::ClassDB::add_signal(get_class_static(), m_signal) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 void MyNode::_bind_methods() { //å®šä¹‰ä¿¡å·çš„å±æ€§ MethodInfo mi(\u0026#34;TestSignal\u0026#34;); //ä¿¡å·åç§°ä¸ºTestSignal mi._push_params(PropertyInfo(Variant::INT,\u0026#34;Arg1\u0026#34;)); //å…·æœ‰ä¸€ä¸ªç±»å‹ä¸ºintçš„å‚æ•°Arg1 ClassDB::add_signal(\u0026#34;NsTestResource\u0026#34;, mi);\t//æ·»åŠ ä¿¡å· //å®çš„å®ç°ç‰ˆæœ¬ //ä¿¡å·åç§°ä¸ºTestSignalï¼Œä¿¡å·å…·æœ‰ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹ä¸ºint ADD_SIGNAL(MethodInfo(\u0026#34;NsTestResource\u0026#34;, PropertyInfo(Variant::INT, \u0026#34;TestSignal\u0026#34;)));\t} æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void ClassDB::add_signal(const StringName \u0026amp;p_class, const MethodInfo \u0026amp;p_signal) { //é”ä¸Šå†™é” OBJTYPE_WLOCK; //ç±»ä¿¡æ¯éç©ºåˆ¤æ–­ ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); //è·å–ä¿¡å·åç§° StringName sname = p_signal.name; //åŒåä¿¡å·æŠ¥é”™ #ifdef DEBUG_METHODS_ENABLED ClassInfo *check = type; while (check) { ERR_FAIL_COND_MSG(check-\u0026gt;signal_map.has(sname), vformat(\u0026#34;Class \u0026#39;%s\u0026#39; already has signal \u0026#39;%s\u0026#39;.\u0026#34;, String(p_class), String(sname))); check = check-\u0026gt;inherits_ptr; } #endif //signal_mapä¸­æ·»åŠ ä¿¡å· type-\u0026gt;signal_map[sname] = p_signal; } has_signal æ£€æŸ¥æŸä¸ªç±»æ˜¯å¦å®šä¹‰è¿‡æŸä¸ªä¿¡å·\næ–¹æ³•ç­¾å\n1 2 3 4 5 bool ClassDB::has_signal( const StringName \u0026amp;p_class, //ç±»å const StringName \u0026amp;p_signal, //ä¿¡å·å bool p_no_inheritance //æ˜¯å¦å¿½ç•¥ç»§æ‰¿å…³ç³» ); ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 void testfun(){ bool exists = ClassDB::has_signal(\u0026#34;Node\u0026#34;, \u0026#34;tree_entered\u0026#34;); print_line(vformat(\u0026#34;Has signal? %s\u0026#34;, exists)); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 bool ClassDB::has_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, bool p_no_inheritance) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //ç±»ä¿¡æ¯éç©ºåˆ¤æ–­ ClassInfo *type = classes.getptr(p_class); ClassInfo *check = type; //å‘ä¸Šé€çº§æŸ¥è¯¢classinfoï¼Œç›´åˆ°objectç±»ï¼Œ while (check) { if (check-\u0026gt;signal_map.has(p_signal)) { return true; } //æ— éœ€å‘ä¸ŠæŸ¥è¯¢ï¼Œåˆ™è¿”å›false if (p_no_inheritance) { return false; } check = check-\u0026gt;inherits_ptr; } return false; } get_signal è·å–ä¿¡å·çš„å®Œæ•´ä¿¡æ¯å­˜å…¥MethodInfoï¼Œå¦‚æœä¿¡å·å­˜åœ¨è¿”å›true å¹¶å¡«å……p_signal\nMethodInfoé“¾æ¥\næ–¹æ³•ç­¾å\n1 2 3 4 5 bool ClassDB::get_signal( const StringName \u0026amp;p_class, // ç±»å const StringName \u0026amp;p_signal, // ä¿¡å·å MethodInfo *r_signal // å­˜å‚¨ä¿¡å·çš„MethodInfo )ï¼› ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 void testfun(){ MethodInfo info; if (ClassDB::get_signal(\u0026#34;MyNode\u0026#34;, \u0026#34;hit\u0026#34;, \u0026amp;info)) { print_line(\u0026#34;Signal name: \u0026#34; + info.name); for (auto arg : info.arguments) { print_line(\u0026#34;Arg: \u0026#34; + arg.name); } } } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 bool ClassDB::get_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, MethodInfo *r_signal) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; ClassInfo *type = classes.getptr(p_class); ClassInfo *check = type; //å‘ä¸Šé€çº§æŸ¥è¯¢classinfoï¼Œç›´åˆ°objectç±» while (check) { //è·å–ä¿¡å·ä¿¡æ¯ if (check-\u0026gt;signal_map.has(p_signal)) { if (r_signal) { //è¿›è¡Œå€¼æ‹·è´ *r_signal = check-\u0026gt;signal_map[p_signal]; } return true; } //çˆ¶ç±»ClassInfoæŒ‡é’ˆ check = check-\u0026gt;inherits_ptr; } return false; } get_signal_list è·å–æŸä¸ªç±»æ‰€æœ‰ä¿¡å·,åŒ…æ‹¬çˆ¶ç±»ä¿¡å·\næ–¹æ³•ç­¾å\n1 2 3 4 5 void ClassDB::get_signal_list( const StringName \u0026amp;p_class, //ç±»å List\u0026lt;MethodInfo\u0026gt; *p_signals, //ä¿¡å·åˆ—è¡¨å¼•ç”¨ï¼Œç”¨äºè¿”å›æŸ¥è¯¢ç»“æœ bool p_no_inheritance //æ˜¯å¦æŸ¥è¯¢çˆ¶ç±»ä¿¡å· ); ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 void testfun(){ List\u0026lt;MethodInfo\u0026gt; signals; ClassDB::get_signal_list(\u0026#34;Node2D\u0026#34;, \u0026amp;signals); for (List\u0026lt;MethodInfo\u0026gt;::Element *E = signals.front(); E; E = E-\u0026gt;next()) { print_line(\u0026#34;Signal: \u0026#34; + E-\u0026gt;get().name); } } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 void ClassDB::get_signal_list(const StringName \u0026amp;p_class, List\u0026lt;MethodInfo\u0026gt; *p_signals, bool p_no_inheritance) { //é”ä¸Šè¯»é” éç©ºåˆ¤æ–­ OBJTYPE_RLOCK; ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); //å‘ä¸Šé€çº§æŸ¥è¯¢classinfoï¼Œç›´åˆ°objectç±» ClassInfo *check = type; while (check) { //éå†æ‰€æœ‰ä¿¡å·ï¼Œå¹¶æ¨å…¥æ•°ç»„ for (KeyValue\u0026lt;StringName, MethodInfo\u0026gt; \u0026amp;E : check-\u0026gt;signal_map) { p_signals-\u0026gt;push_back(E.value); } if (p_no_inheritance) { return; } check = check-\u0026gt;inherits_ptr; } } å±æ€§æ¥å£ å±æ€§ç›¸å…³çš„ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨ClassInfoçš„property_listã€property_mapå’Œproperty_setgetå½“ä¸­\næ¥å£ ä½œç”¨ add_property ç»™æŸä¸ªç±»æ³¨å†Œä¸€ä¸ªâ€œå±æ€§â€ï¼Œå¹¶æŠŠè¿™ä¸ªå±æ€§å’Œå¯¹åº”çš„ setter/getter æ–¹æ³•ç»‘å®šèµ·æ¥ add_property_array ä¸º Inspector ç”Ÿæˆâ€œæ•°ç»„å¼å±æ€§ç»„â€çš„è¾…åŠ©å‡½æ•°ï¼Œæœ¬èº«ä¸åˆ›å»ºå®é™…çš„å±æ€§ add_property_array_count ç»™ä¸€ä¸ªç±»æ³¨å†Œæ•°ç»„å±æ€§ add_property_group ä¸º Inspectorä¸­æ˜¾ç¤ºçš„å±æ€§åˆ†ç»„ add_property_subgroup åˆ›å»º ç¼©è¿›æ›´æ·±ä¸€çº§çš„å­åˆ†ç»„ add_linked_property é“¾æ¥å±æ€§ï¼Œå°†å­å±ä¸‹å…³è”åˆ°çˆ¶å±æ€§ get_property_list è·å–æŸä¸ªç±»çš„æ‰€æœ‰å±æ€§åˆ—è¡¨ get_property_info è·å–æŸä¸ªç±»çš„æŸä¸ªå±æ€§ï¼Œæ³¨æ„ç”±äºæ˜¯é€šè¿‡ClassInfoï¼šï¼šproperty_mapæ¥è¿›è¡ŒæŸ¥è¯¢çš„ï¼Œå› æ­¤å ä½çš„å±æ€§ä¿¡æ¯ä¼šè¿”å›false get_property è·å–æŸä¸ªå®ä¾‹çš„å±æ€§å€¼ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ set_property è®¾ç½®æŸä¸ªå®ä¾‹çš„å±æ€§å€¼ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ has_property æŸ¥è¯¢æŸä¸ªç±»æ˜¯å¦å®šä¹‰è¿‡æŸä¸ªå±æ€§ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_index æŸ¥è¯¢å±æ€§ç´¢å¼•ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_type è·å–å±æ€§ç±»å‹ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_setter è·å–å±æ€§setteræ–¹æ³•åï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_getter è·å–å±æ€§getteræ–¹æ³•åï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ add_property add_propertyç»™æŸä¸ªç±»æ³¨å†Œä¸€ä¸ªâ€œå±æ€§â€ï¼Œå¹¶æŠŠè¿™ä¸ªå±æ€§å’Œå¯¹åº”çš„ setter/getter æ–¹æ³•ç»‘å®šèµ·æ¥ã€‚\nä¸€èˆ¬ç»“åˆget_class_static()ä½¿ç”¨ï¼Œåœ¨_bind_methods ä¸­è°ƒç”¨ï¼Œæ³¨å†Œæœ¬ç±»çš„å±æ€§ã€‚\næ–¹æ³•ç­¾å\n1 2 3 4 5 6 7 static void add_property( const StringName \u0026amp;p_class,// ç±»åï¼Œä½¿ç”¨å°è£…çš„ADD_PROPERTYå®æ—¶ï¼Œè¯¥ç±»åä¼šè¢«è‡ªåŠ¨å¡«å…¥ const PropertyInfo \u0026amp;p_pinfo,// å±æ€§ä¿¡æ¯ const StringName \u0026amp;p_setter,// setter æ–¹æ³•å const StringName \u0026amp;p_getter,// getter æ–¹æ³•å int p_index = -1 // å±æ€§ç´¢å¼•ï¼Œé»˜è®¤ä½¿ç”¨-1ï¼ŒADD_PROPERTYIä¸­å¯ä»¥æ·»åŠ ç´¢å¼•ã€‚é…åˆadd_property_arrayä½¿ç”¨ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 2 #define ADD_PROPERTY(m_property, m_setter, m_getter) ::ClassDB::add_property(get_class_static(), m_property, _scs_create(m_setter), _scs_create(m_getter)) #define ADD_PROPERTYI(m_property, m_setter, m_getter, m_index) ::ClassDB::add_property(get_class_static(), m_property, _scs_create(m_setter), _scs_create(m_getter), m_index) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 void MyNode::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;set_value\u0026#34;, \u0026#34;index\u0026#34;, \u0026#34;value\u0026#34;), \u0026amp;MyData::set_value); ClassDB::bind_method(D_METHOD(\u0026#34;get_value\u0026#34;, \u0026#34;index\u0026#34;), \u0026amp;MyData::get_value); // è¿™é‡Œ p_index åˆ†åˆ«å†™ 0/1/2 ClassDB::add_property(\u0026#34;MyData\u0026#34;,PropertyInfo(Variant::FLOAT, \u0026#34;value_0\u0026#34;),\u0026#34;set_value\u0026#34;, \u0026#34;get_value\u0026#34;,0); //æˆ–è€…ç”¨å® ADD_PROPERTY(PropertyInfo(Variant::FLOAT, \u0026#34;value_0\u0026#34;),\u0026#34;set_value\u0026#34;, \u0026#34;get_value\u0026#34;); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 void ClassDB::add_property(const StringName \u0026amp;p_class, const PropertyInfo \u0026amp;p_pinfo, const StringName \u0026amp;p_setter, const StringName \u0026amp;p_getter, int p_index) { //é”ä¸Šè¯»é”ï¼Œè·å–ç±»ä¿¡æ¯ lock.read_lock(); ClassInfo *type = classes.getptr(p_class); lock.read_unlock(); //ç±»ä¿¡æ¯éç©ºåˆ¤æ–­ ERR_FAIL_NULL(type); //è·å–setteræ–¹æ³• MethodBind *mb_set = nullptr; if (p_setter) { mb_set = get_method(p_class, p_setter); #ifdef DEBUG_METHODS_ENABLED ERR_FAIL_NULL_MSG(mb_set, vformat(\u0026#34;Invalid setter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_setter, p_pinfo.name)); int exp_args = 1 + (p_index \u0026gt;= 0 ? 1 : 0); ERR_FAIL_COND_MSG(mb_set-\u0026gt;get_argument_count() != exp_args, vformat(\u0026#34;Invalid function for setter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_setter, p_pinfo.name)); #endif } //è·å–getteræ–¹æ³• MethodBind *mb_get = nullptr; if (p_getter) { mb_get = get_method(p_class, p_getter); #ifdef DEBUG_METHODS_ENABLED ERR_FAIL_NULL_MSG(mb_get, vformat(\u0026#34;Invalid getter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_getter, p_pinfo.name)); int exp_args = 0 + (p_index \u0026gt;= 0 ? 1 : 0); ERR_FAIL_COND_MSG(mb_get-\u0026gt;get_argument_count() != exp_args, vformat(\u0026#34;Invalid function for getter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_getter, p_pinfo.name)); #endif } //å±æ€§åç§°é‡å¤æŠ¥é”™ #ifdef DEBUG_METHODS_ENABLED ERR_FAIL_COND_MSG(type-\u0026gt;property_setget.has(p_pinfo.name), vformat(\u0026#34;Object \u0026#39;%s\u0026#39; already has property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_pinfo.name)); #endif //é”ä¸Šå†™é”ï¼Œç›´åˆ°å‡½æ•°ç»“æŸ OBJTYPE_WLOCK //åœ¨classinfoä¸­æ·»åŠ å±æ€§ä¿¡æ¯ type-\u0026gt;property_list.push_back(p_pinfo); type-\u0026gt;property_map[p_pinfo.name] = p_pinfo; #ifdef DEBUG_METHODS_ENABLED if (mb_get) { type-\u0026gt;methods_in_properties.insert(p_getter); } if (mb_set) { type-\u0026gt;methods_in_properties.insert(p_setter); } #endif //æ·»åŠ å±æ€§çš„setå’Œgetæ–¹æ³•ï¼Œé”®æ˜¯å±æ€§åç§° PropertySetGet psg; psg.setter = p_setter; psg.getter = p_getter; psg._setptr = mb_set; psg._getptr = mb_get; psg.index = p_index; psg.type = p_pinfo.type; type-\u0026gt;property_setget[p_pinfo.name] = psg; } add_property_array åœ¨ Inspector ä¸­åˆ›å»ºä¸€ä¸ªâ€œæ•°ç»„å±æ€§ç»„â€ï¼ˆarray property groupï¼‰ï¼Œç”¨äºæ˜¾ç¤ºä¸€ç»„ä»¥ç±»ä¼¼å‘½åè§„åˆ™çš„å±æ€§ã€‚\nå®ƒä¸ç›´æ¥å­˜ getter/setterï¼Œä¹Ÿä¸å…³è”å®é™…å±æ€§ã€‚ å®ƒæ˜¯ä¸€ä¸ª è™šæ‹Ÿå±æ€§ï¼ˆVariant::NILï¼‰ ï¼Œä»…ç”¨äº UI åˆ†ç»„ã€‚ å®ƒé…åˆadd_property/ADD_PROPERTYIä½¿ç”¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå®šé•¿æ•°ç»„å±æ€§ã€‚ å®ƒé…åˆ_set()/_get()/_get_property_list()ä½¿ç”¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåŠ¨æ€æ•°ç»„å±æ€§ã€‚ æ³¨æ„ï¼šå®ƒçš„ä½¿ç”¨éå¸¸å¤æ‚,éœ€è¦ç»“åˆObjectçš„å®get_property_listä½¿ç”¨ã€‚åç»­ä¼šæœ‰ä¸“é—¨çš„ç« èŠ‚è®²è§£ã€‚æ­¤å¤„ä»…ç»™å‡ºä¸€ä¸ªç®€çŸ­çš„ç¤ºä¾‹\næ–¹æ³•ç­¾å\n1 2 3 4 5 void ClassDB::add_property_array( const StringName \u0026amp;p_class, // ç±»å const StringName \u0026amp;p_path, // å±æ€§è·¯å¾„ const String \u0026amp;p_array_element_prefix // æ•°ç»„å…ƒç´ å‰ç¼€ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 #define ADD_ARRAY(m_array_path, m_prefix) ClassDB::add_property_array(get_class_static(), m_array_path, m_prefix) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void MyNode::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;set_position\u0026#34;, \u0026#34;index\u0026#34;, \u0026#34;value\u0026#34;), \u0026amp;MyNode::set_position); ClassDB::bind_method(D_METHOD(\u0026#34;get_position\u0026#34;, \u0026#34;index\u0026#34;), \u0026amp;MyNode::get_position); // æ·»åŠ æ•°ç»„å±æ€§ç»„ï¼ˆè™šæ‹Ÿå±æ€§ï¼‰ï¼Œå®šé•¿æ•°ç»„ // æ·»åŠ æ¯ä¸ªå®é™…å±æ€§ï¼Œç®€æ˜“ç‰ˆæœ¬ // å¯¹äºå˜é•¿æ•°ç»„ï¼Œéœ€è¦é‡è½½å‡½æ•°get_property_listä¸­å®šä¹‰è¯¥å±æ€§æ•°ç»„çš„è¡Œä¸º ClassDB::add_property_array(\u0026#34;MyNode\u0026#34;, \u0026#34;positions\u0026#34;, \u0026#34;positions/\u0026#34;); for (int i = 0; i \u0026lt; 3; i++) { String name = \u0026#34;positions/\u0026#34; + itos(i); ClassDB::add_property(\u0026#34;MyNode\u0026#34;, PropertyInfo(Variant::VECTOR3, name), \u0026#34;set_position\u0026#34;, \u0026#34;get_position\u0026#34;, i); } //ä½¿ç”¨å®çš„ç‰ˆæœ¬å®ç° ADD_ARRAY(\u0026#34;TestProperty\u0026#34;, \u0026#34;TestProperty/\u0026#34;); ADD_PROPERTYI(PropertyInfo(Variant::COLOR,\u0026#34;TestProperty/0\u0026#34;), \u0026#34;set_TP_color\u0026#34;, \u0026#34;get_TP_color\u0026#34;,1); ADD_PROPERTYI(PropertyInfo(Variant::COLOR,\u0026#34;TestProperty/1\u0026#34;), \u0026#34;set_TP_color\u0026#34;, \u0026#34;get_TP_color\u0026#34;,2); ClassDB::add_property(\u0026#34;NsTestResource\u0026#34;, PropertyInfo(Variant::VECTOR3,\u0026#34;TestProperty/2\u0026#34;), \u0026#34;set_TP_vector3\u0026#34;, \u0026#34;get_TP_vector3\u0026#34;, 0 ); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 //æ­¤å¤„å°±éå¸¸ç®€å•ï¼Œä»…åšäº†å ä½çš„å±æ€§æ·»åŠ  void ClassDB::add_property_array(const StringName \u0026amp;p_class, const StringName \u0026amp;p_path, const String \u0026amp;p_array_element_prefix) { //é”ä¸Šå†™é”ï¼Œç›´åˆ°å‡½æ•°ç»“æŸï¼Œç©ºå€¼åˆ¤æ–­ OBJTYPE_WLOCK; ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); // æ·»åŠ åˆ°å±æ€§ç»„ï¼Œç±»å‹ä¸ºç©ºNILï¼Œç”¨äºå ä½ //æ³¨æ„ï¼Œæ­¤å¤„çš„usageå±æ€§ä¸º PROPERTY_USAGE_EDITOR | PROPERTY_USAGE_ARRAY ï¼Œä¹Ÿå°±æ˜¯å£°æ˜ä¸ºäº†æ•°ç»„ï¼Œä»¥åŠç¼–è¾‘å™¨å¯è§ type-\u0026gt;property_list.push_back(PropertyInfo(Variant::NIL, p_path, PROPERTY_HINT_NONE, \u0026#34;\u0026#34;, PROPERTY_USAGE_EDITOR | PROPERTY_USAGE_ARRAY, p_array_element_prefix)); } add_property_array_count ç»™ä¸€ä¸ªç±»æ³¨å†Œæ•°ç»„å±æ€§ï¼ˆArray Propertyï¼‰;\né€šå¸¸ç»“åˆè‡ªå®šä¹‰çš„_setter_ å’Œ _getter_ä»¥åŠ_get_property_list_ä½¿ç”¨ å¯ä»¥å®ç°è‡ªå®šä¹‰çš„å˜é•¿æ•°ç»„ å®ƒåªæ³¨å†Œé•¿åº¦å±æ€§æœ¬èº« æ–¹æ³•ç­¾å\n1 2 3 4 5 6 7 8 9 static void add_property_array_count( const StringName \u0026amp;p_class, //è¢«ç»‘å®šç±»çš„ç±»å const String \u0026amp;p_label, //Inspector ä¸Šæ˜¾ç¤ºçš„ æ ‡ç­¾ï¼ˆç”¨æˆ·å¯è§ï¼‰ã€‚ const StringName \u0026amp;p_count_property, //æ•°ç»„é•¿åº¦å±æ€§çš„ å†…éƒ¨å±æ€§åã€‚ const StringName \u0026amp;p_count_setter, //å¯¹åº” setter å‡½æ•°å const StringName \u0026amp;p_count_getter, //å¯¹åº” getter å‡½æ•°å const String \u0026amp;p_array_element_prefix, //æ•°ç»„å…ƒç´ çš„å‰ç¼€ uint32_t p_count_usage = PROPERTY_USAGE_DEFAULT //å±æ€§çš„PropertyUsageç±»å‹ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 2 #define ADD_ARRAY_COUNT(m_label, m_count_property, m_count_property_setter, m_count_property_getter, m_prefix) ClassDB::add_property_array_count(get_class_static(), m_label, m_count_property, _scs_create(m_count_property_setter), _scs_create(m_count_property_getter), m_prefix) #define ADD_ARRAY_COUNT_WITH_USAGE_FLAGS(m_label, m_count_property, m_count_property_setter, m_count_property_getter, m_prefix, m_property_usage_flags) ClassDB::add_property_array_count(get_class_static(), m_label, m_count_property, _scs_create(m_count_property_setter), _scs_create(m_count_property_getter), m_prefix, m_property_usage_flags) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 // æ³¨å†Œæ•°ç»„ç»„ï¼šåå­—â€œColorsâ€ï¼Œé•¿åº¦å±æ€§åâ€œcolor_countâ€ï¼Œå…ƒç´ å‰ç¼€â€œcolor_â€ //æ­¤å¤„ä»…å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œæ³¨å†Œï¼Œå…¶ä»–å±æ€§ä¸æ³¨å†Œ // _bind_methods()ä¸­ ADD_ARRAY_COUNT(\u0026#34;Colors\u0026#34;, \u0026#34;color_count\u0026#34;, \u0026#34;set_color_count\u0026#34;, \u0026#34;get_color_count\u0026#34;, \u0026#34;color_\u0026#34;); // ä¸‹æ–¹æ˜¯ä¸‰ä¸ªé…å¥—å‡½æ•°ï¼š_set()ã€_get()ã€_get_property_list() // æ­¤å¤„çœŸæ­£å®šä¹‰çš„æ•°ç»„ä¸­å±æ€§çš„è¡Œä¸º bool NsTestResource::_set(const StringName \u0026amp;p_name, const Variant \u0026amp;p_value){ Vector\u0026lt;String\u0026gt; components = String(p_name).split(\u0026#34;/\u0026#34;, true, 2); if (components.size() \u0026gt;= 2 \u0026amp;\u0026amp; components[0].begins_with(\u0026#34;color_\u0026#34;) \u0026amp;\u0026amp; components[0].trim_prefix(\u0026#34;color_\u0026#34;).is_valid_int()) { int index = components[0].trim_prefix(\u0026#34;color_\u0026#34;).to_int(); const String \u0026amp;property = components[1]; if (property == \u0026#34;color\u0026#34;) { // set_point_position(point_index, p_value); set_color(index, p_value); return true; } if (property == \u0026#34;shader\u0026#34;) { set_shader(index,p_value); return true; } } return false; } bool NsTestResource::_get(const StringName \u0026amp;p_name, Variant \u0026amp;r_ret)const { Vector\u0026lt;String\u0026gt; components = String(p_name).split(\u0026#34;/\u0026#34;, true, 2); if (components.size() \u0026gt;= 2 \u0026amp;\u0026amp; components[0].begins_with(\u0026#34;color_\u0026#34;) \u0026amp;\u0026amp; components[0].trim_prefix(\u0026#34;color_\u0026#34;).is_valid_int()) { int index = components[0].trim_prefix(\u0026#34;color_\u0026#34;).to_int(); const String \u0026amp;property = components[1]; if (property == \u0026#34;color\u0026#34;) { r_ret = get_color(index); return true; } if (property == \u0026#34;shader\u0026#34;) { r_ret = get_shader(index); return true; } } return false; } void NsTestResource::_get_property_list(List\u0026lt;PropertyInfo\u0026gt; *p_list)const { print_line(\u0026#34;NsTestResource::_get_property_list\u0026#34;); for (int i = 0; i \u0026lt; colors.size();i++) { PropertyInfo pi = PropertyInfo(Variant::COLOR, vformat(\u0026#34;color_%d/color\u0026#34;,i)); p_list-\u0026gt;push_back(pi); pi = PropertyInfo(Variant::OBJECT, vformat(\u0026#34;color_%d/shader\u0026#34;,i),PROPERTY_HINT_RESOURCE_TYPE, \u0026#34;Shader\u0026#34;); p_list-\u0026gt;push_back(pi); } } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 void ClassDB::add_property_array_count(const StringName \u0026amp;p_class, const String \u0026amp;p_label, const StringName \u0026amp;p_count_property, const StringName \u0026amp;p_count_setter, const StringName \u0026amp;p_count_getter, const String \u0026amp;p_array_element_prefix, uint32_t p_count_usage) { add_property(p_class, PropertyInfo(Variant::INT, //å±æ€§ç±»å‹ä¸ºINT p_count_property, //å±æ€§å PROPERTY_HINT_NONE, //æç¤ºä¸ºæ— æç¤º \u0026#34;\u0026#34;, //æç¤ºä¿¡æ¯ä¸ºç©º p_count_usage | PROPERTY_USAGE_ARRAY, //æ•°ç»„å±æ€§ vformat(\u0026#34;%s,%s\u0026#34;, p_label, p_array_element_prefix) //ç±»åä¸ºæ ‡ç­¾å’Œå‰ç¼€çš„ç»„è£… ), p_count_setter, //å±æ€§è®¾ç½®å‡½æ•° p_count_getter //å±æ€§è·å–å‡½æ•° ); } add_property_group ClassDB::add_property_group()ç”¨äºåœ¨ Godot Inspectorï¼ˆå±æ€§é¢æ¿ï¼‰ä¸­åˆ›å»ºä¸€æ¡åˆ†ç»„æ ‡é¢˜ï¼Œè®©å¤šä¸ªå±æ€§æ˜¾ç¤ºåœ¨åŒä¸€ä¸ªæŠ˜å ç»„ä¸‹ï¼Œä»è€Œè®© Inspector æ¸…æ™°æ•´æ´ã€‚ æ–¹æ³•ç­¾å\n1 2 3 4 5 6 void ClassDB::add_property_group( const StringName \u0026amp;p_class, //è‡ªèº«ç±»å const String \u0026amp;p_name, const //åˆ†ç»„æ ‡é¢˜ String \u0026amp;p_prefix, //åˆ†ç»„å‰ç¼€ï¼Œå…¶ä»–å…·æœ‰è¯¥å‰ç¼€çš„å±æ€§å°†æ˜¾ç¤ºåœ¨æœ¬åˆ†ç»„ä¸‹ int p_indent_depth = 0 //åˆ†ç»„ç¼©è¿›æ·±åº¦ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 2 3 4 //ä½¿ç”¨é»˜è®¤ç¼©è¿› 0 #define ADD_GROUP(m_name, m_prefix) ::ClassDB::add_property_group(get_class_static(), m_name, m_prefix) //ä½¿ç”¨è‡ªå®šä¹‰ç¼©è¿› #define ADD_GROUP_INDENT(m_name, m_prefix, m_depth) ::ClassDB::add_property_group(get_class_static(), m_name, m_prefix, m_depth) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 void Resource::_bind_methods() { ADD_GROUP(\u0026#34;AddGroup1\u0026#34;, \u0026#34;addGroup1_\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup1_Color0\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup1_Color1\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_GROUP_INDENT(\u0026#34;AddGroup2\u0026#34;, \u0026#34;AddGroup2_\u0026#34;,1); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;AddGroup2_Color2\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;AddGroup2_Color3\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_SUBGROUP(\u0026#34;AddGroup3\u0026#34;, \u0026#34;addGroup3_\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup3_Color4\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup3_Color5\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_SUBGROUP_INDENT(\u0026#34;AddGroup4\u0026#34;, \u0026#34;addGroup4_\u0026#34;,2); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup4_Color6\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup4_Color7\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void ClassDB::add_property_group(const StringName \u0026amp;p_class, const String \u0026amp;p_name, const String \u0026amp;p_prefix, int p_indent_depth) { // é”ä¸Šè¯»é”ï¼Œè·å–ç±»å‹ä¿¡æ¯æŒ‡é’ˆï¼Œéç©ºæ£€æµ‹ OBJTYPE_WLOCK; ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); //æ ¹æ®ç¼©è¿›ï¼Œè¿›è¡Œå‰ç¼€æ‹¼æ¥ String prefix = p_prefix; if (p_indent_depth \u0026gt; 0) { prefix = vformat(\u0026#34;%s,%d\u0026#34;, p_prefix, p_indent_depth); } //åœ¨ç±»å‹ä¿¡æ¯çš„property_listä¸­ï¼Œå¡«å…¥åˆ†ç»„çš„å±æ€§ type-\u0026gt;property_list.push_back( PropertyInfo(Variant::NIL, //å ä½ p_name, //åˆ†ç»„å PROPERTY_HINT_NONE, //æ— æç¤º prefix, //å‰ç¼€ PROPERTY_USAGE_GROUP//ä½¿ç”¨ç±»å‹ä¸º åˆ†ç»„ ) ); } get_property_list æœ¬è´¨è¿˜æ˜¯å¯¹ClassInfoä¸­çš„property_listçš„éå†è¯».\næ³¨æ„ï¼Œæ­¤å¤„çš„ClassDB::get_property_listä»…æœ‰æŸ¥è¯¢çš„åŠŸèƒ½ï¼Œå¹¶ä¸ä¼šè§¦å‘æˆ‘ä»¬è‡ªå·±é‡å†™çš„_get_property_list()å‡½æ•°ã€‚\nå¦‚æœéœ€è¦èµ°è‡ªå®šä¹‰çš„_get_property_list()å‡½æ•°ï¼Œè¯·ä½¿ç”¨YourObject.get_property_list()çš„æ–¹å¼æ¥æŸ¥è¯¢ã€‚\nobjectä¸­çš„GDCLASS(m_class, m_inherits)å®ä¸­åŒ…è£…äº†_get_property_listvæ–¹æ³•ï¼Œç”¨äºè·å–å±æ€§åˆ—è¡¨æ—¶è°ƒç”¨è‡ªå®šä¹‰çš„_get_property_list()å‡½æ•°ã€‚\næ–¹æ³•ç­¾å\n1 2 3 4 5 6 static void get_property_list( const StringName \u0026amp;p_class, //éœ€è¦æŸ¥è¯¢ç±»çš„åç§° List\u0026lt;PropertyInfo\u0026gt; *p_list, //è¿”å›çš„å±æ€§åˆ—è¡¨ bool p_no_inheritance = false,//æ˜¯å¦å‘ä¸ŠæŸ¥è¯¢çˆ¶ç±»,é»˜è®¤æŸ¥è¯¢ const Object *p_validator = nullptr)//å…³è”çš„å®é™…ç±»ï¼Œå¯ä»¥ä¸å…³è” ; ä½¿ç”¨ç¤ºä¾‹\n1 2 List\u0026lt;PropertyInfo\u0026gt; list; ClassDB::get_property_list(\u0026#34;YourObject\u0026#34;, \u0026amp;list,true); æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void ClassDB::get_property_list(const StringName \u0026amp;p_class, List\u0026lt;PropertyInfo\u0026gt; *p_list, bool p_no_inheritance, const Object *p_validator) { //é”ä¸Šè¯»é”,ç›´åˆ°å‡ºä½œç”¨åŸŸ OBJTYPE_RLOCK; //é€çº§å‘çˆ¶ç±»æŸ¥è¯¢ç±»å‹ä¿¡æ¯ ClassInfo *type = classes.getptr(p_class); ClassInfo *check = type; while (check) { //éå†å±æ€§åˆ—è¡¨ä¿¡æ¯ for (const PropertyInfo \u0026amp;pi : check-\u0026gt;property_list) { //æ˜¯å¦å…³è”å®ä¾‹ if (p_validator) { // Making a copy as we may modify it. PropertyInfo pi_mut = pi; p_validator-\u0026gt;validate_property(pi_mut); p_list-\u0026gt;push_back(pi_mut); } else { //ä¸å…³è”å°±å°†property_listç›´æ¥æ¨å…¥åˆ—è¡¨p_list p_list-\u0026gt;push_back(pi); } } //æ˜¯å¦æŸ¥è¯¢çˆ¶ç±»ï¼Œå¦‚æœä¸æŸ¥è¯¢ï¼Œç›´æ¥è¿”å› if (p_no_inheritance) { return; } //å˜æ›´ä¸ºçˆ¶ç±»ç±»å‹ä¿¡æ¯æŒ‡é’ˆ check = check-\u0026gt;inherits_ptr; } } get_property æ–¹æ³•ç­¾å\n1 2 3 4 5 bool ClassDB::get_property( Object *p_object, //è¢«æŸ¥è¯¢çš„å®ä¾‹ const StringName \u0026amp;p_property, //å±æ€§å Variant \u0026amp;r_value//å±æ€§å€¼ ); ä½¿ç”¨ç¤ºä¾‹\n1 bool ret = ClassDB::get_property(\u0026#34;MyObject\u0026#34;, \u0026#34;property_name\u0026#34;, value); æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\næ³¨ï¼šPropertySetGetå®šä¹‰è¯¦è§æ­¤å¤„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 bool ClassDB::get_property(Object *p_object, const StringName \u0026amp;p_property, Variant \u0026amp;r_value) { //ç©ºæŒ‡é’ˆæ£€æµ‹ ERR_FAIL_NULL_V(p_object, false); //å‘ä¸Šé€çº§æŸ¥è¯¢ç±»å‹ä¿¡æ¯ ClassInfo *type = classes.getptr(p_object-\u0026gt;get_class_name()); ClassInfo *check = type; while (check) { //æŸ¥è¯¢ç±»å‹ä¿¡æ¯ä¸­çš„property_setget const PropertySetGet *psg = check-\u0026gt;property_setget.getptr(p_property); if (psg) { //å­˜åœ¨PropertySetGetï¼Œä½†æ˜¯æ²¡æœ‰getteræ–¹æ³• if (!psg-\u0026gt;getter) { return true; //return true but do nothing } if (psg-\u0026gt;index \u0026gt;= 0) { Variant index = psg-\u0026gt;index; const Variant *arg[1] = { \u0026amp;index }; Callable::CallError ce; //åˆ©ç”¨å¯¹è±¡å®ä¾‹çš„callpæ–¹æ³•ï¼ŒåŠ¨æ€è°ƒç”¨è¯¥å±æ€§çš„getteræ–¹æ³• //å¯¹äºç´¢å¼•ä¸ä¸º-1ï¼ˆæ•°ç»„ï¼‰çš„å±æ€§å€¼ï¼Œéœ€è¦ä¼ å…¥ç´¢å¼•å‚æ•° const Variant value = p_object-\u0026gt;callp(psg-\u0026gt;getter, arg, 1, ce); r_value = (ce.error == Callable::CallError::CALL_OK) ? value : Variant(); } else { Callable::CallError ce; if (psg-\u0026gt;_getptr) { //é€šè¿‡MethodBindæŒ‡é’ˆ_getptrè°ƒç”¨getteræ–¹æ³• r_value = psg-\u0026gt;_getptr-\u0026gt;call(p_object, nullptr, 0, ce); } else { const Variant value = p_object-\u0026gt;callp(psg-\u0026gt;getter, nullptr, 0, ce); r_value = (ce.error == Callable::CallError::CALL_OK) ? value : Variant(); } } return true; } const int64_t *c = check-\u0026gt;constant_map.getptr(p_property); //constants count if (c) { r_value = *c; return true; } if (check-\u0026gt;method_map.has(p_property)) { //methods count r_value = Callable(p_object, p_property); return true; } if (check-\u0026gt;signal_map.has(p_property)) { //signals count r_value = Signal(p_object, p_property); return true; } check = check-\u0026gt;inherits_ptr; } // The \u0026#34;free()\u0026#34; method is special, so we assume it exists and return a Callable. if (p_property == CoreStringName(free_)) { r_value = Callable(p_object, p_property); return true; } return false; } å‡½æ•°æ¥å£ å‡½æ•°ç›¸å…³çš„æ¥å£ï¼Œæ˜¯ClassDBä¸­æœ€å¤æ‚çš„ä¸€ç»„ï¼Œæ¶‰åŠåˆ°å‡½æ•°çš„ç»‘å®šï¼Œæ‰€ä»¥godotç”¨äº†éå¸¸å¤šçš„æ¨¡æ¿æ¥å®ç°ã€‚ å®ƒçš„ä¿¡æ¯å­˜å‚¨åœ¨ClassInfoçš„ä¸‹é¢ä¸¤ä¸ªæˆå‘˜å˜é‡ä¸­ï¼š\nHashMap\u0026lt;StringName, MethodBind *\u0026gt; method_map; HashMap\u0026lt;StringName, LocalVector\u0026lt;MethodBind *\u0026gt;\u0026gt; method_map_compatibility; æ¥å£ ä½œç”¨ bind_method ç±»å‹æ³¨å†Œæ—¶çš„å‡½æ•°ç»‘å®šæ–¹æ³•ï¼Œç”¨çš„éå¸¸å¹¿æ³› has_method æŸ¥è¯¢æ˜¯ç±»å¦åŒ…å«æŸä¸ªå‡½æ•°ï¼Œé€šè¿‡classinfoçš„method_mapæ¥æŸ¥è¯¢ get_method_list æŸ¥è¯¢æŸä¸ªç±»çš„æ‰€æœ‰å‡½æ•°ä¿¡æ¯MethodInfo,é€šè¿‡classinfoçš„method_mapæ¥æŸ¥è¯¢ bind_method bind_methodçš„ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸€ä¸ªC++æˆå‘˜å‡½æ•°ï¼Œå°è£…æˆä¸€ä¸ªMethodBindï¼Œç„¶åå†æ³¨å†Œè¿›ClassDBçš„ç±»å‹ä¿¡æ¯ä¸­ï¼Œè·¯å¾„ä¸ºï¼šclassdb::classes-\u0026gt;ClassInfo::method_map\nè¯¥æ–¹æ³•ä½¿ç”¨éå¸¸ç®€å•ï¼Œä½†æ˜¯å†…éƒ¨å®ç°æå…¶å¤æ‚ï¼Œç¬”è€…ä»£ç èƒ½åŠ›æœ‰é™ï¼Œä»…èƒ½åšéƒ¨åˆ†ä»£ç çš„è§£è¯»ã€‚å› æ­¤è¯¥å‡½æ•°çš„ä»‹ç»ï¼Œä¼šæ›´åå‘ä½¿ç”¨ã€‚\nMethodDefinition åœ¨ä¸‹æ–¹æœ‰è¯¦ç»†æè¿°ï¼Œå®ƒä»…æ˜¯å­—ç¬¦ä¸²çš„æè¿° æ–¹æ³•ç­¾å\n1 2 3 4 5 6 template \u0026lt;typename N, typename M, typename... VarArgs\u0026gt; static MethodBind *bind_method( N p_method_name, //å‡½æ•°åã€å‚æ•°åˆ—è¡¨çš„æè¿°ï¼ŒMethodDefinitionç±»å‹ï¼Œåˆ©ç”¨D_METHOD()ç”Ÿæˆ M p_method, //æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼Œä¾‹å¦‚ \u0026amp;Input::warp_mouse VarArgs... p_args //å‡½æ•°é»˜è®¤å€¼å‚æ•°åŒ… ); ä½¿ç”¨ç¤ºä¾‹\nDEFVALç”¨äºå‡½æ•°é»˜è®¤å€¼å‚æ•°çš„åŒ…è£…ï¼Œå®ƒçš„æ’åºå¯¹åº”å‡½æ•°ç­¾åçš„åNä½ã€‚\nä»¥ä¸‹æ–¹testfuncçš„å‡½æ•°ç»‘å®šä¸ºä¾‹ï¼š\narg4 = 0.0f arg5 = -1.0f 1 2 3 4 void Input::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;is_anything_pressed\u0026#34;), \u0026amp;Input::is_anything_pressed); ClassDB::bind_method(D_METHOD(\u0026#34;testfunc\u0026#34;, \u0026#34;arg1\u0026#34;, \u0026#34;arg2\u0026#34;, \u0026#34;arg3\u0026#34;, \u0026#34;arg4\u0026#34;, \u0026#34;arg5\u0026#34;), \u0026amp;Input::testfunc, DEFVAL(0.0f),DEFVAL(-1.0f)); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\né€šè¿‡ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¦æ­£ç¡®ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œéœ€è¦ä½¿ç”¨ä¸¤ä¸ªå‡½æ•°\nD_METHOD åˆ›å»ºMethodDefinitionï¼Œç”¨äºæè¿°å‡½æ•°çš„å‚æ•°åˆ—è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 template \u0026lt;typename... VarArgs\u0026gt; MethodDefinition D_METHOD(const char *p_name, const VarArgs... p_args) { //åˆ›å»ºå‚æ•°åˆ—è¡¨args,åˆ©ç”¨åˆ—è¡¨åˆå§‹åŒ–å±•å¼€å‚æ•°åŒ…p_args //æ”¶é›†æ‰€æœ‰å‚æ•°åç§° const char *args[sizeof...(p_args) + 1] = { p_args..., nullptr }; // +1 makes sure zero sized arrays are also supported. const char *const *argptrs[sizeof...(p_args) + 1]; for (uint32_t i = 0; i \u0026lt; sizeof...(p_args); i++) { argptrs[i] = \u0026amp;args[i]; } //å°†æ”¶é›†çš„å‚æ•°åˆ—è¡¨ï¼Œä¼ å…¥D_METHODP()è¿›è¡ŒMDçš„åˆ›å»º return D_METHODP(p_name, sizeof...(p_args) == 0 ? nullptr : (const char *const **)argptrs, sizeof...(p_args)); } MethodDefinition D_METHODP(const char *p_name, const char *const **p_args, uint32_t p_argcount) { //å®é™…åˆ›å»ºMethodDefinitionï¼Œå¡«å…¥å‡½æ•°åç§°å’Œå‚æ•°åç§°åˆ—è¡¨ MethodDefinition md; md.name = StaticCString::create(p_name); md.args.resize(p_argcount); for (uint32_t i = 0; i \u0026lt; p_argcount; i++) { md.args.write[i] = StaticCString::create(*p_args[i]); } return md; } ClassDB::bind_method æ‰§è¡Œå‡½æ•°ç»‘å®š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 template \u0026lt;typename N, typename M, typename... VarArgs\u0026gt; static MethodBind *bind_method(N p_method_name, M p_method, VarArgs... p_args) { //åˆ›å»ºå‚æ•°åˆ—è¡¨args,åˆ©ç”¨åˆ—è¡¨åˆå§‹åŒ–å±•å¼€å‚æ•°åŒ…p_args Variant args[sizeof...(p_args) + 1] = { p_args..., Variant() }; // +1 makes sure zero sized arrays are also supported. //åˆ›å»ºå‚æ•°æŒ‡é’ˆåˆ—è¡¨argptrs const Variant *argptrs[sizeof...(p_args) + 1]; //éå†å‚æ•°åˆ—è¡¨argsï¼Œå¹¶å°†å‚æ•°æŒ‡é’ˆä¿å­˜åˆ°argptrsä¸­ for (uint32_t i = 0; i \u0026lt; sizeof...(p_args); i++) { argptrs[i] = \u0026amp;args[i]; } //åˆ›å»ºå‡½æ•°ç»‘å®šMethodBind //æ­¤å¤„æ¯”è¾ƒå¤æ‚ï¼Œæš‚æ—¶ä¸å±•å¼€ MethodBind *bind = create_method_bind(p_method); if constexpr (std::is_same_v\u0026lt;typename member_function_traits\u0026lt;M\u0026gt;::return_type, Object *\u0026gt;) { bind-\u0026gt;set_return_type_is_raw_object_ptr(true); } //å°†å‡½æ•°ç»‘å®šä¿¡æ¯çš„æ³¨å†Œåˆ°ClassDBä¸­ return bind_methodfi(METHOD_FLAGS_DEFAULT, bind, false, p_method_name, sizeof...(p_args) == 0 ? nullptr : (const Variant **)argptrs, sizeof...(p_args)); } get_method_list ä¿¡æ¯ç±» ClassInfo ClassInfoæ˜¯ClassDBä¸­å®šä¹‰çš„ç±»ä¿¡æ¯ç»“æ„ä½“ï¼Œå®ƒä¿å­˜äº†ç±»çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ç±»çš„åç§°ã€ç»§æ‰¿å…³ç³»ã€æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å±æ€§ç­‰ä¿¡æ¯ã€‚ä¸‹æ–¹æˆªå–äº†4.4ç‰ˆæœ¬godotæºç ä¸­ClassInfoç±»çš„éƒ¨åˆ†ä»£ç ï¼Œå¹¶æ ‡æ³¨äº†ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼Œå¸®åŠ©æˆ‘ä»¬å»æ•´ä½“çš„ç†è§£ClassInfoçš„è¿è¡ŒåŸç†ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæ–¹æ³•å’Œå±æ€§çš„é¡ºåºï¼Œå¹¶éä¸æºç ä¸¥æ ¼ä¸€è‡´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 struct ClassInfo { // æ ¹æ®æ³¨å†Œçš„æ—¶æœºå’Œæ¥å£ä¸åŒï¼ŒAPIç±»å‹æœ‰ä»¥ä¸‹5ç§ï¼š // API_COREã€ // API_EDITORã€ // API_EXTENSIONã€ // API_EDITOR_EXTENSIONã€ // API_NONE APIType api = API_NONE; //çˆ¶ç±»çš„ç±»ä¿¡æ¯æŒ‡é’ˆ ClassInfo *inherits_ptr = nullptr; void *class_ptr = nullptr; //gdextensionæŒ‡é’ˆ ObjectGDExtension *gdextension = nullptr; //ç±»çš„æ–¹æ³•ä¿¡æ¯ï¼Œé”®æ˜¯æ–¹æ³•åï¼Œå€¼æ˜¯æ–¹æ³•ç»‘å®š HashMap\u0026lt;StringName, MethodBind *\u0026gt; method_map; HashMap\u0026lt;StringName, LocalVector\u0026lt;MethodBind *\u0026gt;\u0026gt; method_map_compatibility; HashMap\u0026lt;StringName, int64_t\u0026gt; constant_map; struct EnumInfo { List\u0026lt;StringName\u0026gt; constants; bool is_bitfield = false; }; HashMap\u0026lt;StringName, EnumInfo\u0026gt; enum_map; //ç±»ä¿¡å·ä¿¡æ¯ï¼Œé”®æ˜¯ä¿¡å·å HashMap\u0026lt;StringName, MethodInfo\u0026gt; signal_map; //ç±»å±æ€§ä¿¡æ¯åˆ—è¡¨ List\u0026lt;PropertyInfo\u0026gt; property_list; //ç±»å±æ€§ä¿¡æ¯ï¼Œé”®æ˜¯å±æ€§åç§°ï¼Œå€¼æ˜¯å±æ€§ä¿¡æ¯ HashMap\u0026lt;StringName, PropertyInfo\u0026gt; property_map; //ç±»å±æ€§set/getä¿¡æ¯ï¼Œé”®æ˜¯å±æ€§åç§°ï¼Œå€¼æ˜¯å±æ€§è®¾ç½®å’Œè·å–æ–¹æ³•ä¿¡æ¯ HashMap\u0026lt;StringName, PropertySetGet\u0026gt; property_setget; HashMap\u0026lt;StringName, Vector\u0026lt;uint32_t\u0026gt;\u0026gt; virtual_methods_compat; //çˆ¶ç±»åç§° StringName inherits; //è‡ªèº«ç±»å StringName name; bool disabled = false; bool exposed = false; bool reloadable = false; bool is_virtual = false; bool is_runtime = false; // The bool argument indicates the need to postinitialize. Object *(*creation_func)(bool) = nullptr; ClassInfo() {} ~ClassInfo() {} }; MethodDefinition 1 2 3 4 5 6 7 8 9 struct MethodDefinition { StringName name;//æ–¹æ³•åç§° Vector\u0026lt;StringName\u0026gt; args;//æ–¹æ³•å‚æ•°åç§°åˆ—è¡¨ MethodDefinition() {} MethodDefinition(const char *p_name) : name(p_name) {} MethodDefinition(const StringName \u0026amp;p_name) : name(p_name) {} }; MethodInfo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 struct MethodInfo { String name; PropertyInfo return_val; uint32_t flags = METHOD_FLAGS_DEFAULT; int id = 0; List\u0026lt;PropertyInfo\u0026gt; arguments; Vector\u0026lt;Variant\u0026gt; default_arguments; int return_val_metadata = 0; Vector\u0026lt;int\u0026gt; arguments_metadata; int get_argument_meta(int p_arg) const { ERR_FAIL_COND_V(p_arg \u0026lt; -1 || p_arg \u0026gt; arguments.size(), 0); if (p_arg == -1) { return return_val_metadata; } return arguments_metadata.size() \u0026gt; p_arg ? arguments_metadata[p_arg] : 0; } inline bool operator==(const MethodInfo \u0026amp;p_method) const { return id == p_method.id \u0026amp;\u0026amp; name == p_method.name; } inline bool operator\u0026lt;(const MethodInfo \u0026amp;p_method) const { return id == p_method.id ? (name \u0026lt; p_method.name) : (id \u0026lt; p_method.id); } operator Dictionary() const; static MethodInfo from_dict(const Dictionary \u0026amp;p_dict); uint32_t get_compatibility_hash() const; MethodInfo() {} explicit MethodInfo(const GDExtensionMethodInfo \u0026amp;pinfo) : name(*reinterpret_cast\u0026lt;StringName *\u0026gt;(pinfo.name)), return_val(PropertyInfo(pinfo.return_value)), flags(pinfo.flags), id(pinfo.id) { for (uint32_t j = 0; j \u0026lt; pinfo.argument_count; j++) { arguments.push_back(PropertyInfo(pinfo.arguments[j])); } const Variant *def_values = (const Variant *)pinfo.default_arguments; for (uint32_t j = 0; j \u0026lt; pinfo.default_argument_count; j++) { default_arguments.push_back(def_values[j]); } } void _push_params(const PropertyInfo \u0026amp;p_param) { arguments.push_back(p_param); } template \u0026lt;typename... VarArgs\u0026gt; void _push_params(const PropertyInfo \u0026amp;p_param, VarArgs... p_params) { arguments.push_back(p_param); _push_params(p_params...); } MethodInfo(const String \u0026amp;p_name) { name = p_name; } template \u0026lt;typename... VarArgs\u0026gt; MethodInfo(const String \u0026amp;p_name, VarArgs... p_params) { name = p_name; _push_params(p_params...); } MethodInfo(Variant::Type ret) { return_val.type = ret; } MethodInfo(Variant::Type ret, const String \u0026amp;p_name) { return_val.type = ret; name = p_name; } template \u0026lt;typename... VarArgs\u0026gt; MethodInfo(Variant::Type ret, const String \u0026amp;p_name, VarArgs... p_params) { name = p_name; return_val.type = ret; _push_params(p_params...); } MethodInfo(const PropertyInfo \u0026amp;p_ret, const String \u0026amp;p_name) { return_val = p_ret; name = p_name; } template \u0026lt;typename... VarArgs\u0026gt; MethodInfo(const PropertyInfo \u0026amp;p_ret, const String \u0026amp;p_name, VarArgs... p_params) { return_val = p_ret; name = p_name; _push_params(p_params...); } }; MethodBind MethodBindå®ç°æ¯”è¾ƒå¤æ‚ï¼Œæ­¤å¤„ä»…åˆ—å‡ºéƒ¨åˆ†æˆå‘˜å‡½æ•°å’Œæˆå‘˜å˜é‡ï¼Œç”¨äºç†è§£å®ƒçš„ä½œç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class MethodBind { int method_id; uint32_t hint_flags = METHOD_FLAGS_DEFAULT; StringName name; StringName instance_class; Vector\u0026lt;Variant\u0026gt; default_arguments; int default_argument_count = 0; int argument_count = 0; bool _static = false; bool _const = false; bool _returns = false; bool _returns_raw_obj_ptr = false; // ... } PropertyInfo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 struct PropertyInfo { Variant::Type type = Variant::NIL; String name; StringName class_name; // For classes PropertyHint hint = PROPERTY_HINT_NONE; String hint_string; uint32_t usage = PROPERTY_USAGE_DEFAULT; // If you are thinking about adding another member to this class, ask the maintainer (Juan) first. _FORCE_INLINE_ PropertyInfo added_usage(uint32_t p_fl) const { PropertyInfo pi = *this; pi.usage |= p_fl; return pi; } operator Dictionary() const; static PropertyInfo from_dict(const Dictionary \u0026amp;p_dict); PropertyInfo() {} PropertyInfo(const Variant::Type p_type, const String \u0026amp;p_name, const PropertyHint p_hint = PROPERTY_HINT_NONE, const String \u0026amp;p_hint_string = \u0026#34;\u0026#34;, const uint32_t p_usage = PROPERTY_USAGE_DEFAULT, const StringName \u0026amp;p_class_name = StringName()) : type(p_type), name(p_name), hint(p_hint), hint_string(p_hint_string), usage(p_usage) { if (hint == PROPERTY_HINT_RESOURCE_TYPE) { class_name = hint_string; } else { class_name = p_class_name; } } PropertyInfo(const StringName \u0026amp;p_class_name) : type(Variant::OBJECT), class_name(p_class_name) {} explicit PropertyInfo(const GDExtensionPropertyInfo \u0026amp;pinfo) : type((Variant::Type)pinfo.type), name(*reinterpret_cast\u0026lt;StringName *\u0026gt;(pinfo.name)), class_name(*reinterpret_cast\u0026lt;StringName *\u0026gt;(pinfo.class_name)), hint((PropertyHint)pinfo.hint), hint_string(*reinterpret_cast\u0026lt;String *\u0026gt;(pinfo.hint_string)), usage(pinfo.usage) {} bool operator==(const PropertyInfo \u0026amp;p_info) const { return ((type == p_info.type) \u0026amp;\u0026amp; (name == p_info.name) \u0026amp;\u0026amp; (class_name == p_info.class_name) \u0026amp;\u0026amp; (hint == p_info.hint) \u0026amp;\u0026amp; (hint_string == p_info.hint_string) \u0026amp;\u0026amp; (usage == p_info.usage)); } bool operator\u0026lt;(const PropertyInfo \u0026amp;p_info) const { return name \u0026lt; p_info.name; } }; PropertySetGet 1 2 3 4 5 6 7 8 struct PropertySetGet { int index;\t//å±æ€§ç´¢å¼•ï¼Œé»˜è®¤ä¸º-1ï¼Œæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ StringName setter;\t//setterå‡½æ•°å StringName getter;\t//getterå‡½æ•°å MethodBind *_setptr = nullptr; //setterå‡½æ•°åŒ…æŒ‡é’ˆ MethodBind *_getptr = nullptr; //getterå‡½æ•°åŒ…æŒ‡é’ˆ Variant::Type type;\t//å±æ€§ç±»å‹ }; ","date":"2025-11-07T09:18:31+08:00","image":"https://Liyufei1.github.io/godot.png","permalink":"https://Liyufei1.github.io/p/godot%E4%BA%94godot%E4%B8%AD%E7%9A%84%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9Frtti/","title":"ã€godotã€‘äº”ã€godotä¸­çš„åŠ¨æ€ç±»å‹ä¿¡æ¯ç³»ç»ŸRTTI"},{"content":"æ€§èƒ½åˆ†æç›¸å…³ godotä½œä¸ºç›¸å¯¹æˆç†Ÿçš„æ¸¸æˆå¼•æ“ï¼Œå…¶æœ¬èº«å°±æä¾›äº†ç›¸å¯¹å®Œå–„çš„è¿è¡Œæ—¶æ€§èƒ½ç›‘æµ‹å·¥å…·ã€‚æœ¬æ–‡å°†å¯¹å¸¸ç”¨çš„è¿è¡Œæ—¶æ€§èƒ½å‚æ•°çš„è·å–å’Œä½¿ç”¨è¿›è¡Œä¸€ä¸ªç®€æ˜“çš„è¯´æ˜ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶äº†è§£è·å–åŠç†è§£è¿™äº›å‚æ•°ã€‚\nPerformance Performanceæ˜¯godotå†…ç½®çš„æ€§èƒ½æ•°æ®å­˜å‚¨å™¨ï¼Œå®ƒæä¾›å¯¹è®¸å¤šä¸æ€§èƒ½ç›¸å…³çš„ä¸åŒç›‘è§†å™¨çš„è®¿é—®ï¼Œä¾‹å¦‚è´´å›¾å†…å­˜ä½¿ç”¨æƒ…å†µ :RENDER_BUFFER_MEM_USEDï¼ˆåœ¨glbufferDataçš„æ—¶å€™ï¼Œä¼šå¯¹ç”³è¯·çš„sizeè¿›è¡Œç´¯åŠ ï¼‰ã€ç»˜åˆ¶è°ƒç”¨:RENDER_TOTAL_DRAW_CALLS_IN_FRAME ï¼ˆgldrawçš„æ—¶å€™åŠ ä¸€ï¼‰FPSã€‚\nè¿™äº›å€¼ä¸ç¼–è¾‘å™¨çš„è°ƒè¯•å™¨é¢æ¿ä¸­çš„ç›‘è§†é€‰é¡¹å¡ä¸­æ˜¾ç¤ºçš„å€¼ç›¸åŒã€‚é€šè¿‡ä½¿ç”¨è¯¥ç±»çš„ get_monitor() æ–¹æ³•ï¼Œä½ å¯ä»¥ä»ä»£ç ä¸­è®¿é—®è¯¥æ•°æ®ã€‚\næ³¨æ„ï¼šæŸäº›å†…ç½®ç›‘è§†å™¨ä»…åœ¨è°ƒè¯•æ¨¡å¼ä¸‹å¯ç”¨ï¼Œå¹¶ä¸”åœ¨ä»¥å‘å¸ƒæ¨¡å¼å¯¼å‡ºçš„é¡¹ç›®ä¸­ä½¿ç”¨æ—¶ï¼Œå°†å§‹ç»ˆè¿”å› 0ã€‚\næ³¨æ„ï¼šå‡ºäºæ€§èƒ½åŸå› ï¼ŒæŸäº›å†…ç½®ç›‘è§†å™¨ä¸ä¼šå®æ—¶æ›´æ–°ï¼Œæ‰€ä»¥åœ¨æ›´æ”¹ä¹‹é—´å¯èƒ½ä¼šæœ‰é•¿è¾¾ 1 ç§’çš„å»¶è¿Ÿã€‚\næ³¨æ„ï¼šè‡ªå®šä¹‰ç›‘è§†å™¨ä¸æ”¯æŒè´Ÿå€¼ã€‚è´Ÿå€¼è¢«é’³åˆ¶ä¸º 0\n1 2 //Performance::TIME_FPSæ˜¯æå‰å†…ç½®çš„Monitor Performance::get_singleton()-\u0026gt;get_monitor(Performance::TIME_FPS); åç§° ä½œç”¨ TIME_FPS å¸§ç‡ï¼ˆæ¯ç§’å¸§æ•°ï¼‰ TIME_PROCESS æ¯å¸§çš„å¤„ç†æ—¶é—´ï¼ˆä¸åŒ…æ‹¬ç‰©ç†å’Œå¯¼èˆªè¿‡ç¨‹ï¼‰ï¼Œc++/Gdscript TIME_PHYSICS_PROCESS ç‰©ç†å¤„ç†çš„æ—¶é—´ MEMORY_STATIC é™æ€å†…å­˜ä½¿ç”¨é‡ï¼ˆä¸åŒ…æ‹¬åŠ¨æ€å†…å­˜ï¼‰ MEMORY_STATIC_MAX é™æ€å†…å­˜çš„æœ€å¤§ä½¿ç”¨é‡ MEMORY_MESSAGE_BUFFER_MAX æ¶ˆæ¯ç¼“å†²åŒºçš„æœ€å¤§å†…å­˜ä½¿ç”¨é‡ OBJECT_COUNT å½“å‰åœºæ™¯ä¸­çš„æ€»å¯¹è±¡æ•° OBJECT_RESOURCE_COUNT å½“å‰åœºæ™¯ä¸­èµ„æºçš„æ•°é‡ OBJECT_NODE_COUNT å½“å‰åœºæ™¯ä¸­èŠ‚ç‚¹çš„æ•°é‡ OBJECT_ORPHAN_NODE_COUNT å­¤ç«‹èŠ‚ç‚¹çš„æ•°é‡ï¼ˆæ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰ RENDER_TOTAL_OBJECTS_IN_FRAME æ¯å¸§æ¸²æŸ“çš„æ€»å¯¹è±¡æ•°é‡ RENDER_TOTAL_PRIMITIVES_IN_FRAME æ¯å¸§æ¸²æŸ“çš„æ€»å›¾å½¢åŸè¯­æ•°é‡ï¼ˆå¦‚ä¸‰è§’å½¢ã€çº¿æ¡ï¼‰ RENDER_TOTAL_DRAW_CALLS_IN_FRAME æ¯å¸§æ¸²æŸ“çš„æ€»ç»˜åˆ¶è°ƒç”¨æ¬¡æ•° RENDER_TEXTURE_MEM_USED æ¸²æŸ“ä½¿ç”¨çš„çº¹ç†å†…å­˜é‡ RENDER_BUFFER_MEM_USED æ¸²æŸ“ä½¿ç”¨çš„ç¼“å†²åŒºå†…å­˜é‡ MEMORY_STATIC Performanceä¸­çš„é™æ€å†…å­˜æ•°æ®ï¼ŒåŒ…å«äº†godotä½“ç³»ä¸‹çš„æ‰€æœ‰ç”¨æˆ·ç”³è¯·çš„å†…å­˜ï¼Œä¹Ÿå³Variantä¸­è¢«æ ‡æ³¨çš„å˜é‡ã€‚\n**æ³¨æ„ï¼š**cppåŸç”Ÿç±»å‹ç”³è¯·çš„å†…å­˜ç©ºé—´å¹¶ä¸ä¼šè¢«ç»Ÿè®¡è¿›å»ã€‚\nè¯¥æ•°æ®è¢«å®é™…å­˜å‚¨åœ¨Memaryç±»ä¸­ï¼Œå‡ºäºçº¿ç¨‹å®‰å…¨è€ƒè™‘ï¼Œå®ƒè¢«åŒ…è£…åœ¨ä¸€ä¸ªåŸå­ç±»å‹ä¸­ï¼š\nRENDER_TEXTURE_MEM_USED åœ¨glæ¸²æŸ“æ¨¡å¼ä¸‹ï¼Œç”±äºå¹¶æ²¡æœ‰RenderDeviceå±‚ï¼Œéƒ½æ˜¯ç›´æ¥ä½¿ç”¨çš„glæ¥å£ï¼Œå› æ­¤æ•°æ®çš„è®°å½•ç›¸å¯¹æ›´åŠ ç›´æ¥ã€‚\nperformancceä¸­è®¿é—®çš„RENDER_TEXTURE_MEM_USEDæ˜¯é€šè¿‡**RenderingServeræä¾›çš„get_rendering_info**æ¥å£æ¥è·å–çš„ã€‚\nåœ¨å¾€ä¸‹èµ°å°±æ˜¯RGS::RendererUtilitiesæä¾›çš„**get_rendering_info**æ¥å£ï¼Œåœ¨Utilitiesä¸­ï¼Œç®¡ç†ç€glç”³è¯·å‡ºæ¥çš„æ‰€æœ‰å†…å­˜ã€‚\nåœ¨æ¯ä¸€æ¬¡ç”³è¯·å’Œåˆ é™¤æ¸²æŸ“glå†…å­˜æ—¶ï¼ŒUtilitieséƒ½ä¼šå¯¹å†…å­˜å¤§å°çš„ç»Ÿè®¡æ•°å­—åšå‡ºç›¸åº”çš„å¢å‡ã€‚\næˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„èµ„æºæ³„éœ²æŠ¥é”™ï¼Œå°±æ¥è‡ªäºUtilitiesçš„ææ„å‡½æ•°ã€‚\nå½“Utilitieså‘ç”Ÿææ„æ—¶ï¼Œå¦‚æœglç”³è¯·çš„å†…å­˜æœªè¢«å®Œå…¨é‡Šæ”¾ï¼Œå°±ä¼šæ‰“å°è¯¥æ¡æŠ¥é”™æ—¥å¿—ã€‚ï¼ˆå¸¸ç”±äºå­¤ç«‹èŠ‚ç‚¹æœªè¢«æ­£ç¡®é‡Šæ”¾å¯¼è‡´ï¼‰\nRENDER_TOTAL_DRAW_CALLS_IN_FRAME performancceä¸­è®¿é—®çš„RENDER_TOTAL_DRAW_CALLS_IN_FRAMEä¹Ÿæ˜¯é€šè¿‡**RenderingServeræä¾›çš„get_rendering_infoæ¥å£æ¥è·å–çš„ã€‚è€ŒRenderingServeræŸ¥è¯¢çš„æ•°æ®ï¼Œåˆ™æ¥è‡ªRendererViewport**çš„total_draw_calls_usedã€‚\nRendererViewportä¸­è¿™ç»„æ•°æ®ï¼Œåˆ™æ˜¯åœ¨ç»˜åˆ¶é˜¶æ®µdraw_viewports()æ—¶ï¼Œæ”¶é›†ç´¯åŠ æ¿€æ´»çŠ¶æ€çš„Viewportä¸­çš„render_infoä¸­çš„æ•°æ®ã€‚\nå¯¹äºæ¯ä¸ªæ¿€æ´»çš„Viewportä¸­çš„drawcallï¼Œä¼šåœ¨glå…‰æ …åŒ–çš„é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯å®é™…è°ƒç”¨glç»˜åˆ¶å‡½æ•°çš„æ—¶å€™ï¼Œè¿›è¡Œä¸€æ¬¡å¢åŠ ã€‚\n**æ³¨æ„ï¼š**åŸºäºè¿™ä¸€ç‚¹ï¼Œæ‰‹åŠ¨è°ƒç”¨çš„ç»˜åˆ¶æ“ä½œglDrawElementsç­‰ï¼Œä¸ä¼šè¢«ç»Ÿè®¡è¿›godotçš„Drawcallä¸­ã€‚å› æ­¤åº”å°½é‡é¿å…glç›¸å…³å‡½æ•°çš„ç›´æ¥è°ƒç”¨ã€‚è€Œåº”è¯¥é€šè¿‡godotçš„å°è£…å±‚RenderingServeræ¥è°ƒç”¨ã€‚\nRenderingServer Godotå½“ä¸­çš„RenderingServerç›¸å½“äºUnrealä¸­çš„RHIï¼Œå®ƒæ˜¯åº•å±‚çš„æ¸²æŸ“æŠ½è±¡å±‚ï¼Œè´Ÿè´£ä¸å›¾å½¢ APIï¼ˆå¦‚ OpenGLã€Vulkanã€DirectXã€Metal ç­‰ï¼‰äº¤äº’ã€‚\nåŒæ—¶å®ƒä¹Ÿå­˜å‚¨äº†æ¸²æŸ“ç›¸å…³çš„æ•°æ®ï¼Œå¹¶ä¸”æä¾›äº†å¯¹åº”çš„è·å–æ¥å£ã€‚\nget_rendering_info get_rendering_infoå¯ä»¥æŸ¥è¯¢æ¸²æŸ“ç»˜åˆ¶ç›¸å…³çš„ä¿¡æ¯ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š\nåç§° è¯´æ˜ RENDERING_INFO_TOTAL_OBJECTS_IN_FRAME ç»˜åˆ¶å¯¹è±¡æ•°é‡ RENDERING_INFO_TOTAL_PRIMITIVES_IN_FRAME ç»˜åˆ¶å›¾å…ƒæ•°é‡ RENDERING_INFO_TOTAL_DRAW_CALLS_IN_FRAME DrawCall RENDERING_INFO_TEXTURE_MEM_USED è´´å›¾å†…å­˜ RENDERING_INFO_BUFFER_MEM_USED glbuffer RENDERING_INFO_VIDEO_MEM_USED RENDERING_INFO_PIPELINE_COMPILATIONS_CANVAS æ¸²æŸ“ç®¡çº¿ï¼ˆPipelineï¼‰ç¼–è¯‘çš„æ¬¡æ•° RENDERING_INFO_PIPELINE_COMPILATIONS_MESH RENDERING_INFO_PIPELINE_COMPILATIONS_SURFACE RENDERING_INFO_PIPELINE_COMPILATIONS_DRAW RENDERING_INFO_PIPELINE_COMPILATIONS_SPECIALIZATION viewport_get_render_info ä¸ä¸Šæ–¹æ¥å£å·®ä¸å¤šï¼Œä½†æ˜¯é’ˆå¯¹æŸä¸ªè§†å£ï¼Œè€Œéæ‰€æœ‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 enum ViewportRenderInfo { VIEWPORT_RENDER_INFO_OBJECTS_IN_FRAME, VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME, VIEWPORT_RENDER_INFO_DRAW_CALLS_IN_FRAME, VIEWPORT_RENDER_INFO_MAX, }; enum ViewportRenderInfoType { VIEWPORT_RENDER_INFO_TYPE_VISIBLE, VIEWPORT_RENDER_INFO_TYPE_SHADOW, VIEWPORT_RENDER_INFO_TYPE_CANVAS, VIEWPORT_RENDER_INFO_TYPE_MAX }; virtual int viewport_get_render_info(RID p_viewport, ViewportRenderInfoType p_type, ViewportRenderInfo p_info) = 0; Rander GPU and CPU Time æ³¨æ„ï¼Œéœ€è¦åˆ©ç”¨ä¸‹é¢ä¸¤ä¸ªæ¥å£æ—¶ï¼Œéœ€è¦åˆ©ç”¨viewport_set_measure_render_time()æ¥å£æå‰å¼€å¯æ—¶é—´ç»Ÿè®¡ï¼Œå¦åˆ™å§‹ç»ˆè¿”å›0.\nviewport_get_measured_render_time_cpuï¼ŒCPU åœ¨æŒ‡å®š Viewport ä¸Šæ‰§è¡Œæ¸²æŸ“çš„è€—æ—¶ viewport_get_measured_render_time_gpuï¼ŒGPU åœ¨æŒ‡å®š Viewport ä¸Šæ‰§è¡Œæ¸²æŸ“çš„è€—æ—¶ get_frame_setup_time_cpu å‡†å¤‡æ¸²æŸ“å‘½ä»¤ é˜¶æ®µæ‰€æ¶ˆè€—çš„æ—¶é—´ åœºæ™¯å‰”é™¤ï¼ˆCullingï¼‰ æ¸²æŸ“å¯¹è±¡æ’åº å…‰æºä¸é˜´å½±çš„åˆ†é… æè´¨/æ¸²æŸ“çŠ¶æ€è®¾ç½® å°†æ¸²æŸ“æ•°æ®å†™å…¥å‘½ä»¤ç¼“å†²ï¼ˆcommand bufferï¼‰ time .get_ticks_usec()è·å–godotä¸»çº¿ç¨‹æ—¶é—´\nRenderingDevice(glä¸æ”¯æŒ) RENDER_TIMESTAMP å…¶å®æ˜¯å¼•æ“æ¸²æŸ“ç®¡çº¿é‡Œçš„ä¸€ç±» GPU æ—¶é—´æˆ³ (Timestamp) æ ‡è®°ã€‚\né€šè¿‡**RenderingDevice**å¯ä»¥è·å–æŸä¸ªé˜¶æ®µçš„æ—¶é—´æˆ³ã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #include \u0026lt;godot_cpp/classes/rendering_server.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/rendering_device.hpp\u0026gt; using namespace godot; void dump_gpu_pass_times_ms() { Ref\u0026lt;RenderingDevice\u0026gt; rd = RenderingServer::get_singleton()-\u0026gt;get_rendering_device(); if (rd.is_null()) return; const uint32_t count = rd-\u0026gt;get_captured_timestamps_count(); // é‡‡é›†åˆ°çš„æ ‡ç­¾æ•° const uint64_t frame = rd-\u0026gt;get_captured_timestamps_frame(); // å¯¹åº”çš„å¸§å·ï¼ˆå¯é€‰ï¼‰ for (uint32_t i = 0; i \u0026lt; count; i++) { String name = rd-\u0026gt;get_captured_timestamp_name(i); // ä¾‹å¦‚ \u0026#34;Depth Prepass\u0026#34; double gpu_ms = rd-\u0026gt;get_captured_timestamp_gpu_time(i) / 1e6; // çº³ç§’â†’æ¯«ç§’ double cpu_ms = rd-\u0026gt;get_captured_timestamp_cpu_time(i) / 1e6; // ä½ å¯ä»¥ç­›é€‰/é‡å‘½å/ç´¯åŠ åˆ°è‡ªå·±çš„ç»Ÿè®¡é‡Œ UtilityFunctions::print(vformat(\u0026#34;[%s] GPU %.3f ms, CPU %.3f ms (frame %d)\u0026#34;, name, gpu_ms, cpu_ms, (int)frame)); } } godott-benchmark godott-benchmarkæ˜¯godotå®˜æ–¹æä¾›çš„æµ‹è¯•å·¥ç¨‹ï¼Œå®ƒå¯ä»¥é’ˆå¯¹ä¸åŒèŠ¯ç‰‡ï¼Œæµ‹è¯•å½“å‰godotç‰ˆæœ¬çš„å„é¡¹åŠŸèƒ½è€—æ—¶ã€‚\nå¯ä»¥åˆ©ç”¨å®ƒä½œä¸ºæ€§èƒ½åŸºå‡†ã€‚\næ¸²æŸ“CPUï¼šæ¸²æŸ“æ¯å¸§æ‰€èŠ±è´¹çš„å¹³å‡CPUæ—¶é—´ï¼ˆä¾‹å¦‚è®¾ç½®ç»˜åˆ¶è°ƒç”¨ï¼‰ã€‚è¿™ä¸ªåº¦é‡ä¸è€ƒè™‘è¿‡ç¨‹/ç‰©ç†è¿‡ç¨‹åŠŸèƒ½ã€‚ æ¸²æŸ“GPUï¼šæ¯å¸§å¹³å‡èŠ±è´¹çš„GPUæ—¶é—´ã€‚ ç©ºé—²ï¼šc++å’ŒGDScriptè¿›ç¨‹å‡½æ•°æ¯ç§’æ‰€èŠ±è´¹çš„å¹³å‡CPUæ—¶é—´ã€‚ ç‰©ç†ï¼šæ¯ç§’åœ¨c++å’ŒGDScriptç‰©ç†å¤„ç†å‡½æ•°ä¸­èŠ±è´¹çš„å¹³å‡CPUæ—¶é—´ã€‚ ä¸»çº¿ç¨‹æ—¶é—´ï¼šåœ¨ä¸»çº¿ç¨‹ä¸Šè®¾ç½®åœºæ™¯æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚å¯¹äºæ¸²æŸ“åŸºå‡†æµ‹è¯•ï¼Œå®ƒä½œä¸ºåŠ è½½æ—¶é—´åº¦é‡ã€‚ ","date":"2025-11-05T09:18:31+08:00","image":"https://Liyufei1.github.io/godot.png","permalink":"https://Liyufei1.github.io/p/godot%E5%9B%9B%E6%80%A7%E8%83%BD%E7%BB%9F%E8%AE%A1/","title":"ã€godotã€‘å››ã€æ€§èƒ½ç»Ÿè®¡"},{"content":"ä¸€ã€SRCç¼–å†™ Godotä¸­ä¸æ¨èä½¿ç”¨#pragma onceï¼Œè€Œæ˜¯æ¨èä½¿ç”¨**#ifndef**çš„æ–¹å¼ï¼Œæ¥ä¿è¯å¤´æ–‡ä»¶çš„å•æ¬¡å¼•ç”¨ï¼Œå‚è€ƒä¸‹æ–¹è¡Œ1ã€‚ ç±»å†…ç¬¬ä¸€è¡Œï¼Œå¿…é¡»æ‰“ä¸ŠGodotçš„å¯¹åº”å®GDCLASS(SelfClass,BaseClass)ï¼Œå‚è€ƒä¸‹æ–¹è¡Œ12ã€‚ å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å‡½æ•°ï¼Œéœ€è¦åœ¨**_bind_methods**ä¸­ç”¨ ClassDB::bind_methodè¿›è¡Œç»‘å®šï¼Œå‚è€ƒè¡Œ178ã€179 å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å±æ€§ï¼Œéœ€è¦åœ¨**_bind_methodsä¸­ç”¨ADD_PROPERTY**è¿›è¡Œç»‘å®šï¼Œå‚è€ƒè¡Œ181ã€182ã€183 å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„æšä¸¾ï¼Œéœ€è¦ç”¨VARIANT_ENUM_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_ENUM_CONSTANT**è¿›è¡Œæ³¨å†Œï¼Œå‚è€ƒè¡Œï¼š63ã€166ã€199 å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„ä½åŸŸï¼Œéœ€è¦ç”¨VARIANT_BITFIELD_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_BITFIELD_FLAG**è¿›è¡Œæ³¨å†Œï¼Œå‚è€ƒè¡Œï¼š64ã€171ã€203 å¯¹äºéœ€è¦ä¿¡å·ï¼ˆå›è°ƒï¼‰ï¼Œéœ€è¦ç”¨ADD_SIGNALæ³¨å†Œå¹¶ç”¨emit_signalå‘é€ï¼Œä»¥åŠå¯ä»¥ç”¨connectç»‘å®šï¼Œå‚è€ƒè¡Œï¼š78ã€100ã€176 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum ETest{ None, Enum1, Enum2, Num }; enum EFlag{ FlagNone = 0, Flag1 = 1 \u0026lt;\u0026lt; 0, Flag2 = 1 \u0026lt;\u0026lt; 1, Flag3 = 1 \u0026lt;\u0026lt; 2, }; public: Test(); ~Test(); void StartTest(); void StartTest2(); int GetIValue(); void SetIValue(int input); float GetFValue(); void SetFValue(float input); String GetSValue(); void SetSValue(String input); Ref\u0026lt;Texture2D\u0026gt; GetTValue(); void SetTValue(Ref\u0026lt;Texture2D\u0026gt; input); ETest GetEValue(); void SetEValue(ETest input); BitField\u0026lt;EFlag\u0026gt; GetFlagValue(); void SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input); protected: static void _bind_methods(); private: int IValue = 0; float FValue = 0.0f; String SValue = \u0026#34;Hello\u0026#34;; Ref\u0026lt;Texture2D\u0026gt; TValue; ETest EValue = ETest::None; BitField\u0026lt;EFlag\u0026gt; flag = EFlag::FlagNone; }; VARIANT_ENUM_CAST(Test::ETest); VARIANT_BITFIELD_CAST(Test::EFlag); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; Test::Test() { connect(\u0026#34;ready\u0026#34;,Callable(this,\u0026#34;StartTest2\u0026#34;)); } Test::~Test() { } void Test::StartTest() { UtilityFunctions::print(\u0026#34;AAAAAAAAAAAAAAAA\u0026#34;); Ref\u0026lt;ImageTexture\u0026gt; AA(memnew(ImageTexture)); UtilityFunctions::print(\u0026#34;AAAAAAAAAAAAAAAA:\u0026#34;,AA-\u0026gt;get_reference_count()); auto format = AA-\u0026gt;get_format(); Ref\u0026lt;ImageTexture\u0026gt; BB = AA; UtilityFunctions::print(\u0026#34;AAAAAAAAAAAAAAAA:\u0026#34;,AA-\u0026gt;get_reference_count()); } void Test::StartTest2() { UtilityFunctions::print(\u0026#34;BBBBBBBBBBBBBBB:\u0026#34;,IValue); emit_signal(\u0026#34;HelloSignal\u0026#34;,\u0026#34;CCCCCCCCCCCCCCCCCCC\u0026#34;); // UtilityFunctions::print(\u0026#34;BBBBBBBBBBBBBBB:\u0026#34;,IValue,\u0026#34;---\u0026#34;,FValue,\u0026#34;---\u0026#34;,SValue,\u0026#34;---\u0026#34;,TValue-\u0026gt;get_name()); } int Test::GetIValue() { return IValue; } void Test::SetIValue(int input) { IValue = input; } float Test::GetFValue() { return FValue; } void Test::SetFValue(float input) { FValue = input; } String Test::GetSValue() { return SValue; } void Test::SetSValue(String input) { SValue = input; } Ref\u0026lt;Texture2D\u0026gt; Test::GetTValue() { return TValue; } void Test::SetTValue(Ref\u0026lt;Texture2D\u0026gt; input) { TValue = input; } Test::ETest Test::GetEValue() { return EValue; } void Test::SetEValue(ETest input) { EValue = input; } BitField\u0026lt;Test::EFlag\u0026gt; Test::GetFlagValue() { return flag; } void Test::SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input) { flag = input; } void Test::_bind_methods() { BIND_ENUM_CONSTANT(None); BIND_ENUM_CONSTANT(Enum1); BIND_ENUM_CONSTANT(Enum2); BIND_ENUM_CONSTANT(Num); BIND_BITFIELD_FLAG(FlagNone); BIND_BITFIELD_FLAG(Flag1); BIND_BITFIELD_FLAG(Flag2); BIND_BITFIELD_FLAG(Flag3); ADD_SIGNAL(MethodInfo(\u0026#34;HelloSignal\u0026#34;,PropertyInfo(Variant::STRING,\u0026#34;message\u0026#34;))); ClassDB::bind_method(D_METHOD(\u0026#34;StartTest\u0026#34;),\u0026amp;Test::StartTest); ClassDB::bind_method(D_METHOD(\u0026#34;StartTest2\u0026#34;),\u0026amp;Test::StartTest2); ClassDB::bind_method(D_METHOD(\u0026#34;GetIValue\u0026#34;),\u0026amp;Test::GetIValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetIValue\u0026#34;,\u0026#34;IValue\u0026#34;),\u0026amp;Test::SetIValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;IValue\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetFValue\u0026#34;),\u0026amp;Test::GetFValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFValue\u0026#34;,\u0026#34;FValue\u0026#34;),\u0026amp;Test::SetFValue); ADD_PROPERTY(PropertyInfo(Variant::FLOAT,\u0026#34;FValue\u0026#34;),\u0026#34;SetFValue\u0026#34;,\u0026#34;GetFValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetSValue\u0026#34;),\u0026amp;Test::GetSValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetSValue\u0026#34;,\u0026#34;SValue\u0026#34;),\u0026amp;Test::SetSValue); ADD_PROPERTY(PropertyInfo(Variant::STRING,\u0026#34;SValue\u0026#34;),\u0026#34;SetSValue\u0026#34;,\u0026#34;GetSValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetTValue\u0026#34;),\u0026amp;Test::GetTValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetTValue\u0026#34;,\u0026#34;TValue\u0026#34;),\u0026amp;Test::SetTValue); ADD_PROPERTY(PropertyInfo(Variant::OBJECT,\u0026#34;TValue\u0026#34;,PROPERTY_HINT_RESOURCE_TYPE,\u0026#34;Texture2D\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetEValue\u0026#34;),\u0026amp;Test::GetEValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetEValue\u0026#34;,\u0026#34;EValue\u0026#34;),\u0026amp;Test::SetEValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;EValue\u0026#34;,PROPERTY_HINT_ENUM,\u0026#34;None , Enum1 , Enum2\u0026#34;),\u0026#34;SetEValue\u0026#34;,\u0026#34;GetEValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetFlagValue\u0026#34;),\u0026amp;Test::GetFlagValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFlagValue\u0026#34;,\u0026#34;flag\u0026#34;),\u0026amp;Test::SetFlagValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;flag\u0026#34;,PROPERTY_HINT_FLAGS,\u0026#34;FlagNone , Flag1 , Flag2 , Flag3\u0026#34;),\u0026#34;SetFlagValue\u0026#34;,\u0026#34;GetFlagValue\u0026#34;); } ï¼ˆä¸€ï¼‰å‡½æ•°æš´éœ² â€‹\tå¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å‡½æ•°ï¼Œéœ€è¦åœ¨**_bind_methods**ä¸­ç”¨ ClassDB::bind_methodè¿›è¡Œç»‘å®š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: void StartTest(); protected: static void _bind_methods(); }; #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; void Test::StartTest() { UtilityFunctions::print(\u0026#34;StartTest:1111); } void Test::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;StartTest\u0026#34;),\u0026amp;Test::StartTest); } ï¼ˆäºŒï¼‰å±æ€§æš´éœ² å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å±æ€§ï¼Œéœ€è¦åœ¨**_bind_methodsä¸­ç”¨ADD_PROPERTYè¿›è¡Œç»‘å®šï¼ŒåŒæ—¶éœ€è¦æš´éœ²å®ƒå¯¹åº”çš„Getå’ŒSet**æ–¹æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum ETest{ None, Enum1, Enum2, Num }; enum EFlag{ FlagNone = 0, Flag1 = 1 \u0026lt;\u0026lt; 0, Flag2 = 1 \u0026lt;\u0026lt; 1, Flag3 = 1 \u0026lt;\u0026lt; 2, }; public: int GetIValue(); void SetIValue(int input); Ref\u0026lt;Texture2D\u0026gt; GetTValue(); void SetTValue(Ref\u0026lt;Texture2D\u0026gt; input); ETest GetEValue(); void SetEValue(ETest input); BitField\u0026lt;EFlag\u0026gt; GetFlagValue(); void SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input); protected: static void _bind_methods(); private: int IValue = 0; Ref\u0026lt;Texture2D\u0026gt; TValue; ETest EValue = ETest::None; BitField\u0026lt;EFlag\u0026gt; flag = EFlag::FlagNone; }; VARIANT_ENUM_CAST(Test::ETest); VARIANT_BITFIELD_CAST(Test::EFlag); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; int Test::GetIValue() { return IValue; } void Test::SetIValue(int input) { IValue = input; } Ref\u0026lt;Texture2D\u0026gt; Test::GetTValue() { return TValue; } void Test::SetTValue(Ref\u0026lt;Texture2D\u0026gt; input) { TValue = input; } Test::ETest Test::GetEValue() { return EValue; } void Test::SetEValue(ETest input) { EValue = input; } BitField\u0026lt;Test::EFlag\u0026gt; Test::GetFlagValue() { return flag; } void Test::SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input) { flag = input; } void Test::_bind_methods() { //intå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetIValue\u0026#34;),\u0026amp;Test::GetIValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetIValue\u0026#34;,\u0026#34;IValue\u0026#34;),\u0026amp;Test::SetIValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;IValue\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); //èµ„æºå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetTValue\u0026#34;),\u0026amp;Test::GetTValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetTValue\u0026#34;,\u0026#34;TValue\u0026#34;),\u0026amp;Test::SetTValue); ADD_PROPERTY(PropertyInfo(Variant::OBJECT,\u0026#34;TValue\u0026#34;,PROPERTY_HINT_RESOURCE_TYPE,\u0026#34;Texture2D\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); //æšä¸¾å˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetEValue\u0026#34;),\u0026amp;Test::GetEValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetEValue\u0026#34;,\u0026#34;EValue\u0026#34;),\u0026amp;Test::SetEValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;EValue\u0026#34;,PROPERTY_HINT_ENUM,\u0026#34;None , Enum1 , Enum2\u0026#34;),\u0026#34;SetEValue\u0026#34;,\u0026#34;GetEValue\u0026#34;); //ä½åŸŸå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetFlagValue\u0026#34;),\u0026amp;Test::GetFlagValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFlagValue\u0026#34;,\u0026#34;flag\u0026#34;),\u0026amp;Test::SetFlagValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;flag\u0026#34;,PROPERTY_HINT_FLAGS,\u0026#34;FlagNone , Flag1 , Flag2 , Flag3\u0026#34;),\u0026#34;SetFlagValue\u0026#34;,\u0026#34;GetFlagValue\u0026#34;); } ï¼ˆä¸‰ï¼‰æšä¸¾ å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„æšä¸¾ï¼Œéœ€è¦ç”¨VARIANT_ENUM_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_ENUM_CONSTANT**è¿›è¡Œæ³¨å†Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum ETest{ None, Enum1, Enum2, Num }; public: ETest GetEValue(); void SetEValue(ETest input); protected: static void _bind_methods(); private: ETest EValue = ETest::None; }; VARIANT_ENUM_CAST(Test::ETest); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; Test::ETest Test::GetEValue() { return EValue; } void Test::SetEValue(ETest input) { EValue = input; } void Test::_bind_methods() { BIND_ENUM_CONSTANT(None); BIND_ENUM_CONSTANT(Enum1); BIND_ENUM_CONSTANT(Enum2); BIND_ENUM_CONSTANT(Num); //æšä¸¾å˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetEValue\u0026#34;),\u0026amp;Test::GetEValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetEValue\u0026#34;,\u0026#34;EValue\u0026#34;),\u0026amp;Test::SetEValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;EValue\u0026#34;,PROPERTY_HINT_ENUM,\u0026#34;None , Enum1 , Enum2\u0026#34;),\u0026#34;SetEValue\u0026#34;,\u0026#34;GetEValue\u0026#34;); } ï¼ˆå››ï¼‰ä½åŸŸ å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„ä½åŸŸï¼Œéœ€è¦ç”¨VARIANT_BITFIELD_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_BITFIELD_FLAG**è¿›è¡Œæ³¨å†Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum EFlag{ FlagNone = 0, Flag1 = 1 \u0026lt;\u0026lt; 0, Flag2 = 1 \u0026lt;\u0026lt; 1, Flag3 = 1 \u0026lt;\u0026lt; 2, }; public: BitField\u0026lt;EFlag\u0026gt; GetFlagValue(); void SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input); protected: static void _bind_methods(); private: BitField\u0026lt;EFlag\u0026gt; flag = EFlag::FlagNone; }; VARIANT_BITFIELD_CAST(Test::EFlag); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; BitField\u0026lt;Test::EFlag\u0026gt; Test::GetFlagValue() { return flag; } void Test::SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input) { flag = input; } void Test::_bind_methods() { BIND_BITFIELD_FLAG(FlagNone); BIND_BITFIELD_FLAG(Flag1); BIND_BITFIELD_FLAG(Flag2); BIND_BITFIELD_FLAG(Flag3); //ä½åŸŸå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetFlagValue\u0026#34;),\u0026amp;Test::GetFlagValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFlagValue\u0026#34;,\u0026#34;flag\u0026#34;),\u0026amp;Test::SetFlagValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;flag\u0026#34;,PROPERTY_HINT_FLAGS,\u0026#34;FlagNone , Flag1 , Flag2 , Flag3\u0026#34;),\u0026#34;SetFlagValue\u0026#34;,\u0026#34;GetFlagValue\u0026#34;); } ï¼ˆäº”ï¼‰ä¿¡å·/å›è°ƒ 1ã€ADD_SIGNAL å¯¹äºéœ€è¦ä¿¡å·ï¼ˆå›è°ƒï¼‰ï¼Œéœ€è¦ç”¨ADD_SIGNALæ³¨å†Œå¹¶ç”¨emit_signalå‘é€ï¼Œä»¥åŠå¯ä»¥ç”¨connectç»‘å®š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: void StartTest2(); protected: static void _bind_methods(); }; #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; Test::Test() { connect(\u0026#34;ready\u0026#34;,Callable(this,\u0026#34;StartTest2\u0026#34;)); } void Test::StartTest2() { UtilityFunctions::print(\u0026#34;BBBBBBBBBBBBBBB:\u0026#34;,IValue); emit_signal(\u0026#34;HelloSignal\u0026#34;,\u0026#34;CCCCCCCCCCCCCCCCCCC\u0026#34;); } void Test::_bind_methods() { ADD_SIGNAL(MethodInfo(\u0026#34;HelloSignal\u0026#34;,PropertyInfo(Variant::STRING,\u0026#34;message\u0026#34;))); } 2ã€call_deferred 1 2 this-\u0026gt;call_deferred(\u0026#34;method_name\u0026#34;, arg1, arg2); //æ³¨æ„method_nameæ–¹æ³•éœ€è¦è¢«æ³¨å†Œè¿‡æ‰èƒ½æ­£ç¡®è°ƒç”¨ äºŒã€å¸¸ç”¨å‡½æ•° ï¼ˆä¸€ï¼‰å¼•ç”¨è®¡æ•°ã€memnewã€memdelete 1 2 3 4 5 6 7 //godotå¯¹äºå†…å­˜ç®¡ç†æœ‰è‡ªå·±çš„å°è£…ï¼Œæ‰€ä»¥å¯¹äºéåŸç”Ÿç±»ï¼Œéœ€è¦ç”¨å®ƒå®šä¹‰çš„åˆ›å»º/åˆ é™¤æ–¹æ³•ã€‚ memnew(ImageTexture); memdelete(); //ä¸€èˆ¬ä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥æ§åˆ¶èµ„æºç”Ÿå‘½å‘¨æœŸï¼Œè€Œéæ‰‹åŠ¨ç®¡ç† Ref\u0026lt;ImageTexture\u0026gt; AA(memnew(ImageTexture)); UtilityFunctions::print(\u0026#34;reference count:\u0026#34;,AA-\u0026gt;get_reference_count()); ï¼ˆäºŒï¼‰è®¡æ—¶å™¨ 1ã€Timer\n2ã€Tween\nè½»é‡åŒ–çš„è®¡æ—¶å™¨ï¼Œgodotä¼šè‡ªåŠ¨å›æ”¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // å¤‡æ³¨ï¼šæ²¡æœ‰å†…å­˜æ³„æ¼é£é™©ã€‚Refè‡ªåŠ¨ç®¡ç†äº†å†…å­˜ Ref\u0026lt;Tween\u0026gt; tween = create_tween(); double Index = Duration / (2.0f * Times); // Timesæ˜¯é—ªçƒæ¬¡æ•°ä¹Ÿæ˜¯å¾ªç¯æ¬¡æ•°ï¼ŒIndexæ˜¯é—ªçƒé—´éš” for (int i = 0; i \u0026lt; Times; i++) { tween-\u0026gt;tween_property(this, \u0026#34;modulate:a\u0026#34;, 0.0f, Index); tween-\u0026gt;tween_property(this, \u0026#34;modulate:a\u0026#34;, 1.0f, Index); } if (true) { tween-\u0026gt;tween_property(this, \u0026#34;modulate:a\u0026#34;, 0.0f, Index); } tween-\u0026gt;set_trans(Tween::TRANS_LINEAR); ä¸‰ã€ç¼–è¾‘å™¨3Då°å·¥å…·æ’ä»¶Gizmo Gizmoæ˜¯godotè‡ªå¸¦çš„ç¼–è¾‘å™¨ç•Œé¢çš„3Då°å·¥å…·ã€‚\nå®ƒæ˜¯é™„åŠ å¼çš„ï¼Œå³ä¸ä¼šå½±å“åŸèŠ‚ç‚¹ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šè¢«åŸèŠ‚ç‚¹æ‰€æ„ŸçŸ¥ æ”¯æŒç‚¹ã€çº¿ã€ç½‘æ ¼çš„ç»˜åˆ¶ æ”¯æŒç‚¹å‡»å’Œæ‹–æ‹½äº‹ä»¶ è¯¥åŠŸèƒ½ä¸»è¦ç”±ï¼šæ§åˆ¶å™¨EditorNode3DGizmoPluginï¼Œç»„ä»¶EditorNode3DGizmoã€‚ä¸¤å¤§éƒ¨åˆ†ç»„æˆã€‚ä½†éœ€è¦ä½¿ç”¨çš„è¯ï¼Œå°±éœ€è¦åœ¨ç»Ÿä¸€çš„æ’ä»¶ç®¡ç†å™¨ä¸­ï¼Œè¿›è¡Œæ³¨å†Œå’Œåˆå§‹åŒ–ã€‚\nï¼ˆä¸€ï¼‰ã€EditorNode3DGizmoPlugin EditorNode3DGizmoPlugin æ˜¯ Godot ç¼–è¾‘å™¨ä¸­çš„ä¸€ä¸ª æ’ä»¶åŸºç±»ï¼Œç”¨äºæ‰©å±•å’Œæ³¨å†Œè‡ªå®šä¹‰çš„ 3D Gizmo å·¥å…·ã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨ 3D è§†å£ä¸­ä¸ºç‰¹å®šç±»å‹çš„èŠ‚ç‚¹ç»˜åˆ¶è‡ªå®šä¹‰è¾…åŠ©å›¾å½¢ã€æ§åˆ¶æŸ„ã€äº¤äº’éƒ¨ä»¶ã€‚\næ³¨å†Œ Gizmo ç±»å‹ï¼šå…³è”åˆ°æŸä¸ªèŠ‚ç‚¹ç±»ï¼ˆå¦‚ Camera3Dã€Light3Dã€è‡ªå®šä¹‰èŠ‚ç‚¹ç­‰ï¼‰ ç”Ÿæˆ Gizmo å®ä¾‹ï¼šé€šè¿‡ create_gizmo() åˆ›å»ºå¯¹åº”çš„ EditorNode3DGizmo å¯¹è±¡ å®šä¹‰å¤–è§‚ä¸è¡Œä¸ºï¼šcreate_handle_materialï¼ˆï¼‰ã€create_materialï¼ˆï¼‰ç­‰ æ³¨æ„äº‹é¡¹ï¼š å½“_has_gizmoè¢«é‡è½½æ—¶ï¼Œä¼šæ ¹æ®è¿”å›çš„boolå€¼ï¼Œåˆ›å»ºé»˜è®¤çš„EditorNode3DGizmoã€‚ å½“__create_gizmoè¢«é‡è½½æ—¶ï¼Œåˆ›å»ºè‡ªå®šä¹‰çš„EditorNode3DGizmoã€‚ å½“ä»–ä»¬åŒæ—¶è¢«é‡è½½æ—¶ï¼Œä»…ä¼šç”Ÿæ•ˆ__create_gizmo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 //======================å¤´æ–‡ä»¶======================== #pragma once #ifndef SPLINE_GIZMO_PLUGIN_H #define SPLINE_GIZMO_PLUGIN_H #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo_plugin.hpp\u0026#34; using namespace godot; class SplineGizmoPlugin : public EditorNode3DGizmoPlugin { GDCLASS(SplineGizmoPlugin, EditorNode3DGizmoPlugin); protected: static void _bind_methods(){} public: // virtual bool _has_gizmo(Node3D *p_for_node_3d) const override; virtual Ref\u0026lt;EditorNode3DGizmo\u0026gt; _create_gizmo(Node3D *p_for_node_3d) const override; virtual void _redraw(const Ref\u0026lt;EditorNode3DGizmo\u0026gt; \u0026amp;p_gizmo) override; virtual String _get_gizmo_name() const override{ return \u0026#34;SplineGizmo\u0026#34;; } // virtual int32_t _get_priority() const override{ // return -1; // } }; #endif //======================æºæ–‡ä»¶======================== #include \u0026#34;SplineGizmoPlugin.h\u0026#34; #include \u0026#34;Spline.h\u0026#34; #include \u0026#34;SplineGizmo.h\u0026#34; #include \u0026#34;godot_cpp/classes/object.hpp\u0026#34; #include \u0026#34;godot_cpp/core/memory.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/utility_functions.hpp\u0026#34; // bool SplineGizmoPlugin::_has_gizmo(Node3D *p_for_node_3d) const { // UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_has_gizmo :: AAAAAAAAAAAA\u0026#34;); // UtilityFunctions::print(__FUNCTION__,p_for_node_3d-\u0026gt;get_name()); // return Object::cast_to\u0026lt;Spline\u0026gt;(p_for_node_3d) != nullptr; // } Ref\u0026lt;EditorNode3DGizmo\u0026gt; SplineGizmoPlugin::_create_gizmo(Node3D *p_for_node_3d) const{ UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_create_gizmo :: Try to create gizmo for :: \u0026#34;,p_for_node_3d-\u0026gt;get_name()); bool bIsSpline = Object::cast_to\u0026lt;Spline\u0026gt;(p_for_node_3d) != nullptr; if (bIsSpline) { UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_create_gizmo :: \u0026#34;,p_for_node_3d-\u0026gt;get_name()); Ref\u0026lt;EditorNode3DGizmo\u0026gt; Gizmo = memnew(SplineGizmo(p_for_node_3d)); return Gizmo; } return nullptr; } void SplineGizmoPlugin::_redraw(const Ref\u0026lt;EditorNode3DGizmo\u0026gt; \u0026amp;p_gizmo){ UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_redraw :: \u0026#34; , p_gizmo-\u0026gt;get_node_3d()-\u0026gt;get_name()); p_gizmo-\u0026gt;_redraw(); } ï¼ˆäºŒï¼‰ã€EditorNode3DGizmo EditorNode3DGizmo æ˜¯å®é™…åœ¨ 3D è§†å£ä¸­ç»˜åˆ¶å’Œäº¤äº’çš„å¯¹è±¡ã€‚ç”± EditorNode3DGizmoPlugin åˆ›å»ºï¼Œå®ƒè´Ÿè´£ç®¡ç†ç»˜åˆ¶å†…å®¹å’Œäº¤äº’ç‚¹ã€‚\næ·»åŠ å¯è§å…ƒç´ ï¼šé€šè¿‡ add_mesh()ã€add_lines()ã€add_unscaled_billboard() ç­‰æ–¹æ³•ç»˜åˆ¶ä¸åŒç±»å‹çš„è¾…åŠ©å‡ ä½•\næ·»åŠ äº¤äº’å¥æŸ„ï¼ˆHandlesï¼‰ï¼š\nadd_handles() ç”¨äºæ·»åŠ å¯æ‹–æ‹½çš„æ§åˆ¶ç‚¹ åœ¨ç¼–è¾‘å™¨ä¸­ç”¨æˆ·å¯ä»¥ç›´æ¥ç”¨é¼ æ ‡æ“ä½œè¿™äº›ç‚¹ äº¤äº’ä¸æ›´æ–°\nåœ¨æ’ä»¶ä¸­é‡å†™ redraw(gizmo)ï¼Œå¯æ ¹æ®èŠ‚ç‚¹å±æ€§å˜åŒ–å®æ—¶åˆ·æ–° ä½¿ç”¨ set_handle() ä¸ commit_handle() å“åº”ç”¨æˆ·æ“ä½œï¼Œå°†å˜åŠ¨å†™å›èŠ‚ç‚¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 //======================å¤´æ–‡ä»¶======================== #pragma once #ifndef SPLINE_GIZMO_H #define SPLINE_GIZMO_H #include \u0026#34;Spline.h\u0026#34; #include \u0026#34;godot_cpp/classes/node3d.hpp\u0026#34; // #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo_plugin.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo.hpp\u0026#34; // #include \u0026#34;godot_cpp/classes/node3d_gizmo.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/camera3d.hpp\u0026#34; using namespace godot; class SplineGizmo : public EditorNode3DGizmo { GDCLASS(SplineGizmo, EditorNode3DGizmo); protected: static void _bind_methods(){} public: SplineGizmo(){} SplineGizmo(Node3D *p_node); ~SplineGizmo(); virtual void _redraw() override; virtual void _commit_handle(int32_t p_id, bool p_secondary, const Variant \u0026amp;p_restore, bool p_cancel) override; virtual void _set_handle(int32_t p_id, bool p_secondary, Camera3D *p_camera, const Vector2 \u0026amp;p_point) override; private: Spline * SplineInstance; Ref\u0026lt;Material\u0026gt; RedMaterial; Ref\u0026lt;Material\u0026gt; GreenMaterial; Ref\u0026lt;Material\u0026gt; BlueMaterial; }; #endif //======================æºæ–‡ä»¶======================== #include \u0026#34;SplineGizmo.h\u0026#34; #include \u0026#34;Spline.h\u0026#34; #include \u0026#34;godot_cpp/classes/object.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo_plugin.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/standard_material3d.hpp\u0026#34; #include \u0026#34;godot_cpp/core/error_macros.hpp\u0026#34; #include \u0026#34;godot_cpp/core/memory.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/array.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/utility_functions.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/vector3.hpp\u0026#34; SplineGizmo::SplineGizmo(Node3D *p_node){ set_node_3d(p_node); SplineInstance = Object::cast_to\u0026lt;Spline\u0026gt;(p_node); } SplineGizmo::~SplineGizmo(){ } void SplineGizmo::_redraw(){ UtilityFunctions::print(__FUNCTION__,\u0026#34;redraw::CCCCCCC :: \u0026#34;,get_node_3d()-\u0026gt;get_name()); clear(); PackedVector3Array points; PackedInt32Array ids; PackedVector3Array lines; ERR_FAIL_COND(!SplineInstance); int numPoints = SplineInstance-\u0026gt;GetControlPoints().size(); ERR_FAIL_COND(numPoints == 0); for (int i = 0; i \u0026lt; numPoints; i++) { Vector3 CurPoint = SplineInstance-\u0026gt;GetControlPoints()[i]; points.append(CurPoint); ids.append(i); } int segNum = 100; Array TempP = SplineInstance-\u0026gt;GetBezierCurve(segNum); for (int i = 0; i \u0026lt; segNum - 1; i++) { Vector3 CurPoint0 = TempP[i]; Vector3 CurPoint1 = TempP[i + 1]; lines.append(CurPoint0); lines.append(CurPoint1); } add_handles(points, get_plugin()-\u0026gt;get_material(\u0026#34;HandleMat\u0026#34;,this),ids); add_lines(lines, get_plugin()-\u0026gt;get_material(\u0026#34;RedMat\u0026#34;,this)); } void SplineGizmo::_commit_handle(int32_t p_id, bool p_secondary, const Variant \u0026amp;p_restore, bool p_cancel){ UtilityFunctions::print(\u0026#34;SplineGizmo::_commit_handle :: id :: \u0026#34;, p_id , \u0026#34; , Restore :: \u0026#34;, p_restore ,\u0026#34;NewPosition :: \u0026#34;); } void SplineGizmo::_set_handle(int32_t p_id, bool p_secondary, Camera3D *p_camera, const Vector2 \u0026amp;p_point){ // UtilityFunctions::print(\u0026#34;SplineGizmo::_set_handle :: id :: \u0026#34;, p_id , \u0026#34; , Screen Point :: \u0026#34;, p_point ); if (!SplineInstance || !p_camera ) { return; } Array points = SplineInstance-\u0026gt;GetControlPoints(); Vector3 LocalLocation = points[p_id]; Vector3 WorldLocation = SplineInstance-\u0026gt;get_transform().xform(LocalLocation); UtilityFunctions::print(\u0026#34;LocalLocation :: \u0026#34;, LocalLocation , \u0026#34; , WorldLocation :: \u0026#34;, WorldLocation ); const Vector3 ray_o = p_camera-\u0026gt;project_ray_origin(p_point); const Vector3 ray_d = p_camera-\u0026gt;project_ray_normal(p_point); // UtilityFunctions::print(\u0026#34;SplineGizmo::_set_handle :: id :: \u0026#34;, p_id , \u0026#34; , ray_o :: \u0026#34;,ray_o,\u0026#34; , ray_d :: \u0026#34;,ray_d); // æ„é€ â€œå±å¹•å¹³é¢â€ï¼šè¿‡å½“å‰æŠŠæ‰‹ç‚¹ï¼Œæ³•çº¿ = ç›¸æœºå‰å‘ï¼ˆ-Z åˆ—ï¼‰ const Vector3 cam_fwd = -p_camera-\u0026gt;get_global_transform().basis.get_column(2).normalized(); Plane view_plane(cam_fwd, WorldLocation); // UtilityFunctions::print(\u0026#34;cam_fwd :: \u0026#34;, cam_fwd ); Vector3 hit; if (!view_plane.intersects_ray(ray_o, ray_d, \u0026amp;hit)) { // å°„çº¿ä¸å¹³é¢è¿‘å¹³è¡Œï¼Œå¿½ç•¥è¿™å¸§ return; } UtilityFunctions::print(\u0026#34;Hit :: \u0026#34;,hit); points[p_id] = SplineInstance-\u0026gt;get_transform().xform_inv(hit); SplineInstance-\u0026gt;SetControlPoints(points); _redraw(); } ï¼ˆä¸‰ï¼‰ã€EditorPlugin EditorPlugin æ˜¯ Godot ä¸­æ‰€æœ‰ç¼–è¾‘å™¨æ’ä»¶çš„åŸºç±»ï¼Œè´Ÿè´£ï¼š\næ³¨å†Œå’Œå¸è½½ EditorNode3DGizmoPlugin å¤„ç†æ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸ ä¸ç¼–è¾‘å™¨ UIã€åœºæ™¯æ ‘ã€Inspector ç­‰äº¤äº’ æ¥å£ ä½œç”¨ è¯´æ˜ add_node_3d_gizmo_plugin æŠŠè‡ªå®šä¹‰ Gizmo æ’ä»¶æ³¨å†Œåˆ°ç¼–è¾‘å™¨ remove_node_3d_gizmo_plugin æŠŠè‡ªå®šä¹‰ Gizmo æ’ä»¶ç§»é™¤ enable_plugin å¼€å¯æ’ä»¶ disable_plugin å…³é—­æ’ä»¶ handles åˆ¤æ–­æ˜¯å¦æ¥ç®¡æŸç±»å‹èŠ‚ç‚¹çš„ç¼–è¾‘é€»è¾‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 //=================ç±»çš„å®šä¹‰======================= class MyEditorPlugin : public EditorPlugin { GDCLASS(MyEditorPlugin, EditorPlugin); Ref\u0026lt;SplineGizmoPlugin\u0026gt; gizmo_plugin; protected: static void _bind_methods() { } public: virtual void _enter_tree() override { UtilityFunctions::print(\u0026#34;Init :: MyEditorPlugin :: _enter_tree\u0026#34;); gizmo_plugin.instantiate(); gizmo_plugin-\u0026gt;create_handle_material(\u0026#34;HandleMat\u0026#34;); gizmo_plugin-\u0026gt;create_material(\u0026#34;RedMat\u0026#34;, Color(1.0f, 0.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;GreenMat\u0026#34;, Color(0.0f, 1.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;BlueMat\u0026#34;, Color(0.0f, 0.0f, 1.0f)); add_node_3d_gizmo_plugin(gizmo_plugin); } virtual void _exit_tree() override { UtilityFunctions::print(\u0026#34;UnInit :: MyEditorPlugin :: _exit_tree\u0026#34;); remove_node_3d_gizmo_plugin(gizmo_plugin); } }; //==================ä½¿ç”¨ç¤ºä¾‹======================= //==================register_types.cpp======================= void initialize_GodotTest_module(ModuleInitializationLevel p_level) { if (p_level == MODULE_INITIALIZATION_LEVEL_SCENE) { UtilityFunctions::print(\u0026#34;Init :: Scene\u0026#34;); GDREGISTER_CLASS(FowTexture); GDREGISTER_CLASS(Spline); } if (p_level == MODULE_INITIALIZATION_LEVEL_EDITOR) { UtilityFunctions::print(\u0026#34;Init :: Editor\u0026#34;); GDREGISTER_CLASS(SplineGizmo); GDREGISTER_CLASS(SplineGizmoPlugin); GDREGISTER_CLASS(MyEditorPlugin); EditorPlugins::add_by_type\u0026lt;MyEditorPlugin\u0026gt;(); } UtilityFunctions::print(\u0026#34;Init :: None :: \u0026#34;, p_level); } ","date":"2025-11-04T16:38:31+08:00","image":"https://Liyufei1.github.io/godot.png","permalink":"https://Liyufei1.github.io/p/godot%E4%B8%89gdextension%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/","title":"ã€godotã€‘ä¸‰ã€GDExtensionå¼€å‘æŒ‡å—"},{"content":"Moduleså¼€å‘æŒ‡å— æœ¬æ–‡æ¡£æ˜¯é’ˆå¯¹Godot 4.4å¼•æ“çš„ Moduleså¼€å‘æŒ‡å—ï¼Œä¸ºéœ€è¦è¿›è¡Œåº•å±‚å¼€å‘çš„å¼€å‘è€…æä¾›å®ç”¨çš„å‚è€ƒã€‚Godot Moduleså¼€å‘å…è®¸æˆ‘ä»¬ç›´æ¥åœ¨å¼•æ“æºç å±‚é¢æ‰©å±•åŠŸèƒ½ï¼Œç›¸æ¯”GDExtensionå…·æœ‰æ›´å¼ºå¤§çš„èƒ½åŠ›å’Œæ›´æ·±åº¦çš„é›†æˆã€‚æœ¬æ–‡æ¶µç›–äº†æ—¥å¿—æ‰“å°ã€å®¹å™¨ç±»å‹ã€GUIç»„ä»¶ã€çº¿ç¨‹ç®¡ç†ã€é…ç½®ç³»ç»Ÿç­‰æ ¸å¿ƒæ¨¡å—çš„å¸¸ç”¨å¤´æ–‡ä»¶å’Œæœ€å°ä½¿ç”¨ç¤ºä¾‹ï¼Œå¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Godot å¼•æ“çš„ C++ å¼€å‘ã€‚\nå¸¸ç”¨åŠŸèƒ½ ç¼–è¯‘æœŸå®å¼€å…³ åç§° ä½œç”¨ TOOLS_ENABLED åªåœ¨ç¼–è¾‘å™¨/å·¥å…·é“¾é‡Œéœ€è¦çš„ä»£ç  WINDOWS_ENABLED Windows å¹³å° ANDROID_ENABLED Android å¹³å° GLES3_ENABLED GLES3 æ¸²æŸ“åç«¯ VULKAN_ENABLED Vulkan æ¸²æŸ“åç«¯ æ—¥å¿—æ‰“å° å¤´æ–‡ä»¶ï¼š#include \u0026ldquo;core/string/print_string.h\u0026rdquo;\nç”¨äºæ ‡å‡†æ—¥å¿—çš„è¾“å‡ºã€‚åœ¨åšå¼•æ“å¼€å‘æ—¶ä½¿ç”¨ã€‚\nåœ¨åšGDExtensionå¼€å‘æ—¶ï¼Œä½¿ç”¨Utility_functionå¤´æ–‡ä»¶ï¼Œè¿›è¡Œæ—¥å¿—æ‰“å°ã€‚\næ¥å£ ä½œç”¨ ç¤ºä¾‹ void print_line(const Variant \u0026amp;vï¼‰ æ‰“å°æ—¥å¿— __print_line(\u0026ldquo;AAA\u0026rdquo;,10.0); void print_error(const String \u0026amp;p_string) æ‰“å°é”™è¯¯ print_error(\u0026ldquo;BBBB\u0026rdquo;) è®¡æ—¶å™¨ 1 2 3 4 5 6 7 8 9 //1.é€šè¿‡åœºæ™¯æ ‘ï¼ˆmainloopï¼‰è®¾ç½®ç®€å•çš„æ—¶é—´å›è°ƒå‡½æ•° // timer to show text for 3 seconds auto timer = get_scene_tree()-\u0026gt;create_timer(time); timer-\u0026gt;connect(\u0026#34;timeout\u0026#34;, callable_mp(this,\u0026amp;CommandTool::reduce_screen_output_buffer)); //2.c++åŸç”Ÿçš„çº¿ç¨‹è°ƒç”¨ä¹Ÿå¯ä»¥å®ç°ï¼Œä½†æ˜¯éœ€è¦call_deferredæ¥å›åˆ°ä¸»çº¿ç¨‹ //3.tweenï¼Œæ›´åŠ å¤æ‚ï¼Œä½†æ˜¯å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œä»¥åŠè®¾ç½®ç¼“åŠ¨ è‡ªå®šä¹‰é¡¹ç›®é…ç½® å¤´æ–‡ä»¶ï¼š#include \u0026ldquo;core/config/project_settings.h\u0026rdquo;\nProjectSettingsæ˜¯ Godotå¼•æ“çš„æ ¸å¿ƒå•ä¾‹ç±»ï¼Œè´Ÿè´£ç®¡ç†é¡¹ç›®çš„é…ç½®å’Œè®¾ç½®ã€‚å®ƒç»§æ‰¿è‡ªObjectï¼Œä½¿ç”¨ GDCLASS å®æ³¨å†Œåˆ° Godot çš„ç±»å‹ç³»ç»Ÿä¸­\næ ¸å¿ƒèŒè´£ï¼š\nåŠ è½½å’Œä¿å­˜é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆproject.godotï¼‰ å®šä¹‰å…¨å±€è®¾ç½®ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰:GLOBAL_DEF å®šä¹‰ä¸ºåŸºç¡€è®¾ç½®ï¼ˆåœ¨ç¼–è¾‘å™¨ä¸­é«˜äº®ï¼‰:GLOBAL_DEF_BASIC å®šä¹‰å…¨å±€è®¾ç½®ï¼ˆä¿®æ”¹åéœ€è¦é‡å¯ï¼‰:GLOBAL_DEF_RST å®šä¹‰ä¸ºå†…éƒ¨è®¾ç½®ï¼ˆä¸åœ¨ç¼–è¾‘å™¨æ˜¾ç¤ºï¼‰:GLOBAL_DEF_INTERNAL è·å–é…ç½®å€¼: get_setting è®¾ç½®é…ç½®å€¼: set_setting æ£€æŸ¥é…ç½®å€¼æ˜¯å¦å­˜åœ¨: has_setting è·¯å¾„è½¬æ¢ï¼ˆres://ã€user:// ç­‰è·¯å¾„æœ¬åœ°åŒ–ï¼‰ å°†ç»å¯¹è·¯å¾„è½¬æ¢ä¸º res:// è·¯å¾„: localize_path å°† res:// è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„: globalize_path è·å–é¡¹ç›®èµ„æºè·¯å¾„ï¼ˆres:// çš„å®é™…ä½ç½®ï¼‰: get_resource_path è·å–é¡¹ç›®æ•°æ®ç›®å½•è·¯å¾„ï¼ˆres://.godot): get_project_data_path è·å–å¯¼å…¥æ–‡ä»¶è·¯å¾„ï¼ˆres://.godot/importedï¼‰: get_imported_files_path Autoload å•ä¾‹ç®¡ç† æ·»åŠ è‡ªåŠ¨åŠ è½½é¡¹:add_autoload ç§»é™¤è‡ªåŠ¨åŠ è½½é¡¹:remove_autoload æ£€æŸ¥æ˜¯å¦å­˜åœ¨:has_autoload è·å–è‡ªåŠ¨åŠ è½½åˆ—è¡¨:get_autoload_list ä½¿ç”¨ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 void initialize_command_tool_module(ModuleInitializationLevel p_level) { if (p_level == MODULE_INITIALIZATION_LEVEL_SCENE) { GLOBAL_DEF(\u0026#34;MySelfConfig/test111/testBool1\u0026#34;, false); GLOBAL_DEF(\u0026#34;MySelfConfig/test111/testBool2\u0026#34;, true); GLOBAL_DEF(\u0026#34;MySelfConfig/test111/testfloat\u0026#34;, 3.0); GLOBAL_DEF(\u0026#34;MySelfConfig/test111/testString\u0026#34;, \u0026#34;this is a string\u0026#34;); GLOBAL_DEF(\u0026#34;MySelfConfig/test111/test_VECTOR2\u0026#34;, Vector2()); //COLOR GLOBAL_DEF(\u0026#34;MySelfConfig/test111/test_Color\u0026#34;, Color()); GLOBAL_DEF(\u0026#34;MySelfConfig/test111/test_Array\u0026#34;, Array()); GLOBAL_DEF(\u0026#34;MySelfConfig/test111/test_Dictionary\u0026#34;, Dictionary()); } } å®¹å™¨ Godotè„šæœ¬å®¹å™¨ Array âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/variant/array.h\u0026quot;\nâœ¨ä½œç”¨:Arrayæ˜¯è„šæœ¬GDScriptä¸­Arrayç±»å‹çš„C++å®ç°ã€‚å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\né€šç”¨æ€§ï¼šå®ƒæ˜¯ä¸€ä¸ªå­˜å‚¨Variantçš„å®¹å™¨ï¼Œè¿™æ„å‘³ç€åŒä¸€ä¸ªæ•°ç»„é‡Œå¯ä»¥æ··åˆå­˜æ”¾æ•´æ•°ã€å­—ç¬¦ä¸²ã€å¯¹è±¡å¼•ç”¨ç­‰ã€‚ ç±»å‹åŒ–æ•°ç»„ï¼ˆTyped Arrayï¼‰ï¼š Godot 4.0 å¼•å…¥äº†ç±»å‹åŒ–æ•°ç»„çš„æ¦‚å¿µï¼ŒC++ ç«¯å¯ä»¥é€šè¿‡ set_typed ç­‰æ–¹æ³•é™åˆ¶æ•°ç»„åªèƒ½å­˜å‚¨ç‰¹å®šç±»å‹ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 #include \u0026#34;core/variant/array.h\u0026#34; #include \u0026#34;core/variant/variant.h\u0026#34; void demo_array() { // --- åˆ›å»º (Create) --- Array arr; // ä¹Ÿå¯ä»¥åˆ›å»ºå¹¶æŒ‡å®šä¸ºç‰¹å®šç±»å‹çš„æ•°ç»„ï¼ˆä¾‹å¦‚åªå­˜ intï¼‰ // Array typed_arr; // typed_arr.set_typed(Variant::INT, StringName(), Variant()); // --- å¢ (Add) --- arr.push_back(10); // è‡ªåŠ¨å°è£…ä¸º Variant(10) arr.append(\u0026#34;Hello\u0026#34;); // è‡ªåŠ¨å°è£…ä¸º Variant(\u0026#34;Hello\u0026#34;) arr.push_front(3.14); // æ’å…¥åˆ°å¤´éƒ¨ // æ­¤æ—¶æ•°ç»„å†…å®¹å¯èƒ½ä¸º: [3.14, 10, \u0026#34;Hello\u0026#34;] // --- æŸ¥ (Read) --- if (!arr.is_empty()) { // operator[] è¿”å›çš„æ˜¯ Variant \u0026amp; Variant v = arr[0]; // éœ€è¦æ ¹æ®ç±»å‹è½¬æ¢ if (v.get_type() == Variant::FLOAT) { double d = v; // è‡ªåŠ¨è½¬å‹æ“ä½œç¬¦ print_line(rtos(d)); } } // éå† for (int i = 0; i \u0026lt; arr.size(); i++) { Variant item = arr[i]; // print_line(item); // Variant é‡è½½äº† String è½¬æ¢ } // --- æ”¹ (Update) --- arr[1] = \u0026#34;New Value\u0026#34;; // å°†ç´¢å¼• 1 çš„ 10 æ”¹ä¸ºå­—ç¬¦ä¸² // --- åˆ  (Delete) --- arr.remove_at(0); // ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´  arr.erase(\u0026#34;New Value\u0026#34;); // ç§»é™¤åŒ¹é…å€¼çš„å…ƒç´ ï¼ˆçº¿æ€§æŸ¥æ‰¾ï¼‰ arr.clear(); } Dictionary âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/variant/dictionary.h\u0026quot;\nâœ¨ä½œç”¨:é”®å€¼å¯¹å‡ä¸ºVariantçš„å­—å…¸,å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\nåŸºäºå“ˆå¸Œè¡¨ æ’å…¥é¡ºåºä¿ç•™ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 #include \u0026#34;core/variant/dictionary.h\u0026#34; #include \u0026#34;core/variant/variant.h\u0026#34; void demo_dictionary() { // --- åˆ›å»º (Create) --- Dictionary dict; // --- å¢ (Add) / æ”¹ (Update) --- dict[\u0026#34;name\u0026#34;] = \u0026#34;Godot\u0026#34;; // é”®æ˜¯ String, å€¼æ˜¯ String dict[100] = \u0026#34;One Hundred\u0026#34;; // é”®æ˜¯ int, å€¼æ˜¯ String // ä¹Ÿå¯ä»¥ä½œä¸ºå·¦å€¼ä¿®æ”¹ dict[\u0026#34;name\u0026#34;] = \u0026#34;Godot Engine\u0026#34;; // --- æŸ¥ (Read) --- // æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ if (dict.has(\u0026#34;name\u0026#34;)) { Variant v = dict[\u0026#34;name\u0026#34;]; String s = v; print_line(s); } // å®‰å…¨è·å–ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰ // å¦‚æœ \u0026#34;score\u0026#34; ä¸å­˜åœ¨ï¼Œè¿”å› 0 int score = dict.get(\u0026#34;score\u0026#34;, 0); // éå† // æ³¨æ„ï¼šéå†å­—å…¸é€šå¸¸éå†çš„æ˜¯ Key List\u0026lt;Variant\u0026gt; keys; dict.get_key_list(\u0026amp;keys); // è·å–æ‰€æœ‰ key åˆ°ä¸€ä¸ª List ä¸­ for (const Variant \u0026amp;key : keys) { Variant value = dict[key]; print_line(String(key) + \u0026#34; : \u0026#34; + String(value)); } // --- åˆ  (Delete) --- dict.erase(100); // åˆ é™¤é”®ä¸º 100 çš„æ¡ç›® bool removed = dict.erase(\u0026#34;name\u0026#34;); // è¿”å›æ˜¯å¦åˆ é™¤æˆåŠŸ } Godotåº•å±‚å®¹å™¨ Vector\u0026lt;T\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/vector.h\u0026quot;\nâœ¨ä½œç”¨:æ•°ç»„å®¹å™¨,å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\nè¿ç»­å†…å­˜ï¼Œç±»ä¼¼ std::vector é¢‘ç¹éšæœºè®¿é—®ã€éå†æ—¶æ€§èƒ½å¥½ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 Vector\u0026lt;int\u0026gt; v; // å¢ï¼šå°¾éƒ¨æ’å…¥ v.push_back(10); v.push_back(20); v.push_back(30); // æŸ¥ï¼šæŒ‰ä¸‹æ ‡è®¿é—® int x = v[1]; // 20 int size = v.size(); // 3 // æ”¹ï¼šä¿®æ”¹æŸä¸ªå…ƒç´  v.write[1] = 200; // Godot 4 çš„ Vector ç”¨ write[] // æœ‰äº›ç‰ˆæœ¬æ˜¯ `v.set(1, 200);` // æˆ– `v[1] = 200`ï¼ˆå–å†³äºç»‘å®šï¼‰ // æŸ¥ï¼šéå† for (int i = 0; i \u0026lt; v.size(); i++) { print_line(v[i]); } // åˆ ï¼šæŒ‰ä¸‹æ ‡åˆ é™¤ v.remove_at(0); // åˆ é™¤ç¬¬ 0 ä¸ªå…ƒç´ ï¼Œç°åœ¨å†…å®¹ [200, 30] // æŸ¥ï¼šæ˜¯å¦åŒ…å«æŸå€¼ï¼ˆç®€å•ç±»å‹å¯ä»¥è¿™æ ·ï¼‰ int idx = v.find(30); // æ‰¾åˆ°åˆ™è¿”å› indexï¼Œå¦åˆ™ -1 if (idx != -1) { print_line(\u0026#34;found 30 at \u0026#34;, idx); } VMap\u0026lt;K,V\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/vector.h\u0026quot;\nâœ¨ä½œç”¨:åŸºäºVectorå®ç°çš„å…³è”å®¹å™¨ï¼ˆMapï¼‰å®ƒå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæŒ‰ç…§Keyæ’åºçš„Vector.å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹\nå†…å­˜è¿ç»­ï¼Œç¼“å­˜å‹å¥½ï¼ˆCache Friendlyï¼‰ã€‚ æŸ¥æ‰¾ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºğ‘‚(logğ‘) æ’å…¥å’Œåˆ é™¤éœ€è¦ç§»åŠ¨å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include \u0026#34;core/templates/vmap.h\u0026#34; void demo_vmap() { VMap\u0026lt;int, String\u0026gt; player_names; // --- å¢ (Add) --- // æ³¨æ„ï¼šinsert ä¼šæ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™è¦†ç›–ï¼Œä¸å­˜åœ¨åˆ™ä¿æŒæ’åºæ’å…¥ player_names.insert(1, \u0026#34;Alice\u0026#34;); player_names.insert(2, \u0026#34;Bob\u0026#34;); player_names.insert(10, \u0026#34;Boss\u0026#34;); // --- æŸ¥ (Read) --- // æ£€æŸ¥æ˜¯å¦å­˜åœ¨ if (player_names.has(2)) { // è·å–å€¼ï¼Œå¦‚æœ key ä¸å­˜åœ¨ä¼š crashï¼Œæ‰€ä»¥æœ€å¥½å…ˆæ£€æŸ¥ has String name = player_names.get(2); // æˆ–è€…ä½¿ç”¨ getptrï¼Œå¦‚æœä¸å­˜åœ¨è¿”å› nullptr const String *name_ptr = player_names.getptr(2); } // æŸ¥æ‰¾ç´¢å¼•ï¼ˆç”¨äºéå†å†…éƒ¨ vectorï¼‰ int idx = player_names.find(10); // è¿”å›å†…éƒ¨ vector çš„ index if (idx != -1) { // é€šè¿‡ vector ç´¢å¼•è®¿é—® String val = player_names.get_value_at_index(idx); } // --- æ”¹ (Update) --- player_names.insert(1, \u0026#34;AliceUpdated\u0026#34;); // insert å…¼å…·æ›´æ–°åŠŸèƒ½ // å¦‚æœä½ æœ‰ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç´¢å¼•æ”¹ // player_names.get_value_at_index(0) = \u0026#34;NewName\u0026#34;; // --- åˆ  (Delete) --- player_names.erase(10); // ç§»é™¤ key ä¸º 10 çš„å…ƒç´  } List\u0026lt;T\u0026gt; âœ¨å¤´æ–‡ä»¶:``\nâœ¨ä½œç”¨:\néè¿ç»­å†…å­˜ï¼š èŠ‚ç‚¹æ•£è½åœ¨å†…å­˜ä¸­ï¼Œé€šè¿‡æŒ‡é’ˆè¿æ¥ã€‚ æ’å…¥/åˆ é™¤å¿«ï¼š åœ¨å¤´éƒ¨ã€å°¾éƒ¨æˆ–ä»»æ„å·²çŸ¥èŠ‚ç‚¹å¤„æ’å…¥/åˆ é™¤å…ƒç´ æ˜¯ $O(1)$ æ“ä½œã€‚ éšæœºè®¿é—®æ…¢ï¼š æƒ³è¦è®¿é—®ç¬¬ N ä¸ªå…ƒç´ ï¼ˆlist[N]ï¼‰ï¼Œå¿…é¡»ä»å¤´éå†ï¼Œæ˜¯ $O(N)$ æ“ä½œã€‚è¿™æ˜¯å®ƒå’Œ Vector æœ€å¤§çš„åŒºåˆ«ã€‚ è¿­ä»£å™¨ï¼š ä½¿ç”¨ List::Element * æŒ‡é’ˆä½œä¸ºè¿­ä»£å™¨ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 #include \u0026#34;core/templates/list.h\u0026#34; #include \u0026#34;core/string/ustring.h\u0026#34; void demo_list() { // --- 1. åˆ›å»º (Create) --- List\u0026lt;String\u0026gt; chat_log; // --- 2. å¢ (Add) --- // å°¾éƒ¨æ·»åŠ  O(1) chat_log.push_back(\u0026#34;Player joined\u0026#34;); chat_log.push_back(\u0026#34;Player said: Hello\u0026#34;); // å¤´éƒ¨æ·»åŠ  O(1) - é€‚åˆåšé˜Ÿåˆ— chat_log.push_front(\u0026#34;System: Welcome\u0026#34;); // åœ¨ç‰¹å®šä½ç½®æ’å…¥ // List çš„æ’å…¥é€šå¸¸ä¾èµ–äº Element æŒ‡é’ˆ List\u0026lt;String\u0026gt;::Element *E = chat_log.front(); // è·å–ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ (\u0026#34;System: Welcome\u0026#34;) if (E) { // åœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åé¢æ’å…¥ chat_log.insert_after(E, \u0026#34;System: Message of the day\u0026#34;); } // æ­¤æ—¶é¡ºåº: // [0] System: Welcome // [1] System: Message of the day // [2] Player joined // [3] Player said: Hello // --- 3. æŸ¥ (Read) --- // A. è®¿é—®å¤´å°¾ O(1) if (!chat_log.is_empty()) { String first = chat_log.front()-\u0026gt;get(); String last = chat_log.back()-\u0026gt;get(); } // B. éå† (æ¨èæ–¹å¼ 1: èŒƒå›´ for å¾ªç¯ - Godot 4.x) for (const String \u0026amp;msg : chat_log) { print_line(\u0026#34;Log: \u0026#34; + msg); } // C. éå† (ä¼ ç»Ÿæ–¹å¼/æ‰‹åŠ¨æ–¹å¼: ä½¿ç”¨ Element æŒ‡é’ˆ) // è¿™ç§æ–¹å¼åœ¨ä½ éœ€è¦æ“ä½œèŠ‚ç‚¹(å¦‚åˆ é™¤å½“å‰èŠ‚ç‚¹)æ—¶å¾ˆæœ‰ç”¨ for (List\u0026lt;String\u0026gt;::Element *E = chat_log.front(); E; E = E-\u0026gt;next()) { // E æ˜¯èŠ‚ç‚¹æŒ‡é’ˆï¼ŒE-\u0026gt;get() è·å–å€¼ if (E-\u0026gt;get() == \u0026#34;Player joined\u0026#34;) { print_line(\u0026#34;Found join event!\u0026#34;); } } // D. éšæœºè®¿é—® (è­¦å‘Šï¼šææ…¢ï¼) // List é‡è½½äº† []ï¼Œä½†å®ƒæ˜¯ O(N) çš„ï¼Œä¸å»ºè®®åœ¨å¾ªç¯ä¸­ä½¿ç”¨ // String val = chat_log[2]; // æ€§èƒ½å·®ï¼Œæ…ç”¨ // --- 4. æ”¹ (Update) --- // é€šè¿‡èŠ‚ç‚¹æŒ‡é’ˆç›´æ¥ä¿®æ”¹ List\u0026lt;String\u0026gt;::Element *msg_node = chat_log.back(); if (msg_node) { msg_node-\u0026gt;get() = \u0026#34;Player said: Bye\u0026#34;; // ä¿®æ”¹å€¼ } // --- 5. åˆ  (Delete) --- // A. ç§»é™¤å¤´å°¾ O(1) chat_log.pop_front(); // ç§»é™¤ç¬¬ä¸€ä¸ª chat_log.pop_back(); // ç§»é™¤æœ€åä¸€ä¸ª // B. ç§»é™¤ç‰¹å®šå€¼ O(N) - éœ€è¦æŸ¥æ‰¾ chat_log.erase(\u0026#34;Player joined\u0026#34;); // C. é€šè¿‡è¿­ä»£å™¨ç§»é™¤ O(1) - æœ€é«˜æ•ˆçš„ä¸­é—´åˆ é™¤æ–¹å¼ List\u0026lt;String\u0026gt;::Element *node_to_delete = chat_log.front(); // å‡è®¾æˆ‘ä»¬æ‰¾åˆ°äº†è¦åˆ çš„èŠ‚ç‚¹æŒ‡é’ˆ if (node_to_delete) { chat_log.erase(node_to_delete); // ç›´æ¥æŠŠè¿™ä¸ªèŠ‚ç‚¹æ‘˜é™¤ } // æ¸…ç©º chat_log.clear(); } VSet\u0026lt;T\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/vset.h\u0026quot;\nâœ¨ä½œç”¨:ç±»ä¼¼std::set, å†…å­˜ç´§å‡‘ï¼ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œä¸æ”¯æŒé‡å¤å…ƒç´ ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #include \u0026#34;core/templates/vset.h\u0026#34; void demo_vset() { VSet\u0026lt;int\u0026gt; unique_ids; // --- å¢ (Add) --- unique_ids.insert(50); unique_ids.insert(10); unique_ids.insert(50); // é‡å¤æ’å…¥æ— æ•ˆï¼Œé›†åˆä¸­åªæœ‰ä¸€ä¸ª 50 // æ­¤æ—¶å†…éƒ¨çŠ¶æ€ä¸ºæœ‰åºï¼š[10, 50] // --- æŸ¥ (Read) --- if (unique_ids.has(10)) { print_line(\u0026#34;ID 10 exists\u0026#34;); } // æŸ¥æ‰¾ç´¢å¼• int idx = unique_ids.find(50); // è¿”å› 1 // éå† for (int i = 0; i \u0026lt; unique_ids.size(); i++) { int val = unique_ids[i]; // åƒæ•°ç»„ä¸€æ ·è®¿é—® } // --- æ”¹ (Update) --- // Set é€šå¸¸ä¸ç›´æ¥ä¿®æ”¹å…ƒç´ å€¼ï¼ˆå› ä¸ºè¿™ä¼šç ´åæ’åºï¼‰ï¼Œ // è€Œæ˜¯å…ˆ erase æ—§å€¼ï¼Œå† insert æ–°å€¼ã€‚ // --- åˆ  (Delete) --- unique_ids.erase(10); } HashMap\u0026lt;K,V\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/hash_map.h\u0026quot;\nâœ¨ä½œç”¨:åŸºäºå“ˆå¸Œè¡¨å®ç°,å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\nå¹³å‡æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚ æ— åºï¼ˆéå†é¡ºåºä¸ç¡®å®šï¼‰ã€‚ é€‚ç”¨åœºæ™¯ï¼š éœ€è¦å¿«é€ŸæŸ¥æ‰¾å¤§é‡æ•°æ®ï¼Œä¸”ä¸å…³å¿ƒéå†é¡ºåº âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #include \u0026#34;core/templates/hash_map.h\u0026#34; void demo_hashmap() { HashMap\u0026lt;String, int\u0026gt; inventory; // --- å¢ (Add) / æ”¹ (Update) --- inventory.insert(\u0026#34;Apple\u0026#34;, 5); inventory[\u0026#34;Banana\u0026#34;] = 10; // ç±»ä¼¼ std::mapï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æ›´æ–° inventory.insert(\u0026#34;Apple\u0026#34;, 8); // æ›´æ–° Apple çš„å€¼ä¸º 8 // --- æŸ¥ (Read) --- if (inventory.has(\u0026#34;Banana\u0026#34;)) { int count = inventory[\u0026#34;Banana\u0026#34;]; // è·å–å€¼ } // ä½¿ç”¨ find è·å–è¿­ä»£å™¨/æŒ‡é’ˆï¼Œé¿å…ä¸¤æ¬¡å“ˆå¸Œè®¡ç®— HashMap\u0026lt;String, int\u0026gt;::Iterator E = inventory.find(\u0026#34;Apple\u0026#34;); if (E) { int val = E-\u0026gt;value; // E-\u0026gt;key è·å–é”® } // éå† for (const KeyValue\u0026lt;String, int\u0026gt; \u0026amp;E : inventory) { print_line(E.key + \u0026#34;: \u0026#34; + itos(E.value)); } // --- åˆ  (Delete) --- inventory.erase(\u0026#34;Banana\u0026#34;); // å¦‚æœå­˜åœ¨åˆ™åˆ é™¤ bool removed = inventory.remove(\u0026#34;Apple\u0026#34;); // remove ä¹Ÿæ˜¯åˆ é™¤ } RBMap çº¢é»‘æ ‘,æœ‰åºéå†æ€§èƒ½å¥½\nRBSet class_db è·¯å¾„ï¼š#include \u0026ldquo;core/object/class_db.h\u0026rdquo;\nåœ¨_bind_methodsä¸­è¿›è¡Œç±»å‹å’Œå‡½æ•°æ³¨å†Œçš„æ—¶å€™ï¼Œä½¿ç”¨åˆ°çš„ç±»å‹æ³¨å†Œå‡½æ•°å°±æ¥è‡ªè¯¥å¤´æ–‡ä»¶\næ¥å£ ä½œç”¨ ç¤ºä¾‹ ClassDB::bind_method æ³¨å†Œå‡½æ•°åˆ°è„šæœ¬ ClassDB::bind_method(D_METHOD(\u0026ldquo;test_print\u0026rdquo;), \u0026amp;CommandTool::test_print); OS è·¯å¾„ï¼š#include \u0026ldquo;sence/gui/xxx.h\u0026rdquo;\næä¾›äº†ä¸€ç³»åˆ—æ“ä½œç³»ç»Ÿå±‚çº§çš„APIï¼Œæ¯”å¦‚æ‰“å°æ—¥ã€è·å–å¼•æ“è¿è¡Œæ—¶é•¿ç­‰ã€‚\næ¥å£ ä½œç”¨ ç¤ºä¾‹ get_ticks_usec è·å–å¼•æ“è¿è¡Œæ—¶é•¿ï¼Œå•ä½ä¸ºå¾®ç§’ get_ticks_msec è·å–å¼•æ“è¿è¡Œæ—¶é•¿ï¼Œå•ä½ä¸ºæ¯«ç§’ callable è·¯å¾„ï¼š#include \u0026ldquo;core/variant/callable.h\u0026rdquo;\ngodotè‡ªèº«æä¾›äº†ä¸€å¥—ç”¨äºå®‰å…¨ã€ç±»å‹æ£€æŸ¥çš„å‡½æ•°å›è°ƒæœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯Callableï¼Œåœ¨è¿›è¡Œä¿¡å·è¿æ¥æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ°å®ƒã€‚\nç±»ä¼¼ C++ çš„ std::function\u0026lt;void()\u0026gt;ï¼Œä½†å®ƒèƒ½åœ¨ Godot å¯¹è±¡ç³»ç»Ÿä¸­åºåˆ—åŒ–ã€è¿æ¥ä¿¡å·ã€è·¨è¯­è¨€è°ƒç”¨ã€‚\n1 2 3 4 5 //åŸºç¡€æ„é€ å‡½æ•°ï¼Œæ³¨æ„æ­¤å¤„çš„methodéœ€è¦åœ¨_bind_methodä¸­è¢«æ³¨å†Œæ‰èƒ½å¤Ÿé€šè¿‡å­—ç¬¦ä¸²è®¿é—®ã€‚ Callable c = Callable(this, \u0026#34;_on_something\u0026#34;); //æ›´å®‰å…¨é«˜æ•ˆçš„ç»‘å®š Callable c = callable_mp(this, \u0026amp;MyClass::_on_timeout); gui åŸºç¡€è·¯å¾„ï¼š#include \u0026ldquo;sence/gui/xxx.h\u0026rdquo;\nGUIåŸºç¡€ç±» Control æ¥å£ ä½œç”¨ å³å¯¹é½ set_mouse_filter è®¾ç½®é¼ æ ‡/ç‚¹å‡»è¡Œä¸º STOP PASS IGNORE err_dialog_control-\u0026gt;set_custom_minimum_size(Size2(600, 600) * EDSCALE);\nerr_dialog_control-\u0026gt;connect(SceneStringName(draw), callable_mp(this, \u0026amp;LyfTestEditor::test_draw));\nerr_dialog_control-\u0026gt;draw_line(Point2(0,0), Point2(100,100),Color(1,0,0));\nCanvasItem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 void draw_dashed_line(const Point2 \u0026amp;p_from, const Point2 \u0026amp;p_to, const Color \u0026amp;p_color, real_t p_width = -1.0, real_t p_dash = 2.0, bool p_aligned = true, bool p_antialiased = false); void draw_line(const Point2 \u0026amp;p_from, const Point2 \u0026amp;p_to, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_polyline(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_polyline_colors(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, real_t p_width = -1.0, bool p_antialiased = false); void draw_arc(const Vector2 \u0026amp;p_center, real_t p_radius, real_t p_start_angle, real_t p_end_angle, int p_point_count, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_multiline(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_multiline_colors(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, real_t p_width = -1.0, bool p_antialiased = false); void draw_rect(const Rect2 \u0026amp;p_rect, const Color \u0026amp;p_color, bool p_filled = true, real_t p_width = -1.0, bool p_antialiased = false); void draw_circle(const Point2 \u0026amp;p_pos, real_t p_radius, const Color \u0026amp;p_color, bool p_filled = true, real_t p_width = -1.0, bool p_antialiased = false); void draw_texture(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Point2 \u0026amp;p_pos, const Color \u0026amp;p_modulate = Color(1, 1, 1, 1)); void draw_texture_rect(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, bool p_tile = false, const Color \u0026amp;p_modulate = Color(1, 1, 1), bool p_transpose = false); void draw_texture_rect_region(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, const Rect2 \u0026amp;p_src_rect, const Color \u0026amp;p_modulate = Color(1, 1, 1), bool p_transpose = false, bool p_clip_uv = false); void draw_msdf_texture_rect_region(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, const Rect2 \u0026amp;p_src_rect, const Color \u0026amp;p_modulate = Color(1, 1, 1), double p_outline = 0.0, double p_pixel_range = 4.0, double p_scale = 1.0); void draw_lcd_texture_rect_region(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, const Rect2 \u0026amp;p_src_rect, const Color \u0026amp;p_modulate = Color(1, 1, 1)); void draw_style_box(const Ref\u0026lt;StyleBox\u0026gt; \u0026amp;p_style_box, const Rect2 \u0026amp;p_rect); void draw_primitive(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_uvs, Ref\u0026lt;Texture2D\u0026gt; p_texture = Ref\u0026lt;Texture2D\u0026gt;()); void draw_polygon(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_uvs = Vector\u0026lt;Point2\u0026gt;(), Ref\u0026lt;Texture2D\u0026gt; p_texture = Ref\u0026lt;Texture2D\u0026gt;()); void draw_colored_polygon(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Color \u0026amp;p_color, const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_uvs = Vector\u0026lt;Point2\u0026gt;(), Ref\u0026lt;Texture2D\u0026gt; p_texture = Ref\u0026lt;Texture2D\u0026gt;()); void draw_mesh(const Ref\u0026lt;Mesh\u0026gt; \u0026amp;p_mesh, const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Transform2D \u0026amp;p_transform = Transform2D(), const Color \u0026amp;p_modulate = Color(1, 1, 1)); void draw_multimesh(const Ref\u0026lt;MultiMesh\u0026gt; \u0026amp;p_multimesh, const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture); void draw_string(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_multiline_string(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_max_lines = -1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::LineBreakFlag\u0026gt; p_brk_flags = TextServer::BREAK_MANDATORY | TextServer::BREAK_WORD_BOUND, BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_string_outline(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_size = 1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_multiline_string_outline(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_max_lines = -1, int p_size = 1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::LineBreakFlag\u0026gt; p_brk_flags = TextServer::BREAK_MANDATORY | TextServer::BREAK_WORD_BOUND, BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_char(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_char, int p_font_size = Font::DEFAULT_FONT_SIZE, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0)) const; void draw_char_outline(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_char, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_size = 1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0)) const; void draw_set_transform(const Point2 \u0026amp;p_offset, real_t p_rot = 0.0, const Size2 \u0026amp;p_scale = Size2(1.0, 1.0)); void draw_set_transform_matrix(const Transform2D \u0026amp;p_matrix); void draw_animation_slice(double p_animation_length, double p_slice_begin, double p_slice_end, double p_offset = 0); void draw_end_animation(); æ–‡æœ¬ç±» Label âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/label.h\u0026quot; âœ¨ä½œç”¨:Labelæ˜¯godotæä¾›çš„UIæ§ä»¶ï¼Œå¯ä»¥è‡ªé€‚åº”å†…å®¹çš„å¤§å°\nRichTextLabel âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/rich_text_label.h\u0026quot;\nâœ¨ä½œç”¨:RichTextLabelæ˜¯godotæä¾›çš„UIæ§ä»¶ï¼Œå¯ä»¥ä½¿ç”¨BBcodeæ¥æ§åˆ¶æ˜¾ç¤ºçš„å†…å®¹ï¼Œæ¯”å¦‚è®¾ç½®å½“è¡Œæ–‡æœ¬é¢œè‰²ç­‰\nâœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 screen_output_label-\u0026gt;set_use_bbcode(true);\t//ä½¿ç”¨bbcodeï¼Œå¼€å¯æ‰èƒ½æ­£ç¡®æ˜¾ç¤º[color=red]XXXX[\\color]çš„bbcodeæ ¼å¼æ–‡æœ¬ screen_output_label-\u0026gt;set_fit_content(true);\t//è‡ªé€‚åº”æ–‡æœ¬é«˜åº¦ screen_output_label-\u0026gt;set_autowrap_mode(TextServer::AutowrapMode::AUTOWRAP_OFF);//å…³é—­å®½åº¦è°ƒæ•´ï¼Œä¸ä¸Šæ–¹è®¾ç½®ç›¸ç»“åˆï¼Œå¯ä»¥è‡ªé€‚åº”å®½é«˜ã€‚ æŒ‰é’®ç±» OptionButton âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/option_button.h\u0026quot;\nâœ¨ä½œç”¨:OptionButtonæ˜¯Godotä¸­æä¾›çš„ä¸€ä¸ªGUIæ§ä»¶.å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªButtonçš„æ´¾ç”Ÿæ§ä»¶ï¼Œé€šè¿‡å†…éƒ¨åŒ…å«ä¸€ä¸ªPopupMenuå®ç°ä¸‹æ‹‰åŠŸèƒ½ã€‚æœ‰ä»¥ä¸‹ä½œç”¨ï¼š\næ˜¾ç¤ºä¸€ä¸ªä¸‹æ‹‰èœå•ã€‚ åŒ…å«å¤šä¸ªå¯é€‰é¡¹ï¼ˆItemsï¼‰ï¼Œæ¯ä¸ª Item æœ‰ æ–‡æœ¬ã€å›¾æ ‡ã€IDã€å¯ç”¨æ€§ã€‚ ç”¨æˆ·ç‚¹å‡»åï¼Œå¼¹å‡ºPopupMenuä¾›é€‰æ‹©ã€‚ æ”¯æŒå›è°ƒ \u0026amp; ä¿¡å·ï¼ˆå¦‚ item_selected(int index)ï¼‰ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 // åˆ›å»º OptionButton option_button = memnew(OptionButton); add_child(option_button); // æ·»åŠ é€‰é¡¹ option_button-\u0026gt;add_item(\u0026#34;Easy\u0026#34;, 1); option_button-\u0026gt;add_item(\u0026#34;Normal\u0026#34;, 2); option_button-\u0026gt;add_icon_item(p_icon,\u0026#34;Hard\u0026#34;, 3); // é€‰æ‹©é»˜è®¤é¡¹ option_button-\u0026gt;select(1); // Normal // ç»‘å®šä¿¡å· option_button-\u0026gt;connect(\u0026#34;item_selected\u0026#34;, Callable(this, \u0026#34;_on_item_selected\u0026#34;)); // åŠ ä¸€ä¸ª Label æ˜¾ç¤ºä¿¡æ¯ info_label = memnew(Label); info_label-\u0026gt;set_position(Vector2(0, 40)); add_child(info_label); info_label-\u0026gt;set_text(\u0026#34;Selected: Normal\u0026#34;); } // ä¿¡å·å›è°ƒ void _on_item_selected(int index) { int id = option_button-\u0026gt;get_item_id(index); String name = option_button-\u0026gt;get_item_text(index); info_label-\u0026gt;set_text(\u0026#34;Selected: \u0026#34; + name + \u0026#34; (ID = \u0026#34; + String::num_int64(id) + \u0026#34;)\u0026#34;); } MenuButton âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/menu_button.h\u0026quot;\nâœ¨ä½œç”¨:\nâœ¨ä½¿ç”¨ç¤ºä¾‹:\nå¼¹çª—ç±» AcceptDialog âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/dialogs.h\nâœ¨ä½œç”¨:AcceptDialogæ˜¯Godotä¸­æœ€å¸¸ç”¨çš„å¼¹å‡ºå¼å¯¹è¯æ¡†ï¼ˆPopupï¼‰ä¹‹ä¸€ï¼Œç”¨æ¥å‘ç”¨æˆ·æ˜¾ç¤ºä¿¡æ¯ï¼Œå¹¶æä¾›ä¸€ä¸ªâ€œç¡®è®¤/æ¥å—â€æŒ‰é’®ã€‚\nâœ”ï¸è‡ªå¸¦â€œç¡®è®¤â€æŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»åä¼šå‘é€confirmedä¿¡å·ã€‚ âœ”ï¸è‡ªå¸¦canceledä¿¡å·ã€‚ âœ”ï¸å¯ä»¥æ˜¾ç¤ºç®€å•çš„ä¿¡æ¯ï¼Œç”¨äºæé†’ç”¨æˆ·ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 //åˆå§‹åŒ– err_dialog = memnew(AcceptDialog); add_child(err_dialog); err_dialog-\u0026gt;get_ok_button()-\u0026gt;set_text(\u0026#34;ä¸ok\u0026#34;); err_dialog-\u0026gt;get_ok_button()-\u0026gt;connect(\u0026#34;pressed\u0026#34;,callable_mp(this, \u0026amp;LyfTestEditor::test_func)); //è®¾ç½®æ–‡æœ¬ï¼Œå¹¶å”¤èµ·å¼¹çª— err_dialog-\u0026gt;set_text(\u0026#34;LyfTestEditorPlugin::MENU_OPTION_CREATE_111\u0026#34;); err_dialog-\u0026gt;popup_centered(); ConfirmationDialog å¤´æ–‡ä»¶è·¯å¾„ï¼š#include \u0026quot;scene/gui/dialogs.h\u0026quot;\nConfirmationDialogæ˜¯Godotä¸­ç”¨äºç¡®è®¤/å–æ¶ˆæ“ä½œçš„æ ‡å‡†å¼¹çª—ï¼ˆPopupï¼‰ï¼Œç»§æ‰¿è‡ª AcceptDialogã€‚\nç›¸è¾ƒäºAcceptDialogå¤šäº†ä¸€ä¸ªcancelæŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»åä¼šå‘é€canceledä¿¡å·ã€‚\nThread âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/os/thread.h\u0026quot;\nâœ¨ä½œç”¨:Godot æä¾›çš„çº¿ç¨‹ç±»ï¼Œç”¨äºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹ã€‚å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\nè·¨å¹³å°æ”¯æŒï¼šåœ¨ Windowsã€Linuxã€macOS ç­‰å¹³å°ä¸Šç»Ÿä¸€æ¥å£ è½»é‡çº§ï¼šé€‚åˆåå°ä»»åŠ¡ã€æ•°æ®å¤„ç†ç­‰åœºæ™¯ çº¿ç¨‹å®‰å…¨ï¼šéœ€è¦é…åˆ Mutexã€Semaphore ç­‰åŒæ­¥æœºåˆ¶ä½¿ç”¨ âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹:\nä¸è¦åœ¨å­çº¿ç¨‹ä¸­ç›´æ¥æ“ä½œåœºæ™¯æ ‘ï¼šæ‰€æœ‰ GUI æ“ä½œå¿…é¡»åœ¨ä¸»çº¿ç¨‹è¿›è¡Œ ä½¿ç”¨ call_deferredï¼šå¦‚æœéœ€è¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œä»£ç ï¼Œä½¿ç”¨ call_deferred æˆ–ä¿¡å·æœºåˆ¶ é¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼šè€—æ—¶ä»»åŠ¡æ”¾åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 #include \u0026#34;core/os/thread.h\u0026#34; #include \u0026#34;core/os/mutex.h\u0026#34; #include \u0026#34;core/os/semaphore.h\u0026#34; class ThreadExample : public Node { GDCLASS(ThreadExample, Node); private: Thread *worker_thread; Mutex *mutex; Semaphore *semaphore; bool thread_active; Vector\u0026lt;int\u0026gt; shared_data; public: ThreadExample() { worker_thread = memnew(Thread); mutex = memnew(Mutex); semaphore = memnew(Semaphore); thread_active = true; } ~ThreadExample() { thread_active = false; semaphore-\u0026gt;post(); // å”¤é†’çº¿ç¨‹ä½¿å…¶é€€å‡º if (worker_thread-\u0026gt;is_started()) { worker_thread-\u0026gt;wait_to_finish(); } memdelete(worker_thread); memdelete(mutex); memdelete(semaphore); } // çº¿ç¨‹å·¥ä½œå‡½æ•° static void _thread_function(void *p_userdata) { ThreadExample *instance = static_cast\u0026lt;ThreadExample *\u0026gt;(p_userdata); while (instance-\u0026gt;thread_active) { // ç­‰å¾…ä¿¡å·ï¼ˆç­‰å¾…ä»»åŠ¡ï¼‰ instance-\u0026gt;semaphore-\u0026gt;wait(); if (!instance-\u0026gt;thread_active) { break; } // æ‰§è¡Œè€—æ—¶ä»»åŠ¡ï¼ˆä¾‹å¦‚æ•°æ®å¤„ç†ï¼‰ Vector\u0026lt;int\u0026gt; local_data; { // åŠ é”è®¿é—®å…±äº«æ•°æ® MutexLock lock(instance-\u0026gt;mutex); local_data = instance-\u0026gt;shared_data; } // å¤„ç†æ•°æ®ï¼ˆä¸æ¶‰åŠ GUI æ“ä½œï¼‰ for (int i = 0; i \u0026lt; local_data.size(); i++) { local_data[i] *= 2; // ç¤ºä¾‹ï¼šæ•°æ®ç¿»å€ OS::get_singleton()-\u0026gt;delay_usec(1000); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ } // å¤„ç†å®Œæˆåï¼Œé€šçŸ¥ä¸»çº¿ç¨‹æ›´æ–° instance-\u0026gt;call_deferred(\u0026#34;_on_thread_complete\u0026#34;, local_data); } } // å¯åŠ¨çº¿ç¨‹ void start_thread() { ERR_FAIL_COND(worker_thread-\u0026gt;is_started()); worker_thread-\u0026gt;start(_thread_function, this); } // æ·»åŠ ä»»åŠ¡ï¼ˆä»ä¸»çº¿ç¨‹è°ƒç”¨ï¼‰ void add_task(const Vector\u0026lt;int\u0026gt; \u0026amp;data) { MutexLock lock(mutex); shared_data = data; semaphore-\u0026gt;post(); // å”¤é†’å·¥ä½œçº¿ç¨‹ } // çº¿ç¨‹å®Œæˆå›è°ƒï¼ˆåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼‰ void _on_thread_complete(const Vector\u0026lt;int\u0026gt; \u0026amp;result) { // å¯ä»¥å®‰å…¨åœ°æ“ä½œ GUI print_line(\u0026#34;Thread completed with \u0026#34; + itos(result.size()) + \u0026#34; items\u0026#34;); // æ›´æ–° UI ç­‰ for (int i = 0; i \u0026lt; result.size(); i++) { print_line(\u0026#34;Result[\u0026#34; + itos(i) + \u0026#34;] = \u0026#34; + itos(result[i])); } } protected: static void _bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;start_thread\u0026#34;), \u0026amp;ThreadExample::start_thread); ClassDB::bind_method(D_METHOD(\u0026#34;add_task\u0026#34;, \u0026#34;data\u0026#34;), \u0026amp;ThreadExample::add_task); ClassDB::bind_method(D_METHOD(\u0026#34;_on_thread_complete\u0026#34;, \u0026#34;result\u0026#34;), \u0026amp;ThreadExample::_on_thread_complete); } }; çº¿ç¨‹åŒæ­¥å·¥å…· Mutexï¼ˆäº’æ–¥é”ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #include \u0026#34;core/os/mutex.h\u0026#34; Mutex *mutex = memnew(Mutex); // åŠ é” mutex-\u0026gt;lock(); // è®¿é—®å…±äº«èµ„æº critical_section(); // è§£é” mutex-\u0026gt;unlock(); // ä½¿ç”¨ RAII è‡ªåŠ¨ç®¡ç†é”ï¼ˆæ¨èï¼‰ { MutexLock lock(mutex); // æ„é€ æ—¶è‡ªåŠ¨åŠ é” critical_section(); } // ææ„æ—¶è‡ªåŠ¨è§£é” Semaphoreï¼ˆä¿¡å·é‡ï¼‰ 1 2 3 4 5 6 7 8 9 #include \u0026#34;core/os/semaphore.h\u0026#34; Semaphore *semaphore = memnew(Semaphore); // ç­‰å¾…ï¼ˆé˜»å¡ç›´åˆ°æœ‰ä¿¡å·ï¼‰ semaphore-\u0026gt;wait(); // å‘é€ä¿¡å· semaphore-\u0026gt;post(); å¸¸è§ä½¿ç”¨åœºæ™¯ å¼‚æ­¥èµ„æºåŠ è½½ 1 2 3 4 5 6 7 8 9 10 void load_resources_async() { worker_thread-\u0026gt;start([](void *p_userdata) { // åœ¨å­çº¿ç¨‹ä¸­åŠ è½½èµ„æº Ref\u0026lt;Texture2D\u0026gt; texture = ResourceLoader::load(\u0026#34;res://texture.png\u0026#34;); // é€šè¿‡ä¿¡å·é€šçŸ¥ä¸»çº¿ç¨‹ Node *node = static_cast\u0026lt;Node *\u0026gt;(p_userdata); node-\u0026gt;call_deferred(\u0026#34;_on_resource_loaded\u0026#34;, texture); }, this); } åå°æ•°æ®å¤„ç† 1 2 3 4 5 void process_background_task(const Vector\u0026lt;float\u0026gt; \u0026amp;data) { MutexLock lock(mutex); task_queue.push_back(data); semaphore-\u0026gt;post(); // å”¤é†’å·¥ä½œçº¿ç¨‹ } ç½‘ç»œè¯·æ±‚ 1 2 3 4 5 6 7 8 9 10 void fetch_data_async(const String \u0026amp;url) { worker_thread-\u0026gt;start([url](void *p_userdata) { // æ‰§è¡Œç½‘ç»œè¯·æ±‚ String result = http_request(url); // è¿”å›ç»“æœåˆ°ä¸»çº¿ç¨‹ Node *node = static_cast\u0026lt;Node *\u0026gt;(p_userdata); node-\u0026gt;call_deferred(\u0026#34;_on_data_received\u0026#34;, result); }, this); } Config GLOBAL_DEF(\u0026ldquo;aaa/ccc/bbb111\u0026rdquo;, false);\n","date":"2025-11-04T16:18:31+08:00","image":"https://Liyufei1.github.io/godot.png","permalink":"https://Liyufei1.github.io/p/godot%E4%BA%8Cmodules%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/","title":"ã€godotã€‘äºŒã€Moduleså¼€å‘æŒ‡å—"},{"content":"å¼•æ“ç¼–è¯‘ å®˜æ–¹æºç ä»“åº“ï¼šgodot\nå®˜æ–¹godot-cppä»“åº“ï¼šgodot-cpp\nç¼–è¯‘æŒ‡ä»¤ åœ¨Godot_Engineæ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹æ–¹ç¼–è¯‘æŒ‡ä»¤scons,æœ‰ä»¥ä¸‹å¯é€‰å‚æ•°\næŒ‡å®šç›®æ ‡å¹³å° ï¼šï¼šplatform=windows/android/macos æ˜¯å¦å¸¦ç¬¦å·è¡¨ ï¼šï¼šdebug_symbols=yes/no æ„å»ºç›®æ ‡ç±»å‹ ï¼šï¼štarget=editor/template_debug/template_release æ˜¯å¦è¾“å‡ºç¼–è¯‘æŒ‡ä»¤ï¼šï¼šverbose=yes ç›®æ ‡å¹³å°èŠ¯ç‰‡æ¶æ„ï¼šï¼šarch=x86_64/arm64v8 æ˜¯å¦ç”Ÿæˆç¼–è¯‘jsonï¼šï¼šcompiledb=true æŒ‡å®šç¼–è¯‘çº¿ç¨‹æ•°é‡ï¼šï¼š-j8/-j16 ä½¿ç”¨ LLVM/Clang ç¼–è¯‘å™¨è€Œé GCC ï¼šï¼šuse_llvm=yes/no 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 1.windowså¹³å°ç¼–è¯‘ ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\bin ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine ç¼–è¯‘æŒ‡ä»¤ï¼šscons compiledb=true debug_symbols=yes verbose=yes -j16 2.androidçš„libgodot_android.soç¼–è¯‘ ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java\\lib\\libs\\debug\\arm64-v8a ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine ç¼–è¯‘æŒ‡ä»¤ï¼šscons platform=android target=template_debug debug_symbols=yes compiledb=true æˆ–scons platform=android store_release=true production=true dev_mode=false dev_build=false debug_symbols=true tests=false target=template_release arch=arm64 compiledb=true 3.ç”ŸæˆAndroidå¯¼å‡ºæ¨¡æ¿ å‰ç½®ç”Ÿæˆï¼š ç”Ÿæˆdebugçš„soï¼šscons platform=android target=template_debug arch=arm64 dev_build=yes generate_android_binaries=yes ç”Ÿæˆreleaseçš„soï¼šscons platform=android target=template_release arch=arm64 dev_build=yes generate_android_binaries=yes ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\bin\\android_release.apk ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java ç¼–è¯‘æŒ‡ä»¤ï¼š./gradlew.bat generateGodotTemplates 4.androidçš„aarçš„ç¼–è¯‘ï¼Œgodot-lib.template_debug.aar ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java\\lib\\build\\outputs\\aar ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java ç¼–è¯‘æŒ‡ä»¤ï¼šgradlew.bat :lib:bundleTemplateDebugAar 5.ç”Ÿæˆslnæ–‡ä»¶ scons vsproj=yes 6.ç”ŸæˆGDExtensionçš„èƒ¶æ°´ä»£ç  1. ç¼–è¯‘extension_api.jsonæ–‡ä»¶ï¼š bin\\godot.windows.editor.x86_64.exe --dump-extension-api 2. åœ¨godot-cppä¸­æ‰§è¡Œä»£ç ç”Ÿæˆï¼š scons debug_symbols=yes verbose=yes generate_bindings=yes custom_api_file=E:\\Godot\\godot-cpp\\gdextension\\extension_api.json 7.å¯¼å‡ºèµ„æºåŒ…zip/pck ç”Ÿæˆè·¯å¾„ï¼š${YourProjectPath} ç¼–è¯‘è·¯å¾„ï¼š${YourProjectPath} 1. E:\\Godot\\Godot_Engine\\bin\\godot.windows.editor.x86_64.exe --headless --export-pack \u0026#34;Android\u0026#34; game.zip 2. E:\\Godot\\Godot_Engine\\bin\\godot.windows.editor.x86_64.exe --headless --export-pack \u0026#34;Android\u0026#34; game.pck è¿è¡ŒæŒ‡ä»¤ 1 2 3 4 5 //è¿è¡Œç¼–è¾‘å™¨ \u0026#34;godot.exe --path ${PgmPath} -v -e\u0026#34; //ç›´æ¥è¿è¡Œruntime \u0026#34;godot.exe --path ${PgmPath} -v\u0026#34; JNIè·¯å¾„ æ–‡ä»¶è·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java_godot_lib_jni.h\næ¨¡å—(Module)å¼€å‘ å‚è€ƒæ–‡æ¡£ï¼šè‡ªå®šä¹‰ C++ æ¨¡å— â€” Godot Engine (4.x) ç®€ä½“ä¸­æ–‡æ–‡æ¡£\næ–‡ä»¶åŠç»“æ„ æ–°å»ºä¸€ä¸ªæ¨¡å—éœ€è¦ä»¥ä¸‹æ–‡ä»¶åŠç»“æ„ï¼Œå­˜æ”¾åœ¨E:\\Godot\\Godot_Engine\\modulesç›®å½•åº•ä¸‹ ã€‚\nåœ¨E:\\Godot\\Godot_Engine\\modules\\register_module_types.gen.cppæ–‡ä»¶ä¸­ï¼Œä¼šæ ¹æ®æˆ‘ä»¬æ¨¡å—ä¸­çš„SCsubæ–‡ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆå®é™…çš„æ¨¡å—æ³¨å†Œä»£ç ï¼Œå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 //register_module_types.gen.cpp ä¸­è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ï¼Œç”¨äºæ¨¡å—çš„å®é™…æ³¨å†Œã€‚ #include \u0026#34;modules/ns_test_module/register_types.h\u0026#34; //... #ifdef MODULE_NS_TEST_MODULE_ENABLED initialize_ns_test_module_module(p_level); #endif //... #ifdef MODULE_NS_TEST_MODULE_ENABLED uninitialize_ns_test_module_module(p_level); #endif SCsubå’Œconfig.py SCsubæ˜¯è¿™ä¸ªæ¨¡å—çš„ç¼–è¯‘æŒ‡ä»¤ï¼ŒåŒ…æ‹¬æºç çš„æ”¶é›†ã€å¤´æ–‡ä»¶è·¯å¾„æ·»åŠ ã€é™æ€åº“çš„é“¾æ¥ç­‰ã€‚\nä¸config.pyç»“åˆä½¿ç”¨ï¼Œå¯ä»¥åŠ¨æ€çš„ç®¡ç†è¯¥æ¨¡å—çš„ç¼–è¯‘é€‰é¡¹ï¼Œä»¥åŠå°†è¯¥æ¨¡å—è‡ªåŠ¨çš„ç”Ÿæˆåˆ°E:\\Godot\\Godot_Engine\\modules\\register_module_types.gen.cppè¿›è¡Œæ¨¡å—çš„æ³¨å†Œã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 #====SCsub====== from misc.utility.scons_hints import * Import(\u0026#34;env\u0026#34;) Import(\u0026#34;env_modules\u0026#34;) env_nstest = env_modules.Clone() # æ·»åŠ ç¬¬ä¸‰æ–¹åº“çš„å¤´æ–‡ä»¶è·¯å¾„ env.Append(CPPPATH=[\u0026#34;#modules/matrix_data_pipeline/include\u0026#34;]) env.Append(CPPPATH=[\u0026#34;#modules/matrix_data_pipeline/include/NSCppData\u0026#34;]) env.Append(CPPPATH=[\u0026#34;#modules/matrix_data_pipeline/include/NSCppData/ProtoGen\u0026#34;]) # æ·»åŠ åº“æ–‡ä»¶è·¯å¾„ if env[\u0026#34;platform\u0026#34;] == \u0026#34;windows\u0026#34;: env.Append(LIBPATH=[\u0026#34;#modules/matrix_data_pipeline/lib/windows\u0026#34;]) env.Append(LIBS=[\u0026#34;NSCppData\u0026#34;,\u0026#34;libprotobuf\u0026#34;]) elif env[\u0026#34;platform\u0026#34;] == \u0026#34;android\u0026#34;: env.Append(LIBPATH=[\u0026#34;#modules/matrix_data_pipeline/lib/android\u0026#34;]) env.Append(LIBS=[\u0026#34;mylib\u0026#34;]) # Godot source files module_obj = [] env_nstest.add_source_files(module_obj, \u0026#34;*.cpp\u0026#34;) # env_nstest.add_source_files(module_obj, \u0026#34;editor/*.cpp\u0026#34;) env.modules_sources += module_obj 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #====config.py====== def can_build(env, platform): return True def configure(env): pass # def get_doc_classes(): # return [ # \u0026#34;OggPacketSequence\u0026#34;, # \u0026#34;OggPacketSequencePlayback\u0026#34;, # ] # def get_doc_path(): # return \u0026#34;doc_classes\u0026#34; register_types è¯¥æ–‡ä»¶è´Ÿè´£å¯¹è‡ªèº«æ¨¡å—ä¸­å£°æ˜çš„godotç±»å‹è¿›è¡Œç±»å‹æ³¨å†Œï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨ç›¸å¯¹è¾ƒæ—©çš„é˜¶æ®µï¼ˆmainå‡½æ•°çš„setupé˜¶æ®µï¼‰è¿›è¡Œä¸€äº›å•ä¾‹ç±»çš„å®ä¾‹åŒ–ã€‚ å¦‚æœåœ¨è¿›è¡Œç¼–è¾‘å™¨å·¥å…·ç±»çš„å¼€å‘ï¼Œåˆ™å·¥å…·ç±»çš„å®ä¾‹åŒ–å’Œæ³¨å†Œï¼Œä¹Ÿæ˜¯åœ¨è¯¥é˜¶æ®µè¿›è¡Œçš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 //==============register_types.h============ #ifndef NSTEST_REGISTER_TYPES_H #define NSTEST_REGISTER_TYPES_H #include \u0026#34;modules/register_module_types.h\u0026#34; void initialize_ns_test_module_module(ModuleInitializationLevel p_level); void uninitialize_ns_test_module_module(ModuleInitializationLevel p_level); #endif //==============register_types.cpp============ #include \u0026#34;register_types.h\u0026#34; #include \u0026#34;core/object/object.h\u0026#34; #include \u0026#34;ns_test_module.h\u0026#34; void initialize_ns_test_module_module(ModuleInitializationLevel p_level) { if (p_level != MODULE_INITIALIZATION_LEVEL_SCENE) { return; } GDREGISTER_CLASS(NsTestModule) //æ³¨å†Œç±»å‹ GDREGISTER_CLASS(NsTestResource) } void uninitialize_ns_test_module_module(ModuleInitializationLevel p_level) { if (p_level != MODULE_INITIALIZATION_LEVEL_SCENE) { return; } } GDExtensionå¼€å‘ å‚è€ƒæ–‡æ¡£ï¼šå…¥é—¨ â€” Godot Engine (4.x) ç®€ä½“ä¸­æ–‡æ–‡æ¡£\nå¯¹äºGDExtensionä¸­ç¼–å†™çš„c++ä»£ç ï¼Œéœ€è¦è¿›è¡Œç‰¹å®šçš„æ³¨å†Œå’Œç¼–è¯‘æµç¨‹ï¼Œæ‰èƒ½å½¢æˆç»™godotç”¨çš„åŠ¨æ€é“¾æ¥åº“\né¡¹ç›®ç»„ç»‡ç»“æ„ å¯¹äºå¸¦GDExtensionçš„godoté¡¹ç›®ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹çš„åŸºæœ¬ç»“æ„\nexample.gdextension 1 2 3 4 5 6 7 8 9 10 11 12 [configuration] //æ³¨æ„æ­¤å¤„çš„entry_symbolåï¼Œåº”è¯¥ä¸regisiter_typesä¸­çš„å…¥å£å‡½æ•°åä¿æŒä¸€è‡´ entry_symbol = \u0026#34;GodotTest_library_init\u0026#34; compatibility_minimum = \u0026#34;4.1\u0026#34; reloadable = true [libraries] windows.debug.x86_64 = \u0026#34;res://bin/GodotTest.windows.template_debug.x86_64.dll\u0026#34; android.debug.arm64 = \u0026#34;res://bin/GodotTest.android.template_release.arm64.so\u0026#34; android.arm64 = \u0026#34;res://bin/GodotTest.android.template_release.arm64.so\u0026#34; register_types 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 /* godot-cpp integration testing project. * * This is free and unencumbered software released into the public domain. */ #include \u0026#34;register_types.h\u0026#34; #include \u0026lt;gdextension_interface.h\u0026gt; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/core/defs.hpp\u0026gt; #include \u0026lt;godot_cpp/godot.hpp\u0026gt; #include \u0026lt;sys/stat.h\u0026gt; #include \u0026#34;godot_cpp/classes/editor_interface.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/editor_plugin.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/utility_functions.hpp\u0026#34; #include \u0026#34;Test/Fow.h\u0026#34; // Spline #include \u0026#34;Spline/Spline.h\u0026#34; #include \u0026#34;Spline/SplineGizmo.h\u0026#34; #include \u0026#34;Spline/SplineGizmoPlugin.h\u0026#34; //Profiler #include \u0026#34;ProfilerLib/ProfilerUI.h\u0026#34; #include \u0026#34;ProfilerLib/ProfilerTest.h\u0026#34; using namespace godot; class MyEditorPlugin : public EditorPlugin { GDCLASS(MyEditorPlugin, EditorPlugin); Ref\u0026lt;SplineGizmoPlugin\u0026gt; gizmo_plugin; protected: static void _bind_methods() { } public: virtual void _enter_tree() override { UtilityFunctions::print(\u0026#34;Init :: MyEditorPlugin :: _enter_tree\u0026#34;); gizmo_plugin.instantiate(); gizmo_plugin-\u0026gt;create_handle_material(\u0026#34;HandleMat\u0026#34;); gizmo_plugin-\u0026gt;create_material(\u0026#34;RedMat\u0026#34;, Color(1.0f, 0.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;GreenMat\u0026#34;, Color(0.0f, 1.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;BlueMat\u0026#34;, Color(0.0f, 0.0f, 1.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color1\u0026#34;, Color(0.0f, 1.0f, 1.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color2\u0026#34;, Color(1.0f, 0.0f, 1.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color3\u0026#34;, Color(1.0f, 1.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color4\u0026#34;, Color(1.0f, 1.0f, 1.0f)); add_node_3d_gizmo_plugin(gizmo_plugin); } virtual void _exit_tree() override { UtilityFunctions::print(\u0026#34;UnInit :: MyEditorPlugin :: _exit_tree\u0026#34;); remove_node_3d_gizmo_plugin(gizmo_plugin); } }; void initialize_GodotTest_module(ModuleInitializationLevel p_level) { if (p_level == MODULE_INITIALIZATION_LEVEL_SCENE) { UtilityFunctions::print(\u0026#34;Init :: Scene\u0026#34;); GDREGISTER_CLASS(FowTexture); GDREGISTER_CLASS(Spline); GDREGISTER_CLASS(ProfilerContext); GDREGISTER_CLASS(ProfilerUI); GDREGISTER_CLASS(ProfilerTest); } if (p_level == MODULE_INITIALIZATION_LEVEL_EDITOR) { UtilityFunctions::print(\u0026#34;Init :: Editor\u0026#34;); GDREGISTER_CLASS(SplineGizmo); GDREGISTER_CLASS(SplineGizmoPlugin); GDREGISTER_CLASS(MyEditorPlugin); EditorPlugins::add_by_type\u0026lt;MyEditorPlugin\u0026gt;(); } UtilityFunctions::print(\u0026#34;Init :: None :: \u0026#34;, p_level); } void uninitialize_GodotTest_module(ModuleInitializationLevel p_level) { if (p_level == MODULE_INITIALIZATION_LEVEL_SCENE) { UtilityFunctions::print(\u0026#34;UnInit :: Scene\u0026#34;); // return; } if (p_level == MODULE_INITIALIZATION_LEVEL_EDITOR) { UtilityFunctions::print(\u0026#34;UnInit :: Editor\u0026#34;); EditorPlugins::remove_by_type\u0026lt;MyEditorPlugin\u0026gt;(); // return; } } extern \u0026#34;C\u0026#34; { // Initialization. GDExtensionBool GDE_EXPORT GodotTest_library_init(GDExtensionInterfaceGetProcAddress p_get_proc_address, GDExtensionClassLibraryPtr p_library, GDExtensionInitialization *r_initialization) { godot::GDExtensionBinding::InitObject init_obj(p_get_proc_address, p_library, r_initialization); init_obj.register_initializer(initialize_GodotTest_module); init_obj.register_terminator(uninitialize_GodotTest_module); init_obj.set_minimum_library_initialization_level( MODULE_INITIALIZATION_LEVEL_SCENE); return init_obj.init(); } } SConstruct SConstructç”¨äºé…ç½®GDExtensionçš„ç¼–è¯‘ç¯å¢ƒï¼Œ\nå¯ä»¥æŒ‡å®šç¼–è¯‘çš„ä¸­é—´æ–‡ä»¶çš„æ”¾ç½®è·¯å¾„ï¼Œ ä»¥åŠæœ€ç»ˆè¾“å‡ºçš„é“¾æ¥åº“çš„åç§°å’Œä½ç½® è¿˜æœ‰å¼•å…¥çš„ä¸‰æ–¹åº“ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 #!/usr/bin/env python import os import sys def log_env(env,key): print(f\u0026#34;{key}:{env[key]}\u0026#34;) env = SConscript(\u0026#34;godot-cpp/SConstruct\u0026#34;) project_name = \u0026#34;Godot_DemoSR\u0026#34; # For reference: # - CCFLAGS are compilation flags shared between C and C++ # - CFLAGS are for C-specific compilation flags # - CXXFLAGS are for C++-specific compilation flags # - CPPFLAGS are for pre-processor flags # - CPPDEFINES are for pre-processor defines # - LINKFLAGS are for linking flags # tweak this if you want to use different folders, or more folders, to store your source code in. env.VariantDir(\u0026#39;build\u0026#39;, \u0026#39;src\u0026#39;, duplicate=0) env.Append(CPPPATH=[\u0026#34;build/\u0026#34;]) sources = Glob(\u0026#34;build/*.cpp\u0026#34;) + Glob(\u0026#34;build/**/*.cpp\u0026#34;) + Glob(\u0026#34;build/**/**/*.cpp\u0026#34;) if env[\u0026#34;platform\u0026#34;] == \u0026#34;macos\u0026#34;: library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR.{}.{}.framework/libgdDemoSR.{}.{}\u0026#34;.format( project_name, env[\u0026#34;platform\u0026#34;], env[\u0026#34;target\u0026#34;], env[\u0026#34;platform\u0026#34;], env[\u0026#34;target\u0026#34;] ), source=sources, ) elif env[\u0026#34;platform\u0026#34;] == \u0026#34;windows\u0026#34;: env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;/std:c++17\u0026#34;) env.Append(CXXFLAGS = [\u0026#34;/std:c++20\u0026#34;,\u0026#34;/W4\u0026#34;, \u0026#34;/WX\u0026#34;, \u0026#34;/wd4100\u0026#34;,\u0026#34;/wd4244\u0026#34;,\u0026#34;/wd4305\u0026#34;,\u0026#34;/wd4201\u0026#34;,\u0026#34;/wd4127\u0026#34;,\u0026#34;/wd4267\u0026#34;,\u0026#34;/wd5054\u0026#34;,\u0026#34;/wd4996\u0026#34;,\u0026#34;/Zi\u0026#34;,\u0026#34;/FS\u0026#34;]) env.Append(LIBS = [\u0026#34;libzmq\u0026#34;]) env.Append(CPPDEFINES=[\u0026#34;ZMQ_STATIC\u0026#34;]) env.Append(LIBPATH = [\u0026#34;./lib/windows\u0026#34;]) library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR{}{}\u0026#34;.format(project_name, env[\u0026#34;suffix\u0026#34;], env[\u0026#34;SHLIBSUFFIX\u0026#34;]), source=sources, ) elif env[\u0026#34;platform\u0026#34;] == \u0026#34;android\u0026#34;: env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-std=c++17\u0026#34;) env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-fno-exceptions\u0026#34;) # env[\u0026#34;CXX\u0026#34;] = env[\u0026#34;CXX\u0026#34;].replace(\u0026#34;23.2.8568313\u0026#34;,\u0026#34;27.0.12077973\u0026#34;) env.Append(CXXFLAGS = [\u0026#34;-std=c++20\u0026#34;,\u0026#34;-fexceptions\u0026#34;,\u0026#39;-Wall\u0026#39;, \u0026#39;-Wextra\u0026#39;, \u0026#39;-Werror\u0026#39;,\u0026#34;-Wno-unused-parameter\u0026#34;]) env.Append(LIBS = [\u0026#34;libzmq\u0026#34;,\u0026#34;GLESv3\u0026#34;]) env.Append(CPPDEFINES=[\u0026#34;ZMQ_STATIC\u0026#34;,\u0026#34;NS_ANDROID\u0026#34;]) env.Append(LIBPATH = [\u0026#34;./lib/android\u0026#34;]) library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR{}{}\u0026#34;.format(project_name, env[\u0026#34;suffix\u0026#34;], env[\u0026#34;SHLIBSUFFIX\u0026#34;]), source=sources, ) else: env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-std=c++17\u0026#34;) env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-fno-exceptions\u0026#34;) env.Append(CXXFLAGS = [\u0026#34;-std=c++20\u0026#34;,\u0026#34;-fexceptions\u0026#34;,\u0026#39;-Wall\u0026#39;, \u0026#39;-Wextra\u0026#39;, \u0026#34;-Wno-unused-parameter\u0026#34;,\u0026#34;-Wno-changes-meaning\u0026#34;]) env.Append(LIBS = [\u0026#34;libzmq\u0026#34;,\u0026#34;GLESv3\u0026#34;]) env.Append(CPPDEFINES=[\u0026#34;ZMQ_STATIC\u0026#34;]) env.Append(LIBPATH = [\u0026#34;./lib\u0026#34;]) library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR{}{}\u0026#34;.format(project_name, env[\u0026#34;suffix\u0026#34;], env[\u0026#34;SHLIBSUFFIX\u0026#34;]), source=sources, ) Default(library) ","date":"2025-11-04T16:08:31+08:00","image":"https://Liyufei1.github.io/godot.png","permalink":"https://Liyufei1.github.io/p/godot%E4%B8%80%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E5%8F%8A%E7%A4%BA%E4%BE%8B/","title":"ã€godotã€‘ä¸€ã€å¼€å‘ç¯å¢ƒéƒ¨ç½²åŠç¤ºä¾‹"},{"content":"å‰ç½®å·¥å…· ç½‘ç«™å‰ç«¯å·¥å…·-hugoè½¯ä»¶ ï¼šhugo hugoä¸»é¢˜ä¸‹è½½çº¿ä»“åº“ï¼šhugo-theme å‚è€ƒæ•™ç¨‹ï¼šæ•™ç¨‹ hugo hugoæŒ‡ä»¤ ä¸‹æ–¹åˆ—ä¸¾äº†hugoå¸¸ç”¨æŒ‡ä»¤\n1 2 3 4 5 6 7 8 9 // åˆ›å»ºæ–°ç«™ç‚¹ hugo new site myblog // å¯åŠ¨æœåŠ¡ hugo server -D hugo server --buildDrafts // ç”Ÿæˆæ–°çš„é¡µé¢ hugo new Content \u0026#34;posts/new-post.md\u0026#34; hugo.yaml hugo.yamlæ˜¯hugoç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å¯ä»¥é…ç½®ç½‘ç«™çš„æ ‡é¢˜ã€æè¿°ã€ä½œè€…ã€ä¸»é¢˜ç­‰ç­‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 //é…ç½®æ¯é¡µæ–‡ç« æ•°é‡ pagination: pagerSize: 3 //é…ç½®é“¾æ¥ baseurl: https://example.com/ //é¡µé¢æ ‡ç­¾çš„å°å›¾æ ‡è®¾ç½® favicon: /favicon.png article: math: true //æ•°å­¦å…¬å¼ toc: true //ç›®å½• readingTime: true //é˜…è¯»æ—¶é—´ license: enabled: true //è®¸å¯è¯´æ˜ default: Licensed under [Liyufei1](https://github.com/Liyufei1) markdownè¯­æ³• å®˜æ–¹æ–‡æ¡£é“¾æ¥ï¼š markdownè¯­æ³•\nä¸‹æ–¹ä¸ºå¸¸ç”¨çš„è¯­æ³•ï¼Œå¯ä»¥å¿«é€Ÿç”Ÿæˆ\nå¸¸ç”¨ åç§° è¯­æ³• ç¤ºä¾‹ åŠ ç²— \u0026quot; **åŠ ç²—** \u0026quot; åŠ ç²— å€¾æ–œ \u0026quot; *å€¾æ–œ* \u0026quot; å€¾æ–œ åˆ é™¤çº¿ \u0026quot; ~~åˆ é™¤çº¿~~ \u0026quot; åˆ é™¤çº¿ ä»£ç å— \u0026quot; ```shell ä»£ç å—\n``` \u0026quot; shell ä»£ç å— ä»£ç è¡Œ \u0026quot; `ä»£ç è¡Œ` \u0026quot; ä»£ç è¡Œ æ ‡é¢˜ \u0026quot; # æ ‡é¢˜ \u0026quot; # æ ‡é¢˜ åºåˆ— \u0026quot; 1. åºåˆ— \u0026quot; 1. åºåˆ— æ— åºåºåˆ— \u0026quot; - æ— åºåºåˆ— \u0026quot; - æ— åºåºåˆ— å¼•ç”¨ \u0026quot; \u0026gt; å¼•ç”¨ \u0026quot; \u0026gt; å¼•ç”¨ é“¾æ¥ \u0026quot; [é“¾æ¥](https://www.baidu.com) \u0026quot; é“¾æ¥ åˆ—è¡¨ æ•ˆæœå¦‚ä¸‹ï¼š\nå·¦å¯¹é½ å±…ä¸­ å³å¯¹é½ a b c 1 2 3 ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 | å·¦å¯¹é½ | å±…ä¸­ | å³å¯¹é½ | |:-------|:----:|-------:| | a | b | c | | 1 | 2 | 3 | å›¾ç‰‡ ![å›¾ç‰‡è¯´æ˜](guidao2.jpg)\næ­¥éª¤ åˆ›å»ºæœ¬åœ°æ–°ç«™ç‚¹ è¿è¡Œå‘½ä»¤hugo new site devï¼Œåˆ©ç”¨hugoåˆ›å»ºæœ¬åœ°æ–°ç«™ç‚¹ã€‚åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥è¿è¡Œå‘½ä»¤hugo server -Dæ¥è¿è¡Œæ–°å»ºçš„ç«™ç‚¹ï¼Œåœ¨æµè§ˆå™¨ä¸­å¯ä»¥éªŒè¯æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚ åˆ°ä¸Šhugo-themeä¸‹è½½ä¸­æ„çš„ä¸»é¢˜ï¼ˆæœ¬åšå®¢é‡‡ç”¨stackï¼‰ï¼Œå°†ä¸‹è½½çš„ä¸»é¢˜å¤åˆ¶åˆ°æ–°ç«™ç‚¹çš„themesæ–‡ä»¶å¤¹ä¸‹ã€‚ æ­¤æ—¶æ‰§è¡Œå‘½ä»¤hugo server -Då¯åŠ¨æœåŠ¡ï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®æœ¬åœ°åœ°å€ï¼Œå¯ä»¥çœ‹åˆ°æ–°å»ºçš„æ¨¡æ¿ç½‘é¡µ éƒ¨ç½²åˆ°github è¿è¡ŒæŒ‡ä»¤hugo -Dåˆ©ç”¨hugoæ„å»ºé™æ€ç½‘é¡µï¼Œæ­¤æ—¶åœ¨æˆ‘ä»¬çš„æœ¬åœ°ç½‘ç«™æ–‡ä»¶å¤¹ä¸‹æ–¹ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†ä¸€ä¸ªåä¸ºpublicçš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾äº†é™æ€ç½‘é¡µã€‚ åˆ›å»ºgithubä»“åº“ï¼Œéœ€è¦æ³¨æ„ä»“åº“å‘½åä¸ºï¼š\u0026lt;githubç”¨æˆ·å\u0026gt;.github.ioï¼Œåªæœ‰æŒ‰ç…§è¿™ä¸ªè§„èŒƒå‘½åï¼Œgithubæ‰ä¼šå°†é™æ€ç½‘é¡µéƒ¨ç½²åˆ°githubPagesä¸­ã€‚ å°†publicæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°æ­¥éª¤2ä¸­åˆ›å»ºçš„githubä»“åº“ä¸­ã€‚ç„¶ååœ¨ä»“åº“ä¸­è¿è¡ŒPagesé…ç½®ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå³å¯çœ‹åˆ°é™æ€ç½‘é¡µã€‚ githugçš„è‡ªåŠ¨æ„å»º åˆ›å»ºgithubä»“åº“ï¼Œæ­¤ä»“åº“å»ºè®®ä¸ºç§æœ‰ä»“åº“ï¼Œç”¨äºä¿å­˜æœ¬åœ°çš„hugoç½‘ç«™ï¼Œå³çœŸæ­£çš„åšå®¢ä»“åº“ï¼ˆä¸Šæ–¹å‘å¸ƒçš„ä»…ä¸ºé™æ€ç½‘é¡µä»“åº“ï¼‰ã€‚ åˆ›å»º.github/workflows/hugo.ymlæ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\néœ€è¦æ³¨æ„çš„æ˜¯TOKENä¸ºgithubçš„tokenï¼Œéœ€è¦åœ¨githubçš„settingä¸­åˆ›å»ºã€‚åŒæ—¶æ³¨æ„åŒæ­¥çš„åˆ†æ”¯ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 name: deploy on: push: branches: - master jobs: deploy: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v4 with: fetch-depth: 0 - name: Setup Hugo uses: peaceiris/actions-hugo@v3 with: hugo-version: \u0026#34;latest\u0026#34; extended: true - name: Build Web run: hugo -D - name: Deploy Web uses: peaceiris/actions-gh-pages@v4 with: PERSONAL_TOKEN: ${{ secrets.TOKEN }} EXTERNAL_REPOSITORY: Liyufei1/Liyufei1.github.io PUBLISH_BRANCH: master PUBLISH_DIR: ./public commit_message: auto deploy åœ¨githubä¸­åˆ›å»ºTOKENï¼Œå¹¶æ·»åŠ åˆ°blogä»“åº“ä¸­ã€‚åˆ›å»ºtokenæ—¶éœ€è¦å‹¾é€‰repoæƒé™ä»¥åŠworkflowæƒé™ã€‚åˆ›å»ºå®Œæ¯•åï¼Œåœ¨blogä»“åº“ä¸­é…ç½®è¯¥TOKENã€‚åç»­æœ‰ä»£ç æäº¤æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨æ„å»ºé™æ€ç½‘é¡µå¹¶éƒ¨ç½²åˆ°githubPagesä¸­ã€‚ ","date":"2025-11-03T16:08:31+08:00","image":"https://Liyufei1.github.io/p/blog-build/guidao3_hu_b29969dabc11fbc2.jpg","permalink":"https://Liyufei1.github.io/p/blog-build/","title":"Blog Build"},{"content":"æ­£æ–‡æµ‹è¯• è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ï¼Œ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æ—¢ç„¶å¦‚ä½•ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ æˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹ä¸€ä¸ªéå¸¸å°´å°¬çš„äº‹å®ï¼Œé‚£å°±æ˜¯ï¼Œ å¯æ˜¯ï¼Œå³ä½¿æ˜¯è¿™æ ·ï¼Œå­¦ç”Ÿä¼šé€€ä¼šçš„å‡ºç°ä»ç„¶ä»£è¡¨äº†ä¸€å®šçš„æ„ä¹‰ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œå‘ç”Ÿäº†ä¼šå¦‚ä½•ï¼Œä¸å‘ç”Ÿåˆä¼šå¦‚ä½•ã€‚ ç»è¿‡ä¸Šè¿°è®¨è®ºï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ è¿™æ ·çœ‹æ¥ï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å°±æˆ‘ä¸ªäººæ¥è¯´ï¼Œå­¦ç”Ÿä¼šé€€ä¼šå¯¹æˆ‘çš„æ„ä¹‰ï¼Œä¸èƒ½ä¸è¯´éå¸¸é‡å¤§ã€‚ èå£«æ¯”äºšæ›¾ç»æåˆ°è¿‡ï¼Œäººçš„ä¸€ç”Ÿæ˜¯çŸ­çš„ï¼Œä½†å¦‚æœå‘åŠ£åœ°è¿‡è¿™ä¸€ç”Ÿï¼Œå°±å¤ªé•¿äº†ã€‚è¿™ä¼¼ä¹è§£ç­”äº†æˆ‘çš„ç–‘æƒ‘ã€‚ è«æ‰ç‰¹è¯´è¿‡ä¸€å¥å¯Œæœ‰å“²ç†çš„è¯ï¼Œè°å’Œæˆ‘ä¸€æ ·ç”¨åŠŸï¼Œè°å°±ä¼šå’Œæˆ‘ä¸€æ ·æˆåŠŸã€‚è¿™å¯å‘äº†æˆ‘ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ äº†è§£æ¸…æ¥šå­¦ç”Ÿä¼šé€€ä¼šåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ï¼Œæ˜¯è§£å†³ä¸€åˆ‡é—®é¢˜çš„å…³é”®ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ã€‚\nå¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸºæ›¾ç»è¯´è¿‡ï¼Œå…±åŒçš„äº‹ä¸šï¼Œå…±åŒçš„æ–—äº‰ï¼Œå¯ä»¥ä½¿äººä»¬äº§ç”Ÿå¿å—ä¸€åˆ‡çš„åŠ›é‡ã€‚ã€€å¸¦ç€è¿™å¥è¯ï¼Œæˆ‘ä»¬è¿˜è¦æ›´åŠ æ…é‡çš„å®¡è§†è¿™ä¸ªé—®é¢˜ï¼š ä¸€èˆ¬æ¥è®²ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»åŠ¡å¿…æ…é‡çš„è€ƒè™‘è€ƒè™‘ã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æˆ‘è®¤ä¸ºï¼Œ æˆ‘è®¤ä¸ºï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ è¦æƒ³æ¸…æ¥šï¼Œå­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ã€‚ æˆ‘è®¤ä¸ºï¼Œ æ—¢ç„¶å¦‚æ­¤ï¼Œ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ é‚£ä¹ˆï¼Œ æˆ‘è®¤ä¸ºï¼Œ å­¦ç”Ÿä¼šé€€ä¼šå› ä½•è€Œå‘ç”Ÿã€‚\nå¼•ç”¨ æ€å¿µæ˜¯æœ€æš–çš„å¿§ä¼¤åƒä¸€åŒç¿…è†€\nè®©æˆ‘åœä¸äº†é£ä¸è¿œåœ¨è¿‡å¾€æ¸¸è¡\nä¸å‘Šè€Œåˆ«çš„ä½  å°±ç®—ä¸ºäº†æˆ‘ç€æƒ³\nè¿™ä¹ˆæ²‰ç—›çš„å‘µæŠ¤ æˆ‘æ€ä¹ˆèƒ½ç¿±ç¿”\næœ€æš–çš„æ†‚å‚· - ç”°é¦¥ç”„\nå›¾ç‰‡ 1 2 3 ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg) ![Photo by Luca Bravo on Unsplash](luca-bravo-alS7ewQ41M8-unsplash.jpg) ![Photo by Helena Hertz on Unsplash](helena-hertz-wWZzXlDpMog-unsplash.jpg) ![Photo by Hudai Gayiran on Unsplash](hudai-gayiran-3Od_VKcDEAA-unsplash.jpg) ç›¸å†Œè¯­æ³•æ¥è‡ª Typlog\n","date":"2020-09-09T00:00:00Z","image":"https://Liyufei1.github.io/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu_7d5f5b09f91c89db.jpg","permalink":"https://Liyufei1.github.io/p/test-chinese/","title":"Chinese Test"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTeX globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTeX on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples Inline math: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$\nBlock math: $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$","date":"2019-03-08T00:00:00Z","permalink":"https://Liyufei1.github.io/p/math-typesetting/","title":"Math Typesetting"}]