[{"content":"iFlow CLI ä½¿ç”¨å’Œéƒ¨ç½²å®Œæ•´æ•™ç¨‹ iFlowåˆæ­¥è®¤è¯† iFlow CLI æ˜¯ä¸€æ¬¾ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œçš„å¼ºå¤§ AI åŠ©æ‰‹ã€‚å®ƒèƒ½å¤Ÿæ— ç¼åˆ†æä»£ç ä»“åº“ã€æ‰§è¡Œç¼–ç¨‹ä»»åŠ¡ã€ç†è§£ä¸Šä¸‹æ–‡éœ€æ±‚ï¼Œé€šè¿‡è‡ªåŠ¨åŒ–å¤„ç†ä»ç®€å•çš„æ–‡ä»¶æ“ä½œåˆ°å¤æ‚çš„å·¥ä½œæµç¨‹ï¼Œå…¨é¢æå‡æ‚¨çš„å·¥ä½œæ•ˆç‡ã€‚\næ ¸å¿ƒç‰¹æ€§ å…è´¹ AI æ¨¡å‹ï¼šé€šè¿‡ å¿ƒæµå¼€æ”¾å¹³å° è®¿é—®å¼ºå¤§çš„å…è´¹ AI æ¨¡å‹ï¼ŒåŒ…æ‹¬ Kimi K2ã€Qwen3 Coderã€DeepSeek v3 ç­‰ çµæ´»é›†æˆï¼šä¿ç•™ä½ å–œæ¬¢çš„å¼€å‘å·¥å…·ï¼Œä¹Ÿå¯é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿå®ç°è‡ªåŠ¨åŒ– è‡ªç„¶è¯­è¨€äº¤äº’ï¼šå‘Šåˆ«å¤æ‚å‘½ä»¤ï¼Œç”¨æ—¥å¸¸å¯¹è¯é©±åŠ¨ AIï¼Œä»ä»£ç å¼€å‘åˆ°ç”Ÿæ´»åŠ©ç† å¼€æ”¾å¹³å°ï¼šä»å¿ƒæµå¼€æ”¾å¸‚åœºä¸­å¯ä»¥ä¸€é”®å®‰è£…SubAgentå’ŒMCPï¼Œå¿«é€Ÿæ‰©å±•æ™ºèƒ½ä½“ï¼Œç»„å»ºåªå±äºä½ çš„AIå›¢é˜Ÿ æ ¸å¿ƒåŠŸèƒ½ æ”¯æŒ4ç§è¿è¡Œæ¨¡å¼ï¼šyoloæ¨¡å¼ï¼ˆæ¨¡å‹æ‹¥æœ‰æœ€å¤§æƒé™ï¼Œå¯æ‰§è¡Œä»»ä½•æ“ä½œï¼‰ã€æ¥å—ç¼–è¾‘æ¨¡å¼ï¼ˆæ¨¡å‹ä»…æ‹¥æœ‰æ–‡ä»¶ä¿®æ”¹æƒé™ï¼‰ã€è®¡åˆ’æ¨¡å¼ï¼ˆå…ˆè®¡åˆ’åæ‰§è¡Œï¼‰ã€é»˜è®¤æ¨¡å¼ï¼ˆæ¨¡å‹æ— æƒé™ï¼‰ å‡çº§subAgentåŠŸèƒ½ï¼šå°†CLIä»é€šç”¨åŠ©æ‰‹è½¬å˜ä¸ºä¸“å®¶å›¢é˜Ÿï¼Œæä¾›æ›´ä¸“ä¸šå‡†ç¡®çš„å»ºè®®ã€‚ä½¿ç”¨ /agent æŸ¥çœ‹æ›´å¤šé¢„é…ç½®ä»£ç† å‡çº§taskå·¥å…·ï¼šæœ‰æ•ˆå‹ç¼©ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œè®©CLIæ›´å½»åº•åœ°å®Œæˆæ‚¨çš„ä»»åŠ¡ã€‚å½“ä¸Šä¸‹æ–‡è¾¾åˆ°70%æ—¶è‡ªåŠ¨å‹ç¼© é›†æˆå¿ƒæµå¼€æ”¾å¸‚åœºï¼šå¿«é€Ÿå®‰è£…æœ‰ç”¨çš„MCPå·¥å…·ã€Subagentså’Œè‡ªå®šä¹‰æŒ‡ä»¤ã€‚ä½¿ç”¨ /mcp äº†è§£æ›´å¤š å…è´¹å¤šæ¨¡æ€æ¨¡å‹ä½¿ç”¨ï¼šç°åœ¨æ‚¨ä¹Ÿå¯ä»¥åœ¨CLIä¸­ç²˜è´´å›¾ç‰‡äº†ï¼ˆCtrl+Vç²˜è´´å›¾ç‰‡ï¼‰ æ”¯æŒå¯¹è¯å†å²ä¿å­˜å’Œå›æ»šï¼ˆiflow \u0026ndash;resume å’Œ /chat å‘½ä»¤ï¼‰ æ”¯æŒæ›´å¤šæœ‰ç”¨çš„ç»ˆç«¯å‘½ä»¤ï¼ˆiflow -h æŸ¥çœ‹æ›´å¤šå‘½ä»¤ï¼‰ VSCodeæ’ä»¶æ”¯æŒ è‡ªåŠ¨å‡çº§ï¼šiFlow CLIè‡ªåŠ¨æ£€æµ‹å½“å‰ç‰ˆæœ¬æ˜¯å¦ä¸ºæœ€æ–°ç‰ˆæœ¬ æ›´å¤šä½¿ç”¨æ•™ç¨‹è¯·è®¿é—®ï¼šiFlowå¹³å°\nWindowså¹³å°çš„å®‰è£…éƒ¨ç½² ç³»ç»Ÿè¦æ±‚ æ“ä½œç³»ç»Ÿï¼šWindows 10+ï¼ˆä½¿ç”¨ WSL 1ã€WSL 2 æˆ– Git for Windowsï¼‰ ç¡¬ä»¶ï¼š4GB+ å†…å­˜ è½¯ä»¶ï¼šNode.js 22+ ç½‘ç»œï¼šéœ€è¦äº’è”ç½‘è¿æ¥ç”¨äºèº«ä»½éªŒè¯å’Œ AI å¤„ç† Shellï¼šåœ¨ Bashã€Zsh æˆ– Fish ä¸­æ•ˆæœæœ€ä½³ å®‰è£…æ­¥éª¤ æ–¹æ³•ä¸€ï¼šæ ‡å‡†å®‰è£… è®¿é—® Node.jså®˜ç½‘ ä¸‹è½½æœ€æ–°çš„ Node.js å®‰è£…ç¨‹åº è¿è¡Œå®‰è£…ç¨‹åºæ¥å®‰è£… Node.js é‡å¯ç»ˆç«¯ï¼šCMD æˆ– PowerShell è¿è¡Œ npm install -g @iflow-ai/iflow-cli æ¥å®‰è£… iFlow CLI è¿è¡Œ iflow æ¥å¯åŠ¨ iFlow CLI æ–¹æ³•äºŒï¼šä¸­å›½å¤§é™†ç”¨æˆ·ä¸“ç”¨å®‰è£…ï¼ˆæ¨èï¼‰ å¦‚æœæ‚¨åœ¨ä¸­å›½å¤§é™†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… iFlow CLIï¼š\nè®¿é—® iFlow CLI nvmå®‰è£…åŒ… ä¸‹è½½æœ€æ–°çš„ nvm å®‰è£…ç¨‹åº è¿è¡Œå®‰è£…ç¨‹åºæ¥å®‰è£… nvm é‡å¯ç»ˆç«¯ï¼šCMD æˆ– PowerShell è¿è¡Œ nvm node_mirror https://npmmirror.com/mirrors/node/ å’Œ nvm npm_mirror https://npmmirror.com/mirrors/npm/ è¿è¡Œ nvm install 22 æ¥å®‰è£… Node.js 22ï¼Œç¨ç­‰ç‰‡åˆ» è¿è¡Œ nvm use 22 æ¥ä½¿ç”¨ Node.js 22 è¿è¡Œ npm install -g @iflow-ai/iflow-cli æ¥å®‰è£… iFlow CLI è¿è¡Œ iflow æ¥å¯åŠ¨ iFlow CLI éªŒè¯å®‰è£… å®‰è£…å®Œæˆåï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š\n1 iflow --version å¦‚æœæ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œåˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚\nç™»å½•å’Œä½¿ç”¨ iFlow CLIæä¾›ä¸¤ç§èº«ä»½éªŒè¯æ–¹å¼ï¼š\næ¨èæ–¹å¼ï¼šä½¿ç”¨ iFlow åŸç”Ÿèº«ä»½éªŒè¯ å¤‡é€‰æ–¹å¼ï¼šé€šè¿‡ OpenAI å…¼å®¹ API è¿æ¥ è·å– API Key è·å– API Keyçš„æ­¥éª¤ï¼š\næ³¨å†Œ iFlow è´¦æˆ· è¿›å…¥ä¸ªäººè®¾ç½®é¡µé¢æˆ–ç‚¹å‡»æ­¤ç›´è¾¾é“¾æ¥ åœ¨å¼¹å‡ºå¯¹è¯æ¡†ä¸­ç‚¹å‡»\u0026quot;é‡ç½®\u0026quot;ç”Ÿæˆæ–°çš„ API å¯†é’¥ ç”Ÿæˆå¯†é’¥åï¼Œå°†å…¶ç²˜è´´åˆ°ç»ˆç«¯æç¤ºç¬¦ä¸­å³å¯å®Œæˆè®¾ç½®ã€‚æ³¨æ„ï¼šåœ¨ Windows çš„ CMD æˆ–è€… PowerShell ä¸­ï¼Œè¯·ç‚¹å‡»å³é”®è¿›è¡Œç²˜è´´ã€‚\nå¿«é€Ÿå¼€å§‹ è¦å¯åŠ¨ iFlow CLIï¼Œè¯·åœ¨ç»ˆç«¯ä¸­å¯¼èˆªåˆ°æ‚¨çš„å·¥ä½œç©ºé—´å¹¶è¾“å…¥ï¼š\n1 iflow åˆ›å»ºæ–°é¡¹ç›® å¯¹äºæ–°é¡¹ç›®ï¼Œåªéœ€æè¿°æ‚¨æƒ³è¦åˆ›å»ºçš„å†…å®¹ï¼š\n1 2 3 cd new-project/ iflow \u0026gt; ä½¿ç”¨ HTML åˆ›å»ºä¸€ä¸ªåŸºäºç½‘é¡µçš„æˆ‘çš„ä¸–ç•Œæ¸¸æˆ å¤„ç†ç°æœ‰é¡¹ç›® å¯¹äºç°æœ‰ä»£ç åº“ï¼Œå»ºè®®å…ˆä½¿ç”¨ /init å‘½ä»¤å¸®åŠ© iFlow ç†è§£æ‚¨çš„é¡¹ç›®ï¼š\n1 2 3 4 cd project1/ iflow \u0026gt; /init \u0026gt; æ ¹æ® requirement.md æ–‡ä»¶ä¸­çš„ PRD æ–‡æ¡£åˆ†æéœ€æ±‚ï¼Œè¾“å‡ºæŠ€æœ¯æ–‡æ¡£ï¼Œç„¶åå®ç°è§£å†³æ–¹æ¡ˆã€‚ /init å‘½ä»¤ä¼šæ‰«ææ‚¨çš„ä»£ç åº“ï¼Œå­¦ä¹ å…¶ç»“æ„ï¼Œå¹¶åˆ›å»ºåŒ…å«å®Œæ•´æ–‡æ¡£çš„ IFLOW.md æ–‡ä»¶ã€‚\næœ‰å…³æ–œæ å‘½ä»¤çš„å®Œæ•´åˆ—è¡¨å’Œä½¿ç”¨è¯´æ˜ï¼Œè¯·æŸ¥çœ‹iFlowå‘½ä»¤æ–‡æ¡£ã€‚\nå¸¸è§ä½¿ç”¨åœºæ™¯ iFlow CLI çš„åŠŸèƒ½è¿œä¸æ­¢ç¼–ç¨‹ï¼Œå®ƒèƒ½å¤„ç†å„ç§ç±»å‹çš„ä»»åŠ¡ï¼š\nä¿¡æ¯æŸ¥è¯¢ä¸è§„åˆ’ 1 \u0026gt; å¸®æˆ‘æ‰¾åˆ°åŒ—äº¬è¯„åˆ†æœ€é«˜çš„é¤å…ï¼Œåˆ¶å®šä¸€ä¸ª3å¤©çš„ç¾é£Ÿä¹‹æ—…è¡Œç¨‹ã€‚ 1 \u0026gt; æœç´¢æœ€æ–°çš„ iPhone ä»·æ ¼å¯¹æ¯”ï¼Œæ‰¾åˆ°æœ€å…·æ€§ä»·æ¯”çš„è´­ä¹°æ–¹æ¡ˆã€‚ æ–‡ä»¶ç®¡ç† 1 \u0026gt; å°†æˆ‘æ¡Œé¢ä¸Šçš„æ–‡ä»¶æŒ‰æ–‡ä»¶ç±»å‹æ•´ç†åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­ã€‚ 1 \u0026gt; æ‰¹é‡ä¸‹è½½è¿™ä¸ªç½‘é¡µä¸Šçš„æ‰€æœ‰å›¾ç‰‡ï¼Œå¹¶æŒ‰æ—¥æœŸé‡å‘½åã€‚ æ•°æ®åˆ†æ 1 \u0026gt; åˆ†æè¿™ä¸ª Excel è¡¨æ ¼ä¸­çš„é”€å”®æ•°æ®ï¼Œç”Ÿæˆç®€å•çš„å›¾è¡¨ã€‚ 1 \u0026gt; ä»è¿™äº› CSV æ–‡ä»¶ä¸­æå–å®¢æˆ·ä¿¡æ¯ï¼Œåˆå¹¶æˆç»Ÿä¸€çš„è¡¨æ ¼ã€‚ å¼€å‘æ”¯æŒ 1 \u0026gt; åˆ†æè¿™ä¸ªç³»ç»Ÿçš„ä¸»è¦æ¶æ„ç»„ä»¶å’Œæ¨¡å—ä¾èµ–å…³ç³»ã€‚ 1 \u0026gt; æˆ‘çš„è¯·æ±‚åå‡ºç°äº†ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œè¯·å¸®æˆ‘æ‰¾åˆ°é—®é¢˜åŸå› ã€‚ å·¥ä½œæµè‡ªåŠ¨åŒ– 1 \u0026gt; åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œå®šæœŸå°†æˆ‘çš„é‡è¦æ–‡ä»¶å¤‡ä»½åˆ°äº‘å­˜å‚¨ã€‚ 1 \u0026gt; ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ¯å¤©ä¸‹è½½è‚¡ç¥¨ä»·æ ¼å¹¶å‘é€é‚®ä»¶é€šçŸ¥ã€‚ å¸è½½ å¦‚æœéœ€è¦å¸è½½ iFlow CLIï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 npm uninstall -g @iflow-ai/iflow-cli æ­¤å‘½ä»¤å°†å®Œå…¨ç§»é™¤ iFlow CLI åŠå…¶ç›¸å…³æ–‡ä»¶ã€‚\né¢å¤–æ¸…ç† å¦‚æœéœ€è¦å½»åº•æ¸…ç†æ‰€æœ‰ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åˆ é™¤ä»¥ä¸‹ç›®å½•ï¼š\nWindows: C:\\Users\\{ç”¨æˆ·å}\\.iflow é…ç½®æ–‡ä»¶: ~/.iflow/settings.json iFlowä¸­çš„\u0026rsquo;/\u0026lsquo;å‘½ä»¤å’Œä½¿ç”¨ç¤ºä¾‹ iFlow CLI æä¾›äº†ä¸°å¯Œçš„æ–œæ å‘½ä»¤ï¼ˆSlash Commandsï¼‰ï¼Œè¿™äº›å‘½ä»¤å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´é«˜æ•ˆåœ°æ§åˆ¶å’Œä½¿ç”¨AIåŠ©æ‰‹ã€‚æ–œæ å‘½ä»¤ä»¥ / å¼€å¤´ï¼Œå¯ä»¥å¿«é€Ÿæ‰§è¡Œç‰¹å®šåŠŸèƒ½ã€‚\nå¸¸ç”¨æ–œæ å‘½ä»¤ å‘½ä»¤ åŠŸèƒ½æè¿° ä½¿ç”¨ç¤ºä¾‹ é€‚ç”¨åœºæ™¯ /help æˆ– /? æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æ–œæ å‘½ä»¤åˆ—è¡¨å’Œå¸®åŠ©ä¿¡æ¯ \u0026gt; /help éœ€è¦æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤æ—¶ /init åˆ†æå½“å‰é¡¹ç›®ç»“æ„ï¼Œæ‰«æä»£ç åº“å¹¶ç”ŸæˆIFLOW.mdæ–‡æ¡£ï¼Œå¸®åŠ©iFlowæ›´å¥½åœ°ç†è§£æ‚¨çš„é¡¹ç›® \u0026gt; /init\n\u0026gt; æ­£åœ¨åˆ†æé¡¹ç›®ç»“æ„... é¡¹ç›®åˆå§‹åŒ–æ—¶ /chat ç®¡ç†å¯¹è¯å†å²ï¼ŒæŸ¥çœ‹ä¹‹å‰çš„å¯¹è¯è®°å½•æˆ–åˆ‡æ¢åˆ°ä¸åŒçš„å¯¹è¯ \u0026gt; /chat list # åˆ—å‡ºæ‰€æœ‰å¯¹è¯\n\u0026gt; /chat resume # æ¢å¤ä¹‹å‰çš„å¯¹è¯ ç®¡ç†å¯¹è¯å†å²æ—¶ /agent ä½¿ç”¨é¢„é…ç½®çš„ä¸“å®¶ä»£ç†ï¼ˆsubagentï¼‰æ¥å¤„ç†ç‰¹å®šé¢†åŸŸçš„ä»»åŠ¡ \u0026gt; /agent # æŸ¥çœ‹å¯ç”¨çš„ä»£ç†\n\u0026gt; /agent code # ä½¿ç”¨ä»£ç ä¸“å®¶ä»£ç† éœ€è¦ä¸“ä¸šé¢†åŸŸå¸®åŠ©æ—¶ /mcp è®¿é—®å¿ƒæµå¼€æ”¾å¸‚åœºä¸­çš„MCPï¼ˆModel Context Protocolï¼‰å·¥å…·ï¼Œæ‰©å±•iFlowçš„åŠŸèƒ½ \u0026gt; /mcp # æŸ¥çœ‹å¯ç”¨çš„MCPå·¥å…·\n\u0026gt; /mcp install # å®‰è£…MCPå·¥å…· æ‰©å±•åŠŸèƒ½æ—¶ /task ä½¿ç”¨ä»»åŠ¡ç®¡ç†å·¥å…·ï¼Œå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¯ç®¡ç†çš„å­ä»»åŠ¡ \u0026gt; /task create # åˆ›å»ºä»»åŠ¡åˆ—è¡¨\n\u0026gt; /task list # æŸ¥çœ‹ä»»åŠ¡è¿›åº¦ å¤„ç†å¤æ‚ä»»åŠ¡æ—¶ /plan è¿›å…¥è®¡åˆ’æ¨¡å¼ï¼Œå…ˆåˆ¶å®šè¯¦ç»†è®¡åˆ’å†æ‰§è¡Œä»»åŠ¡ï¼Œç¡®ä¿æ‰§è¡Œè¿‡ç¨‹æ›´åŠ å¯æ§ \u0026gt; /plan # è¿›å…¥è®¡åˆ’æ¨¡å¼ éœ€è¦å…ˆåˆ¶å®šè®¡åˆ’å†æ‰§è¡Œæ—¶ /yolo è¿›å…¥YOLOï¼ˆYou Only Live Onceï¼‰æ¨¡å¼ï¼Œèµ‹äºˆAIæ¨¡å‹æœ€å¤§æƒé™ï¼Œå¯æ‰§è¡Œä»»ä½•æ“ä½œ \u0026gt; /yolo # è¿›å…¥YOLOæ¨¡å¼ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ éœ€è¦AIå®Œå…¨è‡ªä¸»æ“ä½œæ—¶ /accept è¿›å…¥æ¥å—ç¼–è¾‘æ¨¡å¼ï¼ŒAIæ¨¡å‹ä»…æ‹¥æœ‰æ–‡ä»¶ä¿®æ”¹æƒé™ï¼Œæ›´å®‰å…¨ \u0026gt; /accept # è¿›å…¥æ¥å—ç¼–è¾‘æ¨¡å¼ éœ€è¦æ›´å®‰å…¨çš„æ“ä½œæ¨¡å¼æ—¶ /compact å‹ç¼©å¯¹è¯ä¸Šä¸‹æ–‡ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜å“åº”é€Ÿåº¦ \u0026gt; /compact # å‹ç¼©å¯¹è¯å†å² å¯¹è¯å†å²è¿‡é•¿æ—¶ /search æ‰§è¡Œç½‘ç»œæœç´¢ä»»åŠ¡ï¼Œè·å–å®æ—¶ä¿¡æ¯ \u0026gt; /search # æ‰§è¡Œæœç´¢ éœ€è¦è·å–å®æ—¶ä¿¡æ¯æ—¶ å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹ åœºæ™¯ å‘½ä»¤ç¤ºä¾‹ é¡¹ç›®åˆå§‹åŒ– \u0026gt; /init\n\u0026gt; åˆ†æé¡¹ç›®ç»“æ„åï¼Œç”Ÿæˆæ–‡æ¡£å¹¶æä¾›ä¼˜åŒ–å»ºè®®ã€‚ ä»£ç å®¡æŸ¥ \u0026gt; /agent code\n\u0026gt; å®¡æŸ¥å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ä»£ç æ–‡ä»¶ï¼Œæ‰¾å‡ºæ½œåœ¨é—®é¢˜ã€‚ ä»»åŠ¡åˆ†è§£ \u0026gt; /task create\n\u0026gt; è¯·å¸®æˆ‘å®ç°ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ï¼ŒåŒ…å«å‰ç«¯è¡¨å•ã€åç«¯æ¥å£å’Œæ•°æ®åº“è®¾è®¡ é«˜çº§æƒé™æ“ä½œ \u0026gt; /yolo\n\u0026gt; åˆ›å»ºæ–°é¡¹ç›®ç›®å½•ï¼Œå®‰è£…ä¾èµ–ï¼Œç”ŸæˆåŸºæœ¬ä»£ç ç»“æ„ è¿™äº›æ–œæ å‘½ä»¤æå¤§åœ°å¢å¼ºäº†iFlow CLIçš„åŠŸèƒ½æ€§ï¼Œè®©æ‚¨å¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶AIåŠ©æ‰‹çš„è¡Œä¸ºï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚æœ‰å…³æ–œæ å‘½ä»¤çš„å®Œæ•´åˆ—è¡¨å’Œæœ€æ–°åŠŸèƒ½ï¼Œè¯·æŸ¥çœ‹iFlowå‘½ä»¤æ–‡æ¡£ã€‚\nç»“è¯­ iFlow CLI æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¼€å‘åŠ©æ‰‹ï¼Œé€šè¿‡æœ¬æ•™ç¨‹ï¼Œæ‚¨åº”è¯¥å·²ç»æŒæ¡äº†å¦‚ä½•åœ¨ Windows å¹³å°ä¸Šå®‰è£…ã€ç™»å½•ä½¿ç”¨å’Œå¸è½½ iFlow CLIã€‚æ›´å¤šé«˜çº§åŠŸèƒ½å’Œä½¿ç”¨æŠ€å·§ï¼Œè¯·è®¿é—®å®˜æ–¹æ–‡æ¡£ï¼šiFlow CLI GitHubä»“åº“\nå¦‚éœ€åŠ å…¥ç¤¾åŒºäº¤æµï¼Œå¯ä»¥æ‰«æå®˜æ–¹å¾®ä¿¡ç¾¤äºŒç»´ç ï¼šiFlowå¾®ä¿¡ç¤¾åŒº\n","date":"2025-12-09T10:00:00+08:00","image":"https://Liyufei1.github.io/guidao5.jpg","permalink":"https://Liyufei1.github.io/p/iflow-cli-%E4%BD%BF%E7%94%A8%E5%92%8C%E9%83%A8%E7%BD%B2%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B/","title":"iFlow CLI ä½¿ç”¨å’Œéƒ¨ç½²å®Œæ•´æ•™ç¨‹"},{"content":"æ¦‚è¿° å¯¹äºè¿½æ±‚æå®¢ç²¾ç¥çš„å°ä¼™ä¼´è€Œè¨€ï¼Œå¯¹godotç¼–è¾‘å™¨çš„æ”¹é€ æ— ç–‘æ˜¯ä¸€ä»¶éå¸¸é…·çš„äº‹æƒ…ã€‚å®ƒå¯ä»¥ä¸ºgodotç¼–è¾‘å™¨æ·»åŠ ä¸€äº›å®šåˆ¶åŒ–çš„æ“ä½œï¼Œç”¨äºæå‡å¼€å‘æ•ˆç‡ï¼ŒåŠ é€Ÿå·¥ç¨‹å®ç°ã€‚å¯¹äºæ³›ç”¨çš„ç¼–è¾‘å™¨åŠŸèƒ½æˆ–æ˜¯è‡ªå®šä¹‰åŠŸèƒ½ç±»çš„è°ƒå¼è¡¥å……ç•Œé¢ï¼Œåšæˆç¼–è¾‘å™¨æ’ä»¶æ˜¯éå¸¸ä¸é”™çš„ï¼Œæ¯”å¦‚ï¼šæ‰¹é‡çš„å®ä½“æ”¾ç½®ã€æ‰¹é‡çš„æè´¨å¤åˆ¶ã€æ›²çº¿çš„debugç»˜åˆ¶ç­‰ã€‚ éœ€è¦å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„ç¼–è¾‘å™¨æ’ä»¶ï¼Œä¼šæ¶‰åŠåˆ°ä¸‹æ–¹å‡ ä¸ªç±»ï¼š\nEditorNode:Godotç¼–è¾‘å™¨çš„æ ¸å¿ƒæ§åˆ¶ç±»,ç®¡ç†æ‰€æœ‰ç¼–è¾‘å™¨é¢æ¿/åœºæ™¯ç¼–è¾‘å™¨/æ–‡ä»¶æµè§ˆå™¨/è„šæœ¬ç¼–è¾‘å™¨/ç¼–è¾‘å™¨æ’ä»¶ç­‰,EditorPluginã€Node3DEditorã€CanvasItemEditor å’ŒEditorDockManageréƒ½é›†æˆåœ¨å®ƒçš„é‡Œé¢. EditorPluginï¼šGodotå†…ç½®çš„æ’ä»¶åŸºç±»ï¼Œæä¾›äº†ä¸ç¼–è¾‘å™¨è¿›è¡Œäº¤äº’çš„æ¥å£ã€‚ Node3DEditorï¼šGodotå†…ç½®3Dåœºæ™¯ç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯3Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ï¼ŒåŒ…æ‹¬äº†ï¼š3Dç‰©ä½“çš„é½æ¬¡çº¿æ€§å˜æ¢ã€å·¥å…·æ ã€Gizmoã€ç½‘æ ¼ç­‰ç­‰ã€‚ CanvasItemEditorï¼šGodotå†…ç½®2Dåœºæ™¯ç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯2Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ï¼ŒåŒ…æ‹¬äº†ï¼š2Dç‰©ä½“çš„å˜æ¢ã€å·¥å…·æ ç­‰ç­‰ã€‚ EditorDockManager: EditorPlugin EditorPluginæ˜¯Godotç¼–è¾‘å™¨æ’ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒç±»ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å¼€å‘æ’ä»¶çš„èµ·ç‚¹ã€‚\nğŸ‘‰åˆå§‹åŒ– 1 2 3 4 5 6 7 //åœ¨register_editor_types.cppä¸­æ³¨å†Œæ’ä»¶ EditorPlugins::add_by_type\u0026lt;LyfTestEditorPlugin\u0026gt;(); //åœ¨EditorDataçš„æ„é€ é˜¶æ®µ,å®é™…åˆ›å»ºå¹¶æ”¶é›†æ’ä»¶ for (int i = 0; i \u0026lt; EditorPlugins::get_plugin_count(); i++) { add_editor_plugin(EditorPlugins::create(i)); } ğŸ‘‰æ‰©å±• Godot ç¼–è¾‘å™¨ æˆ‘ä»¬å¯ä»¥å¯ä»¥æ·»åŠ å·¥å…·é¢æ¿ã€èœå•æŒ‰é’®ã€è‡ªå®šä¹‰æ£€æŸ¥å™¨ã€æ“ä½œ2D/3Dç¼–è¾‘å™¨(Node3DEditor/CanvasItemEditor)ç­‰ã€‚\nEditorPluginUIæ‹“å±•çš„å®ç°,ä¾èµ–å®é™…çš„å·¥ä½œç±»ï¼Œæ¯”å¦‚ï¼šNode3DEditorã€CanvasItemEditorã€EditorDockManagerã€‚å®ƒåªæ˜¯å¯¹å·¥ä½œç±»çš„æ¥å£è¿›è¡Œå°è£…ã€‚\næ¥å£ ä½œç”¨ add_control_to_container æ·»åŠ æ§ä»¶åˆ°æŒ‡å®šä½ç½® add_control_to_bottom_panel ç¼–è¾‘å™¨åº•éƒ¨é¢æ¿æ·»åŠ ä¸€ä¸ªæ–°çš„å·¥å…·é€‰é¡¹å¡ add_control_to_dock ç¼–è¾‘å™¨æ·»åŠ ä¸€ä¸ªå¯åœé çš„è‡ªå®šä¹‰é¢æ¿ add_tool_menu_item åœ¨å·¥å…·æ æ·»åŠ ä¸€ä¸ªèœå•é¡¹ add_control_to_container add_control_to_containerå­˜åœ¨å¤šä¸ªåœé ä½ç½®:\nCONTAINER_TOOLBAR : ä¸Šæ–¹å·¥å…·æ , CONTAINER_SPATIAL_EDITOR_MENU : 3Dè§†å£ä¸Šæ–¹èœå•æ  CONTAINER_SPATIAL_EDITOR_SIDE_LEFT : 3Dè§†å£å·¦æ–¹ CONTAINER_SPATIAL_EDITOR_SIDE_RIGHT : 3Dè§†å£å³æ–¹ CONTAINER_SPATIAL_EDITOR_BOTTOM : 3Dè§†å£ä¸‹æ–¹ CONTAINER_CANVAS_EDITOR_MENU : 2Dè§†å£ä¸Šæ–¹èœå•æ  CONTAINER_CANVAS_EDITOR_SIDE_LEFT : 2Dè§†å£å·¦æ–¹ CONTAINER_CANVAS_EDITOR_SIDE_RIGHT : 2Dè§†å£å³æ–¹ CONTAINER_CANVAS_EDITOR_BOTTOM : 2Dè§†å£ä¸‹æ–¹ CONTAINER_INSPECTOR_BOTTOM : æ£€æŸ¥å™¨ä¸‹æ–¹ CONTAINER_PROJECT_SETTING_TAB_LEFT : é¡¹ç›®è®¾ç½®å·¦ä¾§ CONTAINER_PROJECT_SETTING_TAB_RIGHT : é¡¹ç›®è®¾ç½®å³ä¾§ add_control_to_bottom_panel add_control_to_dock add_tool_menu_item ğŸ‘‰å¤„ç†ç”¨æˆ·é€‰ä¸­çš„å¯¹è±¡ ç¼–è¾‘å™¨æ¯æ¬¡é€‰ä¸­å¯¹è±¡æ—¶éƒ½ä¼šè°ƒç”¨ï¼šbool EditorPlugin::handles(Object *p_object)åˆ¤æ–­å½“å‰é€‰ä¸­çš„å¯¹è±¡æ˜¯å¦åº”è¯¥è¢«æ’ä»¶å¤„ç†ã€‚\nå½“æ’ä»¶å†³å®šâ€œæ¥ç®¡æŸå¯¹è±¡â€æ—¶ï¼Œä¼šè§¦å‘å¯¹è±¡è¿›å…¥/é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼š\nvoid EditorPlugin::make_visible(bool p_visible); è¿›å…¥æ—¶ï¼Œp_visibleä¸ºtrueï¼› é€€å‡ºæ—¶ï¼šp_visibleä¸ºfalse void EditorPlugin::edit(Object *p_object) è¿›å…¥æ—¶ï¼šp_objectä¸ºé€‰ä¸­çš„å¯¹è±¡ï¼› é€€å‡ºæ—¶ï¼šp_objectä¸ºnullptr 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //EditorPluginå­ç±»çš„åŸºæœ¬æ ·å¼ class LyfTestEditorPlugin : public EditorPlugin { GDCLASS(LyfTestEditorPlugin, EditorPlugin); // MeshInstance3DEditor *mesh_editor = nullptr; public: virtual String get_plugin_name() const override { return \u0026#34;LyfTestEditorPlugin\u0026#34;; } bool has_main_screen() const override { return false; } virtual bool handles(Object *p_object) const override; virtual void make_visible(bool p_visible) override; virtual void edit(Object *p_object) override; LyfTestEditorPlugin(); ~LyfTestEditorPlugin(); }; ğŸ‘‰æ·»åŠ ç‰¹å®šçš„ç¼–è¾‘å™¨æ’ä»¶ godotè¿˜å°è£…äº†ä¸€ç³»åˆ—å…·æœ‰å®Œæ•´åŠŸèƒ½çš„ç¼–è¾‘å™¨æ’ä»¶:\nEditorTranslationParserPluginï¼šç”¨äºè§£æç¿»è¯‘æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š.potæ–‡ä»¶ã€‚ EditorImportPlugin: èµ„æºå¯¼å…¥æ’ä»¶ï¼Œæ¯”å¦‚ï¼šè‡ªå®šä¹‰.fbxæ–‡ä»¶å¯¼å…¥ã€‚ EditorNode3DGizmoPlugin: ç”¨æ¥åœ¨3Dè§†å›¾é‡Œä¸ºæŸäº›Node3Dç±»å‹ç»˜åˆ¶è‡ªå®šä¹‰gizmoï¼ˆæ“ä½œæ‰‹æŸ„/å¯è§†è¾…åŠ©ï¼‰ EditorInspectorPlugin: æ£€æŸ¥å™¨å±æ€§ç¼–è¾‘æ’ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 void add_translation_parser_plugin(const Ref\u0026lt;EditorTranslationParserPlugin\u0026gt; \u0026amp;p_parser); void add_import_plugin(const Ref\u0026lt;EditorImportPlugin\u0026gt; \u0026amp;p_importer, bool p_first_priority = false); void add_export_plugin(const Ref\u0026lt;EditorExportPlugin\u0026gt; \u0026amp;p_exporter); void add_export_platform(const Ref\u0026lt;EditorExportPlatform\u0026gt; \u0026amp;p_platform); void add_node_3d_gizmo_plugin(const Ref\u0026lt;EditorNode3DGizmoPlugin\u0026gt; \u0026amp;p_gizmo_plugin); void add_inspector_plugin(const Ref\u0026lt;EditorInspectorPlugin\u0026gt; \u0026amp;p_plugin); void add_scene_format_importer_plugin(const Ref\u0026lt;EditorSceneFormatImporter\u0026gt; \u0026amp;p_importer, bool p_first_priority = false); void add_scene_post_import_plugin(const Ref\u0026lt;EditorScenePostImportPlugin\u0026gt; \u0026amp;p_importer, bool p_first_priority = false); void add_autoload_singleton(const String \u0026amp;p_name, const String \u0026amp;p_path); void add_debugger_plugin(const Ref\u0026lt;EditorDebuggerPlugin\u0026gt; \u0026amp;p_plugin); void add_resource_conversion_plugin(const Ref\u0026lt;EditorResourceConversionPlugin\u0026gt; \u0026amp;p_plugin); void add_context_menu_plugin(EditorContextMenuPlugin::ContextMenuSlot p_slot, const Ref\u0026lt;EditorContextMenuPlugin\u0026gt; \u0026amp;p_plugin); Node3DEditor Node3DEditoræ˜¯Godotå†…ç½®3Dåœºæ™¯ç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯3Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ï¼ŒåŒ…æ‹¬äº†ï¼šè§†å£ã€å·¥å…·æ ã€Gizmoã€ç½‘æ ¼ç­‰ç­‰ã€‚\nâœ”ï¸åˆå§‹åŒ– 1 2 //åœ¨EditorNodeçš„æ„é€ é˜¶æ®µ,åˆ›å»ºå¹¶æ³¨å†Œ add_editor_plugin(memnew(Node3DEditorPlugin)); âœ”ï¸UIæ‰©å±•ï¼šå¾€3Dç•Œé¢ç¼–è¾‘å™¨çš„ä¸Šä¸‹å·¦å³æ·»åŠ æ§ä»¶ æ¥å£ ä½œç”¨ add_control_to_menu_panel åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ add_control_to_left_panel åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ add_control_to_right_panel åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ get_shader_split è·å–è§†å£åº•éƒ¨çš„å®¹å™¨ç›’ 1 2 3 4 5 6 7 8 9 10 11 12 //ä½¿ç”¨ç¤ºä¾‹ //åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;add_control_to_menu_panel(p_control); //åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;add_control_to_left_panel(p_control); //åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;add_control_to_right_panel(p_control); //åœ¨è§†å£åº•éƒ¨æ·»åŠ æ§ä»¶ Node3DEditor::get_singleton()-\u0026gt;get_shader_split()-\u0026gt;add_child(p_control); Gizmoæ‰©å±•ï¼šæ·»åŠ è‡ªå®šä¹‰Gizmo CanvasItemEditor CanvasItemEditoræ˜¯Godotå†…ç½®2Dç¼–è¾‘å™¨çš„æ ¸å¿ƒæ’ä»¶ï¼Œå®ƒæ˜¯2Dåœºæ™¯çš„ç¼–è¾‘ç•Œé¢çš„ä¸»ä½“ã€‚\nUIæ‰©å±•ï¼šå¾€2Dç•Œé¢ç¼–è¾‘å™¨çš„ä¸Šä¸‹å·¦å³æ·»åŠ æ§ä»¶ æ¥å£ ä½œç”¨ add_control_to_menu_panel åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ add_control_to_left_panel åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ add_control_to_right_panel åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ get_bottom_split è·å–è§†å£åº•éƒ¨çš„å®¹å™¨ç›’ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //ä½¿ç”¨ç¤ºä¾‹ case CONTAINER_CANVAS_EDITOR_MENU: { //åœ¨ä¸Šæ–¹èœå•æ æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;add_control_to_menu_panel(p_control); } break; case CONTAINER_CANVAS_EDITOR_SIDE_LEFT: { //åœ¨è§†å£å·¦ä¾§æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;add_control_to_left_panel(p_control); } break; case CONTAINER_CANVAS_EDITOR_SIDE_RIGHT: { //åœ¨è§†å£å³ä¾§æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;add_control_to_right_panel(p_control); } break; case CONTAINER_CANVAS_EDITOR_BOTTOM: { //åœ¨è§†å£åº•éƒ¨æ·»åŠ æ§ä»¶ CanvasItemEditor::get_singleton()-\u0026gt;get_bottom_split()-\u0026gt;add_child(p_control); } break; ","date":"2025-11-20T09:18:31+08:00","image":"https://Liyufei1.github.io/guidao4.jpg","permalink":"https://Liyufei1.github.io/p/godot%E5%85%ADgodot%E4%B8%AD%E7%9A%84%E7%BC%96%E8%BE%91%E5%99%A8%E6%8F%92%E4%BB%B6editorplugin/","title":"ã€godotã€‘å…­ã€godotä¸­çš„ç¼–è¾‘å™¨æ’ä»¶EditorPlugin"},{"content":"æ¦‚è¿° åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼ŒåŠ¨æ€æ€§å’Œçµæ´»æ€§æ˜¯è‡³å…³é‡è¦çš„ç‰¹æ€§ã€‚pythonï¼ŒC#ï¼Œjavaç­‰ç¼–ç¨‹è¯­è¨€ï¼Œä»è¯­éŸ³å±‚é¢å°±æ˜¯æ”¯æŒåå°„æˆ–åŠ¨æ€ç±»å‹ç³»ç»Ÿçš„ï¼Œå¯ä»¥è¿è¡Œæ—¶åŠ¨æ€åœ°æŸ¥çœ‹å¯¹è±¡çš„ç±»å‹ã€æˆå‘˜ã€æ–¹æ³•ï¼Œç”šè‡³åŠ¨æ€è°ƒç”¨æˆ–ä¿®æ”¹å®ƒä»¬ã€‚è€Œæ¸¸æˆå¼•æ“ä¸ºäº†è¿½æ±‚è¿è¡Œæ—¶çš„æ•ˆç‡ï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨Cppè¯­è¨€è¿›è¡Œå¼€å‘ï¼ŒCppè¯­è¨€æœ¬èº«ä¸æ”¯æŒåå°„ï¼Œæ‰€ä»¥å„å¤§æ¸¸æˆå¼•æ“éƒ½å„æ˜¾ç¥é€šåœ°æ·»åŠ äº†åå°„ç³»ç»Ÿï¼Œä»¥æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€ç±»å‹ä¿¡æ¯ã€‚\nåœ¨è™šå¹»å¼•æ“å½“ä¸­ï¼Œæ˜¯é€šè¿‡UObjectç±»æ¥æ”¶é›†å…ƒä¿¡æ¯çš„ã€‚é€šè¿‡UPROPTERTY()ç­‰å®æ ‡è®°ï¼Œç”¨UHTå·¥å…·ï¼Œåœ¨ç¼–è¯‘å‰è¿›è¡Œä¸€æ¬¡å¤´æ–‡ä»¶çš„ç”Ÿæˆï¼Œä»è€Œç”ŸæˆUPROPERTY()æ‰€æ ‡è®°çš„å±æ€§å…ƒä¿¡æ¯çš„Uç±»ã€‚å¯¹äºè™šå¹»çš„åå°„å®ç°æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œå¯ä»¥å‚è€ƒå¤§é’Šåœ¨çŸ¥ä¹ä¸Šçš„æ–‡ç« ï¼šè™šå¹»å¼•æ“çš„å…ƒä¿¡æ¯æœºåˆ¶ åœ¨Unityä¸­ï¼Œåå°„ç³»ç»Ÿç”±C#æä¾›çš„ã€‚ åœ¨godotä¸­ï¼Œåå°„ç³»ç»Ÿåˆ™æ˜¯ç”±åä¸ºClassDBæä¾›ï¼Œå®ƒè®°å½•äº†æ‰€æœ‰æ´¾ç”Ÿè‡ªObjectç±»çš„ç±»å‹ä¿¡æ¯ã€‚åœ¨ä¸šåŠ¡ä»£ç å±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæä¾›çš„ä¸€ç³»åˆ—é™æ€æ–¹æ³•æ¥è¿è¡Œæ—¶è®¿é—®ç±»çš„ç±»å‹ä¿¡æ¯ï¼Œæ¯”å¦‚è·å–ç±»çš„æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å±æ€§ç­‰ä¿¡æ¯ã€‚ ClassDBä»‹ç» å¯¹äºgodotæ¥è¯´ClassDBæ˜¯ä¸€ä¸ªå…¨å±€ç±»ä¿¡æ¯åº“ï¼Œå¯ä»¥å¯¹æ‰€æœ‰æ³¨å†Œç±»çš„å…ƒæ•°æ®è¿›è¡Œè®¿é—®ã€‚\nClassDBåˆ©ç”¨é™æ€æˆå‘˜å˜é‡æ¥å­˜å‚¨ç±»çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ç±»çš„ç»§æ‰¿å…³ç³»ã€æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å±æ€§ç­‰ä¿¡æ¯ã€‚ ClassDBæä¾›äº†ä¸€ç³»åˆ—çš„é™æ€æˆå‘˜å‡½æ•°ç»™ç”¨æˆ·æ¥è¿›è¡Œå…ƒæ•°æ®æŸ¥è¯¢ã€‚ å› æ­¤ClassDBå¹¶æ²¡æœ‰å®ä¾‹åŒ–çš„éœ€æ±‚ã€‚ ä¸‹æ–¹æˆªå–äº†4.4ç‰ˆæœ¬godotæºç ä¸­ClassDBç±»çš„éƒ¨åˆ†ä»£ç ï¼Œå¹¶æ ‡æ³¨äº†ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼Œå¸®åŠ©æˆ‘ä»¬å»æ•´ä½“çš„ç†è§£ClassDBçš„è¿è¡ŒåŸç†ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæ–¹æ³•å’Œå±æ€§çš„é¡ºåºï¼Œå¹¶éä¸æºç ä¸¥æ ¼ä¸€è‡´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 class ClassDB { public: //... //è¯»å†™é”ï¼Œé˜²æ­¢å¤šçº¿ç¨‹é—®é¢˜ static RWLock lock; //æ‰€æœ‰æ³¨å†Œçš„ç±»ä¿¡æ¯ static HashMap\u0026lt;StringName, ClassInfo\u0026gt; classes; // static HashMap\u0026lt;StringName, StringName\u0026gt; resource_base_extensions; static HashMap\u0026lt;StringName, StringName\u0026gt; compat_classes; //... public: //... //æŸ¥è¯¢æ‰€æœ‰ç±»çš„åç§°åˆ—è¡¨ static void get_class_list(List\u0026lt;StringName\u0026gt; *p_classes); //æŸ¥è¯¢æ‰€æœ‰GDExtensionçš„ç±»åç§°åˆ—è¡¨ static void get_extensions_class_list(List\u0026lt;StringName\u0026gt; *p_classes); //æŒ‰ç…§åç§°æŸ¥è¯¢ç±»æ˜¯å¦å­˜åœ¨ static bool class_exists(const StringName \u0026amp;p_class); //ä¿¡å·æ¥å£ static void add_signal(const StringName \u0026amp;p_class, const MethodInfo \u0026amp;p_signal); static bool has_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, bool p_no_inheritance = false); static bool get_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, MethodInfo *r_signal); static void get_signal_list(const StringName \u0026amp;p_class, List\u0026lt;MethodInfo\u0026gt; *p_signals, bool p_no_inheritance = false); }; ç±»çš„æŸ¥è¯¢æ¥å£ åœ¨ç†è§£ClassDBä¸­çš„é™æ€æˆå‘˜å˜é‡static HashMap\u0026lt;StringName, ClassInfo\u0026gt; classes;å­˜å‚¨äº†æ‰€æœ‰çš„ç±»ä¿¡æ¯åï¼Œä¸‹æ–¹ä¸¤ä¸ªæŸ¥è¯¢çš„æ¥å£ï¼Œå°±éå¸¸å¥½ç†è§£äº†ã€‚\næ¥å£ ä½œç”¨ ä¸€èˆ¬æ¥å£ get_class_list æŸ¥è¯¢æ‰€æœ‰ç±»åç§° class_exists æŸ¥è¯¢ç±»æ˜¯å¦å­˜åœ¨ instantiate è°ƒç”¨å®ä¾‹åŒ–å‡½æ•°ï¼Œå¹¶å‘é€é€šçŸ¥ å‘ä¸‹æŸ¥è¯¢ get_inheriters_from_class æŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿ç±» get_direct_inheriters_from_class æŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿ç±»(ä¸åŒ…å«è‡ªèº«) å‘ä¸ŠæŸ¥è¯¢ get_parent_class æŸ¥è¯¢çˆ¶ç±» get_parent_class_nocheck æŸ¥è¯¢çˆ¶ç±»åç§°ï¼Œä¸åšæŠ¥é”™ get_inheritance_chain_nocheck æŸ¥è¯¢ç»§æ‰¿é“¾ is_parent_class æŸ¥è¯¢Aæ˜¯å¦ç»§æ‰¿è‡ªB(åŒ…æ‹¬åŒä¸€ç±») ä¸€èˆ¬æ¥å£ get_class_list ï¼šï¼šæ‰€æœ‰ç±»åç§°æŸ¥è¯¢ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„å…ƒç´ æ˜¯æ‰€æœ‰ç±»çš„åç§°ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 void ClassDB::get_class_list(List\u0026lt;StringName\u0026gt; *p_classes) { //åˆ›å»ºè¯»é”ï¼Œgodotå®šä¹‰çš„å®ï¼Œå¯ä»¥ä¸å…³æ³¨å®ƒçš„å®ç°ç»†èŠ‚ OBJTYPE_RLOCK; //éå†å­˜æ”¾æ‰€æœ‰ç±»ä¿¡æ¯çš„HashMapï¼šclassesï¼Œæ‹¿åˆ°å®ƒçš„é”®å€¼ï¼Œä¹Ÿå°±æ˜¯ç±»åï¼Œæ·»åŠ è¿›è¾“å‡ºåˆ—è¡¨ for (const KeyValue\u0026lt;StringName, ClassInfo\u0026gt; \u0026amp;E : classes) { p_classes-\u0026gt;push_back(E.key); } //å¯¹ p_classes åˆ—è¡¨ä¸­çš„æ‰€æœ‰ç±»åï¼ˆStringNameï¼‰æŒ‰ç…§å­—æ¯é¡ºåºè¿›è¡Œæ’åºã€‚ p_classes-\u0026gt;sort_custom\u0026lt;StringName::AlphCompare\u0026gt;(); } class_exists ï¼šï¼šæŸ¥è¯¢ç±»æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚ 1 2 3 4 5 6 bool ClassDB::class_exists(const StringName \u0026amp;p_class) { //åˆ›å»ºè¯»é” OBJTYPE_RLOCK; //æ ¹æ®é”®å€¼æŸ¥è¯¢å“ˆå¸Œè¡¨ return classes.has(p_class); } å‘ä¸‹æŸ¥è¯¢ get_inheriters_from_class ï¼šï¼š æŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿è‡ªæŒ‡å®šç±»çš„ç±»åç§°åˆ—è¡¨ã€‚ get_direct_inheriters_from_class ï¼šï¼šæŸ¥è¯¢æ‰€æœ‰ç»§æ‰¿è‡ªæŒ‡å®šç±»çš„ç±»åç§°åˆ—è¡¨ï¼Œè¿‡æ»¤æ‰äº†ä¼ å…¥çš„ç±»æœ¬èº« 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 void ClassDB::get_inheriters_from_class(const StringName \u0026amp;p_class, List\u0026lt;StringName\u0026gt; *p_classes) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //éå†å­˜æ”¾æ‰€æœ‰ç±»ä¿¡æ¯ï¼Œå¦‚æœEä¸ºç»§æ‰¿è‡ªp_classçš„ç±»ï¼Œåˆ™æ·»åŠ è¿›è¾“å‡ºåˆ—è¡¨ for (const KeyValue\u0026lt;StringName, ClassInfo\u0026gt; \u0026amp;E : classes) { if (E.key != p_class \u0026amp;\u0026amp; _is_parent_class(E.key, p_class)) { p_classes-\u0026gt;push_back(E.key); } } } void ClassDB::get_direct_inheriters_from_class(const StringName \u0026amp;p_class, List\u0026lt;StringName\u0026gt; *p_classes) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //åŒä¸Šï¼Œä½†æ˜¯è¿‡æ»¤æ‰äº†è‡ªèº« for (const KeyValue\u0026lt;StringName, ClassInfo\u0026gt; \u0026amp;E : classes) { if (E.key != p_class \u0026amp;\u0026amp; _get_parent_class(E.key) == p_class) { p_classes-\u0026gt;push_back(E.key); } } } å‘ä¸ŠæŸ¥è¯¢ get_parent_class ï¼šï¼šæŸ¥è¯¢æŒ‡å®šç±»çš„çˆ¶ç±»åç§° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 StringName ClassDB::get_parent_class(const StringName \u0026amp;p_class) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //è°ƒç”¨å®é™…æ‰§è¡Œå‡½æ•° return _get_parent_class(p_class); } StringName ClassDB::_get_parent_class(const StringName \u0026amp;p_class) { ClassInfo *ti = classes.getptr(p_class); //éç©ºåˆ¤æ–­ï¼Œä¸ºç©ºæ—¶æŠ¥é”™å¹¶è¿”å›ç©ºå­—ç¬¦ä¸² ERR_FAIL_NULL_V_MSG(ti, StringName(), vformat(\u0026#34;Cannot get class \u0026#39;%s\u0026#39;.\u0026#34;, String(p_class))); //è¿”å›çˆ¶ç±»åç§° return ti-\u0026gt;inherits; } get_parent_class_nocheck ï¼šï¼šæŸ¥è¯¢æŒ‡å®šç±»çš„çˆ¶ç±»åç§°ï¼Œä¸åšæŠ¥é”™ 1 2 3 4 5 6 7 8 9 10 11 12 13 StringName ClassDB::get_parent_class_nocheck(const StringName \u0026amp;p_class) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //éç©ºåˆ¤æ–­ ClassInfo *ti = classes.getptr(p_class); if (!ti) { return StringName(); } //è¿”å›çˆ¶ç±»åç§° return ti-\u0026gt;inherits; } get_inheritance_chain_nocheckï¼šï¼šæŸ¥è¯¢ç»§æ‰¿é“¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 bool ClassDB::get_inheritance_chain_nocheck(const StringName \u0026amp;p_class, Vector\u0026lt;StringName\u0026gt; \u0026amp;r_result) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //éç©ºåˆ¤æ–­ ClassInfo *start = classes.getptr(p_class); if (!start) { return false; } //å‘ä¸ŠæŸ¥è¯¢ï¼Œç›´è‡³çˆ¶ç±»æŒ‡é’ˆä¸ºç©º int classes_to_add = 0; for (ClassInfo *ti = start; ti; ti = ti-\u0026gt;inherits_ptr) { classes_to_add++; } //æ‰©å®¹r_resultåˆ—è¡¨ï¼Œå¹¶å°†çˆ¶ç±»ååˆ—è¡¨ç§°æ·»åŠ è¿›åˆ—è¡¨ //ä¸ç”¨push_backï¼Œå› ä¸ºpush_backä¼šåŠ¨æ€æ‰©å®¹ï¼Œæ€§èƒ½è¡¨ç°æ›´å·®ï¼Œè€Œresizeä¸ä¼š int64_t old_size = r_result.size(); r_result.resize(old_size + classes_to_add); StringName *w = r_result.ptrw() + old_size; for (ClassInfo *ti = start; ti; ti = ti-\u0026gt;inherits_ptr) { *w++ = ti-\u0026gt;name; } return true; } ä¿¡å·æ¥å£ ä¿¡å·ç›¸å…³çš„ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨ClassInfoçš„signal_mapå½“ä¸­\næ¥å£ ä½œç”¨ add_signal ä¸ºæŸä¸ªç±»æ·»åŠ ä¸€ä¸ª ä¿¡å·ï¼Œæ™®éä½¿ç”¨å®ƒçš„å®ADD_SIGNALç‰ˆæœ¬ has_signal æ£€æŸ¥ç±»æ˜¯å¦ï¼ˆå«çˆ¶ç±»ï¼‰å®šä¹‰äº†æŸä¸ªä¿¡å· get_signal è¿”å› class æˆ–å…¶ç¥–å…ˆçš„ä¿¡å·æ•°æ®ã€‚ get_signal_list è·å–æ‰€æœ‰ä¿¡å·ï¼ˆå¯åŒ…æ‹¬çˆ¶ç±»ï¼‰ åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ï¼š godotä¸­çš„signalç±»ä¼¼äºueä¸­çš„åŠ¨æ€å¤šæ’­ä»£ç†ã€‚å®ƒå¯ä»¥å°†ä¸€ä¸ªä¿¡å·ï¼ˆå¯ä»¥å¸¦å‚æ•°ï¼‰å‘é€åˆ°æ‰€æœ‰ç›‘å¬å‡½æ•°ã€‚\nä¿¡å·çš„åˆ›å»ºä¸€èˆ¬æ”¾åœ¨_bind_methodsä¸­ ç›‘å¬ä¿¡å·çš„ç»‘å®šï¼Œåˆ™éœ€è¦ç»“åˆå®é™…çš„ç›‘å¬è€…ï¼ˆObject*ï¼‰ï¼Œå› æ­¤ä¸ä¼šåœ¨é™æ€å‡½æ•°_bind_methodsä¸­ç»‘å®šã€‚ ä¿¡å·çš„å‘é€ï¼Œä¹Ÿéœ€è¦ç»“åˆå®é™…çš„å‘é€è€…ã€‚ æ³¨æ„ï¼Œç”±äºä¿¡å·åŠŸèƒ½çš„å®ç°ï¼Œä¾èµ–äº†Objectå†…çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç›¸å…³çš„å‡½æ•°éœ€è¦è¢«æ³¨å†Œè¿›ç±»å‹ä¿¡æ¯å½“ä¸­ï¼Œå¦åˆ™Objectæ— æ³•é€šè¿‡callåŠ¨æ€çš„è°ƒç”¨ç»‘å®šçš„å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 //ä¿¡å·åˆ›å»º void MyNode::_bind_methods() { //å®šä¹‰ä¿¡å·çš„å±æ€§ MethodInfo mi(\u0026#34;TestSignal\u0026#34;); //ä¿¡å·åç§°ä¸ºTestSignal mi._push_params(PropertyInfo(Variant::INT,\u0026#34;Arg1\u0026#34;)); //å…·æœ‰ä¸€ä¸ªç±»å‹ä¸ºintçš„å‚æ•°Arg1 ClassDB::add_signal(\u0026#34;NsTestResource\u0026#34;, mi);\t//æ·»åŠ ä¿¡å· //å®çš„å®ç°ç‰ˆæœ¬ //ä¿¡å·åç§°ä¸ºTestSignalï¼Œä¿¡å·å…·æœ‰ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹ä¸ºint ADD_SIGNAL(MethodInfo(\u0026#34;NsTestResource\u0026#34;, PropertyInfo(Variant::INT, \u0026#34;TestSignal\u0026#34;)));\t} //å®šä¹‰è¢«è°ƒç”¨å‡½æ•° void NsTestResource::test_func_for_signal(int AAA){ print_line(\u0026#34;test_func_for_signal::\u0026#34;,AAA); } //ç»‘å®šä¿¡å· void NsTestResource::test_func_for_connect(){ connect(\u0026#34;TestSignal\u0026#34;, Callable(this,\u0026#34;test_func_for_signal\u0026#34;)); } //å‘å°„ä¿¡å· void NsTestResource::test_func_for_emit(int AAA){ emit_signal(\u0026#34;TestSignal\u0026#34;, 2); } add_signal ä¸ºæŸä¸ªç±»æ·»åŠ ä¸€ä¸ªä¿¡å·,MethodInfoå‚è€ƒé“¾æ¥\næ–¹æ³•ç­¾å\n1 2 3 4 void ClassDB::add_signal( const StringName \u0026amp;p_class, //ç±»å const MethodInfo \u0026amp;p_signal\t//ä¿¡å·ä¿¡æ¯ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 #define ADD_SIGNAL(m_signal) ::ClassDB::add_signal(get_class_static(), m_signal) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 void MyNode::_bind_methods() { //å®šä¹‰ä¿¡å·çš„å±æ€§ MethodInfo mi(\u0026#34;TestSignal\u0026#34;); //ä¿¡å·åç§°ä¸ºTestSignal mi._push_params(PropertyInfo(Variant::INT,\u0026#34;Arg1\u0026#34;)); //å…·æœ‰ä¸€ä¸ªç±»å‹ä¸ºintçš„å‚æ•°Arg1 ClassDB::add_signal(\u0026#34;NsTestResource\u0026#34;, mi);\t//æ·»åŠ ä¿¡å· //å®çš„å®ç°ç‰ˆæœ¬ //ä¿¡å·åç§°ä¸ºTestSignalï¼Œä¿¡å·å…·æœ‰ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹ä¸ºint ADD_SIGNAL(MethodInfo(\u0026#34;NsTestResource\u0026#34;, PropertyInfo(Variant::INT, \u0026#34;TestSignal\u0026#34;)));\t} æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void ClassDB::add_signal(const StringName \u0026amp;p_class, const MethodInfo \u0026amp;p_signal) { //é”ä¸Šå†™é” OBJTYPE_WLOCK; //ç±»ä¿¡æ¯éç©ºåˆ¤æ–­ ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); //è·å–ä¿¡å·åç§° StringName sname = p_signal.name; //åŒåä¿¡å·æŠ¥é”™ #ifdef DEBUG_METHODS_ENABLED ClassInfo *check = type; while (check) { ERR_FAIL_COND_MSG(check-\u0026gt;signal_map.has(sname), vformat(\u0026#34;Class \u0026#39;%s\u0026#39; already has signal \u0026#39;%s\u0026#39;.\u0026#34;, String(p_class), String(sname))); check = check-\u0026gt;inherits_ptr; } #endif //signal_mapä¸­æ·»åŠ ä¿¡å· type-\u0026gt;signal_map[sname] = p_signal; } has_signal æ£€æŸ¥æŸä¸ªç±»æ˜¯å¦å®šä¹‰è¿‡æŸä¸ªä¿¡å·\næ–¹æ³•ç­¾å\n1 2 3 4 5 bool ClassDB::has_signal( const StringName \u0026amp;p_class, //ç±»å const StringName \u0026amp;p_signal, //ä¿¡å·å bool p_no_inheritance //æ˜¯å¦å¿½ç•¥ç»§æ‰¿å…³ç³» ); ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 void testfun(){ bool exists = ClassDB::has_signal(\u0026#34;Node\u0026#34;, \u0026#34;tree_entered\u0026#34;); print_line(vformat(\u0026#34;Has signal? %s\u0026#34;, exists)); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 bool ClassDB::has_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, bool p_no_inheritance) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; //ç±»ä¿¡æ¯éç©ºåˆ¤æ–­ ClassInfo *type = classes.getptr(p_class); ClassInfo *check = type; //å‘ä¸Šé€çº§æŸ¥è¯¢classinfoï¼Œç›´åˆ°objectç±»ï¼Œ while (check) { if (check-\u0026gt;signal_map.has(p_signal)) { return true; } //æ— éœ€å‘ä¸ŠæŸ¥è¯¢ï¼Œåˆ™è¿”å›false if (p_no_inheritance) { return false; } check = check-\u0026gt;inherits_ptr; } return false; } get_signal è·å–ä¿¡å·çš„å®Œæ•´ä¿¡æ¯å­˜å…¥MethodInfoï¼Œå¦‚æœä¿¡å·å­˜åœ¨è¿”å›true å¹¶å¡«å……p_signal\nMethodInfoé“¾æ¥\næ–¹æ³•ç­¾å\n1 2 3 4 5 bool ClassDB::get_signal( const StringName \u0026amp;p_class, // ç±»å const StringName \u0026amp;p_signal, // ä¿¡å·å MethodInfo *r_signal // å­˜å‚¨ä¿¡å·çš„MethodInfo )ï¼› ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 void testfun(){ MethodInfo info; if (ClassDB::get_signal(\u0026#34;MyNode\u0026#34;, \u0026#34;hit\u0026#34;, \u0026amp;info)) { print_line(\u0026#34;Signal name: \u0026#34; + info.name); for (auto arg : info.arguments) { print_line(\u0026#34;Arg: \u0026#34; + arg.name); } } } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 bool ClassDB::get_signal(const StringName \u0026amp;p_class, const StringName \u0026amp;p_signal, MethodInfo *r_signal) { //é”ä¸Šè¯»é” OBJTYPE_RLOCK; ClassInfo *type = classes.getptr(p_class); ClassInfo *check = type; //å‘ä¸Šé€çº§æŸ¥è¯¢classinfoï¼Œç›´åˆ°objectç±» while (check) { //è·å–ä¿¡å·ä¿¡æ¯ if (check-\u0026gt;signal_map.has(p_signal)) { if (r_signal) { //è¿›è¡Œå€¼æ‹·è´ *r_signal = check-\u0026gt;signal_map[p_signal]; } return true; } //çˆ¶ç±»ClassInfoæŒ‡é’ˆ check = check-\u0026gt;inherits_ptr; } return false; } get_signal_list è·å–æŸä¸ªç±»æ‰€æœ‰ä¿¡å·,åŒ…æ‹¬çˆ¶ç±»ä¿¡å·\næ–¹æ³•ç­¾å\n1 2 3 4 5 void ClassDB::get_signal_list( const StringName \u0026amp;p_class, //ç±»å List\u0026lt;MethodInfo\u0026gt; *p_signals, //ä¿¡å·åˆ—è¡¨å¼•ç”¨ï¼Œç”¨äºè¿”å›æŸ¥è¯¢ç»“æœ bool p_no_inheritance //æ˜¯å¦æŸ¥è¯¢çˆ¶ç±»ä¿¡å· ); ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 void testfun(){ List\u0026lt;MethodInfo\u0026gt; signals; ClassDB::get_signal_list(\u0026#34;Node2D\u0026#34;, \u0026amp;signals); for (List\u0026lt;MethodInfo\u0026gt;::Element *E = signals.front(); E; E = E-\u0026gt;next()) { print_line(\u0026#34;Signal: \u0026#34; + E-\u0026gt;get().name); } } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 void ClassDB::get_signal_list(const StringName \u0026amp;p_class, List\u0026lt;MethodInfo\u0026gt; *p_signals, bool p_no_inheritance) { //é”ä¸Šè¯»é” éç©ºåˆ¤æ–­ OBJTYPE_RLOCK; ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); //å‘ä¸Šé€çº§æŸ¥è¯¢classinfoï¼Œç›´åˆ°objectç±» ClassInfo *check = type; while (check) { //éå†æ‰€æœ‰ä¿¡å·ï¼Œå¹¶æ¨å…¥æ•°ç»„ for (KeyValue\u0026lt;StringName, MethodInfo\u0026gt; \u0026amp;E : check-\u0026gt;signal_map) { p_signals-\u0026gt;push_back(E.value); } if (p_no_inheritance) { return; } check = check-\u0026gt;inherits_ptr; } } å±æ€§æ¥å£ å±æ€§ç›¸å…³çš„ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨ClassInfoçš„property_listã€property_mapå’Œproperty_setgetå½“ä¸­\næ¥å£ ä½œç”¨ add_property ç»™æŸä¸ªç±»æ³¨å†Œä¸€ä¸ªâ€œå±æ€§â€ï¼Œå¹¶æŠŠè¿™ä¸ªå±æ€§å’Œå¯¹åº”çš„ setter/getter æ–¹æ³•ç»‘å®šèµ·æ¥ add_property_array ä¸º Inspector ç”Ÿæˆâ€œæ•°ç»„å¼å±æ€§ç»„â€çš„è¾…åŠ©å‡½æ•°ï¼Œæœ¬èº«ä¸åˆ›å»ºå®é™…çš„å±æ€§ add_property_array_count ç»™ä¸€ä¸ªç±»æ³¨å†Œæ•°ç»„å±æ€§ add_property_group ä¸º Inspectorä¸­æ˜¾ç¤ºçš„å±æ€§åˆ†ç»„ add_property_subgroup åˆ›å»º ç¼©è¿›æ›´æ·±ä¸€çº§çš„å­åˆ†ç»„ add_linked_property é“¾æ¥å±æ€§ï¼Œå°†å­å±ä¸‹å…³è”åˆ°çˆ¶å±æ€§ get_property_list è·å–æŸä¸ªç±»çš„æ‰€æœ‰å±æ€§åˆ—è¡¨ get_property_info è·å–æŸä¸ªç±»çš„æŸä¸ªå±æ€§ï¼Œæ³¨æ„ç”±äºæ˜¯é€šè¿‡ClassInfoï¼šï¼šproperty_mapæ¥è¿›è¡ŒæŸ¥è¯¢çš„ï¼Œå› æ­¤å ä½çš„å±æ€§ä¿¡æ¯ä¼šè¿”å›false get_property è·å–æŸä¸ªå®ä¾‹çš„å±æ€§å€¼ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ set_property è®¾ç½®æŸä¸ªå®ä¾‹çš„å±æ€§å€¼ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ has_property æŸ¥è¯¢æŸä¸ªç±»æ˜¯å¦å®šä¹‰è¿‡æŸä¸ªå±æ€§ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_index æŸ¥è¯¢å±æ€§ç´¢å¼•ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_type è·å–å±æ€§ç±»å‹ï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_setter è·å–å±æ€§setteræ–¹æ³•åï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ get_property_getter è·å–å±æ€§getteræ–¹æ³•åï¼Œä¿¡æ¯å­˜æ”¾åœ¨ClassInfo::PropertySetGetä¸­ add_property add_propertyç»™æŸä¸ªç±»æ³¨å†Œä¸€ä¸ªâ€œå±æ€§â€ï¼Œå¹¶æŠŠè¿™ä¸ªå±æ€§å’Œå¯¹åº”çš„ setter/getter æ–¹æ³•ç»‘å®šèµ·æ¥ã€‚\nä¸€èˆ¬ç»“åˆget_class_static()ä½¿ç”¨ï¼Œåœ¨_bind_methods ä¸­è°ƒç”¨ï¼Œæ³¨å†Œæœ¬ç±»çš„å±æ€§ã€‚\næ–¹æ³•ç­¾å\n1 2 3 4 5 6 7 static void add_property( const StringName \u0026amp;p_class,// ç±»åï¼Œä½¿ç”¨å°è£…çš„ADD_PROPERTYå®æ—¶ï¼Œè¯¥ç±»åä¼šè¢«è‡ªåŠ¨å¡«å…¥ const PropertyInfo \u0026amp;p_pinfo,// å±æ€§ä¿¡æ¯ const StringName \u0026amp;p_setter,// setter æ–¹æ³•å const StringName \u0026amp;p_getter,// getter æ–¹æ³•å int p_index = -1 // å±æ€§ç´¢å¼•ï¼Œé»˜è®¤ä½¿ç”¨-1ï¼ŒADD_PROPERTYIä¸­å¯ä»¥æ·»åŠ ç´¢å¼•ã€‚é…åˆadd_property_arrayä½¿ç”¨ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 2 #define ADD_PROPERTY(m_property, m_setter, m_getter) ::ClassDB::add_property(get_class_static(), m_property, _scs_create(m_setter), _scs_create(m_getter)) #define ADD_PROPERTYI(m_property, m_setter, m_getter, m_index) ::ClassDB::add_property(get_class_static(), m_property, _scs_create(m_setter), _scs_create(m_getter), m_index) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 void MyNode::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;set_value\u0026#34;, \u0026#34;index\u0026#34;, \u0026#34;value\u0026#34;), \u0026amp;MyData::set_value); ClassDB::bind_method(D_METHOD(\u0026#34;get_value\u0026#34;, \u0026#34;index\u0026#34;), \u0026amp;MyData::get_value); // è¿™é‡Œ p_index åˆ†åˆ«å†™ 0/1/2 ClassDB::add_property(\u0026#34;MyData\u0026#34;,PropertyInfo(Variant::FLOAT, \u0026#34;value_0\u0026#34;),\u0026#34;set_value\u0026#34;, \u0026#34;get_value\u0026#34;,0); //æˆ–è€…ç”¨å® ADD_PROPERTY(PropertyInfo(Variant::FLOAT, \u0026#34;value_0\u0026#34;),\u0026#34;set_value\u0026#34;, \u0026#34;get_value\u0026#34;); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 void ClassDB::add_property(const StringName \u0026amp;p_class, const PropertyInfo \u0026amp;p_pinfo, const StringName \u0026amp;p_setter, const StringName \u0026amp;p_getter, int p_index) { //é”ä¸Šè¯»é”ï¼Œè·å–ç±»ä¿¡æ¯ lock.read_lock(); ClassInfo *type = classes.getptr(p_class); lock.read_unlock(); //ç±»ä¿¡æ¯éç©ºåˆ¤æ–­ ERR_FAIL_NULL(type); //è·å–setteræ–¹æ³• MethodBind *mb_set = nullptr; if (p_setter) { mb_set = get_method(p_class, p_setter); #ifdef DEBUG_METHODS_ENABLED ERR_FAIL_NULL_MSG(mb_set, vformat(\u0026#34;Invalid setter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_setter, p_pinfo.name)); int exp_args = 1 + (p_index \u0026gt;= 0 ? 1 : 0); ERR_FAIL_COND_MSG(mb_set-\u0026gt;get_argument_count() != exp_args, vformat(\u0026#34;Invalid function for setter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_setter, p_pinfo.name)); #endif } //è·å–getteræ–¹æ³• MethodBind *mb_get = nullptr; if (p_getter) { mb_get = get_method(p_class, p_getter); #ifdef DEBUG_METHODS_ENABLED ERR_FAIL_NULL_MSG(mb_get, vformat(\u0026#34;Invalid getter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_getter, p_pinfo.name)); int exp_args = 0 + (p_index \u0026gt;= 0 ? 1 : 0); ERR_FAIL_COND_MSG(mb_get-\u0026gt;get_argument_count() != exp_args, vformat(\u0026#34;Invalid function for getter \u0026#39;%s::%s\u0026#39; for property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_getter, p_pinfo.name)); #endif } //å±æ€§åç§°é‡å¤æŠ¥é”™ #ifdef DEBUG_METHODS_ENABLED ERR_FAIL_COND_MSG(type-\u0026gt;property_setget.has(p_pinfo.name), vformat(\u0026#34;Object \u0026#39;%s\u0026#39; already has property \u0026#39;%s\u0026#39;.\u0026#34;, p_class, p_pinfo.name)); #endif //é”ä¸Šå†™é”ï¼Œç›´åˆ°å‡½æ•°ç»“æŸ OBJTYPE_WLOCK //åœ¨classinfoä¸­æ·»åŠ å±æ€§ä¿¡æ¯ type-\u0026gt;property_list.push_back(p_pinfo); type-\u0026gt;property_map[p_pinfo.name] = p_pinfo; #ifdef DEBUG_METHODS_ENABLED if (mb_get) { type-\u0026gt;methods_in_properties.insert(p_getter); } if (mb_set) { type-\u0026gt;methods_in_properties.insert(p_setter); } #endif //æ·»åŠ å±æ€§çš„setå’Œgetæ–¹æ³•ï¼Œé”®æ˜¯å±æ€§åç§° PropertySetGet psg; psg.setter = p_setter; psg.getter = p_getter; psg._setptr = mb_set; psg._getptr = mb_get; psg.index = p_index; psg.type = p_pinfo.type; type-\u0026gt;property_setget[p_pinfo.name] = psg; } add_property_array åœ¨ Inspector ä¸­åˆ›å»ºä¸€ä¸ªâ€œæ•°ç»„å±æ€§ç»„â€ï¼ˆarray property groupï¼‰ï¼Œç”¨äºæ˜¾ç¤ºä¸€ç»„ä»¥ç±»ä¼¼å‘½åè§„åˆ™çš„å±æ€§ã€‚\nå®ƒä¸ç›´æ¥å­˜ getter/setterï¼Œä¹Ÿä¸å…³è”å®é™…å±æ€§ã€‚ å®ƒæ˜¯ä¸€ä¸ª è™šæ‹Ÿå±æ€§ï¼ˆVariant::NILï¼‰ ï¼Œä»…ç”¨äº UI åˆ†ç»„ã€‚ å®ƒé…åˆadd_property/ADD_PROPERTYIä½¿ç”¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå®šé•¿æ•°ç»„å±æ€§ã€‚ å®ƒé…åˆ_set()/_get()/_get_property_list()ä½¿ç”¨ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåŠ¨æ€æ•°ç»„å±æ€§ã€‚ æ³¨æ„ï¼šå®ƒçš„ä½¿ç”¨éå¸¸å¤æ‚,éœ€è¦ç»“åˆObjectçš„å®get_property_listä½¿ç”¨ã€‚åç»­ä¼šæœ‰ä¸“é—¨çš„ç« èŠ‚è®²è§£ã€‚æ­¤å¤„ä»…ç»™å‡ºä¸€ä¸ªç®€çŸ­çš„ç¤ºä¾‹\næ–¹æ³•ç­¾å\n1 2 3 4 5 void ClassDB::add_property_array( const StringName \u0026amp;p_class, // ç±»å const StringName \u0026amp;p_path, // å±æ€§è·¯å¾„ const String \u0026amp;p_array_element_prefix // æ•°ç»„å…ƒç´ å‰ç¼€ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 #define ADD_ARRAY(m_array_path, m_prefix) ClassDB::add_property_array(get_class_static(), m_array_path, m_prefix) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void MyNode::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;set_position\u0026#34;, \u0026#34;index\u0026#34;, \u0026#34;value\u0026#34;), \u0026amp;MyNode::set_position); ClassDB::bind_method(D_METHOD(\u0026#34;get_position\u0026#34;, \u0026#34;index\u0026#34;), \u0026amp;MyNode::get_position); // æ·»åŠ æ•°ç»„å±æ€§ç»„ï¼ˆè™šæ‹Ÿå±æ€§ï¼‰ï¼Œå®šé•¿æ•°ç»„ // æ·»åŠ æ¯ä¸ªå®é™…å±æ€§ï¼Œç®€æ˜“ç‰ˆæœ¬ // å¯¹äºå˜é•¿æ•°ç»„ï¼Œéœ€è¦é‡è½½å‡½æ•°get_property_listä¸­å®šä¹‰è¯¥å±æ€§æ•°ç»„çš„è¡Œä¸º ClassDB::add_property_array(\u0026#34;MyNode\u0026#34;, \u0026#34;positions\u0026#34;, \u0026#34;positions/\u0026#34;); for (int i = 0; i \u0026lt; 3; i++) { String name = \u0026#34;positions/\u0026#34; + itos(i); ClassDB::add_property(\u0026#34;MyNode\u0026#34;, PropertyInfo(Variant::VECTOR3, name), \u0026#34;set_position\u0026#34;, \u0026#34;get_position\u0026#34;, i); } //ä½¿ç”¨å®çš„ç‰ˆæœ¬å®ç° ADD_ARRAY(\u0026#34;TestProperty\u0026#34;, \u0026#34;TestProperty/\u0026#34;); ADD_PROPERTYI(PropertyInfo(Variant::COLOR,\u0026#34;TestProperty/0\u0026#34;), \u0026#34;set_TP_color\u0026#34;, \u0026#34;get_TP_color\u0026#34;,1); ADD_PROPERTYI(PropertyInfo(Variant::COLOR,\u0026#34;TestProperty/1\u0026#34;), \u0026#34;set_TP_color\u0026#34;, \u0026#34;get_TP_color\u0026#34;,2); ClassDB::add_property(\u0026#34;NsTestResource\u0026#34;, PropertyInfo(Variant::VECTOR3,\u0026#34;TestProperty/2\u0026#34;), \u0026#34;set_TP_vector3\u0026#34;, \u0026#34;get_TP_vector3\u0026#34;, 0 ); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 //æ­¤å¤„å°±éå¸¸ç®€å•ï¼Œä»…åšäº†å ä½çš„å±æ€§æ·»åŠ  void ClassDB::add_property_array(const StringName \u0026amp;p_class, const StringName \u0026amp;p_path, const String \u0026amp;p_array_element_prefix) { //é”ä¸Šå†™é”ï¼Œç›´åˆ°å‡½æ•°ç»“æŸï¼Œç©ºå€¼åˆ¤æ–­ OBJTYPE_WLOCK; ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); // æ·»åŠ åˆ°å±æ€§ç»„ï¼Œç±»å‹ä¸ºç©ºNILï¼Œç”¨äºå ä½ //æ³¨æ„ï¼Œæ­¤å¤„çš„usageå±æ€§ä¸º PROPERTY_USAGE_EDITOR | PROPERTY_USAGE_ARRAY ï¼Œä¹Ÿå°±æ˜¯å£°æ˜ä¸ºäº†æ•°ç»„ï¼Œä»¥åŠç¼–è¾‘å™¨å¯è§ type-\u0026gt;property_list.push_back(PropertyInfo(Variant::NIL, p_path, PROPERTY_HINT_NONE, \u0026#34;\u0026#34;, PROPERTY_USAGE_EDITOR | PROPERTY_USAGE_ARRAY, p_array_element_prefix)); } add_property_array_count ç»™ä¸€ä¸ªç±»æ³¨å†Œæ•°ç»„å±æ€§ï¼ˆArray Propertyï¼‰;\né€šå¸¸ç»“åˆè‡ªå®šä¹‰çš„_setter_ å’Œ _getter_ä»¥åŠ_get_property_list_ä½¿ç”¨ å¯ä»¥å®ç°è‡ªå®šä¹‰çš„å˜é•¿æ•°ç»„ å®ƒåªæ³¨å†Œé•¿åº¦å±æ€§æœ¬èº« æ–¹æ³•ç­¾å\n1 2 3 4 5 6 7 8 9 static void add_property_array_count( const StringName \u0026amp;p_class, //è¢«ç»‘å®šç±»çš„ç±»å const String \u0026amp;p_label, //Inspector ä¸Šæ˜¾ç¤ºçš„ æ ‡ç­¾ï¼ˆç”¨æˆ·å¯è§ï¼‰ã€‚ const StringName \u0026amp;p_count_property, //æ•°ç»„é•¿åº¦å±æ€§çš„ å†…éƒ¨å±æ€§åã€‚ const StringName \u0026amp;p_count_setter, //å¯¹åº” setter å‡½æ•°å const StringName \u0026amp;p_count_getter, //å¯¹åº” getter å‡½æ•°å const String \u0026amp;p_array_element_prefix, //æ•°ç»„å…ƒç´ çš„å‰ç¼€ uint32_t p_count_usage = PROPERTY_USAGE_DEFAULT //å±æ€§çš„PropertyUsageç±»å‹ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 2 #define ADD_ARRAY_COUNT(m_label, m_count_property, m_count_property_setter, m_count_property_getter, m_prefix) ClassDB::add_property_array_count(get_class_static(), m_label, m_count_property, _scs_create(m_count_property_setter), _scs_create(m_count_property_getter), m_prefix) #define ADD_ARRAY_COUNT_WITH_USAGE_FLAGS(m_label, m_count_property, m_count_property_setter, m_count_property_getter, m_prefix, m_property_usage_flags) ClassDB::add_property_array_count(get_class_static(), m_label, m_count_property, _scs_create(m_count_property_setter), _scs_create(m_count_property_getter), m_prefix, m_property_usage_flags) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 // æ³¨å†Œæ•°ç»„ç»„ï¼šåå­—â€œColorsâ€ï¼Œé•¿åº¦å±æ€§åâ€œcolor_countâ€ï¼Œå…ƒç´ å‰ç¼€â€œcolor_â€ //æ­¤å¤„ä»…å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œæ³¨å†Œï¼Œå…¶ä»–å±æ€§ä¸æ³¨å†Œ // _bind_methods()ä¸­ ADD_ARRAY_COUNT(\u0026#34;Colors\u0026#34;, \u0026#34;color_count\u0026#34;, \u0026#34;set_color_count\u0026#34;, \u0026#34;get_color_count\u0026#34;, \u0026#34;color_\u0026#34;); // ä¸‹æ–¹æ˜¯ä¸‰ä¸ªé…å¥—å‡½æ•°ï¼š_set()ã€_get()ã€_get_property_list() // æ­¤å¤„çœŸæ­£å®šä¹‰çš„æ•°ç»„ä¸­å±æ€§çš„è¡Œä¸º bool NsTestResource::_set(const StringName \u0026amp;p_name, const Variant \u0026amp;p_value){ Vector\u0026lt;String\u0026gt; components = String(p_name).split(\u0026#34;/\u0026#34;, true, 2); if (components.size() \u0026gt;= 2 \u0026amp;\u0026amp; components[0].begins_with(\u0026#34;color_\u0026#34;) \u0026amp;\u0026amp; components[0].trim_prefix(\u0026#34;color_\u0026#34;).is_valid_int()) { int index = components[0].trim_prefix(\u0026#34;color_\u0026#34;).to_int(); const String \u0026amp;property = components[1]; if (property == \u0026#34;color\u0026#34;) { // set_point_position(point_index, p_value); set_color(index, p_value); return true; } if (property == \u0026#34;shader\u0026#34;) { set_shader(index,p_value); return true; } } return false; } bool NsTestResource::_get(const StringName \u0026amp;p_name, Variant \u0026amp;r_ret)const { Vector\u0026lt;String\u0026gt; components = String(p_name).split(\u0026#34;/\u0026#34;, true, 2); if (components.size() \u0026gt;= 2 \u0026amp;\u0026amp; components[0].begins_with(\u0026#34;color_\u0026#34;) \u0026amp;\u0026amp; components[0].trim_prefix(\u0026#34;color_\u0026#34;).is_valid_int()) { int index = components[0].trim_prefix(\u0026#34;color_\u0026#34;).to_int(); const String \u0026amp;property = components[1]; if (property == \u0026#34;color\u0026#34;) { r_ret = get_color(index); return true; } if (property == \u0026#34;shader\u0026#34;) { r_ret = get_shader(index); return true; } } return false; } void NsTestResource::_get_property_list(List\u0026lt;PropertyInfo\u0026gt; *p_list)const { print_line(\u0026#34;NsTestResource::_get_property_list\u0026#34;); for (int i = 0; i \u0026lt; colors.size();i++) { PropertyInfo pi = PropertyInfo(Variant::COLOR, vformat(\u0026#34;color_%d/color\u0026#34;,i)); p_list-\u0026gt;push_back(pi); pi = PropertyInfo(Variant::OBJECT, vformat(\u0026#34;color_%d/shader\u0026#34;,i),PROPERTY_HINT_RESOURCE_TYPE, \u0026#34;Shader\u0026#34;); p_list-\u0026gt;push_back(pi); } } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 void ClassDB::add_property_array_count(const StringName \u0026amp;p_class, const String \u0026amp;p_label, const StringName \u0026amp;p_count_property, const StringName \u0026amp;p_count_setter, const StringName \u0026amp;p_count_getter, const String \u0026amp;p_array_element_prefix, uint32_t p_count_usage) { add_property(p_class, PropertyInfo(Variant::INT, //å±æ€§ç±»å‹ä¸ºINT p_count_property, //å±æ€§å PROPERTY_HINT_NONE, //æç¤ºä¸ºæ— æç¤º \u0026#34;\u0026#34;, //æç¤ºä¿¡æ¯ä¸ºç©º p_count_usage | PROPERTY_USAGE_ARRAY, //æ•°ç»„å±æ€§ vformat(\u0026#34;%s,%s\u0026#34;, p_label, p_array_element_prefix) //ç±»åä¸ºæ ‡ç­¾å’Œå‰ç¼€çš„ç»„è£… ), p_count_setter, //å±æ€§è®¾ç½®å‡½æ•° p_count_getter //å±æ€§è·å–å‡½æ•° ); } add_property_group ClassDB::add_property_group()ç”¨äºåœ¨ Godot Inspectorï¼ˆå±æ€§é¢æ¿ï¼‰ä¸­åˆ›å»ºä¸€æ¡åˆ†ç»„æ ‡é¢˜ï¼Œè®©å¤šä¸ªå±æ€§æ˜¾ç¤ºåœ¨åŒä¸€ä¸ªæŠ˜å ç»„ä¸‹ï¼Œä»è€Œè®© Inspector æ¸…æ™°æ•´æ´ã€‚ æ–¹æ³•ç­¾å\n1 2 3 4 5 6 void ClassDB::add_property_group( const StringName \u0026amp;p_class, //è‡ªèº«ç±»å const String \u0026amp;p_name, const //åˆ†ç»„æ ‡é¢˜ String \u0026amp;p_prefix, //åˆ†ç»„å‰ç¼€ï¼Œå…¶ä»–å…·æœ‰è¯¥å‰ç¼€çš„å±æ€§å°†æ˜¾ç¤ºåœ¨æœ¬åˆ†ç»„ä¸‹ int p_indent_depth = 0 //åˆ†ç»„ç¼©è¿›æ·±åº¦ ); å¸¸ç”¨çš„å®å®šä¹‰\n1 2 3 4 //ä½¿ç”¨é»˜è®¤ç¼©è¿› 0 #define ADD_GROUP(m_name, m_prefix) ::ClassDB::add_property_group(get_class_static(), m_name, m_prefix) //ä½¿ç”¨è‡ªå®šä¹‰ç¼©è¿› #define ADD_GROUP_INDENT(m_name, m_prefix, m_depth) ::ClassDB::add_property_group(get_class_static(), m_name, m_prefix, m_depth) ä½¿ç”¨ç¤ºä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 void Resource::_bind_methods() { ADD_GROUP(\u0026#34;AddGroup1\u0026#34;, \u0026#34;addGroup1_\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup1_Color0\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup1_Color1\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_GROUP_INDENT(\u0026#34;AddGroup2\u0026#34;, \u0026#34;AddGroup2_\u0026#34;,1); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;AddGroup2_Color2\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;AddGroup2_Color3\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_SUBGROUP(\u0026#34;AddGroup3\u0026#34;, \u0026#34;addGroup3_\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup3_Color4\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup3_Color5\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_SUBGROUP_INDENT(\u0026#34;AddGroup4\u0026#34;, \u0026#34;addGroup4_\u0026#34;,2); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup4_Color6\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); ADD_PROPERTY(PropertyInfo(Variant::COLOR,\u0026#34;addGroup4_Color7\u0026#34;), \u0026#34;set_color_Group\u0026#34;, \u0026#34;get_color_Group\u0026#34;); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void ClassDB::add_property_group(const StringName \u0026amp;p_class, const String \u0026amp;p_name, const String \u0026amp;p_prefix, int p_indent_depth) { // é”ä¸Šè¯»é”ï¼Œè·å–ç±»å‹ä¿¡æ¯æŒ‡é’ˆï¼Œéç©ºæ£€æµ‹ OBJTYPE_WLOCK; ClassInfo *type = classes.getptr(p_class); ERR_FAIL_NULL(type); //æ ¹æ®ç¼©è¿›ï¼Œè¿›è¡Œå‰ç¼€æ‹¼æ¥ String prefix = p_prefix; if (p_indent_depth \u0026gt; 0) { prefix = vformat(\u0026#34;%s,%d\u0026#34;, p_prefix, p_indent_depth); } //åœ¨ç±»å‹ä¿¡æ¯çš„property_listä¸­ï¼Œå¡«å…¥åˆ†ç»„çš„å±æ€§ type-\u0026gt;property_list.push_back( PropertyInfo(Variant::NIL, //å ä½ p_name, //åˆ†ç»„å PROPERTY_HINT_NONE, //æ— æç¤º prefix, //å‰ç¼€ PROPERTY_USAGE_GROUP//ä½¿ç”¨ç±»å‹ä¸º åˆ†ç»„ ) ); } get_property_list æœ¬è´¨è¿˜æ˜¯å¯¹ClassInfoä¸­çš„property_listçš„éå†è¯».\næ³¨æ„ï¼Œæ­¤å¤„çš„ClassDB::get_property_listä»…æœ‰æŸ¥è¯¢çš„åŠŸèƒ½ï¼Œå¹¶ä¸ä¼šè§¦å‘æˆ‘ä»¬è‡ªå·±é‡å†™çš„_get_property_list()å‡½æ•°ã€‚\nå¦‚æœéœ€è¦èµ°è‡ªå®šä¹‰çš„_get_property_list()å‡½æ•°ï¼Œè¯·ä½¿ç”¨YourObject.get_property_list()çš„æ–¹å¼æ¥æŸ¥è¯¢ã€‚\nobjectä¸­çš„GDCLASS(m_class, m_inherits)å®ä¸­åŒ…è£…äº†_get_property_listvæ–¹æ³•ï¼Œç”¨äºè·å–å±æ€§åˆ—è¡¨æ—¶è°ƒç”¨è‡ªå®šä¹‰çš„_get_property_list()å‡½æ•°ã€‚\næ–¹æ³•ç­¾å\n1 2 3 4 5 6 static void get_property_list( const StringName \u0026amp;p_class, //éœ€è¦æŸ¥è¯¢ç±»çš„åç§° List\u0026lt;PropertyInfo\u0026gt; *p_list, //è¿”å›çš„å±æ€§åˆ—è¡¨ bool p_no_inheritance = false,//æ˜¯å¦å‘ä¸ŠæŸ¥è¯¢çˆ¶ç±»,é»˜è®¤æŸ¥è¯¢ const Object *p_validator = nullptr)//å…³è”çš„å®é™…ç±»ï¼Œå¯ä»¥ä¸å…³è” ; ä½¿ç”¨ç¤ºä¾‹\n1 2 List\u0026lt;PropertyInfo\u0026gt; list; ClassDB::get_property_list(\u0026#34;YourObject\u0026#34;, \u0026amp;list,true); æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void ClassDB::get_property_list(const StringName \u0026amp;p_class, List\u0026lt;PropertyInfo\u0026gt; *p_list, bool p_no_inheritance, const Object *p_validator) { //é”ä¸Šè¯»é”,ç›´åˆ°å‡ºä½œç”¨åŸŸ OBJTYPE_RLOCK; //é€çº§å‘çˆ¶ç±»æŸ¥è¯¢ç±»å‹ä¿¡æ¯ ClassInfo *type = classes.getptr(p_class); ClassInfo *check = type; while (check) { //éå†å±æ€§åˆ—è¡¨ä¿¡æ¯ for (const PropertyInfo \u0026amp;pi : check-\u0026gt;property_list) { //æ˜¯å¦å…³è”å®ä¾‹ if (p_validator) { // Making a copy as we may modify it. PropertyInfo pi_mut = pi; p_validator-\u0026gt;validate_property(pi_mut); p_list-\u0026gt;push_back(pi_mut); } else { //ä¸å…³è”å°±å°†property_listç›´æ¥æ¨å…¥åˆ—è¡¨p_list p_list-\u0026gt;push_back(pi); } } //æ˜¯å¦æŸ¥è¯¢çˆ¶ç±»ï¼Œå¦‚æœä¸æŸ¥è¯¢ï¼Œç›´æ¥è¿”å› if (p_no_inheritance) { return; } //å˜æ›´ä¸ºçˆ¶ç±»ç±»å‹ä¿¡æ¯æŒ‡é’ˆ check = check-\u0026gt;inherits_ptr; } } get_property æ–¹æ³•ç­¾å\n1 2 3 4 5 bool ClassDB::get_property( Object *p_object, //è¢«æŸ¥è¯¢çš„å®ä¾‹ const StringName \u0026amp;p_property, //å±æ€§å Variant \u0026amp;r_value//å±æ€§å€¼ ); ä½¿ç”¨ç¤ºä¾‹\n1 bool ret = ClassDB::get_property(\u0026#34;MyObject\u0026#34;, \u0026#34;property_name\u0026#34;, value); æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\næ³¨ï¼šPropertySetGetå®šä¹‰è¯¦è§æ­¤å¤„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 bool ClassDB::get_property(Object *p_object, const StringName \u0026amp;p_property, Variant \u0026amp;r_value) { //ç©ºæŒ‡é’ˆæ£€æµ‹ ERR_FAIL_NULL_V(p_object, false); //å‘ä¸Šé€çº§æŸ¥è¯¢ç±»å‹ä¿¡æ¯ ClassInfo *type = classes.getptr(p_object-\u0026gt;get_class_name()); ClassInfo *check = type; while (check) { //æŸ¥è¯¢ç±»å‹ä¿¡æ¯ä¸­çš„property_setget const PropertySetGet *psg = check-\u0026gt;property_setget.getptr(p_property); if (psg) { //å­˜åœ¨PropertySetGetï¼Œä½†æ˜¯æ²¡æœ‰getteræ–¹æ³• if (!psg-\u0026gt;getter) { return true; //return true but do nothing } if (psg-\u0026gt;index \u0026gt;= 0) { Variant index = psg-\u0026gt;index; const Variant *arg[1] = { \u0026amp;index }; Callable::CallError ce; //åˆ©ç”¨å¯¹è±¡å®ä¾‹çš„callpæ–¹æ³•ï¼ŒåŠ¨æ€è°ƒç”¨è¯¥å±æ€§çš„getteræ–¹æ³• //å¯¹äºç´¢å¼•ä¸ä¸º-1ï¼ˆæ•°ç»„ï¼‰çš„å±æ€§å€¼ï¼Œéœ€è¦ä¼ å…¥ç´¢å¼•å‚æ•° const Variant value = p_object-\u0026gt;callp(psg-\u0026gt;getter, arg, 1, ce); r_value = (ce.error == Callable::CallError::CALL_OK) ? value : Variant(); } else { Callable::CallError ce; if (psg-\u0026gt;_getptr) { //é€šè¿‡MethodBindæŒ‡é’ˆ_getptrè°ƒç”¨getteræ–¹æ³• r_value = psg-\u0026gt;_getptr-\u0026gt;call(p_object, nullptr, 0, ce); } else { const Variant value = p_object-\u0026gt;callp(psg-\u0026gt;getter, nullptr, 0, ce); r_value = (ce.error == Callable::CallError::CALL_OK) ? value : Variant(); } } return true; } const int64_t *c = check-\u0026gt;constant_map.getptr(p_property); //constants count if (c) { r_value = *c; return true; } if (check-\u0026gt;method_map.has(p_property)) { //methods count r_value = Callable(p_object, p_property); return true; } if (check-\u0026gt;signal_map.has(p_property)) { //signals count r_value = Signal(p_object, p_property); return true; } check = check-\u0026gt;inherits_ptr; } // The \u0026#34;free()\u0026#34; method is special, so we assume it exists and return a Callable. if (p_property == CoreStringName(free_)) { r_value = Callable(p_object, p_property); return true; } return false; } å‡½æ•°æ¥å£ å‡½æ•°ç›¸å…³çš„æ¥å£ï¼Œæ˜¯ClassDBä¸­æœ€å¤æ‚çš„ä¸€ç»„ï¼Œæ¶‰åŠåˆ°å‡½æ•°çš„ç»‘å®šï¼Œæ‰€ä»¥godotç”¨äº†éå¸¸å¤šçš„æ¨¡æ¿æ¥å®ç°ã€‚ å®ƒçš„ä¿¡æ¯å­˜å‚¨åœ¨ClassInfoçš„ä¸‹é¢ä¸¤ä¸ªæˆå‘˜å˜é‡ä¸­ï¼š\nHashMap\u0026lt;StringName, MethodBind *\u0026gt; method_map; HashMap\u0026lt;StringName, LocalVector\u0026lt;MethodBind *\u0026gt;\u0026gt; method_map_compatibility; æ¥å£ ä½œç”¨ bind_method ç±»å‹æ³¨å†Œæ—¶çš„å‡½æ•°ç»‘å®šæ–¹æ³•ï¼Œç”¨çš„éå¸¸å¹¿æ³› has_method æŸ¥è¯¢æ˜¯ç±»å¦åŒ…å«æŸä¸ªå‡½æ•°ï¼Œé€šè¿‡classinfoçš„method_mapæ¥æŸ¥è¯¢ get_method_list æŸ¥è¯¢æŸä¸ªç±»çš„æ‰€æœ‰å‡½æ•°ä¿¡æ¯MethodInfo,é€šè¿‡classinfoçš„method_mapæ¥æŸ¥è¯¢ bind_method bind_methodçš„ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸€ä¸ªC++æˆå‘˜å‡½æ•°ï¼Œå°è£…æˆä¸€ä¸ªMethodBindï¼Œç„¶åå†æ³¨å†Œè¿›ClassDBçš„ç±»å‹ä¿¡æ¯ä¸­ï¼Œè·¯å¾„ä¸ºï¼šclassdb::classes-\u0026gt;ClassInfo::method_map\nè¯¥æ–¹æ³•ä½¿ç”¨éå¸¸ç®€å•ï¼Œä½†æ˜¯å†…éƒ¨å®ç°æå…¶å¤æ‚ï¼Œç¬”è€…ä»£ç èƒ½åŠ›æœ‰é™ï¼Œä»…èƒ½åšéƒ¨åˆ†ä»£ç çš„è§£è¯»ã€‚å› æ­¤è¯¥å‡½æ•°çš„ä»‹ç»ï¼Œä¼šæ›´åå‘ä½¿ç”¨ã€‚\nMethodDefinition åœ¨ä¸‹æ–¹æœ‰è¯¦ç»†æè¿°ï¼Œå®ƒä»…æ˜¯å­—ç¬¦ä¸²çš„æè¿° æ–¹æ³•ç­¾å\n1 2 3 4 5 6 template \u0026lt;typename N, typename M, typename... VarArgs\u0026gt; static MethodBind *bind_method( N p_method_name, //å‡½æ•°åã€å‚æ•°åˆ—è¡¨çš„æè¿°ï¼ŒMethodDefinitionç±»å‹ï¼Œåˆ©ç”¨D_METHOD()ç”Ÿæˆ M p_method, //æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼Œä¾‹å¦‚ \u0026amp;Input::warp_mouse VarArgs... p_args //å‡½æ•°é»˜è®¤å€¼å‚æ•°åŒ… ); ä½¿ç”¨ç¤ºä¾‹\nDEFVALç”¨äºå‡½æ•°é»˜è®¤å€¼å‚æ•°çš„åŒ…è£…ï¼Œå®ƒçš„æ’åºå¯¹åº”å‡½æ•°ç­¾åçš„åNä½ã€‚\nä»¥ä¸‹æ–¹testfuncçš„å‡½æ•°ç»‘å®šä¸ºä¾‹ï¼š\narg4 = 0.0f arg5 = -1.0f 1 2 3 4 void Input::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;is_anything_pressed\u0026#34;), \u0026amp;Input::is_anything_pressed); ClassDB::bind_method(D_METHOD(\u0026#34;testfunc\u0026#34;, \u0026#34;arg1\u0026#34;, \u0026#34;arg2\u0026#34;, \u0026#34;arg3\u0026#34;, \u0026#34;arg4\u0026#34;, \u0026#34;arg5\u0026#34;), \u0026amp;Input::testfunc, DEFVAL(0.0f),DEFVAL(-1.0f)); } æºç è§£è¯»ï¼ˆå¸¦æ³¨é‡Šï¼‰\né€šè¿‡ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¦æ­£ç¡®ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œéœ€è¦ä½¿ç”¨ä¸¤ä¸ªå‡½æ•°\nD_METHOD åˆ›å»ºMethodDefinitionï¼Œç”¨äºæè¿°å‡½æ•°çš„å‚æ•°åˆ—è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 template \u0026lt;typename... VarArgs\u0026gt; MethodDefinition D_METHOD(const char *p_name, const VarArgs... p_args) { //åˆ›å»ºå‚æ•°åˆ—è¡¨args,åˆ©ç”¨åˆ—è¡¨åˆå§‹åŒ–å±•å¼€å‚æ•°åŒ…p_args //æ”¶é›†æ‰€æœ‰å‚æ•°åç§° const char *args[sizeof...(p_args) + 1] = { p_args..., nullptr }; // +1 makes sure zero sized arrays are also supported. const char *const *argptrs[sizeof...(p_args) + 1]; for (uint32_t i = 0; i \u0026lt; sizeof...(p_args); i++) { argptrs[i] = \u0026amp;args[i]; } //å°†æ”¶é›†çš„å‚æ•°åˆ—è¡¨ï¼Œä¼ å…¥D_METHODP()è¿›è¡ŒMDçš„åˆ›å»º return D_METHODP(p_name, sizeof...(p_args) == 0 ? nullptr : (const char *const **)argptrs, sizeof...(p_args)); } MethodDefinition D_METHODP(const char *p_name, const char *const **p_args, uint32_t p_argcount) { //å®é™…åˆ›å»ºMethodDefinitionï¼Œå¡«å…¥å‡½æ•°åç§°å’Œå‚æ•°åç§°åˆ—è¡¨ MethodDefinition md; md.name = StaticCString::create(p_name); md.args.resize(p_argcount); for (uint32_t i = 0; i \u0026lt; p_argcount; i++) { md.args.write[i] = StaticCString::create(*p_args[i]); } return md; } ClassDB::bind_method æ‰§è¡Œå‡½æ•°ç»‘å®š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 template \u0026lt;typename N, typename M, typename... VarArgs\u0026gt; static MethodBind *bind_method(N p_method_name, M p_method, VarArgs... p_args) { //åˆ›å»ºå‚æ•°åˆ—è¡¨args,åˆ©ç”¨åˆ—è¡¨åˆå§‹åŒ–å±•å¼€å‚æ•°åŒ…p_args Variant args[sizeof...(p_args) + 1] = { p_args..., Variant() }; // +1 makes sure zero sized arrays are also supported. //åˆ›å»ºå‚æ•°æŒ‡é’ˆåˆ—è¡¨argptrs const Variant *argptrs[sizeof...(p_args) + 1]; //éå†å‚æ•°åˆ—è¡¨argsï¼Œå¹¶å°†å‚æ•°æŒ‡é’ˆä¿å­˜åˆ°argptrsä¸­ for (uint32_t i = 0; i \u0026lt; sizeof...(p_args); i++) { argptrs[i] = \u0026amp;args[i]; } //åˆ›å»ºå‡½æ•°ç»‘å®šMethodBind //æ­¤å¤„æ¯”è¾ƒå¤æ‚ï¼Œæš‚æ—¶ä¸å±•å¼€ MethodBind *bind = create_method_bind(p_method); if constexpr (std::is_same_v\u0026lt;typename member_function_traits\u0026lt;M\u0026gt;::return_type, Object *\u0026gt;) { bind-\u0026gt;set_return_type_is_raw_object_ptr(true); } //å°†å‡½æ•°ç»‘å®šä¿¡æ¯çš„æ³¨å†Œåˆ°ClassDBä¸­ return bind_methodfi(METHOD_FLAGS_DEFAULT, bind, false, p_method_name, sizeof...(p_args) == 0 ? nullptr : (const Variant **)argptrs, sizeof...(p_args)); } get_method_list ä¿¡æ¯ç±» ClassInfo ClassInfoæ˜¯ClassDBä¸­å®šä¹‰çš„ç±»ä¿¡æ¯ç»“æ„ä½“ï¼Œå®ƒä¿å­˜äº†ç±»çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ç±»çš„åç§°ã€ç»§æ‰¿å…³ç³»ã€æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å±æ€§ç­‰ä¿¡æ¯ã€‚ä¸‹æ–¹æˆªå–äº†4.4ç‰ˆæœ¬godotæºç ä¸­ClassInfoç±»çš„éƒ¨åˆ†ä»£ç ï¼Œå¹¶æ ‡æ³¨äº†ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼Œå¸®åŠ©æˆ‘ä»¬å»æ•´ä½“çš„ç†è§£ClassInfoçš„è¿è¡ŒåŸç†ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæ–¹æ³•å’Œå±æ€§çš„é¡ºåºï¼Œå¹¶éä¸æºç ä¸¥æ ¼ä¸€è‡´ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 struct ClassInfo { // æ ¹æ®æ³¨å†Œçš„æ—¶æœºå’Œæ¥å£ä¸åŒï¼ŒAPIç±»å‹æœ‰ä»¥ä¸‹5ç§ï¼š // API_COREã€ // API_EDITORã€ // API_EXTENSIONã€ // API_EDITOR_EXTENSIONã€ // API_NONE APIType api = API_NONE; //çˆ¶ç±»çš„ç±»ä¿¡æ¯æŒ‡é’ˆ ClassInfo *inherits_ptr = nullptr; void *class_ptr = nullptr; //gdextensionæŒ‡é’ˆ ObjectGDExtension *gdextension = nullptr; //ç±»çš„æ–¹æ³•ä¿¡æ¯ï¼Œé”®æ˜¯æ–¹æ³•åï¼Œå€¼æ˜¯æ–¹æ³•ç»‘å®š HashMap\u0026lt;StringName, MethodBind *\u0026gt; method_map; HashMap\u0026lt;StringName, LocalVector\u0026lt;MethodBind *\u0026gt;\u0026gt; method_map_compatibility; HashMap\u0026lt;StringName, int64_t\u0026gt; constant_map; struct EnumInfo { List\u0026lt;StringName\u0026gt; constants; bool is_bitfield = false; }; HashMap\u0026lt;StringName, EnumInfo\u0026gt; enum_map; //ç±»ä¿¡å·ä¿¡æ¯ï¼Œé”®æ˜¯ä¿¡å·å HashMap\u0026lt;StringName, MethodInfo\u0026gt; signal_map; //ç±»å±æ€§ä¿¡æ¯åˆ—è¡¨ List\u0026lt;PropertyInfo\u0026gt; property_list; //ç±»å±æ€§ä¿¡æ¯ï¼Œé”®æ˜¯å±æ€§åç§°ï¼Œå€¼æ˜¯å±æ€§ä¿¡æ¯ HashMap\u0026lt;StringName, PropertyInfo\u0026gt; property_map; //ç±»å±æ€§set/getä¿¡æ¯ï¼Œé”®æ˜¯å±æ€§åç§°ï¼Œå€¼æ˜¯å±æ€§è®¾ç½®å’Œè·å–æ–¹æ³•ä¿¡æ¯ HashMap\u0026lt;StringName, PropertySetGet\u0026gt; property_setget; HashMap\u0026lt;StringName, Vector\u0026lt;uint32_t\u0026gt;\u0026gt; virtual_methods_compat; //çˆ¶ç±»åç§° StringName inherits; //è‡ªèº«ç±»å StringName name; bool disabled = false; bool exposed = false; bool reloadable = false; bool is_virtual = false; bool is_runtime = false; // The bool argument indicates the need to postinitialize. Object *(*creation_func)(bool) = nullptr; ClassInfo() {} ~ClassInfo() {} }; MethodDefinition 1 2 3 4 5 6 7 8 9 struct MethodDefinition { StringName name;//æ–¹æ³•åç§° Vector\u0026lt;StringName\u0026gt; args;//æ–¹æ³•å‚æ•°åç§°åˆ—è¡¨ MethodDefinition() {} MethodDefinition(const char *p_name) : name(p_name) {} MethodDefinition(const StringName \u0026amp;p_name) : name(p_name) {} }; MethodInfo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 struct MethodInfo { String name; PropertyInfo return_val; uint32_t flags = METHOD_FLAGS_DEFAULT; int id = 0; List\u0026lt;PropertyInfo\u0026gt; arguments; Vector\u0026lt;Variant\u0026gt; default_arguments; int return_val_metadata = 0; Vector\u0026lt;int\u0026gt; arguments_metadata; int get_argument_meta(int p_arg) const { ERR_FAIL_COND_V(p_arg \u0026lt; -1 || p_arg \u0026gt; arguments.size(), 0); if (p_arg == -1) { return return_val_metadata; } return arguments_metadata.size() \u0026gt; p_arg ? arguments_metadata[p_arg] : 0; } inline bool operator==(const MethodInfo \u0026amp;p_method) const { return id == p_method.id \u0026amp;\u0026amp; name == p_method.name; } inline bool operator\u0026lt;(const MethodInfo \u0026amp;p_method) const { return id == p_method.id ? (name \u0026lt; p_method.name) : (id \u0026lt; p_method.id); } operator Dictionary() const; static MethodInfo from_dict(const Dictionary \u0026amp;p_dict); uint32_t get_compatibility_hash() const; MethodInfo() {} explicit MethodInfo(const GDExtensionMethodInfo \u0026amp;pinfo) : name(*reinterpret_cast\u0026lt;StringName *\u0026gt;(pinfo.name)), return_val(PropertyInfo(pinfo.return_value)), flags(pinfo.flags), id(pinfo.id) { for (uint32_t j = 0; j \u0026lt; pinfo.argument_count; j++) { arguments.push_back(PropertyInfo(pinfo.arguments[j])); } const Variant *def_values = (const Variant *)pinfo.default_arguments; for (uint32_t j = 0; j \u0026lt; pinfo.default_argument_count; j++) { default_arguments.push_back(def_values[j]); } } void _push_params(const PropertyInfo \u0026amp;p_param) { arguments.push_back(p_param); } template \u0026lt;typename... VarArgs\u0026gt; void _push_params(const PropertyInfo \u0026amp;p_param, VarArgs... p_params) { arguments.push_back(p_param); _push_params(p_params...); } MethodInfo(const String \u0026amp;p_name) { name = p_name; } template \u0026lt;typename... VarArgs\u0026gt; MethodInfo(const String \u0026amp;p_name, VarArgs... p_params) { name = p_name; _push_params(p_params...); } MethodInfo(Variant::Type ret) { return_val.type = ret; } MethodInfo(Variant::Type ret, const String \u0026amp;p_name) { return_val.type = ret; name = p_name; } template \u0026lt;typename... VarArgs\u0026gt; MethodInfo(Variant::Type ret, const String \u0026amp;p_name, VarArgs... p_params) { name = p_name; return_val.type = ret; _push_params(p_params...); } MethodInfo(const PropertyInfo \u0026amp;p_ret, const String \u0026amp;p_name) { return_val = p_ret; name = p_name; } template \u0026lt;typename... VarArgs\u0026gt; MethodInfo(const PropertyInfo \u0026amp;p_ret, const String \u0026amp;p_name, VarArgs... p_params) { return_val = p_ret; name = p_name; _push_params(p_params...); } }; MethodBind MethodBindå®ç°æ¯”è¾ƒå¤æ‚ï¼Œæ­¤å¤„ä»…åˆ—å‡ºéƒ¨åˆ†æˆå‘˜å‡½æ•°å’Œæˆå‘˜å˜é‡ï¼Œç”¨äºç†è§£å®ƒçš„ä½œç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class MethodBind { int method_id; uint32_t hint_flags = METHOD_FLAGS_DEFAULT; StringName name; StringName instance_class; Vector\u0026lt;Variant\u0026gt; default_arguments; int default_argument_count = 0; int argument_count = 0; bool _static = false; bool _const = false; bool _returns = false; bool _returns_raw_obj_ptr = false; // ... } PropertyInfo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 struct PropertyInfo { Variant::Type type = Variant::NIL; String name; StringName class_name; // For classes PropertyHint hint = PROPERTY_HINT_NONE; String hint_string; uint32_t usage = PROPERTY_USAGE_DEFAULT; // If you are thinking about adding another member to this class, ask the maintainer (Juan) first. _FORCE_INLINE_ PropertyInfo added_usage(uint32_t p_fl) const { PropertyInfo pi = *this; pi.usage |= p_fl; return pi; } operator Dictionary() const; static PropertyInfo from_dict(const Dictionary \u0026amp;p_dict); PropertyInfo() {} PropertyInfo(const Variant::Type p_type, const String \u0026amp;p_name, const PropertyHint p_hint = PROPERTY_HINT_NONE, const String \u0026amp;p_hint_string = \u0026#34;\u0026#34;, const uint32_t p_usage = PROPERTY_USAGE_DEFAULT, const StringName \u0026amp;p_class_name = StringName()) : type(p_type), name(p_name), hint(p_hint), hint_string(p_hint_string), usage(p_usage) { if (hint == PROPERTY_HINT_RESOURCE_TYPE) { class_name = hint_string; } else { class_name = p_class_name; } } PropertyInfo(const StringName \u0026amp;p_class_name) : type(Variant::OBJECT), class_name(p_class_name) {} explicit PropertyInfo(const GDExtensionPropertyInfo \u0026amp;pinfo) : type((Variant::Type)pinfo.type), name(*reinterpret_cast\u0026lt;StringName *\u0026gt;(pinfo.name)), class_name(*reinterpret_cast\u0026lt;StringName *\u0026gt;(pinfo.class_name)), hint((PropertyHint)pinfo.hint), hint_string(*reinterpret_cast\u0026lt;String *\u0026gt;(pinfo.hint_string)), usage(pinfo.usage) {} bool operator==(const PropertyInfo \u0026amp;p_info) const { return ((type == p_info.type) \u0026amp;\u0026amp; (name == p_info.name) \u0026amp;\u0026amp; (class_name == p_info.class_name) \u0026amp;\u0026amp; (hint == p_info.hint) \u0026amp;\u0026amp; (hint_string == p_info.hint_string) \u0026amp;\u0026amp; (usage == p_info.usage)); } bool operator\u0026lt;(const PropertyInfo \u0026amp;p_info) const { return name \u0026lt; p_info.name; } }; PropertySetGet 1 2 3 4 5 6 7 8 struct PropertySetGet { int index;\t//å±æ€§ç´¢å¼•ï¼Œé»˜è®¤ä¸º-1ï¼Œæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ StringName setter;\t//setterå‡½æ•°å StringName getter;\t//getterå‡½æ•°å MethodBind *_setptr = nullptr; //setterå‡½æ•°åŒ…æŒ‡é’ˆ MethodBind *_getptr = nullptr; //getterå‡½æ•°åŒ…æŒ‡é’ˆ Variant::Type type;\t//å±æ€§ç±»å‹ }; ","date":"2025-11-07T09:18:31+08:00","image":"https://Liyufei1.github.io/guidao4.jpg","permalink":"https://Liyufei1.github.io/p/godot%E4%BA%94godot%E4%B8%AD%E7%9A%84%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9Frtti/","title":"ã€godotã€‘äº”ã€godotä¸­çš„åŠ¨æ€ç±»å‹ä¿¡æ¯ç³»ç»ŸRTTI"},{"content":"æ€§èƒ½åˆ†æç›¸å…³ godotä½œä¸ºç›¸å¯¹æˆç†Ÿçš„æ¸¸æˆå¼•æ“ï¼Œå…¶æœ¬èº«å°±æä¾›äº†ç›¸å¯¹å®Œå–„çš„è¿è¡Œæ—¶æ€§èƒ½ç›‘æµ‹å·¥å…·ã€‚æœ¬æ–‡å°†å¯¹å¸¸ç”¨çš„è¿è¡Œæ—¶æ€§èƒ½å‚æ•°çš„è·å–å’Œä½¿ç”¨è¿›è¡Œä¸€ä¸ªç®€æ˜“çš„è¯´æ˜ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶äº†è§£è·å–åŠç†è§£è¿™äº›å‚æ•°ã€‚\nPerformance Performanceæ˜¯godotå†…ç½®çš„æ€§èƒ½æ•°æ®å­˜å‚¨å™¨ï¼Œå®ƒæä¾›å¯¹è®¸å¤šä¸æ€§èƒ½ç›¸å…³çš„ä¸åŒç›‘è§†å™¨çš„è®¿é—®ï¼Œä¾‹å¦‚è´´å›¾å†…å­˜ä½¿ç”¨æƒ…å†µ :RENDER_BUFFER_MEM_USEDï¼ˆåœ¨glbufferDataçš„æ—¶å€™ï¼Œä¼šå¯¹ç”³è¯·çš„sizeè¿›è¡Œç´¯åŠ ï¼‰ã€ç»˜åˆ¶è°ƒç”¨:RENDER_TOTAL_DRAW_CALLS_IN_FRAME ï¼ˆgldrawçš„æ—¶å€™åŠ ä¸€ï¼‰FPSã€‚\nè¿™äº›å€¼ä¸ç¼–è¾‘å™¨çš„è°ƒè¯•å™¨é¢æ¿ä¸­çš„ç›‘è§†é€‰é¡¹å¡ä¸­æ˜¾ç¤ºçš„å€¼ç›¸åŒã€‚é€šè¿‡ä½¿ç”¨è¯¥ç±»çš„ get_monitor() æ–¹æ³•ï¼Œä½ å¯ä»¥ä»ä»£ç ä¸­è®¿é—®è¯¥æ•°æ®ã€‚\næ³¨æ„ï¼šæŸäº›å†…ç½®ç›‘è§†å™¨ä»…åœ¨è°ƒè¯•æ¨¡å¼ä¸‹å¯ç”¨ï¼Œå¹¶ä¸”åœ¨ä»¥å‘å¸ƒæ¨¡å¼å¯¼å‡ºçš„é¡¹ç›®ä¸­ä½¿ç”¨æ—¶ï¼Œå°†å§‹ç»ˆè¿”å› 0ã€‚\næ³¨æ„ï¼šå‡ºäºæ€§èƒ½åŸå› ï¼ŒæŸäº›å†…ç½®ç›‘è§†å™¨ä¸ä¼šå®æ—¶æ›´æ–°ï¼Œæ‰€ä»¥åœ¨æ›´æ”¹ä¹‹é—´å¯èƒ½ä¼šæœ‰é•¿è¾¾ 1 ç§’çš„å»¶è¿Ÿã€‚\næ³¨æ„ï¼šè‡ªå®šä¹‰ç›‘è§†å™¨ä¸æ”¯æŒè´Ÿå€¼ã€‚è´Ÿå€¼è¢«é’³åˆ¶ä¸º 0\n1 2 //Performance::TIME_FPSæ˜¯æå‰å†…ç½®çš„Monitor Performance::get_singleton()-\u0026gt;get_monitor(Performance::TIME_FPS); åç§° ä½œç”¨ TIME_FPS å¸§ç‡ï¼ˆæ¯ç§’å¸§æ•°ï¼‰ TIME_PROCESS æ¯å¸§çš„å¤„ç†æ—¶é—´ï¼ˆä¸åŒ…æ‹¬ç‰©ç†å’Œå¯¼èˆªè¿‡ç¨‹ï¼‰ï¼Œc++/Gdscript TIME_PHYSICS_PROCESS ç‰©ç†å¤„ç†çš„æ—¶é—´ MEMORY_STATIC é™æ€å†…å­˜ä½¿ç”¨é‡ï¼ˆä¸åŒ…æ‹¬åŠ¨æ€å†…å­˜ï¼‰ MEMORY_STATIC_MAX é™æ€å†…å­˜çš„æœ€å¤§ä½¿ç”¨é‡ MEMORY_MESSAGE_BUFFER_MAX æ¶ˆæ¯ç¼“å†²åŒºçš„æœ€å¤§å†…å­˜ä½¿ç”¨é‡ OBJECT_COUNT å½“å‰åœºæ™¯ä¸­çš„æ€»å¯¹è±¡æ•° OBJECT_RESOURCE_COUNT å½“å‰åœºæ™¯ä¸­èµ„æºçš„æ•°é‡ OBJECT_NODE_COUNT å½“å‰åœºæ™¯ä¸­èŠ‚ç‚¹çš„æ•°é‡ OBJECT_ORPHAN_NODE_COUNT å­¤ç«‹èŠ‚ç‚¹çš„æ•°é‡ï¼ˆæ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰ RENDER_TOTAL_OBJECTS_IN_FRAME æ¯å¸§æ¸²æŸ“çš„æ€»å¯¹è±¡æ•°é‡ RENDER_TOTAL_PRIMITIVES_IN_FRAME æ¯å¸§æ¸²æŸ“çš„æ€»å›¾å½¢åŸè¯­æ•°é‡ï¼ˆå¦‚ä¸‰è§’å½¢ã€çº¿æ¡ï¼‰ RENDER_TOTAL_DRAW_CALLS_IN_FRAME æ¯å¸§æ¸²æŸ“çš„æ€»ç»˜åˆ¶è°ƒç”¨æ¬¡æ•° RENDER_TEXTURE_MEM_USED æ¸²æŸ“ä½¿ç”¨çš„çº¹ç†å†…å­˜é‡ RENDER_BUFFER_MEM_USED æ¸²æŸ“ä½¿ç”¨çš„ç¼“å†²åŒºå†…å­˜é‡ MEMORY_STATIC Performanceä¸­çš„é™æ€å†…å­˜æ•°æ®ï¼ŒåŒ…å«äº†godotä½“ç³»ä¸‹çš„æ‰€æœ‰ç”¨æˆ·ç”³è¯·çš„å†…å­˜ï¼Œä¹Ÿå³Variantä¸­è¢«æ ‡æ³¨çš„å˜é‡ã€‚\n**æ³¨æ„ï¼š**cppåŸç”Ÿç±»å‹ç”³è¯·çš„å†…å­˜ç©ºé—´å¹¶ä¸ä¼šè¢«ç»Ÿè®¡è¿›å»ã€‚\nè¯¥æ•°æ®è¢«å®é™…å­˜å‚¨åœ¨Memaryç±»ä¸­ï¼Œå‡ºäºçº¿ç¨‹å®‰å…¨è€ƒè™‘ï¼Œå®ƒè¢«åŒ…è£…åœ¨ä¸€ä¸ªåŸå­ç±»å‹ä¸­ï¼š\nRENDER_TEXTURE_MEM_USED åœ¨glæ¸²æŸ“æ¨¡å¼ä¸‹ï¼Œç”±äºå¹¶æ²¡æœ‰RenderDeviceå±‚ï¼Œéƒ½æ˜¯ç›´æ¥ä½¿ç”¨çš„glæ¥å£ï¼Œå› æ­¤æ•°æ®çš„è®°å½•ç›¸å¯¹æ›´åŠ ç›´æ¥ã€‚\nperformancceä¸­è®¿é—®çš„RENDER_TEXTURE_MEM_USEDæ˜¯é€šè¿‡**RenderingServeræä¾›çš„get_rendering_info**æ¥å£æ¥è·å–çš„ã€‚\nåœ¨å¾€ä¸‹èµ°å°±æ˜¯RGS::RendererUtilitiesæä¾›çš„**get_rendering_info**æ¥å£ï¼Œåœ¨Utilitiesä¸­ï¼Œç®¡ç†ç€glç”³è¯·å‡ºæ¥çš„æ‰€æœ‰å†…å­˜ã€‚\nåœ¨æ¯ä¸€æ¬¡ç”³è¯·å’Œåˆ é™¤æ¸²æŸ“glå†…å­˜æ—¶ï¼ŒUtilitieséƒ½ä¼šå¯¹å†…å­˜å¤§å°çš„ç»Ÿè®¡æ•°å­—åšå‡ºç›¸åº”çš„å¢å‡ã€‚\næˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„èµ„æºæ³„éœ²æŠ¥é”™ï¼Œå°±æ¥è‡ªäºUtilitiesçš„ææ„å‡½æ•°ã€‚\nå½“Utilitieså‘ç”Ÿææ„æ—¶ï¼Œå¦‚æœglç”³è¯·çš„å†…å­˜æœªè¢«å®Œå…¨é‡Šæ”¾ï¼Œå°±ä¼šæ‰“å°è¯¥æ¡æŠ¥é”™æ—¥å¿—ã€‚ï¼ˆå¸¸ç”±äºå­¤ç«‹èŠ‚ç‚¹æœªè¢«æ­£ç¡®é‡Šæ”¾å¯¼è‡´ï¼‰\nRENDER_TOTAL_DRAW_CALLS_IN_FRAME performancceä¸­è®¿é—®çš„RENDER_TOTAL_DRAW_CALLS_IN_FRAMEä¹Ÿæ˜¯é€šè¿‡**RenderingServeræä¾›çš„get_rendering_infoæ¥å£æ¥è·å–çš„ã€‚è€ŒRenderingServeræŸ¥è¯¢çš„æ•°æ®ï¼Œåˆ™æ¥è‡ªRendererViewport**çš„total_draw_calls_usedã€‚\nRendererViewportä¸­è¿™ç»„æ•°æ®ï¼Œåˆ™æ˜¯åœ¨ç»˜åˆ¶é˜¶æ®µdraw_viewports()æ—¶ï¼Œæ”¶é›†ç´¯åŠ æ¿€æ´»çŠ¶æ€çš„Viewportä¸­çš„render_infoä¸­çš„æ•°æ®ã€‚\nå¯¹äºæ¯ä¸ªæ¿€æ´»çš„Viewportä¸­çš„drawcallï¼Œä¼šåœ¨glå…‰æ …åŒ–çš„é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯å®é™…è°ƒç”¨glç»˜åˆ¶å‡½æ•°çš„æ—¶å€™ï¼Œè¿›è¡Œä¸€æ¬¡å¢åŠ ã€‚\n**æ³¨æ„ï¼š**åŸºäºè¿™ä¸€ç‚¹ï¼Œæ‰‹åŠ¨è°ƒç”¨çš„ç»˜åˆ¶æ“ä½œglDrawElementsç­‰ï¼Œä¸ä¼šè¢«ç»Ÿè®¡è¿›godotçš„Drawcallä¸­ã€‚å› æ­¤åº”å°½é‡é¿å…glç›¸å…³å‡½æ•°çš„ç›´æ¥è°ƒç”¨ã€‚è€Œåº”è¯¥é€šè¿‡godotçš„å°è£…å±‚RenderingServeræ¥è°ƒç”¨ã€‚\nRenderingServer Godotå½“ä¸­çš„RenderingServerç›¸å½“äºUnrealä¸­çš„RHIï¼Œå®ƒæ˜¯åº•å±‚çš„æ¸²æŸ“æŠ½è±¡å±‚ï¼Œè´Ÿè´£ä¸å›¾å½¢ APIï¼ˆå¦‚ OpenGLã€Vulkanã€DirectXã€Metal ç­‰ï¼‰äº¤äº’ã€‚\nåŒæ—¶å®ƒä¹Ÿå­˜å‚¨äº†æ¸²æŸ“ç›¸å…³çš„æ•°æ®ï¼Œå¹¶ä¸”æä¾›äº†å¯¹åº”çš„è·å–æ¥å£ã€‚\nget_rendering_info get_rendering_infoå¯ä»¥æŸ¥è¯¢æ¸²æŸ“ç»˜åˆ¶ç›¸å…³çš„ä¿¡æ¯ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š\nåç§° è¯´æ˜ RENDERING_INFO_TOTAL_OBJECTS_IN_FRAME ç»˜åˆ¶å¯¹è±¡æ•°é‡ RENDERING_INFO_TOTAL_PRIMITIVES_IN_FRAME ç»˜åˆ¶å›¾å…ƒæ•°é‡ RENDERING_INFO_TOTAL_DRAW_CALLS_IN_FRAME DrawCall RENDERING_INFO_TEXTURE_MEM_USED è´´å›¾å†…å­˜ RENDERING_INFO_BUFFER_MEM_USED glbuffer RENDERING_INFO_VIDEO_MEM_USED RENDERING_INFO_PIPELINE_COMPILATIONS_CANVAS æ¸²æŸ“ç®¡çº¿ï¼ˆPipelineï¼‰ç¼–è¯‘çš„æ¬¡æ•° RENDERING_INFO_PIPELINE_COMPILATIONS_MESH RENDERING_INFO_PIPELINE_COMPILATIONS_SURFACE RENDERING_INFO_PIPELINE_COMPILATIONS_DRAW RENDERING_INFO_PIPELINE_COMPILATIONS_SPECIALIZATION viewport_get_render_info ä¸ä¸Šæ–¹æ¥å£å·®ä¸å¤šï¼Œä½†æ˜¯é’ˆå¯¹æŸä¸ªè§†å£ï¼Œè€Œéæ‰€æœ‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 enum ViewportRenderInfo { VIEWPORT_RENDER_INFO_OBJECTS_IN_FRAME, VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME, VIEWPORT_RENDER_INFO_DRAW_CALLS_IN_FRAME, VIEWPORT_RENDER_INFO_MAX, }; enum ViewportRenderInfoType { VIEWPORT_RENDER_INFO_TYPE_VISIBLE, VIEWPORT_RENDER_INFO_TYPE_SHADOW, VIEWPORT_RENDER_INFO_TYPE_CANVAS, VIEWPORT_RENDER_INFO_TYPE_MAX }; virtual int viewport_get_render_info(RID p_viewport, ViewportRenderInfoType p_type, ViewportRenderInfo p_info) = 0; Rander GPU and CPU Time æ³¨æ„ï¼Œéœ€è¦åˆ©ç”¨ä¸‹é¢ä¸¤ä¸ªæ¥å£æ—¶ï¼Œéœ€è¦åˆ©ç”¨viewport_set_measure_render_time()æ¥å£æå‰å¼€å¯æ—¶é—´ç»Ÿè®¡ï¼Œå¦åˆ™å§‹ç»ˆè¿”å›0.\nviewport_get_measured_render_time_cpuï¼ŒCPU åœ¨æŒ‡å®š Viewport ä¸Šæ‰§è¡Œæ¸²æŸ“çš„è€—æ—¶ viewport_get_measured_render_time_gpuï¼ŒGPU åœ¨æŒ‡å®š Viewport ä¸Šæ‰§è¡Œæ¸²æŸ“çš„è€—æ—¶ get_frame_setup_time_cpu å‡†å¤‡æ¸²æŸ“å‘½ä»¤ é˜¶æ®µæ‰€æ¶ˆè€—çš„æ—¶é—´ åœºæ™¯å‰”é™¤ï¼ˆCullingï¼‰ æ¸²æŸ“å¯¹è±¡æ’åº å…‰æºä¸é˜´å½±çš„åˆ†é… æè´¨/æ¸²æŸ“çŠ¶æ€è®¾ç½® å°†æ¸²æŸ“æ•°æ®å†™å…¥å‘½ä»¤ç¼“å†²ï¼ˆcommand bufferï¼‰ time .get_ticks_usec()è·å–godotä¸»çº¿ç¨‹æ—¶é—´\nRenderingDevice(glä¸æ”¯æŒ) RENDER_TIMESTAMP å…¶å®æ˜¯å¼•æ“æ¸²æŸ“ç®¡çº¿é‡Œçš„ä¸€ç±» GPU æ—¶é—´æˆ³ (Timestamp) æ ‡è®°ã€‚\né€šè¿‡**RenderingDevice**å¯ä»¥è·å–æŸä¸ªé˜¶æ®µçš„æ—¶é—´æˆ³ã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #include \u0026lt;godot_cpp/classes/rendering_server.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/rendering_device.hpp\u0026gt; using namespace godot; void dump_gpu_pass_times_ms() { Ref\u0026lt;RenderingDevice\u0026gt; rd = RenderingServer::get_singleton()-\u0026gt;get_rendering_device(); if (rd.is_null()) return; const uint32_t count = rd-\u0026gt;get_captured_timestamps_count(); // é‡‡é›†åˆ°çš„æ ‡ç­¾æ•° const uint64_t frame = rd-\u0026gt;get_captured_timestamps_frame(); // å¯¹åº”çš„å¸§å·ï¼ˆå¯é€‰ï¼‰ for (uint32_t i = 0; i \u0026lt; count; i++) { String name = rd-\u0026gt;get_captured_timestamp_name(i); // ä¾‹å¦‚ \u0026#34;Depth Prepass\u0026#34; double gpu_ms = rd-\u0026gt;get_captured_timestamp_gpu_time(i) / 1e6; // çº³ç§’â†’æ¯«ç§’ double cpu_ms = rd-\u0026gt;get_captured_timestamp_cpu_time(i) / 1e6; // ä½ å¯ä»¥ç­›é€‰/é‡å‘½å/ç´¯åŠ åˆ°è‡ªå·±çš„ç»Ÿè®¡é‡Œ UtilityFunctions::print(vformat(\u0026#34;[%s] GPU %.3f ms, CPU %.3f ms (frame %d)\u0026#34;, name, gpu_ms, cpu_ms, (int)frame)); } } godott-benchmark godott-benchmarkæ˜¯godotå®˜æ–¹æä¾›çš„æµ‹è¯•å·¥ç¨‹ï¼Œå®ƒå¯ä»¥é’ˆå¯¹ä¸åŒèŠ¯ç‰‡ï¼Œæµ‹è¯•å½“å‰godotç‰ˆæœ¬çš„å„é¡¹åŠŸèƒ½è€—æ—¶ã€‚\nå¯ä»¥åˆ©ç”¨å®ƒä½œä¸ºæ€§èƒ½åŸºå‡†ã€‚\næ¸²æŸ“CPUï¼šæ¸²æŸ“æ¯å¸§æ‰€èŠ±è´¹çš„å¹³å‡CPUæ—¶é—´ï¼ˆä¾‹å¦‚è®¾ç½®ç»˜åˆ¶è°ƒç”¨ï¼‰ã€‚è¿™ä¸ªåº¦é‡ä¸è€ƒè™‘è¿‡ç¨‹/ç‰©ç†è¿‡ç¨‹åŠŸèƒ½ã€‚ æ¸²æŸ“GPUï¼šæ¯å¸§å¹³å‡èŠ±è´¹çš„GPUæ—¶é—´ã€‚ ç©ºé—²ï¼šc++å’ŒGDScriptè¿›ç¨‹å‡½æ•°æ¯ç§’æ‰€èŠ±è´¹çš„å¹³å‡CPUæ—¶é—´ã€‚ ç‰©ç†ï¼šæ¯ç§’åœ¨c++å’ŒGDScriptç‰©ç†å¤„ç†å‡½æ•°ä¸­èŠ±è´¹çš„å¹³å‡CPUæ—¶é—´ã€‚ ä¸»çº¿ç¨‹æ—¶é—´ï¼šåœ¨ä¸»çº¿ç¨‹ä¸Šè®¾ç½®åœºæ™¯æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚å¯¹äºæ¸²æŸ“åŸºå‡†æµ‹è¯•ï¼Œå®ƒä½œä¸ºåŠ è½½æ—¶é—´åº¦é‡ã€‚ ","date":"2025-11-05T09:18:31+08:00","image":"https://Liyufei1.github.io/guidao4.jpg","permalink":"https://Liyufei1.github.io/p/godot%E5%9B%9B%E6%80%A7%E8%83%BD%E7%BB%9F%E8%AE%A1/","title":"ã€godotã€‘å››ã€æ€§èƒ½ç»Ÿè®¡"},{"content":"ä¸€ã€SRCç¼–å†™ Godotä¸­ä¸æ¨èä½¿ç”¨#pragma onceï¼Œè€Œæ˜¯æ¨èä½¿ç”¨**#ifndef**çš„æ–¹å¼ï¼Œæ¥ä¿è¯å¤´æ–‡ä»¶çš„å•æ¬¡å¼•ç”¨ï¼Œå‚è€ƒä¸‹æ–¹è¡Œ1ã€‚ ç±»å†…ç¬¬ä¸€è¡Œï¼Œå¿…é¡»æ‰“ä¸ŠGodotçš„å¯¹åº”å®GDCLASS(SelfClass,BaseClass)ï¼Œå‚è€ƒä¸‹æ–¹è¡Œ12ã€‚ å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å‡½æ•°ï¼Œéœ€è¦åœ¨**_bind_methods**ä¸­ç”¨ ClassDB::bind_methodè¿›è¡Œç»‘å®šï¼Œå‚è€ƒè¡Œ178ã€179 å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å±æ€§ï¼Œéœ€è¦åœ¨**_bind_methodsä¸­ç”¨ADD_PROPERTY**è¿›è¡Œç»‘å®šï¼Œå‚è€ƒè¡Œ181ã€182ã€183 å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„æšä¸¾ï¼Œéœ€è¦ç”¨VARIANT_ENUM_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_ENUM_CONSTANT**è¿›è¡Œæ³¨å†Œï¼Œå‚è€ƒè¡Œï¼š63ã€166ã€199 å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„ä½åŸŸï¼Œéœ€è¦ç”¨VARIANT_BITFIELD_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_BITFIELD_FLAG**è¿›è¡Œæ³¨å†Œï¼Œå‚è€ƒè¡Œï¼š64ã€171ã€203 å¯¹äºéœ€è¦ä¿¡å·ï¼ˆå›è°ƒï¼‰ï¼Œéœ€è¦ç”¨ADD_SIGNALæ³¨å†Œå¹¶ç”¨emit_signalå‘é€ï¼Œä»¥åŠå¯ä»¥ç”¨connectç»‘å®šï¼Œå‚è€ƒè¡Œï¼š78ã€100ã€176 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum ETest{ None, Enum1, Enum2, Num }; enum EFlag{ FlagNone = 0, Flag1 = 1 \u0026lt;\u0026lt; 0, Flag2 = 1 \u0026lt;\u0026lt; 1, Flag3 = 1 \u0026lt;\u0026lt; 2, }; public: Test(); ~Test(); void StartTest(); void StartTest2(); int GetIValue(); void SetIValue(int input); float GetFValue(); void SetFValue(float input); String GetSValue(); void SetSValue(String input); Ref\u0026lt;Texture2D\u0026gt; GetTValue(); void SetTValue(Ref\u0026lt;Texture2D\u0026gt; input); ETest GetEValue(); void SetEValue(ETest input); BitField\u0026lt;EFlag\u0026gt; GetFlagValue(); void SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input); protected: static void _bind_methods(); private: int IValue = 0; float FValue = 0.0f; String SValue = \u0026#34;Hello\u0026#34;; Ref\u0026lt;Texture2D\u0026gt; TValue; ETest EValue = ETest::None; BitField\u0026lt;EFlag\u0026gt; flag = EFlag::FlagNone; }; VARIANT_ENUM_CAST(Test::ETest); VARIANT_BITFIELD_CAST(Test::EFlag); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; Test::Test() { connect(\u0026#34;ready\u0026#34;,Callable(this,\u0026#34;StartTest2\u0026#34;)); } Test::~Test() { } void Test::StartTest() { UtilityFunctions::print(\u0026#34;AAAAAAAAAAAAAAAA\u0026#34;); Ref\u0026lt;ImageTexture\u0026gt; AA(memnew(ImageTexture)); UtilityFunctions::print(\u0026#34;AAAAAAAAAAAAAAAA:\u0026#34;,AA-\u0026gt;get_reference_count()); auto format = AA-\u0026gt;get_format(); Ref\u0026lt;ImageTexture\u0026gt; BB = AA; UtilityFunctions::print(\u0026#34;AAAAAAAAAAAAAAAA:\u0026#34;,AA-\u0026gt;get_reference_count()); } void Test::StartTest2() { UtilityFunctions::print(\u0026#34;BBBBBBBBBBBBBBB:\u0026#34;,IValue); emit_signal(\u0026#34;HelloSignal\u0026#34;,\u0026#34;CCCCCCCCCCCCCCCCCCC\u0026#34;); // UtilityFunctions::print(\u0026#34;BBBBBBBBBBBBBBB:\u0026#34;,IValue,\u0026#34;---\u0026#34;,FValue,\u0026#34;---\u0026#34;,SValue,\u0026#34;---\u0026#34;,TValue-\u0026gt;get_name()); } int Test::GetIValue() { return IValue; } void Test::SetIValue(int input) { IValue = input; } float Test::GetFValue() { return FValue; } void Test::SetFValue(float input) { FValue = input; } String Test::GetSValue() { return SValue; } void Test::SetSValue(String input) { SValue = input; } Ref\u0026lt;Texture2D\u0026gt; Test::GetTValue() { return TValue; } void Test::SetTValue(Ref\u0026lt;Texture2D\u0026gt; input) { TValue = input; } Test::ETest Test::GetEValue() { return EValue; } void Test::SetEValue(ETest input) { EValue = input; } BitField\u0026lt;Test::EFlag\u0026gt; Test::GetFlagValue() { return flag; } void Test::SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input) { flag = input; } void Test::_bind_methods() { BIND_ENUM_CONSTANT(None); BIND_ENUM_CONSTANT(Enum1); BIND_ENUM_CONSTANT(Enum2); BIND_ENUM_CONSTANT(Num); BIND_BITFIELD_FLAG(FlagNone); BIND_BITFIELD_FLAG(Flag1); BIND_BITFIELD_FLAG(Flag2); BIND_BITFIELD_FLAG(Flag3); ADD_SIGNAL(MethodInfo(\u0026#34;HelloSignal\u0026#34;,PropertyInfo(Variant::STRING,\u0026#34;message\u0026#34;))); ClassDB::bind_method(D_METHOD(\u0026#34;StartTest\u0026#34;),\u0026amp;Test::StartTest); ClassDB::bind_method(D_METHOD(\u0026#34;StartTest2\u0026#34;),\u0026amp;Test::StartTest2); ClassDB::bind_method(D_METHOD(\u0026#34;GetIValue\u0026#34;),\u0026amp;Test::GetIValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetIValue\u0026#34;,\u0026#34;IValue\u0026#34;),\u0026amp;Test::SetIValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;IValue\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetFValue\u0026#34;),\u0026amp;Test::GetFValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFValue\u0026#34;,\u0026#34;FValue\u0026#34;),\u0026amp;Test::SetFValue); ADD_PROPERTY(PropertyInfo(Variant::FLOAT,\u0026#34;FValue\u0026#34;),\u0026#34;SetFValue\u0026#34;,\u0026#34;GetFValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetSValue\u0026#34;),\u0026amp;Test::GetSValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetSValue\u0026#34;,\u0026#34;SValue\u0026#34;),\u0026amp;Test::SetSValue); ADD_PROPERTY(PropertyInfo(Variant::STRING,\u0026#34;SValue\u0026#34;),\u0026#34;SetSValue\u0026#34;,\u0026#34;GetSValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetTValue\u0026#34;),\u0026amp;Test::GetTValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetTValue\u0026#34;,\u0026#34;TValue\u0026#34;),\u0026amp;Test::SetTValue); ADD_PROPERTY(PropertyInfo(Variant::OBJECT,\u0026#34;TValue\u0026#34;,PROPERTY_HINT_RESOURCE_TYPE,\u0026#34;Texture2D\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetEValue\u0026#34;),\u0026amp;Test::GetEValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetEValue\u0026#34;,\u0026#34;EValue\u0026#34;),\u0026amp;Test::SetEValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;EValue\u0026#34;,PROPERTY_HINT_ENUM,\u0026#34;None , Enum1 , Enum2\u0026#34;),\u0026#34;SetEValue\u0026#34;,\u0026#34;GetEValue\u0026#34;); ClassDB::bind_method(D_METHOD(\u0026#34;GetFlagValue\u0026#34;),\u0026amp;Test::GetFlagValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFlagValue\u0026#34;,\u0026#34;flag\u0026#34;),\u0026amp;Test::SetFlagValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;flag\u0026#34;,PROPERTY_HINT_FLAGS,\u0026#34;FlagNone , Flag1 , Flag2 , Flag3\u0026#34;),\u0026#34;SetFlagValue\u0026#34;,\u0026#34;GetFlagValue\u0026#34;); } ï¼ˆä¸€ï¼‰å‡½æ•°æš´éœ² â€‹\tå¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å‡½æ•°ï¼Œéœ€è¦åœ¨**_bind_methods**ä¸­ç”¨ ClassDB::bind_methodè¿›è¡Œç»‘å®š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: void StartTest(); protected: static void _bind_methods(); }; #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; void Test::StartTest() { UtilityFunctions::print(\u0026#34;StartTest:1111); } void Test::_bind_methods() { ClassDB::bind_method(D_METHOD(\u0026#34;StartTest\u0026#34;),\u0026amp;Test::StartTest); } ï¼ˆäºŒï¼‰å±æ€§æš´éœ² å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„å±æ€§ï¼Œéœ€è¦åœ¨**_bind_methodsä¸­ç”¨ADD_PROPERTYè¿›è¡Œç»‘å®šï¼ŒåŒæ—¶éœ€è¦æš´éœ²å®ƒå¯¹åº”çš„Getå’ŒSet**æ–¹æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum ETest{ None, Enum1, Enum2, Num }; enum EFlag{ FlagNone = 0, Flag1 = 1 \u0026lt;\u0026lt; 0, Flag2 = 1 \u0026lt;\u0026lt; 1, Flag3 = 1 \u0026lt;\u0026lt; 2, }; public: int GetIValue(); void SetIValue(int input); Ref\u0026lt;Texture2D\u0026gt; GetTValue(); void SetTValue(Ref\u0026lt;Texture2D\u0026gt; input); ETest GetEValue(); void SetEValue(ETest input); BitField\u0026lt;EFlag\u0026gt; GetFlagValue(); void SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input); protected: static void _bind_methods(); private: int IValue = 0; Ref\u0026lt;Texture2D\u0026gt; TValue; ETest EValue = ETest::None; BitField\u0026lt;EFlag\u0026gt; flag = EFlag::FlagNone; }; VARIANT_ENUM_CAST(Test::ETest); VARIANT_BITFIELD_CAST(Test::EFlag); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; int Test::GetIValue() { return IValue; } void Test::SetIValue(int input) { IValue = input; } Ref\u0026lt;Texture2D\u0026gt; Test::GetTValue() { return TValue; } void Test::SetTValue(Ref\u0026lt;Texture2D\u0026gt; input) { TValue = input; } Test::ETest Test::GetEValue() { return EValue; } void Test::SetEValue(ETest input) { EValue = input; } BitField\u0026lt;Test::EFlag\u0026gt; Test::GetFlagValue() { return flag; } void Test::SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input) { flag = input; } void Test::_bind_methods() { //intå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetIValue\u0026#34;),\u0026amp;Test::GetIValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetIValue\u0026#34;,\u0026#34;IValue\u0026#34;),\u0026amp;Test::SetIValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;IValue\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); //èµ„æºå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetTValue\u0026#34;),\u0026amp;Test::GetTValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetTValue\u0026#34;,\u0026#34;TValue\u0026#34;),\u0026amp;Test::SetTValue); ADD_PROPERTY(PropertyInfo(Variant::OBJECT,\u0026#34;TValue\u0026#34;,PROPERTY_HINT_RESOURCE_TYPE,\u0026#34;Texture2D\u0026#34;),\u0026#34;SetIValue\u0026#34;,\u0026#34;GetIValue\u0026#34;); //æšä¸¾å˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetEValue\u0026#34;),\u0026amp;Test::GetEValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetEValue\u0026#34;,\u0026#34;EValue\u0026#34;),\u0026amp;Test::SetEValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;EValue\u0026#34;,PROPERTY_HINT_ENUM,\u0026#34;None , Enum1 , Enum2\u0026#34;),\u0026#34;SetEValue\u0026#34;,\u0026#34;GetEValue\u0026#34;); //ä½åŸŸå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetFlagValue\u0026#34;),\u0026amp;Test::GetFlagValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFlagValue\u0026#34;,\u0026#34;flag\u0026#34;),\u0026amp;Test::SetFlagValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;flag\u0026#34;,PROPERTY_HINT_FLAGS,\u0026#34;FlagNone , Flag1 , Flag2 , Flag3\u0026#34;),\u0026#34;SetFlagValue\u0026#34;,\u0026#34;GetFlagValue\u0026#34;); } ï¼ˆä¸‰ï¼‰æšä¸¾ å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„æšä¸¾ï¼Œéœ€è¦ç”¨VARIANT_ENUM_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_ENUM_CONSTANT**è¿›è¡Œæ³¨å†Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum ETest{ None, Enum1, Enum2, Num }; public: ETest GetEValue(); void SetEValue(ETest input); protected: static void _bind_methods(); private: ETest EValue = ETest::None; }; VARIANT_ENUM_CAST(Test::ETest); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; Test::ETest Test::GetEValue() { return EValue; } void Test::SetEValue(ETest input) { EValue = input; } void Test::_bind_methods() { BIND_ENUM_CONSTANT(None); BIND_ENUM_CONSTANT(Enum1); BIND_ENUM_CONSTANT(Enum2); BIND_ENUM_CONSTANT(Num); //æšä¸¾å˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetEValue\u0026#34;),\u0026amp;Test::GetEValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetEValue\u0026#34;,\u0026#34;EValue\u0026#34;),\u0026amp;Test::SetEValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;EValue\u0026#34;,PROPERTY_HINT_ENUM,\u0026#34;None , Enum1 , Enum2\u0026#34;),\u0026#34;SetEValue\u0026#34;,\u0026#34;GetEValue\u0026#34;); } ï¼ˆå››ï¼‰ä½åŸŸ å¯¹äºéœ€è¦æš´éœ²åˆ°è„šæœ¬çš„ä½åŸŸï¼Œéœ€è¦ç”¨VARIANT_BITFIELD_CASTä»¥åŠåœ¨**_bind_methodsä¸­ç”¨BIND_BITFIELD_FLAG**è¿›è¡Œæ³¨å†Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: enum EFlag{ FlagNone = 0, Flag1 = 1 \u0026lt;\u0026lt; 0, Flag2 = 1 \u0026lt;\u0026lt; 1, Flag3 = 1 \u0026lt;\u0026lt; 2, }; public: BitField\u0026lt;EFlag\u0026gt; GetFlagValue(); void SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input); protected: static void _bind_methods(); private: BitField\u0026lt;EFlag\u0026gt; flag = EFlag::FlagNone; }; VARIANT_BITFIELD_CAST(Test::EFlag); #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/image_texture.hpp\u0026gt; BitField\u0026lt;Test::EFlag\u0026gt; Test::GetFlagValue() { return flag; } void Test::SetFlagValue(BitField\u0026lt;EFlag\u0026gt; input) { flag = input; } void Test::_bind_methods() { BIND_BITFIELD_FLAG(FlagNone); BIND_BITFIELD_FLAG(Flag1); BIND_BITFIELD_FLAG(Flag2); BIND_BITFIELD_FLAG(Flag3); //ä½åŸŸå˜é‡ ClassDB::bind_method(D_METHOD(\u0026#34;GetFlagValue\u0026#34;),\u0026amp;Test::GetFlagValue); ClassDB::bind_method(D_METHOD(\u0026#34;SetFlagValue\u0026#34;,\u0026#34;flag\u0026#34;),\u0026amp;Test::SetFlagValue); ADD_PROPERTY(PropertyInfo(Variant::INT,\u0026#34;flag\u0026#34;,PROPERTY_HINT_FLAGS,\u0026#34;FlagNone , Flag1 , Flag2 , Flag3\u0026#34;),\u0026#34;SetFlagValue\u0026#34;,\u0026#34;GetFlagValue\u0026#34;); } ï¼ˆäº”ï¼‰ä¿¡å·/å›è°ƒ 1ã€ADD_SIGNAL å¯¹äºéœ€è¦ä¿¡å·ï¼ˆå›è°ƒï¼‰ï¼Œéœ€è¦ç”¨ADD_SIGNALæ³¨å†Œå¹¶ç”¨emit_signalå‘é€ï¼Œä»¥åŠå¯ä»¥ç”¨connectç»‘å®š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 //----------------å¤´æ–‡ä»¶---------------- #ifndef TEST_H #define TEST_H #include \u0026lt;godot_cpp/classes/node3d.hpp\u0026gt; #include \u0026lt;godot_cpp/classes/texture2d.hpp\u0026gt; using namespace godot; class Test : public Node3D { GDCLASS(Test,Node3D) public: void StartTest2(); protected: static void _bind_methods(); }; #endif //----------------æºæ–‡ä»¶---------------- #include \u0026#34;Test.h\u0026#34; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/variant/utility_functions.hpp\u0026gt; Test::Test() { connect(\u0026#34;ready\u0026#34;,Callable(this,\u0026#34;StartTest2\u0026#34;)); } void Test::StartTest2() { UtilityFunctions::print(\u0026#34;BBBBBBBBBBBBBBB:\u0026#34;,IValue); emit_signal(\u0026#34;HelloSignal\u0026#34;,\u0026#34;CCCCCCCCCCCCCCCCCCC\u0026#34;); } void Test::_bind_methods() { ADD_SIGNAL(MethodInfo(\u0026#34;HelloSignal\u0026#34;,PropertyInfo(Variant::STRING,\u0026#34;message\u0026#34;))); } 2ã€call_deferred 1 2 this-\u0026gt;call_deferred(\u0026#34;method_name\u0026#34;, arg1, arg2); //æ³¨æ„method_nameæ–¹æ³•éœ€è¦è¢«æ³¨å†Œè¿‡æ‰èƒ½æ­£ç¡®è°ƒç”¨ äºŒã€å¸¸ç”¨å‡½æ•° ï¼ˆä¸€ï¼‰å¼•ç”¨è®¡æ•°ã€memnewã€memdelete 1 2 3 4 5 6 7 //godotå¯¹äºå†…å­˜ç®¡ç†æœ‰è‡ªå·±çš„å°è£…ï¼Œæ‰€ä»¥å¯¹äºéåŸç”Ÿç±»ï¼Œéœ€è¦ç”¨å®ƒå®šä¹‰çš„åˆ›å»º/åˆ é™¤æ–¹æ³•ã€‚ memnew(ImageTexture); memdelete(); //ä¸€èˆ¬ä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥æ§åˆ¶èµ„æºç”Ÿå‘½å‘¨æœŸï¼Œè€Œéæ‰‹åŠ¨ç®¡ç† Ref\u0026lt;ImageTexture\u0026gt; AA(memnew(ImageTexture)); UtilityFunctions::print(\u0026#34;reference count:\u0026#34;,AA-\u0026gt;get_reference_count()); ï¼ˆäºŒï¼‰è®¡æ—¶å™¨ 1ã€Timer\n2ã€Tween\nè½»é‡åŒ–çš„è®¡æ—¶å™¨ï¼Œgodotä¼šè‡ªåŠ¨å›æ”¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // å¤‡æ³¨ï¼šæ²¡æœ‰å†…å­˜æ³„æ¼é£é™©ã€‚Refè‡ªåŠ¨ç®¡ç†äº†å†…å­˜ Ref\u0026lt;Tween\u0026gt; tween = create_tween(); double Index = Duration / (2.0f * Times); // Timesæ˜¯é—ªçƒæ¬¡æ•°ä¹Ÿæ˜¯å¾ªç¯æ¬¡æ•°ï¼ŒIndexæ˜¯é—ªçƒé—´éš” for (int i = 0; i \u0026lt; Times; i++) { tween-\u0026gt;tween_property(this, \u0026#34;modulate:a\u0026#34;, 0.0f, Index); tween-\u0026gt;tween_property(this, \u0026#34;modulate:a\u0026#34;, 1.0f, Index); } if (true) { tween-\u0026gt;tween_property(this, \u0026#34;modulate:a\u0026#34;, 0.0f, Index); } tween-\u0026gt;set_trans(Tween::TRANS_LINEAR); ä¸‰ã€ç¼–è¾‘å™¨3Då°å·¥å…·æ’ä»¶Gizmo Gizmoæ˜¯godotè‡ªå¸¦çš„ç¼–è¾‘å™¨ç•Œé¢çš„3Då°å·¥å…·ã€‚\nå®ƒæ˜¯é™„åŠ å¼çš„ï¼Œå³ä¸ä¼šå½±å“åŸèŠ‚ç‚¹ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šè¢«åŸèŠ‚ç‚¹æ‰€æ„ŸçŸ¥ æ”¯æŒç‚¹ã€çº¿ã€ç½‘æ ¼çš„ç»˜åˆ¶ æ”¯æŒç‚¹å‡»å’Œæ‹–æ‹½äº‹ä»¶ è¯¥åŠŸèƒ½ä¸»è¦ç”±ï¼šæ§åˆ¶å™¨EditorNode3DGizmoPluginï¼Œç»„ä»¶EditorNode3DGizmoã€‚ä¸¤å¤§éƒ¨åˆ†ç»„æˆã€‚ä½†éœ€è¦ä½¿ç”¨çš„è¯ï¼Œå°±éœ€è¦åœ¨ç»Ÿä¸€çš„æ’ä»¶ç®¡ç†å™¨ä¸­ï¼Œè¿›è¡Œæ³¨å†Œå’Œåˆå§‹åŒ–ã€‚\nï¼ˆä¸€ï¼‰ã€EditorNode3DGizmoPlugin EditorNode3DGizmoPlugin æ˜¯ Godot ç¼–è¾‘å™¨ä¸­çš„ä¸€ä¸ª æ’ä»¶åŸºç±»ï¼Œç”¨äºæ‰©å±•å’Œæ³¨å†Œè‡ªå®šä¹‰çš„ 3D Gizmo å·¥å…·ã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨ 3D è§†å£ä¸­ä¸ºç‰¹å®šç±»å‹çš„èŠ‚ç‚¹ç»˜åˆ¶è‡ªå®šä¹‰è¾…åŠ©å›¾å½¢ã€æ§åˆ¶æŸ„ã€äº¤äº’éƒ¨ä»¶ã€‚\næ³¨å†Œ Gizmo ç±»å‹ï¼šå…³è”åˆ°æŸä¸ªèŠ‚ç‚¹ç±»ï¼ˆå¦‚ Camera3Dã€Light3Dã€è‡ªå®šä¹‰èŠ‚ç‚¹ç­‰ï¼‰ ç”Ÿæˆ Gizmo å®ä¾‹ï¼šé€šè¿‡ create_gizmo() åˆ›å»ºå¯¹åº”çš„ EditorNode3DGizmo å¯¹è±¡ å®šä¹‰å¤–è§‚ä¸è¡Œä¸ºï¼šcreate_handle_materialï¼ˆï¼‰ã€create_materialï¼ˆï¼‰ç­‰ æ³¨æ„äº‹é¡¹ï¼š å½“_has_gizmoè¢«é‡è½½æ—¶ï¼Œä¼šæ ¹æ®è¿”å›çš„boolå€¼ï¼Œåˆ›å»ºé»˜è®¤çš„EditorNode3DGizmoã€‚ å½“__create_gizmoè¢«é‡è½½æ—¶ï¼Œåˆ›å»ºè‡ªå®šä¹‰çš„EditorNode3DGizmoã€‚ å½“ä»–ä»¬åŒæ—¶è¢«é‡è½½æ—¶ï¼Œä»…ä¼šç”Ÿæ•ˆ__create_gizmo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 //======================å¤´æ–‡ä»¶======================== #pragma once #ifndef SPLINE_GIZMO_PLUGIN_H #define SPLINE_GIZMO_PLUGIN_H #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo_plugin.hpp\u0026#34; using namespace godot; class SplineGizmoPlugin : public EditorNode3DGizmoPlugin { GDCLASS(SplineGizmoPlugin, EditorNode3DGizmoPlugin); protected: static void _bind_methods(){} public: // virtual bool _has_gizmo(Node3D *p_for_node_3d) const override; virtual Ref\u0026lt;EditorNode3DGizmo\u0026gt; _create_gizmo(Node3D *p_for_node_3d) const override; virtual void _redraw(const Ref\u0026lt;EditorNode3DGizmo\u0026gt; \u0026amp;p_gizmo) override; virtual String _get_gizmo_name() const override{ return \u0026#34;SplineGizmo\u0026#34;; } // virtual int32_t _get_priority() const override{ // return -1; // } }; #endif //======================æºæ–‡ä»¶======================== #include \u0026#34;SplineGizmoPlugin.h\u0026#34; #include \u0026#34;Spline.h\u0026#34; #include \u0026#34;SplineGizmo.h\u0026#34; #include \u0026#34;godot_cpp/classes/object.hpp\u0026#34; #include \u0026#34;godot_cpp/core/memory.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/utility_functions.hpp\u0026#34; // bool SplineGizmoPlugin::_has_gizmo(Node3D *p_for_node_3d) const { // UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_has_gizmo :: AAAAAAAAAAAA\u0026#34;); // UtilityFunctions::print(__FUNCTION__,p_for_node_3d-\u0026gt;get_name()); // return Object::cast_to\u0026lt;Spline\u0026gt;(p_for_node_3d) != nullptr; // } Ref\u0026lt;EditorNode3DGizmo\u0026gt; SplineGizmoPlugin::_create_gizmo(Node3D *p_for_node_3d) const{ UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_create_gizmo :: Try to create gizmo for :: \u0026#34;,p_for_node_3d-\u0026gt;get_name()); bool bIsSpline = Object::cast_to\u0026lt;Spline\u0026gt;(p_for_node_3d) != nullptr; if (bIsSpline) { UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_create_gizmo :: \u0026#34;,p_for_node_3d-\u0026gt;get_name()); Ref\u0026lt;EditorNode3DGizmo\u0026gt; Gizmo = memnew(SplineGizmo(p_for_node_3d)); return Gizmo; } return nullptr; } void SplineGizmoPlugin::_redraw(const Ref\u0026lt;EditorNode3DGizmo\u0026gt; \u0026amp;p_gizmo){ UtilityFunctions::print(\u0026#34;SplineGizmoPlugin::_redraw :: \u0026#34; , p_gizmo-\u0026gt;get_node_3d()-\u0026gt;get_name()); p_gizmo-\u0026gt;_redraw(); } ï¼ˆäºŒï¼‰ã€EditorNode3DGizmo EditorNode3DGizmo æ˜¯å®é™…åœ¨ 3D è§†å£ä¸­ç»˜åˆ¶å’Œäº¤äº’çš„å¯¹è±¡ã€‚ç”± EditorNode3DGizmoPlugin åˆ›å»ºï¼Œå®ƒè´Ÿè´£ç®¡ç†ç»˜åˆ¶å†…å®¹å’Œäº¤äº’ç‚¹ã€‚\næ·»åŠ å¯è§å…ƒç´ ï¼šé€šè¿‡ add_mesh()ã€add_lines()ã€add_unscaled_billboard() ç­‰æ–¹æ³•ç»˜åˆ¶ä¸åŒç±»å‹çš„è¾…åŠ©å‡ ä½•\næ·»åŠ äº¤äº’å¥æŸ„ï¼ˆHandlesï¼‰ï¼š\nadd_handles() ç”¨äºæ·»åŠ å¯æ‹–æ‹½çš„æ§åˆ¶ç‚¹ åœ¨ç¼–è¾‘å™¨ä¸­ç”¨æˆ·å¯ä»¥ç›´æ¥ç”¨é¼ æ ‡æ“ä½œè¿™äº›ç‚¹ äº¤äº’ä¸æ›´æ–°\nåœ¨æ’ä»¶ä¸­é‡å†™ redraw(gizmo)ï¼Œå¯æ ¹æ®èŠ‚ç‚¹å±æ€§å˜åŒ–å®æ—¶åˆ·æ–° ä½¿ç”¨ set_handle() ä¸ commit_handle() å“åº”ç”¨æˆ·æ“ä½œï¼Œå°†å˜åŠ¨å†™å›èŠ‚ç‚¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 //======================å¤´æ–‡ä»¶======================== #pragma once #ifndef SPLINE_GIZMO_H #define SPLINE_GIZMO_H #include \u0026#34;Spline.h\u0026#34; #include \u0026#34;godot_cpp/classes/node3d.hpp\u0026#34; // #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo_plugin.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo.hpp\u0026#34; // #include \u0026#34;godot_cpp/classes/node3d_gizmo.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/camera3d.hpp\u0026#34; using namespace godot; class SplineGizmo : public EditorNode3DGizmo { GDCLASS(SplineGizmo, EditorNode3DGizmo); protected: static void _bind_methods(){} public: SplineGizmo(){} SplineGizmo(Node3D *p_node); ~SplineGizmo(); virtual void _redraw() override; virtual void _commit_handle(int32_t p_id, bool p_secondary, const Variant \u0026amp;p_restore, bool p_cancel) override; virtual void _set_handle(int32_t p_id, bool p_secondary, Camera3D *p_camera, const Vector2 \u0026amp;p_point) override; private: Spline * SplineInstance; Ref\u0026lt;Material\u0026gt; RedMaterial; Ref\u0026lt;Material\u0026gt; GreenMaterial; Ref\u0026lt;Material\u0026gt; BlueMaterial; }; #endif //======================æºæ–‡ä»¶======================== #include \u0026#34;SplineGizmo.h\u0026#34; #include \u0026#34;Spline.h\u0026#34; #include \u0026#34;godot_cpp/classes/object.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/editor_node3d_gizmo_plugin.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/standard_material3d.hpp\u0026#34; #include \u0026#34;godot_cpp/core/error_macros.hpp\u0026#34; #include \u0026#34;godot_cpp/core/memory.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/array.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/utility_functions.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/vector3.hpp\u0026#34; SplineGizmo::SplineGizmo(Node3D *p_node){ set_node_3d(p_node); SplineInstance = Object::cast_to\u0026lt;Spline\u0026gt;(p_node); } SplineGizmo::~SplineGizmo(){ } void SplineGizmo::_redraw(){ UtilityFunctions::print(__FUNCTION__,\u0026#34;redraw::CCCCCCC :: \u0026#34;,get_node_3d()-\u0026gt;get_name()); clear(); PackedVector3Array points; PackedInt32Array ids; PackedVector3Array lines; ERR_FAIL_COND(!SplineInstance); int numPoints = SplineInstance-\u0026gt;GetControlPoints().size(); ERR_FAIL_COND(numPoints == 0); for (int i = 0; i \u0026lt; numPoints; i++) { Vector3 CurPoint = SplineInstance-\u0026gt;GetControlPoints()[i]; points.append(CurPoint); ids.append(i); } int segNum = 100; Array TempP = SplineInstance-\u0026gt;GetBezierCurve(segNum); for (int i = 0; i \u0026lt; segNum - 1; i++) { Vector3 CurPoint0 = TempP[i]; Vector3 CurPoint1 = TempP[i + 1]; lines.append(CurPoint0); lines.append(CurPoint1); } add_handles(points, get_plugin()-\u0026gt;get_material(\u0026#34;HandleMat\u0026#34;,this),ids); add_lines(lines, get_plugin()-\u0026gt;get_material(\u0026#34;RedMat\u0026#34;,this)); } void SplineGizmo::_commit_handle(int32_t p_id, bool p_secondary, const Variant \u0026amp;p_restore, bool p_cancel){ UtilityFunctions::print(\u0026#34;SplineGizmo::_commit_handle :: id :: \u0026#34;, p_id , \u0026#34; , Restore :: \u0026#34;, p_restore ,\u0026#34;NewPosition :: \u0026#34;); } void SplineGizmo::_set_handle(int32_t p_id, bool p_secondary, Camera3D *p_camera, const Vector2 \u0026amp;p_point){ // UtilityFunctions::print(\u0026#34;SplineGizmo::_set_handle :: id :: \u0026#34;, p_id , \u0026#34; , Screen Point :: \u0026#34;, p_point ); if (!SplineInstance || !p_camera ) { return; } Array points = SplineInstance-\u0026gt;GetControlPoints(); Vector3 LocalLocation = points[p_id]; Vector3 WorldLocation = SplineInstance-\u0026gt;get_transform().xform(LocalLocation); UtilityFunctions::print(\u0026#34;LocalLocation :: \u0026#34;, LocalLocation , \u0026#34; , WorldLocation :: \u0026#34;, WorldLocation ); const Vector3 ray_o = p_camera-\u0026gt;project_ray_origin(p_point); const Vector3 ray_d = p_camera-\u0026gt;project_ray_normal(p_point); // UtilityFunctions::print(\u0026#34;SplineGizmo::_set_handle :: id :: \u0026#34;, p_id , \u0026#34; , ray_o :: \u0026#34;,ray_o,\u0026#34; , ray_d :: \u0026#34;,ray_d); // æ„é€ â€œå±å¹•å¹³é¢â€ï¼šè¿‡å½“å‰æŠŠæ‰‹ç‚¹ï¼Œæ³•çº¿ = ç›¸æœºå‰å‘ï¼ˆ-Z åˆ—ï¼‰ const Vector3 cam_fwd = -p_camera-\u0026gt;get_global_transform().basis.get_column(2).normalized(); Plane view_plane(cam_fwd, WorldLocation); // UtilityFunctions::print(\u0026#34;cam_fwd :: \u0026#34;, cam_fwd ); Vector3 hit; if (!view_plane.intersects_ray(ray_o, ray_d, \u0026amp;hit)) { // å°„çº¿ä¸å¹³é¢è¿‘å¹³è¡Œï¼Œå¿½ç•¥è¿™å¸§ return; } UtilityFunctions::print(\u0026#34;Hit :: \u0026#34;,hit); points[p_id] = SplineInstance-\u0026gt;get_transform().xform_inv(hit); SplineInstance-\u0026gt;SetControlPoints(points); _redraw(); } ï¼ˆä¸‰ï¼‰ã€EditorPlugin EditorPlugin æ˜¯ Godot ä¸­æ‰€æœ‰ç¼–è¾‘å™¨æ’ä»¶çš„åŸºç±»ï¼Œè´Ÿè´£ï¼š\næ³¨å†Œå’Œå¸è½½ EditorNode3DGizmoPlugin å¤„ç†æ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸ ä¸ç¼–è¾‘å™¨ UIã€åœºæ™¯æ ‘ã€Inspector ç­‰äº¤äº’ æ¥å£ ä½œç”¨ è¯´æ˜ add_node_3d_gizmo_plugin æŠŠè‡ªå®šä¹‰ Gizmo æ’ä»¶æ³¨å†Œåˆ°ç¼–è¾‘å™¨ remove_node_3d_gizmo_plugin æŠŠè‡ªå®šä¹‰ Gizmo æ’ä»¶ç§»é™¤ enable_plugin å¼€å¯æ’ä»¶ disable_plugin å…³é—­æ’ä»¶ handles åˆ¤æ–­æ˜¯å¦æ¥ç®¡æŸç±»å‹èŠ‚ç‚¹çš„ç¼–è¾‘é€»è¾‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 //=================ç±»çš„å®šä¹‰======================= class MyEditorPlugin : public EditorPlugin { GDCLASS(MyEditorPlugin, EditorPlugin); Ref\u0026lt;SplineGizmoPlugin\u0026gt; gizmo_plugin; protected: static void _bind_methods() { } public: virtual void _enter_tree() override { UtilityFunctions::print(\u0026#34;Init :: MyEditorPlugin :: _enter_tree\u0026#34;); gizmo_plugin.instantiate(); gizmo_plugin-\u0026gt;create_handle_material(\u0026#34;HandleMat\u0026#34;); gizmo_plugin-\u0026gt;create_material(\u0026#34;RedMat\u0026#34;, Color(1.0f, 0.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;GreenMat\u0026#34;, Color(0.0f, 1.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;BlueMat\u0026#34;, Color(0.0f, 0.0f, 1.0f)); add_node_3d_gizmo_plugin(gizmo_plugin); } virtual void _exit_tree() override { UtilityFunctions::print(\u0026#34;UnInit :: MyEditorPlugin :: _exit_tree\u0026#34;); remove_node_3d_gizmo_plugin(gizmo_plugin); } }; //==================ä½¿ç”¨ç¤ºä¾‹======================= //==================register_types.cpp======================= void initialize_GodotTest_module(ModuleInitializationLevel p_level) { if (p_level == MODULE_INITIALIZATION_LEVEL_SCENE) { UtilityFunctions::print(\u0026#34;Init :: Scene\u0026#34;); GDREGISTER_CLASS(FowTexture); GDREGISTER_CLASS(Spline); } if (p_level == MODULE_INITIALIZATION_LEVEL_EDITOR) { UtilityFunctions::print(\u0026#34;Init :: Editor\u0026#34;); GDREGISTER_CLASS(SplineGizmo); GDREGISTER_CLASS(SplineGizmoPlugin); GDREGISTER_CLASS(MyEditorPlugin); EditorPlugins::add_by_type\u0026lt;MyEditorPlugin\u0026gt;(); } UtilityFunctions::print(\u0026#34;Init :: None :: \u0026#34;, p_level); } ","date":"2025-11-04T16:38:31+08:00","image":"https://Liyufei1.github.io/guidao4.jpg","permalink":"https://Liyufei1.github.io/p/godot%E4%B8%89gdextension%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/","title":"ã€godotã€‘ä¸‰ã€GDExtensionå¼€å‘æŒ‡å—"},{"content":"Moduleså¼€å‘æŒ‡å— Godotè„šæœ¬å®¹å™¨ Array âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/variant/array.h\u0026quot;\nâœ¨ä½œç”¨:Arrayæ˜¯è„šæœ¬GDScriptä¸­Arrayç±»å‹çš„C++å®ç°ã€‚å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\né€šç”¨æ€§ï¼šå®ƒæ˜¯ä¸€ä¸ªå­˜å‚¨Variantçš„å®¹å™¨ï¼Œè¿™æ„å‘³ç€åŒä¸€ä¸ªæ•°ç»„é‡Œå¯ä»¥æ··åˆå­˜æ”¾æ•´æ•°ã€å­—ç¬¦ä¸²ã€å¯¹è±¡å¼•ç”¨ç­‰ã€‚ ç±»å‹åŒ–æ•°ç»„ï¼ˆTyped Arrayï¼‰ï¼š Godot 4.0 å¼•å…¥äº†ç±»å‹åŒ–æ•°ç»„çš„æ¦‚å¿µï¼ŒC++ ç«¯å¯ä»¥é€šè¿‡ set_typed ç­‰æ–¹æ³•é™åˆ¶æ•°ç»„åªèƒ½å­˜å‚¨ç‰¹å®šç±»å‹ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 #include \u0026#34;core/variant/array.h\u0026#34; #include \u0026#34;core/variant/variant.h\u0026#34; void demo_array() { // --- åˆ›å»º (Create) --- Array arr; // ä¹Ÿå¯ä»¥åˆ›å»ºå¹¶æŒ‡å®šä¸ºç‰¹å®šç±»å‹çš„æ•°ç»„ï¼ˆä¾‹å¦‚åªå­˜ intï¼‰ // Array typed_arr; // typed_arr.set_typed(Variant::INT, StringName(), Variant()); // --- å¢ (Add) --- arr.push_back(10); // è‡ªåŠ¨å°è£…ä¸º Variant(10) arr.append(\u0026#34;Hello\u0026#34;); // è‡ªåŠ¨å°è£…ä¸º Variant(\u0026#34;Hello\u0026#34;) arr.push_front(3.14); // æ’å…¥åˆ°å¤´éƒ¨ // æ­¤æ—¶æ•°ç»„å†…å®¹å¯èƒ½ä¸º: [3.14, 10, \u0026#34;Hello\u0026#34;] // --- æŸ¥ (Read) --- if (!arr.is_empty()) { // operator[] è¿”å›çš„æ˜¯ Variant \u0026amp; Variant v = arr[0]; // éœ€è¦æ ¹æ®ç±»å‹è½¬æ¢ if (v.get_type() == Variant::FLOAT) { double d = v; // è‡ªåŠ¨è½¬å‹æ“ä½œç¬¦ print_line(rtos(d)); } } // éå† for (int i = 0; i \u0026lt; arr.size(); i++) { Variant item = arr[i]; // print_line(item); // Variant é‡è½½äº† String è½¬æ¢ } // --- æ”¹ (Update) --- arr[1] = \u0026#34;New Value\u0026#34;; // å°†ç´¢å¼• 1 çš„ 10 æ”¹ä¸ºå­—ç¬¦ä¸² // --- åˆ  (Delete) --- arr.remove_at(0); // ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´  arr.erase(\u0026#34;New Value\u0026#34;); // ç§»é™¤åŒ¹é…å€¼çš„å…ƒç´ ï¼ˆçº¿æ€§æŸ¥æ‰¾ï¼‰ arr.clear(); } Dictionary âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/variant/dictionary.h\u0026quot;\nâœ¨ä½œç”¨:é”®å€¼å¯¹å‡ä¸ºVariantçš„å­—å…¸,å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\nåŸºäºå“ˆå¸Œè¡¨ æ’å…¥é¡ºåºä¿ç•™ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 #include \u0026#34;core/variant/dictionary.h\u0026#34; #include \u0026#34;core/variant/variant.h\u0026#34; void demo_dictionary() { // --- åˆ›å»º (Create) --- Dictionary dict; // --- å¢ (Add) / æ”¹ (Update) --- dict[\u0026#34;name\u0026#34;] = \u0026#34;Godot\u0026#34;; // é”®æ˜¯ String, å€¼æ˜¯ String dict[100] = \u0026#34;One Hundred\u0026#34;; // é”®æ˜¯ int, å€¼æ˜¯ String // ä¹Ÿå¯ä»¥ä½œä¸ºå·¦å€¼ä¿®æ”¹ dict[\u0026#34;name\u0026#34;] = \u0026#34;Godot Engine\u0026#34;; // --- æŸ¥ (Read) --- // æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ if (dict.has(\u0026#34;name\u0026#34;)) { Variant v = dict[\u0026#34;name\u0026#34;]; String s = v; print_line(s); } // å®‰å…¨è·å–ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰ // å¦‚æœ \u0026#34;score\u0026#34; ä¸å­˜åœ¨ï¼Œè¿”å› 0 int score = dict.get(\u0026#34;score\u0026#34;, 0); // éå† // æ³¨æ„ï¼šéå†å­—å…¸é€šå¸¸éå†çš„æ˜¯ Key List\u0026lt;Variant\u0026gt; keys; dict.get_key_list(\u0026amp;keys); // è·å–æ‰€æœ‰ key åˆ°ä¸€ä¸ª List ä¸­ for (const Variant \u0026amp;key : keys) { Variant value = dict[key]; print_line(String(key) + \u0026#34; : \u0026#34; + String(value)); } // --- åˆ  (Delete) --- dict.erase(100); // åˆ é™¤é”®ä¸º 100 çš„æ¡ç›® bool removed = dict.erase(\u0026#34;name\u0026#34;); // è¿”å›æ˜¯å¦åˆ é™¤æˆåŠŸ } Godotåº•å±‚å®¹å™¨ Vector\u0026lt;T\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/vector.h\u0026quot;\nâœ¨ä½œç”¨:æ•°ç»„å®¹å™¨,å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\nè¿ç»­å†…å­˜ï¼Œç±»ä¼¼ std::vector é¢‘ç¹éšæœºè®¿é—®ã€éå†æ—¶æ€§èƒ½å¥½ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 Vector\u0026lt;int\u0026gt; v; // å¢ï¼šå°¾éƒ¨æ’å…¥ v.push_back(10); v.push_back(20); v.push_back(30); // æŸ¥ï¼šæŒ‰ä¸‹æ ‡è®¿é—® int x = v[1]; // 20 int size = v.size(); // 3 // æ”¹ï¼šä¿®æ”¹æŸä¸ªå…ƒç´  v.write[1] = 200; // Godot 4 çš„ Vector ç”¨ write[] // æœ‰äº›ç‰ˆæœ¬æ˜¯ `v.set(1, 200);` // æˆ– `v[1] = 200`ï¼ˆå–å†³äºç»‘å®šï¼‰ // æŸ¥ï¼šéå† for (int i = 0; i \u0026lt; v.size(); i++) { print_line(v[i]); } // åˆ ï¼šæŒ‰ä¸‹æ ‡åˆ é™¤ v.remove_at(0); // åˆ é™¤ç¬¬ 0 ä¸ªå…ƒç´ ï¼Œç°åœ¨å†…å®¹ [200, 30] // æŸ¥ï¼šæ˜¯å¦åŒ…å«æŸå€¼ï¼ˆç®€å•ç±»å‹å¯ä»¥è¿™æ ·ï¼‰ int idx = v.find(30); // æ‰¾åˆ°åˆ™è¿”å› indexï¼Œå¦åˆ™ -1 if (idx != -1) { print_line(\u0026#34;found 30 at \u0026#34;, idx); } VMap\u0026lt;K,V\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/vector.h\u0026quot;\nâœ¨ä½œç”¨:åŸºäºVectorå®ç°çš„å…³è”å®¹å™¨ï¼ˆMapï¼‰å®ƒå†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæŒ‰ç…§Keyæ’åºçš„Vector.å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹\nå†…å­˜è¿ç»­ï¼Œç¼“å­˜å‹å¥½ï¼ˆCache Friendlyï¼‰ã€‚ æŸ¥æ‰¾ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºğ‘‚(logğ‘) æ’å…¥å’Œåˆ é™¤éœ€è¦ç§»åŠ¨å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include \u0026#34;core/templates/vmap.h\u0026#34; void demo_vmap() { VMap\u0026lt;int, String\u0026gt; player_names; // --- å¢ (Add) --- // æ³¨æ„ï¼šinsert ä¼šæ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™è¦†ç›–ï¼Œä¸å­˜åœ¨åˆ™ä¿æŒæ’åºæ’å…¥ player_names.insert(1, \u0026#34;Alice\u0026#34;); player_names.insert(2, \u0026#34;Bob\u0026#34;); player_names.insert(10, \u0026#34;Boss\u0026#34;); // --- æŸ¥ (Read) --- // æ£€æŸ¥æ˜¯å¦å­˜åœ¨ if (player_names.has(2)) { // è·å–å€¼ï¼Œå¦‚æœ key ä¸å­˜åœ¨ä¼š crashï¼Œæ‰€ä»¥æœ€å¥½å…ˆæ£€æŸ¥ has String name = player_names.get(2); // æˆ–è€…ä½¿ç”¨ getptrï¼Œå¦‚æœä¸å­˜åœ¨è¿”å› nullptr const String *name_ptr = player_names.getptr(2); } // æŸ¥æ‰¾ç´¢å¼•ï¼ˆç”¨äºéå†å†…éƒ¨ vectorï¼‰ int idx = player_names.find(10); // è¿”å›å†…éƒ¨ vector çš„ index if (idx != -1) { // é€šè¿‡ vector ç´¢å¼•è®¿é—® String val = player_names.get_value_at_index(idx); } // --- æ”¹ (Update) --- player_names.insert(1, \u0026#34;AliceUpdated\u0026#34;); // insert å…¼å…·æ›´æ–°åŠŸèƒ½ // å¦‚æœä½ æœ‰ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç´¢å¼•æ”¹ // player_names.get_value_at_index(0) = \u0026#34;NewName\u0026#34;; // --- åˆ  (Delete) --- player_names.erase(10); // ç§»é™¤ key ä¸º 10 çš„å…ƒç´  } List\u0026lt;T\u0026gt; âœ¨å¤´æ–‡ä»¶:``\nâœ¨ä½œç”¨:\néè¿ç»­å†…å­˜ï¼š èŠ‚ç‚¹æ•£è½åœ¨å†…å­˜ä¸­ï¼Œé€šè¿‡æŒ‡é’ˆè¿æ¥ã€‚ æ’å…¥/åˆ é™¤å¿«ï¼š åœ¨å¤´éƒ¨ã€å°¾éƒ¨æˆ–ä»»æ„å·²çŸ¥èŠ‚ç‚¹å¤„æ’å…¥/åˆ é™¤å…ƒç´ æ˜¯ $O(1)$ æ“ä½œã€‚ éšæœºè®¿é—®æ…¢ï¼š æƒ³è¦è®¿é—®ç¬¬ N ä¸ªå…ƒç´ ï¼ˆlist[N]ï¼‰ï¼Œå¿…é¡»ä»å¤´éå†ï¼Œæ˜¯ $O(N)$ æ“ä½œã€‚è¿™æ˜¯å®ƒå’Œ Vector æœ€å¤§çš„åŒºåˆ«ã€‚ è¿­ä»£å™¨ï¼š ä½¿ç”¨ List::Element * æŒ‡é’ˆä½œä¸ºè¿­ä»£å™¨ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 #include \u0026#34;core/templates/list.h\u0026#34; #include \u0026#34;core/string/ustring.h\u0026#34; void demo_list() { // --- 1. åˆ›å»º (Create) --- List\u0026lt;String\u0026gt; chat_log; // --- 2. å¢ (Add) --- // å°¾éƒ¨æ·»åŠ  O(1) chat_log.push_back(\u0026#34;Player joined\u0026#34;); chat_log.push_back(\u0026#34;Player said: Hello\u0026#34;); // å¤´éƒ¨æ·»åŠ  O(1) - é€‚åˆåšé˜Ÿåˆ— chat_log.push_front(\u0026#34;System: Welcome\u0026#34;); // åœ¨ç‰¹å®šä½ç½®æ’å…¥ // List çš„æ’å…¥é€šå¸¸ä¾èµ–äº Element æŒ‡é’ˆ List\u0026lt;String\u0026gt;::Element *E = chat_log.front(); // è·å–ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ (\u0026#34;System: Welcome\u0026#34;) if (E) { // åœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åé¢æ’å…¥ chat_log.insert_after(E, \u0026#34;System: Message of the day\u0026#34;); } // æ­¤æ—¶é¡ºåº: // [0] System: Welcome // [1] System: Message of the day // [2] Player joined // [3] Player said: Hello // --- 3. æŸ¥ (Read) --- // A. è®¿é—®å¤´å°¾ O(1) if (!chat_log.is_empty()) { String first = chat_log.front()-\u0026gt;get(); String last = chat_log.back()-\u0026gt;get(); } // B. éå† (æ¨èæ–¹å¼ 1: èŒƒå›´ for å¾ªç¯ - Godot 4.x) for (const String \u0026amp;msg : chat_log) { print_line(\u0026#34;Log: \u0026#34; + msg); } // C. éå† (ä¼ ç»Ÿæ–¹å¼/æ‰‹åŠ¨æ–¹å¼: ä½¿ç”¨ Element æŒ‡é’ˆ) // è¿™ç§æ–¹å¼åœ¨ä½ éœ€è¦æ“ä½œèŠ‚ç‚¹(å¦‚åˆ é™¤å½“å‰èŠ‚ç‚¹)æ—¶å¾ˆæœ‰ç”¨ for (List\u0026lt;String\u0026gt;::Element *E = chat_log.front(); E; E = E-\u0026gt;next()) { // E æ˜¯èŠ‚ç‚¹æŒ‡é’ˆï¼ŒE-\u0026gt;get() è·å–å€¼ if (E-\u0026gt;get() == \u0026#34;Player joined\u0026#34;) { print_line(\u0026#34;Found join event!\u0026#34;); } } // D. éšæœºè®¿é—® (è­¦å‘Šï¼šææ…¢ï¼) // List é‡è½½äº† []ï¼Œä½†å®ƒæ˜¯ O(N) çš„ï¼Œä¸å»ºè®®åœ¨å¾ªç¯ä¸­ä½¿ç”¨ // String val = chat_log[2]; // æ€§èƒ½å·®ï¼Œæ…ç”¨ // --- 4. æ”¹ (Update) --- // é€šè¿‡èŠ‚ç‚¹æŒ‡é’ˆç›´æ¥ä¿®æ”¹ List\u0026lt;String\u0026gt;::Element *msg_node = chat_log.back(); if (msg_node) { msg_node-\u0026gt;get() = \u0026#34;Player said: Bye\u0026#34;; // ä¿®æ”¹å€¼ } // --- 5. åˆ  (Delete) --- // A. ç§»é™¤å¤´å°¾ O(1) chat_log.pop_front(); // ç§»é™¤ç¬¬ä¸€ä¸ª chat_log.pop_back(); // ç§»é™¤æœ€åä¸€ä¸ª // B. ç§»é™¤ç‰¹å®šå€¼ O(N) - éœ€è¦æŸ¥æ‰¾ chat_log.erase(\u0026#34;Player joined\u0026#34;); // C. é€šè¿‡è¿­ä»£å™¨ç§»é™¤ O(1) - æœ€é«˜æ•ˆçš„ä¸­é—´åˆ é™¤æ–¹å¼ List\u0026lt;String\u0026gt;::Element *node_to_delete = chat_log.front(); // å‡è®¾æˆ‘ä»¬æ‰¾åˆ°äº†è¦åˆ çš„èŠ‚ç‚¹æŒ‡é’ˆ if (node_to_delete) { chat_log.erase(node_to_delete); // ç›´æ¥æŠŠè¿™ä¸ªèŠ‚ç‚¹æ‘˜é™¤ } // æ¸…ç©º chat_log.clear(); } VSet\u0026lt;T\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/vset.h\u0026quot;\nâœ¨ä½œç”¨:ç±»ä¼¼std::set, å†…å­˜ç´§å‡‘ï¼ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œä¸æ”¯æŒé‡å¤å…ƒç´ ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #include \u0026#34;core/templates/vset.h\u0026#34; void demo_vset() { VSet\u0026lt;int\u0026gt; unique_ids; // --- å¢ (Add) --- unique_ids.insert(50); unique_ids.insert(10); unique_ids.insert(50); // é‡å¤æ’å…¥æ— æ•ˆï¼Œé›†åˆä¸­åªæœ‰ä¸€ä¸ª 50 // æ­¤æ—¶å†…éƒ¨çŠ¶æ€ä¸ºæœ‰åºï¼š[10, 50] // --- æŸ¥ (Read) --- if (unique_ids.has(10)) { print_line(\u0026#34;ID 10 exists\u0026#34;); } // æŸ¥æ‰¾ç´¢å¼• int idx = unique_ids.find(50); // è¿”å› 1 // éå† for (int i = 0; i \u0026lt; unique_ids.size(); i++) { int val = unique_ids[i]; // åƒæ•°ç»„ä¸€æ ·è®¿é—® } // --- æ”¹ (Update) --- // Set é€šå¸¸ä¸ç›´æ¥ä¿®æ”¹å…ƒç´ å€¼ï¼ˆå› ä¸ºè¿™ä¼šç ´åæ’åºï¼‰ï¼Œ // è€Œæ˜¯å…ˆ erase æ—§å€¼ï¼Œå† insert æ–°å€¼ã€‚ // --- åˆ  (Delete) --- unique_ids.erase(10); } HashMap\u0026lt;K,V\u0026gt; âœ¨å¤´æ–‡ä»¶:#include \u0026quot;core/templates/hash_map.h\u0026quot;\nâœ¨ä½œç”¨:åŸºäºå“ˆå¸Œè¡¨å®ç°,å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:\nå¹³å‡æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚ æ— åºï¼ˆéå†é¡ºåºä¸ç¡®å®šï¼‰ã€‚ é€‚ç”¨åœºæ™¯ï¼š éœ€è¦å¿«é€ŸæŸ¥æ‰¾å¤§é‡æ•°æ®ï¼Œä¸”ä¸å…³å¿ƒéå†é¡ºåº âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #include \u0026#34;core/templates/hash_map.h\u0026#34; void demo_hashmap() { HashMap\u0026lt;String, int\u0026gt; inventory; // --- å¢ (Add) / æ”¹ (Update) --- inventory.insert(\u0026#34;Apple\u0026#34;, 5); inventory[\u0026#34;Banana\u0026#34;] = 10; // ç±»ä¼¼ std::mapï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æ›´æ–° inventory.insert(\u0026#34;Apple\u0026#34;, 8); // æ›´æ–° Apple çš„å€¼ä¸º 8 // --- æŸ¥ (Read) --- if (inventory.has(\u0026#34;Banana\u0026#34;)) { int count = inventory[\u0026#34;Banana\u0026#34;]; // è·å–å€¼ } // ä½¿ç”¨ find è·å–è¿­ä»£å™¨/æŒ‡é’ˆï¼Œé¿å…ä¸¤æ¬¡å“ˆå¸Œè®¡ç®— HashMap\u0026lt;String, int\u0026gt;::Iterator E = inventory.find(\u0026#34;Apple\u0026#34;); if (E) { int val = E-\u0026gt;value; // E-\u0026gt;key è·å–é”® } // éå† for (const KeyValue\u0026lt;String, int\u0026gt; \u0026amp;E : inventory) { print_line(E.key + \u0026#34;: \u0026#34; + itos(E.value)); } // --- åˆ  (Delete) --- inventory.erase(\u0026#34;Banana\u0026#34;); // å¦‚æœå­˜åœ¨åˆ™åˆ é™¤ bool removed = inventory.remove(\u0026#34;Apple\u0026#34;); // remove ä¹Ÿæ˜¯åˆ é™¤ } RBMap çº¢é»‘æ ‘,æœ‰åºéå†æ€§èƒ½å¥½\nRBSet print è·¯å¾„ï¼š#include \u0026ldquo;core/string/print_string.h\u0026rdquo;\nç”¨äºæ ‡å‡†æ—¥å¿—çš„è¾“å‡ºã€‚åœ¨åšå¼•æ“å¼€å‘æ—¶ä½¿ç”¨ã€‚\nåœ¨åšGDExtensionå¼€å‘æ—¶ï¼Œä½¿ç”¨Utility_functionå¤´æ–‡ä»¶ï¼Œè¿›è¡Œæ—¥å¿—æ‰“å°ã€‚\næ¥å£ ä½œç”¨ ç¤ºä¾‹ void print_line(const Variant \u0026amp;vï¼‰ æ‰“å°æ—¥å¿— __print_line(\u0026ldquo;AAA\u0026rdquo;,10.0); void print_error(const String \u0026amp;p_string) æ‰“å°é”™è¯¯ print_error(\u0026ldquo;BBBB\u0026rdquo;) class_db è·¯å¾„ï¼š#include \u0026ldquo;core/object/class_db.h\u0026rdquo;\nåœ¨_bind_methodsä¸­è¿›è¡Œç±»å‹å’Œå‡½æ•°æ³¨å†Œçš„æ—¶å€™ï¼Œä½¿ç”¨åˆ°çš„ç±»å‹æ³¨å†Œå‡½æ•°å°±æ¥è‡ªè¯¥å¤´æ–‡ä»¶\næ¥å£ ä½œç”¨ ç¤ºä¾‹ ClassDB::bind_method æ³¨å†Œå‡½æ•°åˆ°è„šæœ¬ ClassDB::bind_method(D_METHOD(\u0026ldquo;test_print\u0026rdquo;), \u0026amp;CommandTool::test_print); OS è·¯å¾„ï¼š#include \u0026ldquo;sence/gui/xxx.h\u0026rdquo;\næä¾›äº†ä¸€ç³»åˆ—æ“ä½œç³»ç»Ÿå±‚çº§çš„APIï¼Œæ¯”å¦‚æ‰“å°æ—¥ã€è·å–å¼•æ“è¿è¡Œæ—¶é•¿ç­‰ã€‚\næ¥å£ ä½œç”¨ ç¤ºä¾‹ get_ticks_usec è·å–å¼•æ“è¿è¡Œæ—¶é•¿ï¼Œå•ä½ä¸ºå¾®ç§’ get_ticks_msec è·å–å¼•æ“è¿è¡Œæ—¶é•¿ï¼Œå•ä½ä¸ºæ¯«ç§’ callable è·¯å¾„ï¼š#include \u0026ldquo;core/variant/callable.h\u0026rdquo;\ngodotè‡ªèº«æä¾›äº†ä¸€å¥—ç”¨äºå®‰å…¨ã€ç±»å‹æ£€æŸ¥çš„å‡½æ•°å›è°ƒæœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯Callableï¼Œåœ¨è¿›è¡Œä¿¡å·è¿æ¥æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ°å®ƒã€‚\nç±»ä¼¼ C++ çš„ std::function\u0026lt;void()\u0026gt;ï¼Œä½†å®ƒèƒ½åœ¨ Godot å¯¹è±¡ç³»ç»Ÿä¸­åºåˆ—åŒ–ã€è¿æ¥ä¿¡å·ã€è·¨è¯­è¨€è°ƒç”¨ã€‚\n1 2 3 4 5 //åŸºç¡€æ„é€ å‡½æ•°ï¼Œæ³¨æ„æ­¤å¤„çš„methodéœ€è¦åœ¨_bind_methodä¸­è¢«æ³¨å†Œæ‰èƒ½å¤Ÿé€šè¿‡å­—ç¬¦ä¸²è®¿é—®ã€‚ Callable c = Callable(this, \u0026#34;_on_something\u0026#34;); //æ›´å®‰å…¨é«˜æ•ˆçš„ç»‘å®š Callable c = callable_mp(this, \u0026amp;MyClass::_on_timeout); gui åŸºç¡€è·¯å¾„ï¼š#include \u0026ldquo;sence/gui/xxx.h\u0026rdquo;\nGUIåŸºç¡€ç±» Control err_dialog_control-\u0026gt;set_custom_minimum_size(Size2(600, 600) * EDSCALE);\nerr_dialog_control-\u0026gt;connect(SceneStringName(draw), callable_mp(this, \u0026amp;LyfTestEditor::test_draw));\nerr_dialog_control-\u0026gt;draw_line(Point2(0,0), Point2(100,100),Color(1,0,0));\nCanvasItem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 void draw_dashed_line(const Point2 \u0026amp;p_from, const Point2 \u0026amp;p_to, const Color \u0026amp;p_color, real_t p_width = -1.0, real_t p_dash = 2.0, bool p_aligned = true, bool p_antialiased = false); void draw_line(const Point2 \u0026amp;p_from, const Point2 \u0026amp;p_to, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_polyline(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_polyline_colors(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, real_t p_width = -1.0, bool p_antialiased = false); void draw_arc(const Vector2 \u0026amp;p_center, real_t p_radius, real_t p_start_angle, real_t p_end_angle, int p_point_count, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_multiline(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Color \u0026amp;p_color, real_t p_width = -1.0, bool p_antialiased = false); void draw_multiline_colors(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, real_t p_width = -1.0, bool p_antialiased = false); void draw_rect(const Rect2 \u0026amp;p_rect, const Color \u0026amp;p_color, bool p_filled = true, real_t p_width = -1.0, bool p_antialiased = false); void draw_circle(const Point2 \u0026amp;p_pos, real_t p_radius, const Color \u0026amp;p_color, bool p_filled = true, real_t p_width = -1.0, bool p_antialiased = false); void draw_texture(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Point2 \u0026amp;p_pos, const Color \u0026amp;p_modulate = Color(1, 1, 1, 1)); void draw_texture_rect(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, bool p_tile = false, const Color \u0026amp;p_modulate = Color(1, 1, 1), bool p_transpose = false); void draw_texture_rect_region(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, const Rect2 \u0026amp;p_src_rect, const Color \u0026amp;p_modulate = Color(1, 1, 1), bool p_transpose = false, bool p_clip_uv = false); void draw_msdf_texture_rect_region(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, const Rect2 \u0026amp;p_src_rect, const Color \u0026amp;p_modulate = Color(1, 1, 1), double p_outline = 0.0, double p_pixel_range = 4.0, double p_scale = 1.0); void draw_lcd_texture_rect_region(const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Rect2 \u0026amp;p_rect, const Rect2 \u0026amp;p_src_rect, const Color \u0026amp;p_modulate = Color(1, 1, 1)); void draw_style_box(const Ref\u0026lt;StyleBox\u0026gt; \u0026amp;p_style_box, const Rect2 \u0026amp;p_rect); void draw_primitive(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_uvs, Ref\u0026lt;Texture2D\u0026gt; p_texture = Ref\u0026lt;Texture2D\u0026gt;()); void draw_polygon(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Vector\u0026lt;Color\u0026gt; \u0026amp;p_colors, const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_uvs = Vector\u0026lt;Point2\u0026gt;(), Ref\u0026lt;Texture2D\u0026gt; p_texture = Ref\u0026lt;Texture2D\u0026gt;()); void draw_colored_polygon(const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_points, const Color \u0026amp;p_color, const Vector\u0026lt;Point2\u0026gt; \u0026amp;p_uvs = Vector\u0026lt;Point2\u0026gt;(), Ref\u0026lt;Texture2D\u0026gt; p_texture = Ref\u0026lt;Texture2D\u0026gt;()); void draw_mesh(const Ref\u0026lt;Mesh\u0026gt; \u0026amp;p_mesh, const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture, const Transform2D \u0026amp;p_transform = Transform2D(), const Color \u0026amp;p_modulate = Color(1, 1, 1)); void draw_multimesh(const Ref\u0026lt;MultiMesh\u0026gt; \u0026amp;p_multimesh, const Ref\u0026lt;Texture2D\u0026gt; \u0026amp;p_texture); void draw_string(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_multiline_string(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_max_lines = -1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::LineBreakFlag\u0026gt; p_brk_flags = TextServer::BREAK_MANDATORY | TextServer::BREAK_WORD_BOUND, BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_string_outline(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_size = 1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_multiline_string_outline(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_text, HorizontalAlignment p_alignment = HORIZONTAL_ALIGNMENT_LEFT, float p_width = -1, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_max_lines = -1, int p_size = 1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0), BitField\u0026lt;TextServer::LineBreakFlag\u0026gt; p_brk_flags = TextServer::BREAK_MANDATORY | TextServer::BREAK_WORD_BOUND, BitField\u0026lt;TextServer::JustificationFlag\u0026gt; p_jst_flags = TextServer::JUSTIFICATION_KASHIDA | TextServer::JUSTIFICATION_WORD_BOUND, TextServer::Direction p_direction = TextServer::DIRECTION_AUTO, TextServer::Orientation p_orientation = TextServer::ORIENTATION_HORIZONTAL) const; void draw_char(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_char, int p_font_size = Font::DEFAULT_FONT_SIZE, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0)) const; void draw_char_outline(const Ref\u0026lt;Font\u0026gt; \u0026amp;p_font, const Point2 \u0026amp;p_pos, const String \u0026amp;p_char, int p_font_size = Font::DEFAULT_FONT_SIZE, int p_size = 1, const Color \u0026amp;p_modulate = Color(1.0, 1.0, 1.0)) const; void draw_set_transform(const Point2 \u0026amp;p_offset, real_t p_rot = 0.0, const Size2 \u0026amp;p_scale = Size2(1.0, 1.0)); void draw_set_transform_matrix(const Transform2D \u0026amp;p_matrix); void draw_animation_slice(double p_animation_length, double p_slice_begin, double p_slice_end, double p_offset = 0); void draw_end_animation(); æ–‡æœ¬ç±» Label âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/label.h\u0026quot; âœ¨ä½œç”¨:Labelæ˜¯godotæä¾›çš„UIæ§ä»¶ï¼Œå¯ä»¥è‡ªé€‚åº”å†…å®¹çš„å¤§å°\nRichTextLabel âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/rich_text_label.h\u0026quot;\nâœ¨ä½œç”¨:RichTextLabelæ˜¯godotæä¾›çš„UIæ§ä»¶ï¼Œå¯ä»¥ä½¿ç”¨BBcodeæ¥æ§åˆ¶æ˜¾ç¤ºçš„å†…å®¹ï¼Œæ¯”å¦‚è®¾ç½®å½“è¡Œæ–‡æœ¬é¢œè‰²ç­‰\nâœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 screen_output_label-\u0026gt;set_use_bbcode(true);\t//ä½¿ç”¨bbcodeï¼Œå¼€å¯æ‰èƒ½æ­£ç¡®æ˜¾ç¤º[color=red]XXXX[\\color]çš„bbcodeæ ¼å¼æ–‡æœ¬ screen_output_label-\u0026gt;set_fit_content(true);\t//è‡ªé€‚åº”æ–‡æœ¬é«˜åº¦ screen_output_label-\u0026gt;set_autowrap_mode(TextServer::AutowrapMode::AUTOWRAP_OFF);//å…³é—­å®½åº¦è°ƒæ•´ï¼Œä¸ä¸Šæ–¹è®¾ç½®ç›¸ç»“åˆï¼Œå¯ä»¥è‡ªé€‚åº”å®½é«˜ã€‚ æŒ‰é’®ç±» OptionButton âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/option_button.h\u0026quot;\nâœ¨ä½œç”¨:OptionButtonæ˜¯Godotä¸­æä¾›çš„ä¸€ä¸ªGUIæ§ä»¶.å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªButtonçš„æ´¾ç”Ÿæ§ä»¶ï¼Œé€šè¿‡å†…éƒ¨åŒ…å«ä¸€ä¸ªPopupMenuå®ç°ä¸‹æ‹‰åŠŸèƒ½ã€‚æœ‰ä»¥ä¸‹ä½œç”¨ï¼š\næ˜¾ç¤ºä¸€ä¸ªä¸‹æ‹‰èœå•ã€‚ åŒ…å«å¤šä¸ªå¯é€‰é¡¹ï¼ˆItemsï¼‰ï¼Œæ¯ä¸ª Item æœ‰ æ–‡æœ¬ã€å›¾æ ‡ã€IDã€å¯ç”¨æ€§ã€‚ ç”¨æˆ·ç‚¹å‡»åï¼Œå¼¹å‡ºPopupMenuä¾›é€‰æ‹©ã€‚ æ”¯æŒå›è°ƒ \u0026amp; ä¿¡å·ï¼ˆå¦‚ item_selected(int index)ï¼‰ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 // åˆ›å»º OptionButton option_button = memnew(OptionButton); add_child(option_button); // æ·»åŠ é€‰é¡¹ option_button-\u0026gt;add_item(\u0026#34;Easy\u0026#34;, 1); option_button-\u0026gt;add_item(\u0026#34;Normal\u0026#34;, 2); option_button-\u0026gt;add_icon_item(p_icon,\u0026#34;Hard\u0026#34;, 3); // é€‰æ‹©é»˜è®¤é¡¹ option_button-\u0026gt;select(1); // Normal // ç»‘å®šä¿¡å· option_button-\u0026gt;connect(\u0026#34;item_selected\u0026#34;, Callable(this, \u0026#34;_on_item_selected\u0026#34;)); // åŠ ä¸€ä¸ª Label æ˜¾ç¤ºä¿¡æ¯ info_label = memnew(Label); info_label-\u0026gt;set_position(Vector2(0, 40)); add_child(info_label); info_label-\u0026gt;set_text(\u0026#34;Selected: Normal\u0026#34;); } // ä¿¡å·å›è°ƒ void _on_item_selected(int index) { int id = option_button-\u0026gt;get_item_id(index); String name = option_button-\u0026gt;get_item_text(index); info_label-\u0026gt;set_text(\u0026#34;Selected: \u0026#34; + name + \u0026#34; (ID = \u0026#34; + String::num_int64(id) + \u0026#34;)\u0026#34;); } MenuButton âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/menu_button.h\u0026quot;\nâœ¨ä½œç”¨:\nâœ¨ä½¿ç”¨ç¤ºä¾‹:\nå¼¹çª—ç±» AcceptDialog âœ¨å¤´æ–‡ä»¶:#include \u0026quot;scene/gui/dialogs.h\nâœ¨ä½œç”¨:AcceptDialogæ˜¯Godotä¸­æœ€å¸¸ç”¨çš„å¼¹å‡ºå¼å¯¹è¯æ¡†ï¼ˆPopupï¼‰ä¹‹ä¸€ï¼Œç”¨æ¥å‘ç”¨æˆ·æ˜¾ç¤ºä¿¡æ¯ï¼Œå¹¶æä¾›ä¸€ä¸ªâ€œç¡®è®¤/æ¥å—â€æŒ‰é’®ã€‚\nâœ”ï¸è‡ªå¸¦â€œç¡®è®¤â€æŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»åä¼šå‘é€confirmedä¿¡å·ã€‚ âœ”ï¸è‡ªå¸¦canceledä¿¡å·ã€‚ âœ”ï¸å¯ä»¥æ˜¾ç¤ºç®€å•çš„ä¿¡æ¯ï¼Œç”¨äºæé†’ç”¨æˆ·ã€‚ âœ¨ä½¿ç”¨ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 //åˆå§‹åŒ– err_dialog = memnew(AcceptDialog); add_child(err_dialog); err_dialog-\u0026gt;get_ok_button()-\u0026gt;set_text(\u0026#34;ä¸ok\u0026#34;); err_dialog-\u0026gt;get_ok_button()-\u0026gt;connect(\u0026#34;pressed\u0026#34;,callable_mp(this, \u0026amp;LyfTestEditor::test_func)); //è®¾ç½®æ–‡æœ¬ï¼Œå¹¶å”¤èµ·å¼¹çª— err_dialog-\u0026gt;set_text(\u0026#34;LyfTestEditorPlugin::MENU_OPTION_CREATE_111\u0026#34;); err_dialog-\u0026gt;popup_centered(); ConfirmationDialog å¤´æ–‡ä»¶è·¯å¾„ï¼š#include \u0026quot;scene/gui/dialogs.h\u0026quot;\nConfirmationDialogæ˜¯Godotä¸­ç”¨äºç¡®è®¤/å–æ¶ˆæ“ä½œçš„æ ‡å‡†å¼¹çª—ï¼ˆPopupï¼‰ï¼Œç»§æ‰¿è‡ª AcceptDialogã€‚\nç›¸è¾ƒäºAcceptDialogå¤šäº†ä¸€ä¸ªcancelæŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»åä¼šå‘é€canceledä¿¡å·ã€‚\ntimer 1 2 3 4 5 6 7 8 9 //1.é€šè¿‡åœºæ™¯æ ‘ï¼ˆmainloopï¼‰è®¾ç½®ç®€å•çš„æ—¶é—´å›è°ƒå‡½æ•° // timer to show text for 3 seconds auto timer = get_scene_tree()-\u0026gt;create_timer(time); timer-\u0026gt;connect(\u0026#34;timeout\u0026#34;, callable_mp(this,\u0026amp;CommandTool::reduce_screen_output_buffer)); //2.c++åŸç”Ÿçš„çº¿ç¨‹è°ƒç”¨ä¹Ÿå¯ä»¥å®ç°ï¼Œä½†æ˜¯éœ€è¦call_deferredæ¥å›åˆ°ä¸»çº¿ç¨‹ //3.tweenï¼Œæ›´åŠ å¤æ‚ï¼Œä½†æ˜¯å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œä»¥åŠè®¾ç½®ç¼“åŠ¨ ","date":"2025-11-04T16:18:31+08:00","image":"https://Liyufei1.github.io/guidao4.jpg","permalink":"https://Liyufei1.github.io/p/godot%E4%BA%8Cmodules%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/","title":"ã€godotã€‘äºŒã€Moduleså¼€å‘æŒ‡å—"},{"content":"å¼•æ“ç¼–è¯‘ å®˜æ–¹æºç ä»“åº“ï¼šgodot\nå®˜æ–¹godot-cppä»“åº“ï¼šgodot-cpp\nç¼–è¯‘æŒ‡ä»¤ åœ¨Godot_Engineæ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹æ–¹ç¼–è¯‘æŒ‡ä»¤scons,æœ‰ä»¥ä¸‹å¯é€‰å‚æ•°\næŒ‡å®šç›®æ ‡å¹³å° ï¼šï¼šplatform=windows/android/macos æ˜¯å¦å¸¦ç¬¦å·è¡¨ ï¼šï¼šdebug_symbols=yes/no æ„å»ºç›®æ ‡ç±»å‹ ï¼šï¼štarget=editor/template_debug/template_release æ˜¯å¦è¾“å‡ºç¼–è¯‘æŒ‡ä»¤ï¼šï¼šverbose=yes ç›®æ ‡å¹³å°èŠ¯ç‰‡æ¶æ„ï¼šï¼šarch=x86_64/arm64v8 æ˜¯å¦ç”Ÿæˆç¼–è¯‘jsonï¼šï¼šcompiledb=true æŒ‡å®šç¼–è¯‘çº¿ç¨‹æ•°é‡ï¼šï¼š-j8/-j16 ä½¿ç”¨ LLVM/Clang ç¼–è¯‘å™¨è€Œé GCC ï¼šï¼šuse_llvm=yes/no 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 1.windowså¹³å°ç¼–è¯‘ ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\bin ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine ç¼–è¯‘æŒ‡ä»¤ï¼šscons compiledb=true debug_symbols=yes verbose=yes -j16 2.androidçš„libgodot_android.soç¼–è¯‘ ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java\\lib\\libs\\debug\\arm64-v8a ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine ç¼–è¯‘æŒ‡ä»¤ï¼šscons platform=android target=template_debug debug_symbols=yes compiledb=true æˆ–scons platform=android store_release=true production=true dev_mode=false dev_build=false debug_symbols=true tests=false target=template_release arch=arm64 compiledb=true 3.ç”ŸæˆAndroidå¯¼å‡ºæ¨¡æ¿ å‰ç½®ç”Ÿæˆï¼š ç”Ÿæˆdebugçš„soï¼šscons platform=android target=template_debug arch=arm64 dev_build=yes generate_android_binaries=yes ç”Ÿæˆreleaseçš„soï¼šscons platform=android target=template_release arch=arm64 dev_build=yes generate_android_binaries=yes ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\bin\\android_release.apk ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java ç¼–è¯‘æŒ‡ä»¤ï¼š./gradlew.bat generateGodotTemplates 4.androidçš„aarçš„ç¼–è¯‘ï¼Œgodot-lib.template_debug.aar ç”Ÿæˆè·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java\\lib\\build\\outputs\\aar ç¼–è¯‘è·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java ç¼–è¯‘æŒ‡ä»¤ï¼šgradlew.bat :lib:bundleTemplateDebugAar 5.ç”Ÿæˆslnæ–‡ä»¶ scons vsproj=yes 6.ç”ŸæˆGDExtensionçš„èƒ¶æ°´ä»£ç  1. ç¼–è¯‘extension_api.jsonæ–‡ä»¶ï¼š bin\\godot.windows.editor.x86_64.exe --dump-extension-api 2. åœ¨godot-cppä¸­æ‰§è¡Œä»£ç ç”Ÿæˆï¼š scons debug_symbols=yes verbose=yes generate_bindings=yes custom_api_file=E:\\Godot\\godot-cpp\\gdextension\\extension_api.json 7.å¯¼å‡ºèµ„æºåŒ…zip/pck ç”Ÿæˆè·¯å¾„ï¼š${YourProjectPath} ç¼–è¯‘è·¯å¾„ï¼š${YourProjectPath} 1. E:\\Godot\\Godot_Engine\\bin\\godot.windows.editor.x86_64.exe --headless --export-pack \u0026#34;Android\u0026#34; game.zip 2. E:\\Godot\\Godot_Engine\\bin\\godot.windows.editor.x86_64.exe --headless --export-pack \u0026#34;Android\u0026#34; game.pck è¿è¡ŒæŒ‡ä»¤ 1 2 3 4 5 //è¿è¡Œç¼–è¾‘å™¨ \u0026#34;godot.exe --path ${PgmPath} -v -e\u0026#34; //ç›´æ¥è¿è¡Œruntime \u0026#34;godot.exe --path ${PgmPath} -v\u0026#34; JNIè·¯å¾„ æ–‡ä»¶è·¯å¾„ï¼šE:\\Godot\\Godot_Engine\\platform\\android\\java_godot_lib_jni.h\næ¨¡å—(Module)å¼€å‘ å‚è€ƒæ–‡æ¡£ï¼šè‡ªå®šä¹‰ C++ æ¨¡å— â€” Godot Engine (4.x) ç®€ä½“ä¸­æ–‡æ–‡æ¡£\næ–‡ä»¶åŠç»“æ„ æ–°å»ºä¸€ä¸ªæ¨¡å—éœ€è¦ä»¥ä¸‹æ–‡ä»¶åŠç»“æ„ï¼Œå­˜æ”¾åœ¨E:\\Godot\\Godot_Engine\\modulesç›®å½•åº•ä¸‹ ã€‚\nåœ¨E:\\Godot\\Godot_Engine\\modules\\register_module_types.gen.cppæ–‡ä»¶ä¸­ï¼Œä¼šæ ¹æ®æˆ‘ä»¬æ¨¡å—ä¸­çš„SCsubæ–‡ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆå®é™…çš„æ¨¡å—æ³¨å†Œä»£ç ï¼Œå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 //register_module_types.gen.cpp ä¸­è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ï¼Œç”¨äºæ¨¡å—çš„å®é™…æ³¨å†Œã€‚ #include \u0026#34;modules/ns_test_module/register_types.h\u0026#34; //... #ifdef MODULE_NS_TEST_MODULE_ENABLED initialize_ns_test_module_module(p_level); #endif //... #ifdef MODULE_NS_TEST_MODULE_ENABLED uninitialize_ns_test_module_module(p_level); #endif SCsubå’Œconfig.py SCsubæ˜¯è¿™ä¸ªæ¨¡å—çš„ç¼–è¯‘æŒ‡ä»¤ï¼ŒåŒ…æ‹¬æºç çš„æ”¶é›†ã€å¤´æ–‡ä»¶è·¯å¾„æ·»åŠ ã€é™æ€åº“çš„é“¾æ¥ç­‰ã€‚\nä¸config.pyç»“åˆä½¿ç”¨ï¼Œå¯ä»¥åŠ¨æ€çš„ç®¡ç†è¯¥æ¨¡å—çš„ç¼–è¯‘é€‰é¡¹ï¼Œä»¥åŠå°†è¯¥æ¨¡å—è‡ªåŠ¨çš„ç”Ÿæˆåˆ°E:\\Godot\\Godot_Engine\\modules\\register_module_types.gen.cppè¿›è¡Œæ¨¡å—çš„æ³¨å†Œã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 #====SCsub====== from misc.utility.scons_hints import * Import(\u0026#34;env\u0026#34;) Import(\u0026#34;env_modules\u0026#34;) env_nstest = env_modules.Clone() # æ·»åŠ ç¬¬ä¸‰æ–¹åº“çš„å¤´æ–‡ä»¶è·¯å¾„ env.Append(CPPPATH=[\u0026#34;#modules/matrix_data_pipeline/include\u0026#34;]) env.Append(CPPPATH=[\u0026#34;#modules/matrix_data_pipeline/include/NSCppData\u0026#34;]) env.Append(CPPPATH=[\u0026#34;#modules/matrix_data_pipeline/include/NSCppData/ProtoGen\u0026#34;]) # æ·»åŠ åº“æ–‡ä»¶è·¯å¾„ if env[\u0026#34;platform\u0026#34;] == \u0026#34;windows\u0026#34;: env.Append(LIBPATH=[\u0026#34;#modules/matrix_data_pipeline/lib/windows\u0026#34;]) env.Append(LIBS=[\u0026#34;NSCppData\u0026#34;,\u0026#34;libprotobuf\u0026#34;]) elif env[\u0026#34;platform\u0026#34;] == \u0026#34;android\u0026#34;: env.Append(LIBPATH=[\u0026#34;#modules/matrix_data_pipeline/lib/android\u0026#34;]) env.Append(LIBS=[\u0026#34;mylib\u0026#34;]) # Godot source files module_obj = [] env_nstest.add_source_files(module_obj, \u0026#34;*.cpp\u0026#34;) # env_nstest.add_source_files(module_obj, \u0026#34;editor/*.cpp\u0026#34;) env.modules_sources += module_obj 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #====config.py====== def can_build(env, platform): return True def configure(env): pass # def get_doc_classes(): # return [ # \u0026#34;OggPacketSequence\u0026#34;, # \u0026#34;OggPacketSequencePlayback\u0026#34;, # ] # def get_doc_path(): # return \u0026#34;doc_classes\u0026#34; register_types è¯¥æ–‡ä»¶è´Ÿè´£å¯¹è‡ªèº«æ¨¡å—ä¸­å£°æ˜çš„godotç±»å‹è¿›è¡Œç±»å‹æ³¨å†Œï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨ç›¸å¯¹è¾ƒæ—©çš„é˜¶æ®µï¼ˆmainå‡½æ•°çš„setupé˜¶æ®µï¼‰è¿›è¡Œä¸€äº›å•ä¾‹ç±»çš„å®ä¾‹åŒ–ã€‚ å¦‚æœåœ¨è¿›è¡Œç¼–è¾‘å™¨å·¥å…·ç±»çš„å¼€å‘ï¼Œåˆ™å·¥å…·ç±»çš„å®ä¾‹åŒ–å’Œæ³¨å†Œï¼Œä¹Ÿæ˜¯åœ¨è¯¥é˜¶æ®µè¿›è¡Œçš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 //==============register_types.h============ #ifndef NSTEST_REGISTER_TYPES_H #define NSTEST_REGISTER_TYPES_H #include \u0026#34;modules/register_module_types.h\u0026#34; void initialize_ns_test_module_module(ModuleInitializationLevel p_level); void uninitialize_ns_test_module_module(ModuleInitializationLevel p_level); #endif //==============register_types.cpp============ #include \u0026#34;register_types.h\u0026#34; #include \u0026#34;core/object/object.h\u0026#34; #include \u0026#34;ns_test_module.h\u0026#34; void initialize_ns_test_module_module(ModuleInitializationLevel p_level) { if (p_level != MODULE_INITIALIZATION_LEVEL_SCENE) { return; } GDREGISTER_CLASS(NsTestModule) //æ³¨å†Œç±»å‹ GDREGISTER_CLASS(NsTestResource) } void uninitialize_ns_test_module_module(ModuleInitializationLevel p_level) { if (p_level != MODULE_INITIALIZATION_LEVEL_SCENE) { return; } } GDExtensionå¼€å‘ å‚è€ƒæ–‡æ¡£ï¼šå…¥é—¨ â€” Godot Engine (4.x) ç®€ä½“ä¸­æ–‡æ–‡æ¡£\nå¯¹äºGDExtensionä¸­ç¼–å†™çš„c++ä»£ç ï¼Œéœ€è¦è¿›è¡Œç‰¹å®šçš„æ³¨å†Œå’Œç¼–è¯‘æµç¨‹ï¼Œæ‰èƒ½å½¢æˆç»™godotç”¨çš„åŠ¨æ€é“¾æ¥åº“\né¡¹ç›®ç»„ç»‡ç»“æ„ å¯¹äºå¸¦GDExtensionçš„godoté¡¹ç›®ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹çš„åŸºæœ¬ç»“æ„\nexample.gdextension 1 2 3 4 5 6 7 8 9 10 11 12 [configuration] //æ³¨æ„æ­¤å¤„çš„entry_symbolåï¼Œåº”è¯¥ä¸regisiter_typesä¸­çš„å…¥å£å‡½æ•°åä¿æŒä¸€è‡´ entry_symbol = \u0026#34;GodotTest_library_init\u0026#34; compatibility_minimum = \u0026#34;4.1\u0026#34; reloadable = true [libraries] windows.debug.x86_64 = \u0026#34;res://bin/GodotTest.windows.template_debug.x86_64.dll\u0026#34; android.debug.arm64 = \u0026#34;res://bin/GodotTest.android.template_release.arm64.so\u0026#34; android.arm64 = \u0026#34;res://bin/GodotTest.android.template_release.arm64.so\u0026#34; register_types 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 /* godot-cpp integration testing project. * * This is free and unencumbered software released into the public domain. */ #include \u0026#34;register_types.h\u0026#34; #include \u0026lt;gdextension_interface.h\u0026gt; #include \u0026lt;godot_cpp/core/class_db.hpp\u0026gt; #include \u0026lt;godot_cpp/core/defs.hpp\u0026gt; #include \u0026lt;godot_cpp/godot.hpp\u0026gt; #include \u0026lt;sys/stat.h\u0026gt; #include \u0026#34;godot_cpp/classes/editor_interface.hpp\u0026#34; #include \u0026#34;godot_cpp/classes/editor_plugin.hpp\u0026#34; #include \u0026#34;godot_cpp/variant/utility_functions.hpp\u0026#34; #include \u0026#34;Test/Fow.h\u0026#34; // Spline #include \u0026#34;Spline/Spline.h\u0026#34; #include \u0026#34;Spline/SplineGizmo.h\u0026#34; #include \u0026#34;Spline/SplineGizmoPlugin.h\u0026#34; //Profiler #include \u0026#34;ProfilerLib/ProfilerUI.h\u0026#34; #include \u0026#34;ProfilerLib/ProfilerTest.h\u0026#34; using namespace godot; class MyEditorPlugin : public EditorPlugin { GDCLASS(MyEditorPlugin, EditorPlugin); Ref\u0026lt;SplineGizmoPlugin\u0026gt; gizmo_plugin; protected: static void _bind_methods() { } public: virtual void _enter_tree() override { UtilityFunctions::print(\u0026#34;Init :: MyEditorPlugin :: _enter_tree\u0026#34;); gizmo_plugin.instantiate(); gizmo_plugin-\u0026gt;create_handle_material(\u0026#34;HandleMat\u0026#34;); gizmo_plugin-\u0026gt;create_material(\u0026#34;RedMat\u0026#34;, Color(1.0f, 0.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;GreenMat\u0026#34;, Color(0.0f, 1.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;BlueMat\u0026#34;, Color(0.0f, 0.0f, 1.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color1\u0026#34;, Color(0.0f, 1.0f, 1.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color2\u0026#34;, Color(1.0f, 0.0f, 1.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color3\u0026#34;, Color(1.0f, 1.0f, 0.0f)); gizmo_plugin-\u0026gt;create_material(\u0026#34;Color4\u0026#34;, Color(1.0f, 1.0f, 1.0f)); add_node_3d_gizmo_plugin(gizmo_plugin); } virtual void _exit_tree() override { UtilityFunctions::print(\u0026#34;UnInit :: MyEditorPlugin :: _exit_tree\u0026#34;); remove_node_3d_gizmo_plugin(gizmo_plugin); } }; void initialize_GodotTest_module(ModuleInitializationLevel p_level) { if (p_level == MODULE_INITIALIZATION_LEVEL_SCENE) { UtilityFunctions::print(\u0026#34;Init :: Scene\u0026#34;); GDREGISTER_CLASS(FowTexture); GDREGISTER_CLASS(Spline); GDREGISTER_CLASS(ProfilerContext); GDREGISTER_CLASS(ProfilerUI); GDREGISTER_CLASS(ProfilerTest); } if (p_level == MODULE_INITIALIZATION_LEVEL_EDITOR) { UtilityFunctions::print(\u0026#34;Init :: Editor\u0026#34;); GDREGISTER_CLASS(SplineGizmo); GDREGISTER_CLASS(SplineGizmoPlugin); GDREGISTER_CLASS(MyEditorPlugin); EditorPlugins::add_by_type\u0026lt;MyEditorPlugin\u0026gt;(); } UtilityFunctions::print(\u0026#34;Init :: None :: \u0026#34;, p_level); } void uninitialize_GodotTest_module(ModuleInitializationLevel p_level) { if (p_level == MODULE_INITIALIZATION_LEVEL_SCENE) { UtilityFunctions::print(\u0026#34;UnInit :: Scene\u0026#34;); // return; } if (p_level == MODULE_INITIALIZATION_LEVEL_EDITOR) { UtilityFunctions::print(\u0026#34;UnInit :: Editor\u0026#34;); EditorPlugins::remove_by_type\u0026lt;MyEditorPlugin\u0026gt;(); // return; } } extern \u0026#34;C\u0026#34; { // Initialization. GDExtensionBool GDE_EXPORT GodotTest_library_init(GDExtensionInterfaceGetProcAddress p_get_proc_address, GDExtensionClassLibraryPtr p_library, GDExtensionInitialization *r_initialization) { godot::GDExtensionBinding::InitObject init_obj(p_get_proc_address, p_library, r_initialization); init_obj.register_initializer(initialize_GodotTest_module); init_obj.register_terminator(uninitialize_GodotTest_module); init_obj.set_minimum_library_initialization_level( MODULE_INITIALIZATION_LEVEL_SCENE); return init_obj.init(); } } SConstruct SConstructç”¨äºé…ç½®GDExtensionçš„ç¼–è¯‘ç¯å¢ƒï¼Œ\nå¯ä»¥æŒ‡å®šç¼–è¯‘çš„ä¸­é—´æ–‡ä»¶çš„æ”¾ç½®è·¯å¾„ï¼Œ ä»¥åŠæœ€ç»ˆè¾“å‡ºçš„é“¾æ¥åº“çš„åç§°å’Œä½ç½® è¿˜æœ‰å¼•å…¥çš„ä¸‰æ–¹åº“ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 #!/usr/bin/env python import os import sys def log_env(env,key): print(f\u0026#34;{key}:{env[key]}\u0026#34;) env = SConscript(\u0026#34;godot-cpp/SConstruct\u0026#34;) project_name = \u0026#34;Godot_DemoSR\u0026#34; # For reference: # - CCFLAGS are compilation flags shared between C and C++ # - CFLAGS are for C-specific compilation flags # - CXXFLAGS are for C++-specific compilation flags # - CPPFLAGS are for pre-processor flags # - CPPDEFINES are for pre-processor defines # - LINKFLAGS are for linking flags # tweak this if you want to use different folders, or more folders, to store your source code in. env.VariantDir(\u0026#39;build\u0026#39;, \u0026#39;src\u0026#39;, duplicate=0) env.Append(CPPPATH=[\u0026#34;build/\u0026#34;]) sources = Glob(\u0026#34;build/*.cpp\u0026#34;) + Glob(\u0026#34;build/**/*.cpp\u0026#34;) + Glob(\u0026#34;build/**/**/*.cpp\u0026#34;) if env[\u0026#34;platform\u0026#34;] == \u0026#34;macos\u0026#34;: library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR.{}.{}.framework/libgdDemoSR.{}.{}\u0026#34;.format( project_name, env[\u0026#34;platform\u0026#34;], env[\u0026#34;target\u0026#34;], env[\u0026#34;platform\u0026#34;], env[\u0026#34;target\u0026#34;] ), source=sources, ) elif env[\u0026#34;platform\u0026#34;] == \u0026#34;windows\u0026#34;: env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;/std:c++17\u0026#34;) env.Append(CXXFLAGS = [\u0026#34;/std:c++20\u0026#34;,\u0026#34;/W4\u0026#34;, \u0026#34;/WX\u0026#34;, \u0026#34;/wd4100\u0026#34;,\u0026#34;/wd4244\u0026#34;,\u0026#34;/wd4305\u0026#34;,\u0026#34;/wd4201\u0026#34;,\u0026#34;/wd4127\u0026#34;,\u0026#34;/wd4267\u0026#34;,\u0026#34;/wd5054\u0026#34;,\u0026#34;/wd4996\u0026#34;,\u0026#34;/Zi\u0026#34;,\u0026#34;/FS\u0026#34;]) env.Append(LIBS = [\u0026#34;libzmq\u0026#34;]) env.Append(CPPDEFINES=[\u0026#34;ZMQ_STATIC\u0026#34;]) env.Append(LIBPATH = [\u0026#34;./lib/windows\u0026#34;]) library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR{}{}\u0026#34;.format(project_name, env[\u0026#34;suffix\u0026#34;], env[\u0026#34;SHLIBSUFFIX\u0026#34;]), source=sources, ) elif env[\u0026#34;platform\u0026#34;] == \u0026#34;android\u0026#34;: env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-std=c++17\u0026#34;) env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-fno-exceptions\u0026#34;) # env[\u0026#34;CXX\u0026#34;] = env[\u0026#34;CXX\u0026#34;].replace(\u0026#34;23.2.8568313\u0026#34;,\u0026#34;27.0.12077973\u0026#34;) env.Append(CXXFLAGS = [\u0026#34;-std=c++20\u0026#34;,\u0026#34;-fexceptions\u0026#34;,\u0026#39;-Wall\u0026#39;, \u0026#39;-Wextra\u0026#39;, \u0026#39;-Werror\u0026#39;,\u0026#34;-Wno-unused-parameter\u0026#34;]) env.Append(LIBS = [\u0026#34;libzmq\u0026#34;,\u0026#34;GLESv3\u0026#34;]) env.Append(CPPDEFINES=[\u0026#34;ZMQ_STATIC\u0026#34;,\u0026#34;NS_ANDROID\u0026#34;]) env.Append(LIBPATH = [\u0026#34;./lib/android\u0026#34;]) library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR{}{}\u0026#34;.format(project_name, env[\u0026#34;suffix\u0026#34;], env[\u0026#34;SHLIBSUFFIX\u0026#34;]), source=sources, ) else: env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-std=c++17\u0026#34;) env[\u0026#34;CXXFLAGS\u0026#34;].remove(\u0026#34;-fno-exceptions\u0026#34;) env.Append(CXXFLAGS = [\u0026#34;-std=c++20\u0026#34;,\u0026#34;-fexceptions\u0026#34;,\u0026#39;-Wall\u0026#39;, \u0026#39;-Wextra\u0026#39;, \u0026#34;-Wno-unused-parameter\u0026#34;,\u0026#34;-Wno-changes-meaning\u0026#34;]) env.Append(LIBS = [\u0026#34;libzmq\u0026#34;,\u0026#34;GLESv3\u0026#34;]) env.Append(CPPDEFINES=[\u0026#34;ZMQ_STATIC\u0026#34;]) env.Append(LIBPATH = [\u0026#34;./lib\u0026#34;]) library = env.SharedLibrary( \u0026#34;{}/bin/libgdDemoSR{}{}\u0026#34;.format(project_name, env[\u0026#34;suffix\u0026#34;], env[\u0026#34;SHLIBSUFFIX\u0026#34;]), source=sources, ) Default(library) ","date":"2025-11-04T16:08:31+08:00","image":"https://Liyufei1.github.io/guidao4.jpg","permalink":"https://Liyufei1.github.io/p/godot%E4%B8%80%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E5%8F%8A%E7%A4%BA%E4%BE%8B/","title":"ã€godotã€‘ä¸€ã€å¼€å‘ç¯å¢ƒéƒ¨ç½²åŠç¤ºä¾‹"},{"content":"å‰ç½®å·¥å…· ç½‘ç«™å‰ç«¯å·¥å…·-hugoè½¯ä»¶ ï¼šhugo hugoä¸»é¢˜ä¸‹è½½çº¿ä»“åº“ï¼šhugo-theme å‚è€ƒæ•™ç¨‹ï¼šæ•™ç¨‹ hugo hugoæŒ‡ä»¤ ä¸‹æ–¹åˆ—ä¸¾äº†hugoå¸¸ç”¨æŒ‡ä»¤\n1 2 3 4 5 6 7 8 9 // åˆ›å»ºæ–°ç«™ç‚¹ hugo new site myblog // å¯åŠ¨æœåŠ¡ hugo server -D hugo server --buildDrafts // ç”Ÿæˆæ–°çš„é¡µé¢ hugo new Content \u0026#34;posts/new-post.md\u0026#34; hugo.yaml hugo.yamlæ˜¯hugoç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å¯ä»¥é…ç½®ç½‘ç«™çš„æ ‡é¢˜ã€æè¿°ã€ä½œè€…ã€ä¸»é¢˜ç­‰ç­‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 //é…ç½®æ¯é¡µæ–‡ç« æ•°é‡ pagination: pagerSize: 3 //é…ç½®é“¾æ¥ baseurl: https://example.com/ //é¡µé¢æ ‡ç­¾çš„å°å›¾æ ‡è®¾ç½® favicon: /favicon.png article: math: true //æ•°å­¦å…¬å¼ toc: true //ç›®å½• readingTime: true //é˜…è¯»æ—¶é—´ license: enabled: true //è®¸å¯è¯´æ˜ default: Licensed under [Liyufei1](https://github.com/Liyufei1) markdownè¯­æ³• å®˜æ–¹æ–‡æ¡£é“¾æ¥ï¼š markdownè¯­æ³•\nä¸‹æ–¹ä¸ºå¸¸ç”¨çš„è¯­æ³•ï¼Œå¯ä»¥å¿«é€Ÿç”Ÿæˆ\nå¸¸ç”¨ åç§° è¯­æ³• ç¤ºä¾‹ åŠ ç²— \u0026quot; **åŠ ç²—** \u0026quot; åŠ ç²— å€¾æ–œ \u0026quot; *å€¾æ–œ* \u0026quot; å€¾æ–œ åˆ é™¤çº¿ \u0026quot; ~~åˆ é™¤çº¿~~ \u0026quot; åˆ é™¤çº¿ ä»£ç å— \u0026quot; ```shell ä»£ç å—\n``` \u0026quot; shell ä»£ç å— ä»£ç è¡Œ \u0026quot; `ä»£ç è¡Œ` \u0026quot; ä»£ç è¡Œ æ ‡é¢˜ \u0026quot; # æ ‡é¢˜ \u0026quot; # æ ‡é¢˜ åºåˆ— \u0026quot; 1. åºåˆ— \u0026quot; 1. åºåˆ— æ— åºåºåˆ— \u0026quot; - æ— åºåºåˆ— \u0026quot; - æ— åºåºåˆ— å¼•ç”¨ \u0026quot; \u0026gt; å¼•ç”¨ \u0026quot; \u0026gt; å¼•ç”¨ é“¾æ¥ \u0026quot; [é“¾æ¥](https://www.baidu.com) \u0026quot; é“¾æ¥ åˆ—è¡¨ æ•ˆæœå¦‚ä¸‹ï¼š\nå·¦å¯¹é½ å±…ä¸­ å³å¯¹é½ a b c 1 2 3 ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 | å·¦å¯¹é½ | å±…ä¸­ | å³å¯¹é½ | |:-------|:----:|-------:| | a | b | c | | 1 | 2 | 3 | å›¾ç‰‡ ![å›¾ç‰‡è¯´æ˜](guidao2.jpg)\næ­¥éª¤ åˆ›å»ºæœ¬åœ°æ–°ç«™ç‚¹ è¿è¡Œå‘½ä»¤hugo new site devï¼Œåˆ©ç”¨hugoåˆ›å»ºæœ¬åœ°æ–°ç«™ç‚¹ã€‚åˆ›å»ºå®Œæˆåï¼Œå¯ä»¥è¿è¡Œå‘½ä»¤hugo server -Dæ¥è¿è¡Œæ–°å»ºçš„ç«™ç‚¹ï¼Œåœ¨æµè§ˆå™¨ä¸­å¯ä»¥éªŒè¯æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚ åˆ°ä¸Šhugo-themeä¸‹è½½ä¸­æ„çš„ä¸»é¢˜ï¼ˆæœ¬åšå®¢é‡‡ç”¨stackï¼‰ï¼Œå°†ä¸‹è½½çš„ä¸»é¢˜å¤åˆ¶åˆ°æ–°ç«™ç‚¹çš„themesæ–‡ä»¶å¤¹ä¸‹ã€‚ æ­¤æ—¶æ‰§è¡Œå‘½ä»¤hugo server -Då¯åŠ¨æœåŠ¡ï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®æœ¬åœ°åœ°å€ï¼Œå¯ä»¥çœ‹åˆ°æ–°å»ºçš„æ¨¡æ¿ç½‘é¡µ éƒ¨ç½²åˆ°github è¿è¡ŒæŒ‡ä»¤hugo -Dåˆ©ç”¨hugoæ„å»ºé™æ€ç½‘é¡µï¼Œæ­¤æ—¶åœ¨æˆ‘ä»¬çš„æœ¬åœ°ç½‘ç«™æ–‡ä»¶å¤¹ä¸‹æ–¹ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†ä¸€ä¸ªåä¸ºpublicçš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾äº†é™æ€ç½‘é¡µã€‚ åˆ›å»ºgithubä»“åº“ï¼Œéœ€è¦æ³¨æ„ä»“åº“å‘½åä¸ºï¼š\u0026lt;githubç”¨æˆ·å\u0026gt;.github.ioï¼Œåªæœ‰æŒ‰ç…§è¿™ä¸ªè§„èŒƒå‘½åï¼Œgithubæ‰ä¼šå°†é™æ€ç½‘é¡µéƒ¨ç½²åˆ°githubPagesä¸­ã€‚ å°†publicæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°æ­¥éª¤2ä¸­åˆ›å»ºçš„githubä»“åº“ä¸­ã€‚ç„¶ååœ¨ä»“åº“ä¸­è¿è¡ŒPagesé…ç½®ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå³å¯çœ‹åˆ°é™æ€ç½‘é¡µã€‚ githugçš„è‡ªåŠ¨æ„å»º åˆ›å»ºgithubä»“åº“ï¼Œæ­¤ä»“åº“å»ºè®®ä¸ºç§æœ‰ä»“åº“ï¼Œç”¨äºä¿å­˜æœ¬åœ°çš„hugoç½‘ç«™ï¼Œå³çœŸæ­£çš„åšå®¢ä»“åº“ï¼ˆä¸Šæ–¹å‘å¸ƒçš„ä»…ä¸ºé™æ€ç½‘é¡µä»“åº“ï¼‰ã€‚ åˆ›å»º.github/workflows/hugo.ymlæ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\néœ€è¦æ³¨æ„çš„æ˜¯TOKENä¸ºgithubçš„tokenï¼Œéœ€è¦åœ¨githubçš„settingä¸­åˆ›å»ºã€‚åŒæ—¶æ³¨æ„åŒæ­¥çš„åˆ†æ”¯ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 name: deploy on: push: branches: - master jobs: deploy: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v4 with: fetch-depth: 0 - name: Setup Hugo uses: peaceiris/actions-hugo@v3 with: hugo-version: \u0026#34;latest\u0026#34; extended: true - name: Build Web run: hugo -D - name: Deploy Web uses: peaceiris/actions-gh-pages@v4 with: PERSONAL_TOKEN: ${{ secrets.TOKEN }} EXTERNAL_REPOSITORY: Liyufei1/Liyufei1.github.io PUBLISH_BRANCH: master PUBLISH_DIR: ./public commit_message: auto deploy åœ¨githubä¸­åˆ›å»ºTOKENï¼Œå¹¶æ·»åŠ åˆ°blogä»“åº“ä¸­ã€‚åˆ›å»ºtokenæ—¶éœ€è¦å‹¾é€‰repoæƒé™ä»¥åŠworkflowæƒé™ã€‚åˆ›å»ºå®Œæ¯•åï¼Œåœ¨blogä»“åº“ä¸­é…ç½®è¯¥TOKENã€‚åç»­æœ‰ä»£ç æäº¤æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨æ„å»ºé™æ€ç½‘é¡µå¹¶éƒ¨ç½²åˆ°githubPagesä¸­ã€‚ ","date":"2025-11-03T16:08:31+08:00","image":"https://Liyufei1.github.io/p/blog-build/guidao3_hu_b46614b8b19cebf7.jpg","permalink":"https://Liyufei1.github.io/p/blog-build/","title":"Blog Build"},{"content":"æ­£æ–‡æµ‹è¯• è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ï¼Œ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æ—¢ç„¶å¦‚ä½•ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ æˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹ä¸€ä¸ªéå¸¸å°´å°¬çš„äº‹å®ï¼Œé‚£å°±æ˜¯ï¼Œ å¯æ˜¯ï¼Œå³ä½¿æ˜¯è¿™æ ·ï¼Œå­¦ç”Ÿä¼šé€€ä¼šçš„å‡ºç°ä»ç„¶ä»£è¡¨äº†ä¸€å®šçš„æ„ä¹‰ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œå‘ç”Ÿäº†ä¼šå¦‚ä½•ï¼Œä¸å‘ç”Ÿåˆä¼šå¦‚ä½•ã€‚ ç»è¿‡ä¸Šè¿°è®¨è®ºï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ è¿™æ ·çœ‹æ¥ï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å°±æˆ‘ä¸ªäººæ¥è¯´ï¼Œå­¦ç”Ÿä¼šé€€ä¼šå¯¹æˆ‘çš„æ„ä¹‰ï¼Œä¸èƒ½ä¸è¯´éå¸¸é‡å¤§ã€‚ èå£«æ¯”äºšæ›¾ç»æåˆ°è¿‡ï¼Œäººçš„ä¸€ç”Ÿæ˜¯çŸ­çš„ï¼Œä½†å¦‚æœå‘åŠ£åœ°è¿‡è¿™ä¸€ç”Ÿï¼Œå°±å¤ªé•¿äº†ã€‚è¿™ä¼¼ä¹è§£ç­”äº†æˆ‘çš„ç–‘æƒ‘ã€‚ è«æ‰ç‰¹è¯´è¿‡ä¸€å¥å¯Œæœ‰å“²ç†çš„è¯ï¼Œè°å’Œæˆ‘ä¸€æ ·ç”¨åŠŸï¼Œè°å°±ä¼šå’Œæˆ‘ä¸€æ ·æˆåŠŸã€‚è¿™å¯å‘äº†æˆ‘ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ äº†è§£æ¸…æ¥šå­¦ç”Ÿä¼šé€€ä¼šåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ï¼Œæ˜¯è§£å†³ä¸€åˆ‡é—®é¢˜çš„å…³é”®ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ã€‚\nå¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸºæ›¾ç»è¯´è¿‡ï¼Œå…±åŒçš„äº‹ä¸šï¼Œå…±åŒçš„æ–—äº‰ï¼Œå¯ä»¥ä½¿äººä»¬äº§ç”Ÿå¿å—ä¸€åˆ‡çš„åŠ›é‡ã€‚ã€€å¸¦ç€è¿™å¥è¯ï¼Œæˆ‘ä»¬è¿˜è¦æ›´åŠ æ…é‡çš„å®¡è§†è¿™ä¸ªé—®é¢˜ï¼š ä¸€èˆ¬æ¥è®²ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»åŠ¡å¿…æ…é‡çš„è€ƒè™‘è€ƒè™‘ã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æˆ‘è®¤ä¸ºï¼Œ æˆ‘è®¤ä¸ºï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ è¦æƒ³æ¸…æ¥šï¼Œå­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ã€‚ æˆ‘è®¤ä¸ºï¼Œ æ—¢ç„¶å¦‚æ­¤ï¼Œ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ é‚£ä¹ˆï¼Œ æˆ‘è®¤ä¸ºï¼Œ å­¦ç”Ÿä¼šé€€ä¼šå› ä½•è€Œå‘ç”Ÿã€‚\nå¼•ç”¨ æ€å¿µæ˜¯æœ€æš–çš„å¿§ä¼¤åƒä¸€åŒç¿…è†€\nè®©æˆ‘åœä¸äº†é£ä¸è¿œåœ¨è¿‡å¾€æ¸¸è¡\nä¸å‘Šè€Œåˆ«çš„ä½  å°±ç®—ä¸ºäº†æˆ‘ç€æƒ³\nè¿™ä¹ˆæ²‰ç—›çš„å‘µæŠ¤ æˆ‘æ€ä¹ˆèƒ½ç¿±ç¿”\næœ€æš–çš„æ†‚å‚· - ç”°é¦¥ç”„\nå›¾ç‰‡ 1 2 3 ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg) ![Photo by Luca Bravo on Unsplash](luca-bravo-alS7ewQ41M8-unsplash.jpg) ![Photo by Helena Hertz on Unsplash](helena-hertz-wWZzXlDpMog-unsplash.jpg) ![Photo by Hudai Gayiran on Unsplash](hudai-gayiran-3Od_VKcDEAA-unsplash.jpg) ç›¸å†Œè¯­æ³•æ¥è‡ª Typlog\n","date":"2020-09-09T00:00:00Z","image":"https://Liyufei1.github.io/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu_2307260c751d0e0b.jpg","permalink":"https://Liyufei1.github.io/p/test-chinese/","title":"Chinese Test"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2019-03-11T00:00:00Z","image":"https://Liyufei1.github.io/p/markdown-syntax-guide/pawel-czerwinski-8uZPynIu-rQ-unsplash_hu_e95a4276bf860a84.jpg","permalink":"https://Liyufei1.github.io/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"},{"content":"Lorem est tota propiore conpellat pectoribus de pectora summo.\nRedit teque digerit hominumque toris verebor lumina non cervice subde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc caluere tempus inhospita parcite confusaque translucet patri vestro qui optatis lumine cognoscere flos nubis! Fronde ipsamque patulos Dryopen deorum.\nExierant elisi ambit vivere dedere Duce pollice Eris modo Spargitque ferrea quos palude Rursus nulli murmur; hastile inridet ut ab gravi sententia! Nomine potitus silentia flumen, sustinet placuit petis in dilapsa erat sunt. Atria tractus malis.\nComas hunc haec pietate fetum procerum dixit Post torum vates letum Tiresia Flumen querellas Arcanaque montibus omnes Quidem et Vagus elidunt The Van de Graaf Canon\nMane refeci capiebant unda mulcebat Victa caducifer, malo vulnere contra dicere aurato, ludit regale, voca! Retorsit colit est profanae esse virescere furit nec; iaculi matertera et visa est, viribus. Divesque creatis, tecta novat collumque vulnus est, parvas. Faces illo pepulere tempus adest. Tendit flamma, ab opes virum sustinet, sidus sequendo urbis.\nIubar proles corpore raptos vero auctor imperium; sed et huic: manus caeli Lelegas tu lux. Verbis obstitit intus oblectamina fixis linguisque ausus sperare Echionides cornuaque tenent clausit possit. Omnia putatur. Praeteritae refert ausus; ferebant e primus lora nutat, vici quae mea ipse. Et iter nil spectatae vulnus haerentia iuste et exercebat, sui et.\nEurytus Hector, materna ipsumque ut Politen, nec, nate, ignari, vernum cohaesit sequitur. Vel mitis temploque vocatus, inque alis, oculos nomen non silvis corpore coniunx ne displicet illa. Crescunt non unus, vidit visa quantum inmiti flumina mortis facto sic: undique a alios vincula sunt iactata abdita! Suspenderat ego fuit tendit: luna, ante urbem Propoetides parte.\n","date":"2019-03-09T00:00:00Z","image":"https://Liyufei1.github.io/p/placeholder-text/matt-le-SJSpo9hQf7s-unsplash_hu_c1ca39d792aee4ab.jpg","permalink":"https://Liyufei1.github.io/p/placeholder-text/","title":"Placeholder Text"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTeX globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTeX on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples Inline math: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$\nBlock math: $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$","date":"2019-03-08T00:00:00Z","permalink":"https://Liyufei1.github.io/p/math-typesetting/","title":"Math Typesetting"},{"content":"Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your site\u0026rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nğŸ™ˆ :see_no_evil: ğŸ™‰ :hear_no_evil: ğŸ™Š :speak_no_evil:\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3 .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; } ","date":"2019-03-05T00:00:00Z","image":"https://Liyufei1.github.io/p/emoji-support/the-creative-exchange-d2zvqp3fpro-unsplash_hu_27b8954607cdb515.jpg","permalink":"https://Liyufei1.github.io/p/emoji-support/","title":"Emoji Support"},{"content":"Hugo åšå®¢é¡¹ç›®æŒ‡å— é¡¹ç›®æ¦‚è¿° è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Hugo é™æ€ç½‘ç«™ç”Ÿæˆå™¨æ„å»ºçš„ä¸ªäººæŠ€æœ¯åšå®¢é¡¹ç›®ã€‚åšå®¢ä¸»è¦èšç„¦äº Godot æ¸¸æˆå¼•æ“å¼€å‘æŠ€æœ¯å’Œ Hugo åšå®¢æ­å»ºç›¸å…³æ•™ç¨‹ã€‚ä»å†…å®¹æ¥çœ‹ï¼Œä½œè€… Liyufei1 ä¸“æ³¨äº Godot å¼•æ“çš„æ·±åº¦å¼€å‘ï¼ŒåŒ…æ‹¬ Modules å¼€å‘ã€GDExtension å¼€å‘ã€æ€§èƒ½ç»Ÿè®¡ã€åŠ¨æ€ç±»å‹ä¿¡æ¯ä»¥åŠç¼–è¾‘å™¨æ’ä»¶ç­‰é«˜çº§ä¸»é¢˜ã€‚\né¡¹ç›®ä½¿ç”¨ GitHub Pages è¿›è¡Œéƒ¨ç½²ï¼Œé€šè¿‡ GitHub Actions å®ç°è‡ªåŠ¨åŒ–æ„å»ºå’Œå‘å¸ƒæµç¨‹ã€‚\nç›®å½•ç»“æ„ 1 2 3 4 5 6 7 8 9 10 11 12 13 content/post/ â”œâ”€â”€ blog-with-hugo/ # Hugo åšå®¢æ­å»ºæ•™ç¨‹ â”œâ”€â”€ chinese-test/ # ä¸­æ–‡æµ‹è¯•æ–‡ç«  â”œâ”€â”€ emoji-support/ # è¡¨æƒ…æ”¯æŒç¤ºä¾‹ â”œâ”€â”€ godotå¼•æ“-0å¼€å‘ç¯å¢ƒéƒ¨ç½²/ # Godot å¼€å‘ç¯å¢ƒæ­å»º â”œâ”€â”€ godotå¼•æ“1moduleså¼€å‘æŒ‡å—/ # Godot Modules å¼€å‘ â”œâ”€â”€ godotå¼•æ“2gdextensionå¼€å‘æŒ‡å—/ # Godot GDExtension å¼€å‘ â”œâ”€â”€ godotå¼•æ“3æ€§èƒ½ç»Ÿè®¡/ # Godot æ€§èƒ½ç»Ÿè®¡ â”œâ”€â”€ godotå¼•æ“4åŠ¨æ€ç±»å‹ä¿¡æ¯/ # Godot åŠ¨æ€ç±»å‹ä¿¡æ¯ â”œâ”€â”€ godotå¼•æ“5ç¼–è¾‘å™¨æ’ä»¶/ # Godot ç¼–è¾‘å™¨æ’ä»¶å¼€å‘ â”œâ”€â”€ markdown-syntax/ # Markdown è¯­æ³•ç¤ºä¾‹ â”œâ”€â”€ math-typesetting/ # æ•°å­¦å…¬å¼æ’ç‰ˆ â””â”€â”€ placeholder-text/ # å ä½æ–‡æœ¬ç¤ºä¾‹ ä¸»è¦å†…å®¹åˆ†ç±» 1. Hugo åšå®¢æ­å»º Hugo é™æ€ç½‘ç«™ç”Ÿæˆå™¨ä½¿ç”¨æ•™ç¨‹ GitHub Pages éƒ¨ç½²æµç¨‹ è‡ªåŠ¨åŒ–æ„å»ºé…ç½®ï¼ˆGitHub Actionsï¼‰ ä¸»é¢˜é€‰æ‹©å’Œé…ç½® 2. Godot å¼•æ“å¼€å‘ å¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼šGodot æºç ç¼–è¯‘ã€GDExtensionã€Modules å¼€å‘ç¯å¢ƒé…ç½® Modules å¼€å‘æŒ‡å—ï¼šGodot åº•å±‚å®¹å™¨ã€ç±»å‹ç³»ç»Ÿã€GUI ç»„ä»¶ã€å®šæ—¶å™¨ç­‰å¼€å‘æŒ‡å— GDExtension å¼€å‘æŒ‡å—ï¼šC++ æ‰©å±•å¼€å‘ï¼Œä¸ Godot å¼•æ“é›†æˆ æ€§èƒ½ç»Ÿè®¡ï¼šæ€§èƒ½åˆ†æå’Œä¼˜åŒ–æŠ€æœ¯ åŠ¨æ€ç±»å‹ä¿¡æ¯ï¼šGodot åŠ¨æ€ç±»å‹ç³»ç»Ÿè¯¦è§£ ç¼–è¾‘å™¨æ’ä»¶ï¼šè‡ªå®šä¹‰ç¼–è¾‘å™¨åŠŸèƒ½å¼€å‘ Hugo é…ç½®è¦ç‚¹ æ ¹æ®é¡¹ç›®ç»“æ„ï¼Œhugo.yaml é…ç½®åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š\nå¤šè¯­è¨€æ”¯æŒï¼ˆä¸­æ–‡ï¼‰ åˆ†ç±»ç³»ç»Ÿï¼ˆcategoriesï¼‰ å›¾ç‰‡å’Œå¤šåª’ä½“æ”¯æŒ æ•°å­¦å…¬å¼æ¸²æŸ“ è‡ªå®šä¹‰ä¸»é¢˜é…ç½® æ„å»ºå’Œè¿è¡Œ 1 2 3 4 5 6 7 8 9 10 11 # å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼ˆåŒ…å«è‰ç¨¿æ–‡ç« ï¼‰ hugo server -D # æˆ–è€… hugo server --buildDrafts # æ„å»ºé™æ€ç½‘ç«™ hugo -D # åˆ›å»ºæ–°æ–‡ç«  hugo new content \u0026#34;posts/new-post.md\u0026#34; éƒ¨ç½²æµç¨‹ æœ¬åœ°ä½¿ç”¨ Hugo æ„å»ºé™æ€ç½‘é¡µï¼Œç”Ÿæˆåœ¨ public ç›®å½• è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ° GitHub Pagesï¼ˆ\u0026lt;githubç”¨æˆ·å\u0026gt;.github.ioï¼‰ é€šè¿‡ GitHub Actions å®ç°æŒç»­é›†æˆå’Œéƒ¨ç½² GitHub Actions å·¥ä½œæµæ–‡ä»¶ä½äº .github/workflows/hugo.ymlï¼Œé…ç½®äº† Hugo çš„è‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²ã€‚\nå¼€å‘çº¦å®š æ–‡ç« ä½¿ç”¨ Markdown æ ¼å¼ç¼–å†™ï¼ŒåŒ…å« TOML æ ¼å¼çš„å‰ç½®å…ƒæ•°æ® æ”¯æŒè‰ç¨¿çŠ¶æ€ï¼ˆdraft = trueï¼‰ å›¾ç‰‡èµ„æºä¸æ–‡ç« å†…å®¹æ”¾ç½®åœ¨åŒä¸€ç›®å½• ä½¿ç”¨ BBCode è¿›è¡Œå¯Œæ–‡æœ¬æ ¼å¼åŒ– æ”¯æŒæ•°å­¦å…¬å¼æ¸²æŸ“ æŠ€æœ¯æ ˆ é™æ€ç½‘ç«™ç”Ÿæˆå™¨: Hugo éƒ¨ç½²å¹³å°: GitHub Pages è‡ªåŠ¨åŒ–å·¥å…·: GitHub Actions ä¸»é¢˜: Hugo Stack (æˆ–å…¶ä»–è‡ªå®šä¹‰ä¸»é¢˜) ä¸»è¦è¯­è¨€: ä¸­æ–‡ å†…å®¹ç‰¹ç‚¹ åšå®¢å†…å®¹æŠ€æœ¯æ·±åº¦è¾ƒé«˜ï¼Œç‰¹åˆ«åœ¨ Godot å¼•æ“å¼€å‘æ–¹é¢æ¶µç›–äº†ä»åŸºç¡€ç¯å¢ƒæ­å»ºåˆ°é«˜çº§å®šåˆ¶å¼€å‘çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ã€‚æ–‡ç« åŒ…å«å¤§é‡ä»£ç ç¤ºä¾‹å’Œé…ç½®è¯´æ˜ï¼Œé€‚åˆæœ‰ä¸€å®šç¼–ç¨‹åŸºç¡€çš„å¼€å‘è€…å‚è€ƒå­¦ä¹ ã€‚\n","date":"0001-01-01T00:00:00Z","permalink":"https://Liyufei1.github.io/p/","title":""}]